(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return c});var r=n(37),i=n(19),a="A".codePointAt(0);function o(e){for(var t=[],n=[""],i=e;i>0;){var a=[];e:for(var o=0,s=n;o<s.length;o++){var l=s[o],c=!0,u=!1,h=void 0;try{for(var d,p="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var f=d.value;if(0===i)break e;a.push("".concat(l).concat(f)),i-=1}}catch(b){u=!0,h=b}finally{try{c||null==p.return||p.return()}finally{if(u)throw h}}}n=a,t=[].concat(Object(r.a)(t),a)}return t}function s(e){var t=[],n=a,r=e+1;do{var i=n+(r-=1)%26,o=String.fromCodePoint(i);t.push(o),r=Math.floor(r/26)}while(r>0);return t.reverse().join("")}function l(e){var t=e.split("-"),n=Object(i.a)(t,2),r=n[0],o=n[1];return[r.split("").reduce(function(e,t){return 26*e+t.charCodeAt(0)-a+1},0)-1,+o-1]}function c(e){var t=Boolean(e.match(/^[.\d]+$/)),n=(e.match(/\./g)||[]).length;return!!t&&(!(n>1)&&(1!==e.length||"."!==e[0]))}},3:function(e,t,n){"use strict";var r=n(5),i=n(7),a=n(32),o=n(31),s=n(18),l=function(){function e(t){Object(r.a)(this,e),this.tokens=t}return Object(i.a)(e,[{key:"sanitize",value:function(){var e=this;return this.tokens.map(function(t){switch(t.type){case u.NUMBER:return e.number(t);case u.CELL:return e.cell(t);case u.FUNCTION:return e.function(t);default:return t}})}},{key:"number",value:function(e){return Object(s.c)(e.text)?(e.value=parseFloat(e.text),e):(e.type=u.TEXT,e)}},{key:"cell",value:function(e){return e.value=this.getCellLabel(e),e}},{key:"function",value:function(e){var t=this.getFunction(e);return t?e.value=t:e.type=u.TEXT,e}},{key:"getCellLabel",value:function(e){var t=e.text,n=t.match(/\d+/).index,r=t.slice(0,n).toUpperCase(),i=t.slice(n);return"".concat(r,"-").concat(i)}},{key:"getFunction",value:function(e){var t=e.text.toUpperCase(),n=o.a[t];return n&&n.fn}}]),e}(),c=function(){function e(t,n,i,a){Object(r.a)(this,e),this.regex=t,this.groupIndex=n,this.token=i,this.category=a}return Object(i.a)(e,[{key:"setIndex",value:function(e){this.regex.lastIndex=e}},{key:"test",value:function(e){return this.regex.exec(e)}}]),e}();n.d(t,"b",function(){return u}),n.d(t,"a",function(){return p});var u={EOF:"EOF",EQUALS:"EQUALS",COMMA:"COMMA",COLON:"COLON",LPAREN:"LPAREN",RPAREN:"RPAREN",PLUS:"PLUS",MINUS:"MINUS",MULT:"MULT",DIV:"DIV",NUMBER:"NUMBER",CELL:"CELL",FUNCTION:"FUNCTION",TEXT:"TEXT"},h=u,d=[new c(/=/g,0,h.EQUALS,"structure"),new c(/,/g,0,h.COMMA,"structure"),new c(/:/g,0,h.COLON,"structure"),new c(/\(/g,0,h.LPAREN,"structure"),new c(/\)/g,0,h.RPAREN,"structure"),new c(/\+/g,0,h.PLUS,"operator"),new c(/\-/g,0,h.MINUS,"operator"),new c(/\*/g,0,h.MULT,"operator"),new c(/\//g,0,h.DIV,"operator"),new c(/[\d\.]+/g,0,h.NUMBER,"entity"),new c(/[a-z]+[\d]+/gi,0,h.CELL,"entity"),new c(/([a-z]+)\(/gi,1,h.FUNCTION,"entity")],p=function(){function e(t){Object(r.a)(this,e),this.input=t,this.index=0,this.char=this.initChar(t),this.markers=[],this.tokens=[]}return Object(i.a)(e,[{key:"getTokens",value:function(){for(;this.char!==h.EOF;){var e=this.nextToken();this.tokens.push(e)}var t=new l(this.tokens);return this.tokens=t.sanitize(),this.tokens}},{key:"nextToken",value:function(){if(this.char===h.EOF)return new a.a(h.EOF,h.EOF,0,"eof",this.index);if(!this.isFormula())return this.tokenTEXTorNUMBER();for(var e,t=this.getWhitespaceLen(),n=0,r=d;n<r.length;n++){var i=r[n];i.setIndex(this.index);var o=i.test(this.input);if(o&&o.index===this.index){var s=o[i.groupIndex];e=new a.a(i.token,s,t,i.category,this.index),this.index+=s.length-1,this.consume();break}}return e||(e=this.tokenTEXT(t)),e}},{key:"initChar",value:function(e){return 0===this.input.length&&(this.input="0",this.index=-1),e[this.index]}},{key:"tokenTEXT",value:function(e){for(var t=[];!(this.isEOF()||this.isSeparator()||this.isWhitespace());)t.push(this.char),this.consume();var n=t.join("");return new a.a(h.TEXT,n,e,"entity",this.index-n.length)}},{key:"tokenTEXTorNUMBER",value:function(){var e;return e=Object(s.c)(this.input)?new a.a(h.NUMBER,this.input,0,"entity",this.index):new a.a(h.TEXT,this.input,0,"entity",this.index),this.index=this.input.length-1,this.consume(),e}},{key:"consume",value:function(){this.index++,this.index<this.input.length?this.char=this.input[this.index]:this.char=h.EOF}},{key:"isFormula",value:function(){return"="===this.input[0]}},{key:"isEOF",value:function(){return this.char===h.EOF}},{key:"isWhitespace",value:function(){return!this.isEOF()&&Boolean(this.char.match(/\s/))}},{key:"isSeparator",value:function(){return Boolean(this.char.match(/[\(\)\+\-\/\*]/))}},{key:"getWhitespaceLen",value:function(){for(var e=0;this.isWhitespace();)e++,this.consume();return e}}]),e}();t.c=p},31:function(e,t,n){"use strict";var r=n(29),i={AVERAGE:{fn:function(){var e,t;if(0===arguments.length)throw new Error("Empty elements");return(e=i.SUM).fn.apply(e,arguments)/(t=i.COUNT).fn.apply(t,arguments)},definition:"AVERAGE(value1, value2, ...)",example:"AVERAGE(A1:B3, 3)",summary:"Returns the average from a series of numbers."},CONCAT:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.reduce(function(e,t){return e+t},"")},definition:'CONCAT("text1", "text2", ...)',example:'CONCAT("one", "two")',summary:"Returns a single concatenated string from a series of strings."},COUNT:{fn:function(){return arguments.length},definition:"COUNT(element1, element2, ...)",example:"COUNT(A1:B3, 2, C4)",summary:"Returns the number of non-empty elements in a set."},MAX:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.forEach(function(e){if("number"!==typeof e)throw new TypeError("".concat(e," is not a number"))}),Math.max.apply(Math,t)},definition:"MAX(value1, value2, ...)",example:"MAX(A1:B3, 4, C3)",summary:"Returns the maximum value from a series of numbers"},MIN:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.forEach(function(e){if("number"!==typeof e)throw new TypeError("".concat(e," is not a number"))}),Math.min.apply(Math,t)},definition:"MIN(value1, value2, ...)",example:"MIN(A1:B3, 4, C3)",summary:"Returns the minimum value from a series of numbers."},POWER:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(2!==t.length)throw new Error("Formula takes only two elements");var r=t[0],i=t[1];return Math.pow(r,i)},definition:"POWER(base, exponent)",example:"POWER(A3,2)",summary:"Returns a number raised to an exponent."},SQRT:{fn:function(){if(1!==arguments.length)throw new Error("Formula takes only one element");return Math.sqrt(arguments.length<=0?void 0:arguments[0])},definition:"SQRT(value)",example:"SQRT(9) or SQRT(A3)",summary:"Returns the square root of a number."},SUM:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.reduce(function(e,t){return e+t})},definition:"SUM(value1, value2, ...)",example:"SUM(A1:B3, 3, C5)",summary:"Retuns the sum from a series of numbers."}};i.AVG=Object(r.a)({},i.AVERAGE,{definition:"AVG(value1, value2, ...)",example:"AVG(A1:B3, 3)"}),i.POW=Object(r.a)({},i.POWER,{definition:"POW(base, exponent)",example:"POW(A3,2)"}),t.a=i},32:function(e,t,n){"use strict";var r=n(5);t.a=function e(t,n,i,a,o){Object(r.a)(this,e),this.type=t,this.category=a,this.text=n,this.whitespace=i,this.index=o,this.value=null,this.html=null}},36:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1),i=n.n(r).a.createContext()},38:function(e,t,n){"use strict";var r=n(24),i=Object(r.c)({activeCell:null,cellInputter:null,rows:14,columns:6},{SET_ACTIVE_CELL:function(e,t){var n=t.payload;e.activeCell=n},SET_CELL_INPUTTER:function(e,t){var n=t.payload;e.cellInputter=n},UNSET_CELL_INPUTTER:function(e){e.cellInputter=null}}),a=Object(r.c)({},{SET_CELL_DATA:function(e,t){var n=t.payload,r=n.location,i=n.data;e[r]=i},DELETE_CELL_DATA:function(e,t){delete e[t.payload]}}),o=Object(r.a)({reducer:{global:i,table:a}});t.a=o},39:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=n(24),i=Object(r.b)("SET_ACTIVE_CELL"),a=Object(r.b)("SET_CELL_INPUTTER"),o=Object(r.b)("UNSET_CELL_INPUTTER")},40:function(e,t,n){"use strict";var r=n(19),i=n(37),a=n(7),o=n(5),s=n(38),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.a;Object(o.a)(this,e);var n=t.getState().global;this.store=t,this.rows=n.rows,this.columns=n.columns}return Object(a.a)(e,[{key:"getCellResult",value:function(e){var t=this.table[e];return t&&t.result}},{key:"replaceCellData",value:function(e,t,n){this.store.dispatch(C(e,t,n))}},{key:"clearCell",value:function(e){this.store.dispatch(I(e))}},{key:"table",get:function(){return this.store.getState().table}},{key:"locations",get:function(){return Object.keys(this.table)}}]),e}(),c=n(3),u=n(18),h=n(12),d=n(11),p=n(13),f=function(){function e(t){Object(o.a)(this,e),this._name=t}return Object(a.a)(e,[{key:"eval",value:function(){throw new Error("Implement method.")}}]),e}(),b=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,"TextNode"))).textNode=e,n}return Object(p.a)(t,e),Object(a.a)(t,[{key:"eval",value:function(){return this.textNode.text}}]),t}(f),v=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,"NumberNode"))).numberNode=e,n}return Object(p.a)(t,e),Object(a.a)(t,[{key:"eval",value:function(){return this.value}},{key:"value",get:function(){return this.numberNode.value}}]),t}(f),m=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,"CellNode"))).cell=e,n}return Object(p.a)(t,e),Object(a.a)(t,[{key:"location",get:function(){return this.cell.value}}]),t}(f),y=function(e){function t(e,n){var r;return Object(o.a)(this,t),(r=Object(h.a)(this,Object(d.a)(t).call(this,"UnaryOp"))).opNode=e,r.expr=n,r}return Object(p.a)(t,e),Object(a.a)(t,[{key:"eval",value:function(e){return this.opNode.type===c.b.PLUS?e:this.opNode.type===c.b.MINUS?-e:void 0}}]),t}(f),k=function(e){function t(e,n){var r;return Object(o.a)(this,t),(r=Object(h.a)(this,Object(d.a)(t).call(this,"FuncOp"))).funcNode=e,r.argNodes=n,r}return Object(p.a)(t,e),Object(a.a)(t,[{key:"eval",value:function(e){return this.funcNode.value.apply(void 0,Object(i.a)(e))}}]),t}(f),O=function(e){function t(e,n,r){var i;return Object(o.a)(this,t),(i=Object(h.a)(this,Object(d.a)(t).call(this,"BinaryOp"))).leftNode=e,i.opNode=n,i.rightNode=r,i}return Object(p.a)(t,e),Object(a.a)(t,[{key:"eval",value:function(e,t){switch(this.opNode.type){case c.b.PLUS:return e+t;case c.b.MINUS:return e-t;case c.b.DIV:if(0===t)throw new Error("Division by zero: ".concat(e,"/").concat(t));return e/t;case c.b.MULT:return e*t;default:throw new Error('Unsupported operator "'.concat(this.token.text,'"'))}}}]),t}(f),g=function(){function e(t){Object(o.a)(this,e),this.index=0,this.tokens=t,this.curr=this.tokens[0],this.ast=null,this.hasCellRefs=!1}return Object(a.a)(e,[{key:"parse",value:function(){switch(this.peekType()){case c.b.TEXT:this.ast=this.text();break;case c.b.NUMBER:this.ast=this.number();break;default:this.equals(),this.ast=this.expr()}if(null!==this.curr)throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));return this.ast}},{key:"expr",value:function(){var e,t,n;for(e=this.term();[c.b.PLUS,c.b.MINUS].includes(this.peekType());)t=this.operator(),n=this.term(),e=new O(e,t,n);return e}},{key:"term",value:function(){var e,t,n;for(e=this.factor();[c.b.MULT,c.b.DIV].includes(this.peekType());)t=this.operator(),n=this.factor(),e=new O(e,t,n);return e}},{key:"factor",value:function(){switch(this.peekType()){case c.b.PLUS:case c.b.MINUS:return this.unaryOp();case c.b.NUMBER:return this.number();case c.b.CELL:return this.cell();case c.b.LPAREN:return this.enclosedExpr();case c.b.FUNCTION:return this.func();case c.b.RPAREN:throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));default:throw new Error("Missing factor")}}},{key:"text",value:function(){var e;if(this.peekType()!==c.b.TEXT)throw new Error("Missing string");return e=new b(this.curr),this.consume(),e}},{key:"number",value:function(){if(this.peekType()===c.b.NUMBER){var e=new v(this.curr);return this.consume(),e}throw new Error("Missing number")}},{key:"operator",value:function(){if([c.b.PLUS,c.b.MINUS,c.b.MULT,c.b.DIV].includes(this.peekType())){var e=this.curr;return this.consume(),e}throw new Error("Missing operator")}},{key:"enclosedExpr",value:function(){this.lparen();var e=this.expr();return this.rparen(),e}},{key:"cell",value:function(){if(this.peekType()!==c.b.CELL)throw new Error("Missing cell node");var e=new m(this.curr);return this.hasCellRefs=!0,this.consume(),e}},{key:"func",value:function(){if(this.peekType()!==c.b.FUNCTION)throw new Error("Missing function");var e=this.curr;this.consume(),this.lparen();var t=this.args();return this.rparen(),new k(e,t)}},{key:"args",value:function(){var e=[],t=this.term();for(e.push(t);this.peekType()===c.b.COMMA;)this.consume(),t=this.term(),e.push(t);return e}},{key:"equals",value:function(){if(this.peekType()!==c.b.EQUALS)throw new Error("Missing equals sign");this.consume()}},{key:"lparen",value:function(){if(this.peekType()!==c.b.LPAREN)throw new Error("Missing left parenthesis");this.consume()}},{key:"rparen",value:function(){if(this.peekType()!==c.b.RPAREN)throw new Error("Missing right parenthesis");this.consume()}},{key:"unaryOp",value:function(){if(![c.b.PLUS,c.b.MINUS].includes(this.peekType()))throw new Error("Missing unary operator");var e=this.curr;return this.consume(),new y(e,this.factor())}},{key:"consume",value:function(){this.index<this.tokens.length-1?(this.index++,this.curr=this.tokens[this.index]):this.curr=null}},{key:"peekType",value:function(){return this.curr&&this.curr.type}}]),e}(),x=function(){function e(t){Object(o.a)(this,e),this.location=t,this.error=null,this.cache={},this.result=null,this.state=new l}return Object(a.a)(e,[{key:"interpret",value:function(e){var t,n,r=j.addVertex(this.location,e);try{t=new c.a(e),n=new g(t.getTokens()),r.ast=n.parse(),j.recalculate(this.location),this.result=r.result}catch(i){return this.error=r.error=i,this.result=r.result=this.errorResponse(),this.result}return this.error=r.error,this.result}},{key:"visit",value:function(e){var t=j.getVertex(e);if(j.isResolved(e))return t.result;if(j.markVisited(e),!t.ast)return t.result;try{this.result=t.result=this._visit(t.ast)}catch(n){throw this.error=t.error=n,this.result=t.result=this.errorResponse(),n}return this.result}},{key:"_visit",value:function(e){switch(e._name){case"NumberNode":return this.NumberNode(e);case"CellNode":return this.CellNode(e);case"TextNode":return this.TextNode(e);case"FuncOp":return this.FuncOp(e);case"BinaryOp":return this.BinaryOp(e);case"UnaryOp":return this.UnaryOp(e);default:var t=e._name||(e.constructor||{}).name;throw new Error("Unrecognized AST node ".concat(t))}}},{key:"TextNode",value:function(e){return e.eval()}},{key:"NumberNode",value:function(e){return e.eval()}},{key:"CellNode",value:function(e){var t,n=e.location;if(!this.isLocationValid(n))throw new Error("Location out of bounds");if(void 0!==this.cache[n])return this.cache[n];if(j.isVisited(n))throw new Error("Circular reference");return t=this.dfsCellVisit(n),this.cache[n]=t,t}},{key:"UnaryOp",value:function(e){var t=this._visit(e.expr);return e.eval(t)}},{key:"FuncOp",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.argNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=this._visit(s);t.push(l)}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e.eval(t)}},{key:"BinaryOp",value:function(e){var t=this._visit(e.leftNode),n=this._visit(e.rightNode);return e.eval(t,n)}},{key:"isLocationValid",value:function(e){var t=Object(u.d)(e),n=Object(r.a)(t,2),i=n[0],a=n[1];return!(Math.min(i,a)<0)&&(!(i>=this.state.columns)&&!(a>=this.state.rows))}},{key:"dfsCellVisit",value:function(t){var n=new e(t),r=0;return j.hasVertex(t)&&(r=n.visit(t)),r}},{key:"errorResponse",value:function(){var e=this.error.message;return e.match(/division by zero/i)?"#DIV/0!":e.match(/circular reference/i)?"#REF!":"#ERROR!"}}]),e}(),w=function e(t){Object(o.a)(this,e),this.entered=t,this.error=null,this.result=null,this.ast=null},j=new(function(){function e(){Object(o.a)(this,e),this.adj={},this.pending=null,this.visited=null,this.store=new l}return Object(a.a)(e,[{key:"interpret",value:function(e,t){return new x(e).interpret(t)}},{key:"recalculate",value:function(e){this.setPendingNodes(),this.dfs(e),this.updateStore()}},{key:"getCellResult",value:function(e){return this.hasVertex(e)?this.getVertex(e).result:""}},{key:"setPendingNodes",value:function(){var e=this;this.pending=new Set,Object.keys(this.adj).forEach(function(t){e.pending.add(t)})}},{key:"isResolved",value:function(e){return this.isVisited(e)||!this.isPending(e)}},{key:"isVisited",value:function(e){return this.visited.has(e)}},{key:"isPending",value:function(e){return this.pending.has(e)}},{key:"dfs",value:function(e){for(var t=this;this.pending.size>0;){this.visited=new Set,e||(e=Object(i.a)(this.pending)[0]);try{new x(e).visit(e)}catch(n){}this.visited.forEach(function(e){return t.pending.delete(e)}),e=null}}},{key:"updateStore",value:function(){for(var e=new Set(this.store.locations),t=0,n=Object.entries(this.adj);t<n.length;t++){var i=n[t],a=Object(r.a)(i,2),o=a[0],s=a[1],l=s.entered,c=s.result;e.delete(o),c!==this.store.getCellResult(o)&&this.store.replaceCellData(o,l,c)}var u=!0,h=!1,d=void 0;try{for(var p,f=e[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var b=p.value;this.store.clearCell(b)}}catch(v){h=!0,d=v}finally{try{u||null==f.return||f.return()}finally{if(h)throw d}}}},{key:"markVisited",value:function(e){return this.visited.add(e)}},{key:"addVertex",value:function(e,t){var n=new w(t);return this.adj[e]=n,n}},{key:"hasVertex",value:function(e){return e in this.adj}},{key:"getVertex",value:function(e){return this.testMissingLocation(e),this.adj[e]}},{key:"delVertex",value:function(e){e in this.adj&&(delete this.adj[e],this.recalculate())}},{key:"resetAll",value:function(){this.adj={},this.pending=null,this.visited=null,this.store=new l}},{key:"testMissingLocation",value:function(e){if(!this.hasVertex(e))throw new Error("Missing location")}}]),e}());function E(e,t){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:j.interpret(e,t)}}}}function C(e,t,n){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:n}}}}function I(e){return function(t,n){var r=n().table[e];return j.delVertex(e),void 0===r?Promise.resolve():Promise.resolve(t({type:"DELETE_CELL_DATA",payload:e}))}}n.d(t,"c",function(){return E}),n.d(t,"b",function(){return C}),n.d(t,"a",function(){return I})},57:function(e,t,n){"use strict";(function(e){var r=n(28),i=n(19),a=n(5),o=n(7),s=n(12),l=n(11),c=n(15),u=n(13),h=n(6),d=n(1),p=n.n(d),f=n(8),b=n(23),v=n(40),m=n(18),y=n(3),k=n(60),O=n(36),g=n(39),x=Object(h.a)("div",{target:"e2z1oka0"})({name:"1b7bwed",styles:"position:fixed;"}),w=Object(h.a)("input",{target:"e2z1oka1"})({name:"2pr53n",styles:"display:flex;align-items:center;outline:none;height:100%;width:100%;border:2px solid salmon;padding:2px;box-sizing:border-box;font-size:13px;padding-right:10px;background-color:white;"}),j=function(t){function n(){var e;return Object(a.a)(this,n),(e=Object(s.a)(this,Object(l.a)(n).call(this))).state={tokens:[],isFuncSelectorVisible:!1,inputValue:"",keyEvent:{key:""},cursorPos:0},e.refInput=p.a.createRef(),e.handleOnKeyDown=e.handleOnKeyDown.bind(Object(c.a)(e)),e.handleOnBlur=e.handleOnBlur.bind(Object(c.a)(e)),e.handleOnChange=e.handleOnChange.bind(Object(c.a)(e)),e.setIsFuncSelectorVisible=e.setIsFuncSelectorVisible.bind(Object(c.a)(e)),e.setInputValue=e.setInputValue.bind(Object(c.a)(e)),e}return Object(u.a)(n,t),Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.willReplaceValue?"":this.props.entered;this.focusInputTag(),this.setInputValue(e)}},{key:"componentDidUpdate",value:function(e,t){t.keyEvent!==this.state.keyEvent&&(this.setFocus(this.state.keyEvent.key),this.keyActions()),t.inputValue!==this.state.inputValue&&this.tokenizeInputValue()}},{key:"keyActions",value:function(){switch(this.state.keyEvent.key){case"Escape":this.props.closeCellInputter();break;case"Enter":this.state.isFuncSelectorVisible||(this.setCellValue(),this.props.closeCellInputter());break;case"ArrowLeft":case"ArrowRight":this.setState({cursorPos:this.refInput.current.selectionEnd})}}},{key:"tokenizeInputValue",value:function(){var e=this.state.inputValue,t=new y.c(e).getTokens();this.setState({tokens:t})}},{key:"focusInputTag",value:function(){this.refInput.current.focus()}},{key:"setFocus",value:function(){var e,t,n=this.state.keyEvent.key,r=this.props.location,a=Object(m.d)(r),o=Object(i.a)(a,2),s=o[0],l=o[1];if("Tab"===n)t='[data-cell="result"][data-location="'.concat(r,'"]');else if("Enter"===n){if(this.state.isFuncSelectorVisible)return;var c=Math.min(this.props.rows-1,l+1),u=Object(m.a)(s),h=""+(c+1),d="".concat(u,"-").concat(h);t='[data-cell="result"][data-location="'.concat(d,'"]')}else t="Escape"===n?'[data-cell="result"][data-location="'.concat(r,'"]'):'[data-cell="input"][data-location="'.concat(r,'"]');e=document.querySelector(t),document.activeElement!==e&&e.focus()}},{key:"setCellValue",value:function(){var e=this.props.location,t=this.state.inputValue;this.isWhitespace(t)?this.props.clearCellData(e):this.props.setCellData(e,t.toUpperCase())}},{key:"isWhitespace",value:function(e){return 0===e.length||Boolean(e.match(/^\s+$/))}},{key:"setIsFuncSelectorVisible",value:function(e){this.setState({isFuncSelectorVisible:e})}},{key:"setInputValue",value:function(t,n){var r=this;this.setState({inputValue:t,cursorPos:t.length},function(){n&&e(function(){r.refInput.current.selectionStart=n,r.refInput.current.selectionEnd=n})})}},{key:"handleOnChange",value:function(e){var t=e.target.value,n=e.target.selectionStart;this.setState({inputValue:t,cursorPos:n})}},{key:"handleOnKeyDown",value:function(e){var t=e.key,n=e.target.value;this.setState({keyEvent:{key:t},inputValue:n})}},{key:"handleOnBlur",value:function(e){var t=this;this.setState({inputValue:e.target.value},function(){t.setCellValue(),t.props.closeCellInputter()})}},{key:"render",value:function(){var e=this.refInput.current,t=this.props.cellRect,n=t.top,i=t.left,a=t.width,o=t.height;return this.props.location?Object(f.d)(O.a.Provider,{value:{inputRect:e&&e.getBoundingClientRect(),setIsFuncSelectorVisible:this.setIsFuncSelectorVisible,setInputValue:this.setInputValue,keyEvent:this.state.keyEvent,inputValue:this.state.inputValue}},Object(f.d)(x,{css:Object(r.a)({top:n,left:i,width:a,height:o})},Object(f.d)(w,{ref:this.refInput,"data-cell":"input","data-location":this.props.location,value:this.state.inputValue,onChange:this.handleOnChange,onKeyDown:this.handleOnKeyDown,onBlur:this.handleOnBlur}),Object(f.d)(k.a,{tokens:this.state.tokens,cursorPos:this.state.cursorPos}))):null}}]),n}(p.a.PureComponent);var E={setCellData:v.c,clearCellData:v.a,closeCellInputter:g.a};t.a=Object(b.b)(function(e){var t=e.global,n=t.cellInputter,r=n.location,i=n.willReplaceValue,a=n.cellRect,o=t.rows,s=t.columns,l=e.table[r];return{location:r,willReplaceValue:i,cellRect:a,entered:l?l.entered:"",rows:o,columns:s}},E)(j)}).call(this,n(72).setImmediate)},60:function(e,t,n){"use strict";var r=n(19),i=n(5),a=n(7),o=n(12),s=n(11),l=n(13),c=n(1),u=n.n(c),h=n(3),d=n(28),p=n(6),f=n(8),b=n(31),v=n(36),m=Object(p.a)("div",{target:"ehusaxe0"})("background:",function(e){return e.theme.colors.dropdown.normal},";margin-top:1px;box-shadow:0 0 5px ",function(e){return e.theme.colors.shadow},";border:1px solid ",function(e){return e.theme.colors.dropdown.active},";width:300px;padding:6px 8px;"),y=Object(p.a)("pre",{target:"ehusaxe1"})({name:"p8bxbz",styles:"line-height:1em;padding-bottom:3px;font-size:14px;"}),k=Object(p.a)("div",{target:"ehusaxe2"})({name:"11i7ysg",styles:"padding-top:12px;font-size:12px;"}),O=Object(p.a)("p",{target:"ehusaxe3"})({name:"kcaog3",styles:"line-height:1em;font-size:13px;"}),g=Object(p.a)("hr",{target:"ehusaxe4"})("border:0;border-top:1px solid ",function(e){return e.theme.colors.dropdown.active},";"),x={name:"1gdm77d",styles:"padding-bottom:6px;"},w=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"getFnScope",value:function(){var e,t=this.props,n=t.fnScopes,r=t.cursorPos,i=!0,a=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;if(!(r>=c.startIndex+1))break;e=c}}catch(u){a=!0,o=u}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return e&&null===e.endIndex?e:e&&r-1<e.endIndex?e:null}},{key:"getFnNode",value:function(e){var t=e.fnName.toUpperCase();return b.a[t]}},{key:"render",value:function(){var e=this.getFnScope(),t=this.context.inputRect;if(!t)return null;var n,r=t.bottom,i=t.left;return e?(n=this.getFnNode(e),Object(f.d)(m,{css:Object(d.a)({top:r,left:i})},Object(f.d)(y,{css:x},n.definition),Object(f.d)(g,null),Object(f.d)(k,null,"Example"),Object(f.d)(y,null,n.example),Object(f.d)(k,null,"Summary"),Object(f.d)(O,null,n.summary))):null}}]),t}(u.a.PureComponent);w.contextType=v.a;var j=w,E=n(29),C=n(16),I=n.n(C),T=Object(p.a)("li",{target:"e9dst5h0"})();var N=function(e){var t=e.item,n=e.isActive;return Object(f.d)(T,{tabIndex:0},n&&t.active?t.active:t.base)},S=Object(p.a)("ul",{target:"ehyu2mo0"})({name:"12pmg09",styles:"position:fixed;margin:0;padding:0;list-style:none;"}),L=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(n=Object(o.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={activeIndex:0,selectedIndex:null},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.fireSelected()}},{key:"fireSelected",value:function(){if(null!==this.state.selectedIndex){var e=this.props.items[this.state.selectedIndex];this.props.selectedFn(e.value)}}},{key:"renderListItems",value:function(){var e=this;return this.props.items.map(function(t,n){return u.a.createElement(N,{key:n,item:t.item,style:Object(E.a)({},e.props.styles.li),isActive:t.isActive})})}},{key:"render",value:function(){var e=this.props,t=e.items,n=e.top,r=e.left,i=e.styles;return 0===t.length?null:u.a.createElement(S,{tabIndex:-1,style:Object(E.a)({top:n,left:r},i.ul),onClick:this.handleOnClick},this.renderListItems())}}]),t}(u.a.PureComponent);L.propsTypes={selectedFn:I.a.func.isRequired,items:I.a.array.isRequired,top:I.a.number.isRequired,left:I.a.number.isRequired,styles:I.a.shape({ul:I.a.object,li:I.a.object})};var A=L,R=(n(32),n(46)),U={name:"s7sq8v",styles:"padding:6px 8px;"},V=Object(p.a)("div",{target:"e1o68vv70"})(U," background:",function(e){return e.theme.colors.dropdown.normal},";"),M=Object(p.a)("div",{target:"e1o68vv71"})(U," background:",function(e){return e.theme.colors.dropdown.active},";"),D=Object(p.a)("pre",{target:"e1o68vv72"})({name:"p8bxbz",styles:"line-height:1em;padding-bottom:3px;font-size:14px;"}),F=Object(p.a)("div",{target:"e1o68vv73"})({name:"1qxtz39",styles:"font-size:12px;"}),P=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(n=Object(o.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={listItems:[],itemIndex:0,keyEvent:null,isVisible:!1},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({itemIndex:0},function(){e.setListItems()})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.listItems!==t.listItems}},{key:"componentDidUpdate",value:function(e,t){this.updateContextData(t),this.updateListItems(e),this.keyActions()}},{key:"componentWillUnmount",value:function(){this.context.setIsFuncSelectorVisible(!1)}},{key:"updateListItems",value:function(e){var t=this;e.token!==this.props.token&&this.setState({itemIndex:0},function(){t.setListItems()})}},{key:"updateContextData",value:function(e){var t=this.context.keyEvent;e.keyEvent!==t&&(this.setState({keyEvent:t}),this.setItemIndex(t))}},{key:"keyActions",value:function(){var e=this.context.keyEvent;this.state.keyEvent!==e&&"Enter"===e.key&&this.state.isVisible&&this.updateInputValue()}},{key:"updateInputValue",value:function(){var e=this.context.inputValue,t=this.props.token,n=this.state.listItems[this.state.itemIndex].fnName,r=t.index+t.text.length,i=e.slice(0,t.index),a=e.slice(r),o="".concat(i).concat(n,"(").concat(a),s=i.length+n.length+1;this.context.setInputValue(o,s)}},{key:"setListItems",value:function(){var e,t=this,n=this.props.token.text.toUpperCase(),r=!1,i=Object.keys(b.a).filter(function(e){return e.startsWith(n)}).sort().map(function(e){return{item:{base:t.itemBase(e),active:t.itemActive(e)},isActive:!1,fnName:e}});e=Math.max(Math.min(i.length-1,this.state.itemIndex),0),i.length>0&&(i[e].isActive=r=!0),this.context.setIsFuncSelectorVisible(r),this.setState({listItems:i,itemIndex:e,isVisible:r})}},{key:"setItemIndex",value:function(e){var t=this,n=this.state.itemIndex;switch(e.key){case"ArrowUp":n=this.state.itemIndex-1;break;case"ArrowDown":n=this.state.itemIndex+1}this.setState({itemIndex:n},function(){t.setListItems()})}},{key:"itemBase",value:function(e){return Object(f.d)(V,null,Object(f.d)(D,null,e))}},{key:"itemActive",value:function(e){return Object(f.d)(M,null,Object(f.d)(D,null,e),Object(f.d)(F,null,b.a[e].summary))}},{key:"getListStyles",value:function(){var e=this.props.theme;return{ul:{marginTop:1,boxShadow:"0 0 5px ".concat(e.colors.shadow),border:"1px solid ".concat(e.colors.dropdown.active),width:300}}}},{key:"render",value:function(){var e=this.state,t=e.listItems,n=e.isVisible,r=this.context.inputRect;return n?Object(f.d)(A,{selectItem:function(){},items:t,top:Math.round(r.bottom),left:Math.round(r.left),styles:this.getListStyles()}):null}}]),t}(u.a.Component);P.contextType=v.a;var B=Object(R.b)(P),_=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(n=Object(o.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={fnScopes:[]},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){this.setFnScopes()}},{key:"componentDidUpdate",value:function(e){e.tokens!==this.props.tokens&&this.setFnScopes()}},{key:"setFnScopes",value:function(){var e=[],t=[],n=!0,r=!1,i=void 0;try{for(var a,o=this.props.tokens[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.type===h.b.FUNCTION){var l={fnName:s.text,startIndex:s.index,endIndex:null};e.push(l),t.push(l)}else if(s.type===h.b.LPAREN)e.push("(");else if(s.type===h.b.RPAREN){if(e.pop(),e.length>0&&"("!==e[e.length-1])e.pop().endIndex=s.index-1}}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}t.sort(function(e,t){return e.startIndex-t.startIndex}),this.setState({fnScopes:t})}},{key:"getCurrTokenIndex",value:function(e,t){var n;for(n=0;n<e.length;n++){var r=e[n],i=r.index+r.text.length;if(t>r.index&&t<=i)break}return n}},{key:"getCompareTokens",value:function(){var e=this.props,t=e.tokens,n=e.cursorPos,r=this.getCurrTokenIndex(t,n);return[r>0&&t[r-1],t[r],r<t.length-2&&t[r+1]]}},{key:"getFuncSelector",value:function(){var e=this.getCompareTokens(),t=Object(r.a)(e,3),n=t[0],i=t[1],a=t[2];if(this.props.tokens.length<2)return null;var o=n&&i&&a&&"operator"===n.category&&[h.b.TEXT,h.b.FUNCTION].includes(i.type)&&a.type!==h.b.RPAREN,s=n&&i&&!a&&[h.b.TEXT,h.b.FUNCTION].includes(i.type);return o||s?u.a.createElement(B,{token:i}):void 0}},{key:"render",value:function(){var e=this.getFuncSelector();return e||u.a.createElement(j,{cursorPos:this.props.cursorPos,fnScopes:this.state.fnScopes})}}]),t}(u.a.PureComponent);_.defaultProps={cursorPos:0};t.a=_},62:function(e,t,n){e.exports=n(79)},79:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(43),o=n.n(a),s=n(23),l=n(59),c=n(46),u=n(8),h=(n(71),n(38)),d={xs:0,sm:420,md:900,lg:1200},p={xs:"sm",sm:"md",md:"lg"},f={xs:"@media (max-width: ".concat(d.sm-1,"px)"),sm:"@media (min-width: ".concat(d.sm,"px) and (max-width: ").concat(d.md-1,"px)"),md:"@media (min-width: ".concat(d.md,"px) and (max-width: ").concat(d.lg-1,"px)"),lg:"@media (min-width: ".concat(d.lg,"px)"),from:function(e){return"@media (min-width: ".concat(d[e],"px)")},upTo:function(e){return"@media (max-width: ".concat(d[p[e]]-1,"px)")}},b={colors:{text:"#3D3D3D",cell:{border:"#dfdfdf",borderDark:"#CCC",labelBkg:"#F5F5F5"},dropdown:{normal:"#fafafa",active:"#ebebeb"},primary:{strong:"#E10D75"},field:{background:"#F0F0F0"},shadow:"#939393"},breaks:d,queries:f},v=Object(u.c)("body{color:",b.colors.text,";line-height:1.3em;font-family:Arial,Helvetica,sans-serif;}table,th,td{border:0;border-spacing:0;border-collapse:collapse;}td{padding:0;line-height:1.2em;}pre,p,h1,h2,h3,h4,h5,h6{margin:0;}"),m=n(6),y=Object(m.a)("header",{target:"e1mq5pli0"})({name:"1rn5ure",styles:"width:100%;display:flex;flex-direction:column;align-items:center;padding:30px 0 30px;"});var k=function(){return i.a.createElement(y,null,i.a.createElement("h3",null,"Spreadsheet App"))},O=n(5),g=n(7),x=n(12),w=n(11),j=n(15),E=n(13),C=n(33),I=Object(m.a)("div",{target:"etucg500"})("display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";font-size:12px;");var T=function(e){var t=e.label;return i.a.createElement(I,{"data-col":t,className:"col-label-width col-label-height"},t)},N=Object(m.a)("div",{target:"e1ia7370"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"}),S=Object(m.a)("div",{target:"e1ia7371"})("display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";");var L=function(e){var t=e.colLabels;return i.a.createElement(N,{"data-row":"header"},i.a.createElement(S,{className:"row-label-width col-label-height"}),new Array(t.length).fill(0).map(function(e,n){return i.a.createElement(T,{key:n,label:t[n]})}))},A=Object(m.a)("div",{target:"e12nkt8n0"})("font-size:12px;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";");var R=function(e){var t=e.label;return i.a.createElement(A,{"data-row":t,className:"row-label-width row-label-height"},t)},U=n(40),V=n(39),M=Object(m.a)("div",{target:"egobumn0"})("cursor:cell;font-size:13px;border-right:1px solid ",function(e){return e.theme.colors.cell.border},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.border},";"),D=Object(m.a)("div",{target:"egobumn1"})({name:"tyi3kt",styles:"display:flex;align-items:center;outline:none;border:2px solid transparent;line-height:1.1em;height:100%;width:100%;padding:2px;:focus,:focus-within{border:2px solid salmon;}"}),F=function(e){function t(){var e;return Object(O.a)(this,t),(e=Object(x.a)(this,Object(w.a)(t).call(this))).refCell=i.a.createRef(),e.handleCellOnKeyDown=e.handleCellOnKeyDown.bind(Object(j.a)(e)),e.handleCellOnDoubleClick=e.handleCellOnDoubleClick.bind(Object(j.a)(e)),e.handleCellOnClick=e.handleCellOnClick.bind(Object(j.a)(e)),e.handleWrapperOnClick=e.handleWrapperOnClick.bind(Object(j.a)(e)),e}return Object(E.a)(t,e),Object(g.a)(t,[{key:"displayCellInputter",value:function(e){var t=this.props.location,n=this.refCell.current.getBoundingClientRect(),r=JSON.parse(JSON.stringify(n));this.props.displayCellInputter({location:t,willReplaceValue:e,cellRect:r})}},{key:"handleCellOnKeyDown",value:function(e){var t=e.key;(this.props.setActiveCell(this.props.location),["Delete","Backspace"].includes(t))?(""+this.props.result).length>0&&this.props.clearCellData(this.props.location):1===t.length&&this.displayCellInputter(!0)}},{key:"handleCellOnDoubleClick",value:function(){this.displayCellInputter(!1)}},{key:"getStyle",value:function(){var e={};return"number"===typeof this.props.result&&(e={whiteSpace:"nowrap",textOverflow:"clip",overflow:"hidden"}),e}},{key:"handleWrapperOnClick",value:function(){this.refCell.current.focus()}},{key:"handleCellOnClick",value:function(e){e.stopPropagation()}},{key:"render",value:function(){return Object(u.d)(M,{className:"row-label-height col-label-width",onClick:this.handleWrapperOnClick},Object(u.d)(D,{ref:this.refCell,"data-cell":"result","data-location":this.props.location,css:this.getStyle(),tabIndex:"0",onClick:this.handleCellOnClick,onKeyDown:this.handleCellOnKeyDown,onDoubleClick:this.handleCellOnDoubleClick},this.props.result))}}]),t}(i.a.PureComponent);var P={clearCellData:U.a,displayCellInputter:V.b,setActiveCell:V.c},B=Object(s.b)(function(e,t){var n=e.table[t.location];return{result:n?n.result:""}},P)(F),_=Object(m.a)("div",{target:"exk1gay0"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"});var z=function(e){var t=e.rowNumber,n=e.colLabels;return i.a.createElement(_,{"data-row":t},i.a.createElement(R,{label:t}),new Array(n.length).fill(0).map(function(e,r){var a="".concat(n[r],"-").concat(t);return i.a.createElement(B,{key:r,location:a})}))},W=n(18),X=n(29),K=n(19);var q={id:"keyboardNav",initial:"idle",context:{columns:null,rows:null,key:null,colIndex:null,rowIndex:null,endLocation:null,wasFocused:!1},states:{idle:{on:{MOVE_FOCUS:{actions:["setNewContext","calcTargetLocation"],target:"focusTarget"}}},focusTarget:{invoke:{src:function(e){return e.endLocation?new Promise(function(t){setTimeout(function(){var n='[data-location="'.concat(e.endLocation,'"]'),r=document.querySelector(n);r&&r.focus(),t(!0)},0)}):Promise.resolve(!1)},onDone:{actions:Object(C.b)({wasFocused:function(e,t){return t.data}}),target:"idle"}}}}},Q={actions:{setNewContext:Object(C.b)(function(e,t){var n=t.key,r=t.location,i=Object(W.d)(r),a=Object(K.a)(i,2);return{colIndex:a[0],rowIndex:a[1],key:n}}),calcTargetLocation:Object(C.b)({endLocation:function(e){return function(e){var t=e.rows,n=e.columns,r=e.rowIndex,i=e.colIndex;switch(e.key){case"ArrowUp":r=Math.max(0,r-1);break;case"ArrowRight":i=Math.min(n-1,i+1);break;case"ArrowDown":case"Enter":r=Math.min(t-1,r+1);break;case"ArrowLeft":i=Math.max(0,i-1);break;default:return null}var a=Object(W.a)(i),o=""+(r+1);return"".concat(a,"-").concat(o)}(e)}})}};var G=function(e,t){var n=Object(X.a)({},q.context,{columns:t,rows:e});return Object(C.a)(q,Q,n)},J=Object(m.a)("div",{target:"e1tmjcr20"})("display:flex;flex-direction:column;width:fit-content;border-top:2px solid ",function(e){return e.theme.colors.cell.borderDark},";border-left:2px solid ",function(e){return e.theme.colors.cell.borderDark},";border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";*{box-sizing:border-box;}.row-label-width{width:34px;}.row-label-height{min-height:28px;}.col-label-width{width:140px;}.col-label-height{min-height:26px;}"),$=function(e){function t(e){var n;return Object(O.a)(this,t),(n=Object(x.a)(this,Object(w.a)(t).call(this,e))).keyboardNavMachine=G(n.props.rows,n.props.columns),n.focusService=Object(C.c)(n.keyboardNavMachine),n.handleTableOnClick=n.handleTableOnClick.bind(Object(j.a)(n)),n.handleTableOnKeyDown=n.handleTableOnKeyDown.bind(Object(j.a)(n)),n.colLabels=Object(W.b)(e.columns),n}return Object(E.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.focusService.start()}},{key:"componentWillUnmount",value:function(){this.focusService.stop()}},{key:"handleTableOnClick",value:function(e){e.stopPropagation()}},{key:"handleTableOnKeyDown",value:function(e){e.stopPropagation(),this.moveFocus(e.key,e.target.dataset.location)}},{key:"moveFocus",value:function(e,t){this.focusService.send({type:"MOVE_FOCUS",key:e,location:t})}},{key:"renderColLabelRow",value:function(e){return i.a.createElement(L,{key:e,rows:this.props.rows,colLabels:this.colLabels})}},{key:"renderDataRows",value:function(e){return i.a.createElement(z,{key:e,rowNumber:e,colLabels:this.colLabels,activeCell:this.props.activeCell})}},{key:"renderRows",value:function(){var e=this;return new Array(this.props.rows+1).fill(0).map(function(t,n){return 0===n?e.renderColLabelRow(n):e.renderDataRows(n)})}},{key:"render",value:function(){return i.a.createElement(J,{"data-table":"app",onClick:this.handleTableOnClick,onKeyDown:this.handleTableOnKeyDown},this.renderRows())}}]),t}(i.a.PureComponent),H=Object(s.b)(function(e){var t=e.global;return{activeCell:t.activeCell,rows:t.rows,columns:t.columns}})($),Y=n(57),Z=Object(m.a)("div",{target:"e4x97se0"})({name:"pl3zfx",styles:'display:grid;grid:"left-blank main right-blank" 100vh / auto minmax(auto,1000px) auto;'}),ee=Object(m.a)("main",{target:"e4x97se1"})({name:"n7iznt",styles:"grid-area:main;"});var te=Object(s.b)(function(e){return{cellInputter:e.global.cellInputter}})(function(e){var t=e.cellInputter;return i.a.createElement(Z,null,i.a.createElement(ee,null,t&&i.a.createElement(Y.a,null),i.a.createElement("div",{"data-dummy-focus-stop":!0,tabIndex:"0"}),i.a.createElement(k,null),i.a.createElement(H,null)))});var ne=function(){return i.a.createElement(s.a,{store:h.a},i.a.createElement(l.a,null,i.a.createElement(c.a,{theme:b},i.a.createElement(u.a,{styles:v}),i.a.createElement(te,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[62,1,2]]]);
//# sourceMappingURL=main.d5673b8f.chunk.js.map
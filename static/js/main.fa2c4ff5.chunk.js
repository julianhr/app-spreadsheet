(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAfCAYAAAARB2hWAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABsVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+MDwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzE8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MTAwPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT4xPC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpGQTdGMTE3NDA3MjA2ODExQjM0QkRCMTI3QTg3OTlBMDwveG1wTU06T3JpZ2luYWxEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOkNCODc4QkZEMzgzRjExRTNBNkQxQjQwMjJCMkQwMUY1PC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOkNCODc4QkZFMzgzRjExRTNBNkQxQjQwMjJCMkQwMUY1PC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOkQ2NTYzQjExMzQyMDY4MTE4MDgzRjE0OEE2QjUzMjZEPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOkZBN0YxMTc0MDcyMDY4MTFCMzRCREIxMjdBODc5OUEwPC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8ZGM6c3ViamVjdD4KICAgICAgICAgICAgPHJkZjpTZXEvPgogICAgICAgICA8L2RjOnN1YmplY3Q+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE5OjAzOjE0IDE5OjAzOjIwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5QaXhlbG1hdG9yIDMuOC4xPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4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"},54:function(e,t,n){e.exports=n(66)},66:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(34),o=n.n(a),s=n(14),l=n(52),u=n(37),c=n(4),h=(n(63),n(20)),d=n(18),p=Object(h.c)({activeCell:{entered:"",location:""},inputter:{valueEvent:{value:"",cursorPos:0}},scheduledFloatingInputter:{willOpen:!1,isInteractive:!1},floatingInputter:{cellRect:{},isOpen:!1,isInteractive:!1},rows:30,columns:10},{SET_TABLE_DIMENSIONS:function(e,t){var n=t.payload;e.rows=n.rows,e.columns=n.columns},SET_ACTIVE_CELL:function(e,t){var n=t.payload;e.activeCell=n},SCHEDULE_FLOATING_INPUTTER:function(e,t){var n=t.payload.isInteractive;e.scheduledFloatingInputter={willOpen:!0,isInteractive:n}},UNSCHEDULE_FLOATING_INPUTTER:function(e){e.scheduledFloatingInputter={willOpen:!1,isInteractive:!1}},OPEN_FLOATING_INPUTTER:function(e,t){var n=t.payload;e.floatingInputter=Object(d.a)({},e.floatingInputter,n)},SET_FLOATING_INPUTTER_INTERACTIVE:function(e,t){var n=t.payload;e.floatingInputter=Object(d.a)({},e.floatingInputter,{isInteractive:n})},CLOSE_FLOATING_INPUTTER:function(e){e.floatingInputter.isOpen=!1},SET_INPUTTER_VALUE_EVENT:function(e,t){var n=t.payload;e.inputter.valueEvent=n},RESET_FLOATING_INPUTTER:function(e,t){var n=t.payload;e.floatingInputter=Object(d.a)({},e.floatingInputter,n)}}),v=Object(h.c)({},{SET_CELL_DATA:function(e,t){var n=t.payload,i=n.location,r=n.data;e[i]=r},DELETE_CELL_DATA:function(e,t){delete e[t.payload]}}),f=n(30),b=Object(h.c)({colWidths:{},rowHeights:{}},{SET_COL_WIDTH:function(e,t){var n=t.payload,i=n.colLabel,r=n.width,a=e.colWidths;e.colWidths=Object(d.a)({},a,Object(f.a)({},i,r))},SET_ROW_HEIGHT:function(e,t){var n=t.payload,i=n.rowLabel,r=n.height,a=e.rowHeights;e.rowHeights=Object(d.a)({},a,Object(f.a)({},i,r))}}),g=Object(h.a)({reducer:{global:p,tableData:v,tableMeta:b}}),y={xs:0,sm:420,md:900,lg:1200},m={xs:"sm",sm:"md",md:"lg"},O={xs:"@media (max-width: ".concat(y.sm-1,"px)"),sm:"@media (min-width: ".concat(y.sm,"px) and (max-width: ").concat(y.md-1,"px)"),md:"@media (min-width: ".concat(y.md,"px) and (max-width: ").concat(y.lg-1,"px)"),lg:"@media (min-width: ".concat(y.lg,"px)"),from:function(e){return"@media (min-width: ".concat(y[e],"px)")},upTo:function(e){return"@media (max-width: ".concat(y[m[e]]-1,"px)")}},k={colors:{text:"#3D3D3D",table:{border:"#dfdfdf",borderDark:"#CCC",labelBkg:"#F5F5F5"},dropdown:{normal:"#fafafa",active:"#ebebeb"},primary:{strong:"#E10D75",light:"salmon"},field:{background:"#F0F0F0"},shadow:"#939393"},breaks:y,queries:O},E=Object(c.c)("body{color:",k.colors.text,";line-height:1.3em;font-family:Arial,Helvetica,sans-serif;}table,th,td{border:0;border-spacing:0;border-collapse:collapse;}td{padding:0;line-height:1.2em;}pre,p,h1,h2,h3,h4,h5,h6{margin:0;}ul,li{margin:0;padding:0;}"),w=n(3),j=Object(w.a)("header",{target:"e1mq5pli0"})({name:"4rmlxi",styles:"width:100%;display:flex;flex-direction:column;"}),I=Object(w.a)("a",{target:"e1mq5pli1"})("text-decoration:none;color:",function(e){return e.theme.colors.text},";padding:10px 0 0;:hover{text-decoration:underline;}"),x=Object(w.a)("h3",{target:"e1mq5pli2"})({name:"1uz45nq",styles:"align-self:center;padding:10px 0 20px;"});var C=function(){return r.a.createElement(j,null,r.a.createElement(I,{href:"https://www.cimarron.me",rel:"noopener noreferrer"},"Julian Hernandez"),r.a.createElement(x,null,"Spreadsheet App"))},A=n(2),N=n(5),R=n(10),M=n(9),T=n(8),S=n(11);function D(e,t){return{type:"SET_INPUTTER_VALUE_EVENT",payload:{value:e,cursorPos:void 0===t?e.length:t}}}function U(e){return function(t,n){var i=(n().tableData[e]||{}).entered||"";return t(D(i,i.length)),Promise.resolve(t({type:"SET_ACTIVE_CELL",payload:{entered:i,location:e}}))}}var L=Object(h.b)("CLOSE_FLOATING_INPUTTER"),P={name:"jnj6ln",styles:"border:0;display:flex;font-size:13px;padding:0 8px;"},F={style:function(){return P},props:{"data-inputter":"bar"}},V=r.a.createContext(),W=function e(t,n,i,r,a){Object(A.a)(this,e),this.type=t,this.category=r,this.text=n,this.whitespace=i,this.index=a,this.value=null,this.html=null};function z(e){e.forEach(function(e){if("number"!==typeof e)throw new TypeError("Function argument not a number: ".concat(e))})}var G={AVERAGE:{fn:function(){var e,t;if(0===arguments.length)throw new Error("Empty elements");return(e=G.SUM).fn.apply(e,arguments)/(t=G.COUNT).fn.apply(t,arguments)},definition:"AVERAGE(value1, value2, ...)",example:"AVERAGE(A1:B3, 3)",summary:"Returns the average from a series of numbers."},CONCAT:{fn:function(){for(var e=[],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(0===n.length)throw new Error("Empty elements");for(var r=0,a=n;r<a.length;r++){var o=a[r];if("string"!==typeof o)throw new Error("Element is not a string: ".concat(o));e.push(o)}return e.join("")},definition:'CONCAT("text1", "text2", ...)',example:'CONCAT("one", "two")',summary:"Returns a single concatenated string from a series of strings."},COUNT:{fn:function(){return arguments.length},definition:"COUNT(element1, element2, ...)",example:"COUNT(A1:B3, 2, C4)",summary:"Returns the number of non-empty elements in a set."},MAX:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return z(t),Math.max.apply(Math,t)},definition:"MAX(value1, value2, ...)",example:"MAX(A1:B3, 4, C3)",summary:"Returns the maximum value from a series of numbers"},MIN:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return z(t),Math.min.apply(Math,t)},definition:"MIN(value1, value2, ...)",example:"MIN(A1:B3, 4, C3)",summary:"Returns the minimum value from a series of numbers."},POWER:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(2!==t.length)throw new Error("Formula takes only two elements");z(t);var i=t[0],r=t[1];return Math.pow(i,r)},definition:"POWER(base, exponent)",example:"POWER(A3,2)",summary:"Returns a number raised to an exponent."},SQRT:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1!==t.length)throw new Error("Formula takes only one element");return z(t),Math.sqrt(t[0])},definition:"SQRT(value)",example:"SQRT(9) or SQRT(A3)",summary:"Returns the square root of a number."},SUM:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return z(t),t.reduce(function(e,t){return t+e},0)},definition:"SUM(value1, value2, ...)",example:"SUM(A1:B3, 3, C5)",summary:"Retuns the sum from a series of numbers."}};G.AVG=Object(d.a)({},G.AVERAGE,{definition:"AVG(value1, value2, ...)",example:"AVG(A1:B3, 3)"}),G.POW=Object(d.a)({},G.POWER,{definition:"POW(base, exponent)",example:"POW(A3,2)"});var B=G,Z=n(25),K=n(13),H="A".codePointAt(0);function Y(e,t,n){return Math.min(Math.max(e,t),n)}function Q(e){for(var t=[],n=[""],i=e;i>0;){var r=[];e:for(var a=0,o=n;a<o.length;a++){var s=o[a],l=!0,u=!1,c=void 0;try{for(var h,d="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;if(0===i)break e;r.push("".concat(s).concat(p)),i-=1}}catch(v){u=!0,c=v}finally{try{l||null==d.return||d.return()}finally{if(u)throw c}}}n=r,t=[].concat(Object(Z.a)(t),r)}return t}function X(e){var t=[],n=H,i=e+1;do{var r=n+(i-=1)%26,a=String.fromCodePoint(r);t.push(a),i=Math.floor(i/26)}while(i>0);return t.reverse().join("")}function q(e){var t=e.split("-"),n=Object(K.a)(t,2),i=n[0],r=n[1];return[i.split("").reduce(function(e,t){return 26*e+t.charCodeAt(0)-H+1},0)-1,+r-1]}function J(e){var t=Boolean(e.match(/^[.\d]+$/)),n=(e.match(/\./g)||[]).length;return!!t&&(!(n>1)&&(1!==e.length||"."!==e[0]))}function _(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];if(i){if(n)return;e.apply(void 0,a),n=setTimeout(function(){clearTimeout(n),n=null},t)}else clearInterval(n),n=setTimeout(function(){e.apply(void 0,a),n=null},t)}}var $=function(){function e(t){Object(A.a)(this,e),this.tokens=t}return Object(N.a)(e,[{key:"sanitize",value:function(){var e=this;return this.tokens.map(function(t){switch(t.type){case te.NUMBER:return e.number(t);case te.CELL:return e.cell(t);case te.FUNCTION:return e.function(t);case te.STRING:return e.string(t);default:return t}})}},{key:"number",value:function(e){return J(e.text)?(e.value=parseFloat(e.text),e):(e.type=te.UNKNOWN,e)}},{key:"cell",value:function(e){return e.value=this.getCellLabel(e),e}},{key:"function",value:function(e){var t=this.getFunction(e);return t?e.value=t:e.type=te.UNKNOWN,e}},{key:"string",value:function(e){return e.value=e.text.slice(1,-1),e}},{key:"getCellLabel",value:function(e){var t=e.text,n=t.match(/\d+/).index,i=t.slice(0,n).toUpperCase(),r=t.slice(n);return"".concat(i,"-").concat(r)}},{key:"getFunction",value:function(e){var t=e.text.toUpperCase(),n=B[t];return n&&n.fn}}]),e}(),ee=function(){function e(t,n,i,r){Object(A.a)(this,e),this.regex=t,this.groupIndex=n,this.token=i,this.category=r}return Object(N.a)(e,[{key:"setIndex",value:function(e){this.regex.lastIndex=e}},{key:"test",value:function(e){return this.regex.exec(e)}}]),e}(),te={EOF:"EOF",EQUALS:"EQUALS",COMMA:"COMMA",COLON:"COLON",LPAREN:"LPAREN",RPAREN:"RPAREN",PLUS:"PLUS",MINUS:"MINUS",MULT:"MULT",DIV:"DIV",TEXT:"TEXT",CELL:"CELL",STRING:"STRING",NUMBER:"NUMBER",FUNCTION:"FUNCTION",UNKNOWN:"UNKNOWN"},ne=te,ie=[new ee(/=/g,0,ne.EQUALS,"structure"),new ee(/,/g,0,ne.COMMA,"structure"),new ee(/:/g,0,ne.COLON,"structure"),new ee(/\(/g,0,ne.LPAREN,"structure"),new ee(/\)/g,0,ne.RPAREN,"structure"),new ee(/\+/g,0,ne.PLUS,"operator"),new ee(/\-/g,0,ne.MINUS,"operator"),new ee(/\*/g,0,ne.MULT,"operator"),new ee(/\//g,0,ne.DIV,"operator"),new ee(/("[^"]+")/g,1,ne.STRING,"entity"),new ee(/[\d\.]+/g,0,ne.NUMBER,"entity"),new ee(/[a-z]+[\d]+/gi,0,ne.CELL,"entity"),new ee(/([a-z]+)\(/gi,1,ne.FUNCTION,"entity")],re=function(){function e(t){Object(A.a)(this,e),this.input=t,this.index=0,this.char=this.initChar(t),this.markers=[],this.tokens=[]}return Object(N.a)(e,[{key:"getTokens",value:function(){for(;this.char!==ne.EOF;){var e=this.nextToken();this.tokens.push(e)}var t=new $(this.tokens);return this.tokens=t.sanitize(),this.tokens}},{key:"nextToken",value:function(){if(this.char===ne.EOF)return new W(ne.EOF,ne.EOF,0,"eof",this.index);if(!this.isFormula())return this.tokenTEXTorNUMBER();for(var e,t=this.getWhitespaceLen(),n=0,i=ie;n<i.length;n++){var r=i[n];r.setIndex(this.index);var a=r.test(this.input);if(a&&a.index===this.index){var o=a[r.groupIndex];e=new W(r.token,o,t,r.category,this.index),this.index+=o.length-1,this.consume();break}}return e||(e=this.tokenUNKNOWN(t)),e}},{key:"initChar",value:function(e){return 0===this.input.length&&(this.input="0",this.index=-1),e[this.index]}},{key:"tokenUNKNOWN",value:function(e){for(var t=[];!(this.isEOF()||this.isSeparator()||this.isWhitespace());)t.push(this.char),this.consume();var n=t.join("");return new W(ne.UNKNOWN,n,e,"entity",this.index-n.length)}},{key:"tokenTEXTorNUMBER",value:function(){var e;return e=J(this.input)?new W(ne.NUMBER,this.input,0,"entity",this.index):new W(ne.TEXT,this.input,0,"entity",this.index),this.index=this.input.length-1,this.consume(),e}},{key:"consume",value:function(){this.index++,this.index<this.input.length?this.char=this.input[this.index]:this.char=ne.EOF}},{key:"isFormula",value:function(){return"="===this.input[0]}},{key:"isEOF",value:function(){return this.char===ne.EOF}},{key:"isWhitespace",value:function(){return!this.isEOF()&&Boolean(this.char.match(/\s/))}},{key:"isSeparator",value:function(){return Boolean(this.char.match(/[\(\)\+\-\/\*]/))}},{key:"getWhitespaceLen",value:function(){for(var e=0;this.isWhitespace();)e++,this.consume();return e}}]),e}(),ae=re,oe=function(){function e(t){Object(A.a)(this,e),this.c=t}return Object(N.a)(e,[{key:"run",value:function(){var e=this.c.state.keyEvent.key;"Escape"===e?(this.c.props.resetInputterValueEvent(),this.c.props.onEscape()):["ArrowLeft","ArrowRight"].includes(e)&&this.c.props.setInputterValueEvent(this.c.props.valueEvent.value,this.c.refInput.current.selectionEnd)}}]),e}(),se=function(){function e(t){Object(A.a)(this,e),this.c=t}return Object(N.a)(e,[{key:"run",value:function(){var e,t=this.c.props.location;e=this.c.state.isFuncSelectorVisible?this.funcSelectorElQry(t):this.defaultElQry(t),this.focusElement(e)}},{key:"funcSelectorElQry",value:function(e){if("Escape"===this.c.state.keyEvent.key)return this.resultCellQry(e)}},{key:"defaultElQry",value:function(e){var t=this.c.state.keyEvent,n=t.key,i=t.shiftKey;return"Escape"===n?this.resultCellQry(e):"Tab"===n&&i?this.left(e):"Tab"===n?this.right(e):"Enter"===n?this.down(e):void 0}},{key:"left",value:function(e){var t=q(e),n=Object(K.a)(t,2),i=n[0],r=n[1],a=X(Math.max(0,i-1)),o=""+(r+1),s="".concat(a,"-").concat(o);return this.resultCellQry(s)}},{key:"right",value:function(e){var t=q(e),n=Object(K.a)(t,2),i=n[0],r=n[1],a=X(Math.min(this.c.props.columns-1,i+1)),o=""+(r+1),s="".concat(a,"-").concat(o);return this.resultCellQry(s)}},{key:"down",value:function(e){var t=q(e),n=Object(K.a)(t,2),i=n[0],r=n[1],a=Math.min(this.c.props.rows-1,r+1),o=X(i),s=""+(a+1),l="".concat(o,"-").concat(s);return this.resultCellQry(l)}},{key:"resultCellQry",value:function(e){return'[data-cell="result"][data-location="'.concat(e,'"]')}},{key:"focusElement",value:function(e){e&&document.querySelector(e).focus()}}]),e}(),le=function(){function e(t,n,i){Object(A.a)(this,e),this.c=t,this.maxLen=n,this.history=[],this.index=0,this.lastUndo=null,this.push=_(this.pushValueEvent.bind(this),i,!1),this.push.bind(this)}return Object(N.a)(e,[{key:"reset",value:function(){var e=this.c.props,t=e.entered,n=e.valueEvent;this.history=[],t!==n.value&&this.history.push({value:t,cursorPos:t.length}),this.index=0,this.lastUndo=null}},{key:"keyAction",value:function(){var e=this.c.state.keyEvent,t=e.key,n=e.metaKey,i=e.ctrlKey,r=e.shiftKey;"z"===t&&r&&(n||i)?this.redo():"z"===t&&(n||i)&&this.undo()}},{key:"pushValueEvent",value:function(e){this.c.props.isInteractive&&(this.isValueRepeated(e)||(this.truncateHistory(),this.history.push(e),this.index=this.history.length-1,this.lastUndo=null))}},{key:"undo",value:function(){var e=Math.max(0,this.index-1);this.setInputterValueEvent(e)}},{key:"redo",value:function(){var e=Math.min(this.history.length-1,this.index+1);this.setInputterValueEvent(e)}},{key:"isValueRepeated",value:function(e){var t=e.value;if(this.lastUndo&&this.lastUndo.value===t)return!0;if(this.history.length>0){var n=this.history.length-1;return this.history[n].value===t}return!1}},{key:"truncateHistory",value:function(){for(;this.index<this.history.length-1;)this.history.pop();this.history.length===this.maxLen&&this.history.shift()}},{key:"setInputterValueEvent",value:function(e){if(e!==this.index){var t=this.history[e];this.index=e,this.lastUndo=t,this.c.props.setInputterValueEvent(t.value,t.cursorPos)}}}]),e}(),ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g;Object(A.a)(this,e);var n=t.getState().global;this.store=t,this.rows=n.rows,this.columns=n.columns}return Object(N.a)(e,[{key:"getCellResult",value:function(e){var t=this.tableData[e];return t&&t.result}},{key:"replaceCellData",value:function(e,t,n){this.store.dispatch(function(e,t,n){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:n}}}}(e,t,n))}},{key:"clearCell",value:function(e){this.store.dispatch(je(e))}},{key:"tableData",get:function(){return this.store.getState().tableData}},{key:"locations",get:function(){return Object.keys(this.tableData)}}]),e}(),ce=function(){function e(t){Object(A.a)(this,e),this._name=t}return Object(N.a)(e,[{key:"eval",value:function(){throw new Error("Implement method.")}}]),e}(),he=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,"TextNode"))).node=e,n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"eval",value:function(){return this.node.text}}]),t}(ce),de=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,"StringNode"))).node=e,n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"eval",value:function(){return this.node.value}}]),t}(ce),pe=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,"NumberNode"))).node=e,n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"eval",value:function(){return this.node.value}}]),t}(ce),ve=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,"CellNode"))).cell=e,n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"location",get:function(){return this.cell.value}}]),t}(ce),fe=function(e){function t(e,n){var i;return Object(A.a)(this,t),(i=Object(R.a)(this,Object(M.a)(t).call(this,"CellRange"))).leftCell=e,i.rightCell=n,i}return Object(S.a)(t,e),t}(ce),be=function(e){function t(e,n){var i;return Object(A.a)(this,t),(i=Object(R.a)(this,Object(M.a)(t).call(this,"UnaryOp"))).opNode=e,i.expr=n,i}return Object(S.a)(t,e),Object(N.a)(t,[{key:"eval",value:function(e){return this.opNode.type===te.PLUS?e:this.opNode.type===te.MINUS?-e:void 0}}]),t}(ce),ge=function(e){function t(e,n){var i;return Object(A.a)(this,t),(i=Object(R.a)(this,Object(M.a)(t).call(this,"FuncOp"))).funcNode=e,i.argNodes=n,i}return Object(S.a)(t,e),Object(N.a)(t,[{key:"eval",value:function(e){return this.funcNode.value.apply(void 0,Object(Z.a)(e))}}]),t}(ce),ye=function(e){function t(e,n,i){var r;return Object(A.a)(this,t),(r=Object(R.a)(this,Object(M.a)(t).call(this,"BinaryOp"))).leftNode=e,r.opNode=n,r.rightNode=i,r}return Object(S.a)(t,e),Object(N.a)(t,[{key:"eval",value:function(e,t){switch(this.opNode.type){case te.PLUS:return e+t;case te.MINUS:return e-t;case te.DIV:if(0===t)throw new Error("Division by zero: ".concat(e,"/").concat(t));return e/t;case te.MULT:return e*t;default:throw new Error('Unsupported operator "'.concat(this.token.text,'"'))}}}]),t}(ce),me=function(){function e(t){Object(A.a)(this,e),this.index=0,this.tokens=t,this.curr=this.tokens[0],this.ast=null}return Object(N.a)(e,[{key:"parse",value:function(){switch(this.peekType()){case te.TEXT:this.ast=this.text();break;case te.NUMBER:this.ast=this.number();break;default:this.equals(),this.ast=this.expr()}if(null!==this.curr)throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));return this.ast}},{key:"expr",value:function(){var e,t,n;for(e=this.term();[te.PLUS,te.MINUS].includes(this.peekType());)t=this.operator(),n=this.term(),e=new ye(e,t,n);return e}},{key:"term",value:function(){var e,t,n;for(e=this.factor();[te.MULT,te.DIV].includes(this.peekType());)t=this.operator(),n=this.factor(),e=new ye(e,t,n);return e}},{key:"factor",value:function(){switch(this.peekType()){case te.LPAREN:return this.enclosedExpr();case te.PLUS:case te.MINUS:return this.unaryOp();case te.NUMBER:return this.number();case te.CELL:return this.cell();case te.FUNCTION:return this.func();case te.RPAREN:throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));default:throw new Error("Missing factor")}}},{key:"enclosedExpr",value:function(){this.lparen();var e=this.expr();return this.rparen(),e}},{key:"cell",value:function(){if(this.peekType()!==te.CELL)throw new Error("Missing cell node");var e=new ve(this.curr);return this.consume(),e}},{key:"cellRange",value:function(){var e,t;if(!this.isCellRange())throw new Error("Missing cell range");if(e=new ve(this.curr),this.consume(),this.consume(),t=new ve(this.curr),this.consume(),t.location<e.location){var n=this.invertCellRange(e,t),i=Object(K.a)(n,2);e=i[0],t=i[1]}return new fe(e,t)}},{key:"invertCellRange",value:function(e,t){this.tokens[this.index-2]=t.cell,this.tokens[this.index]=e.cell;var n=e;return[e=t,t=n]}},{key:"func",value:function(){if(this.peekType()!==te.FUNCTION)throw new Error("Missing function");var e=this.curr;this.consume(),this.lparen();var t=this.list();return this.rparen(),new ge(e,t)}},{key:"list",value:function(){var e,t=[];for(e=this.listNode(),t.push(e);this.peekType()===te.COMMA;)this.consume(),e=this.listNode(),t.push(e);return t}},{key:"listNode",value:function(){return this.isCellRange()?this.cellRange():this.peekType()===te.STRING?this.string():this.expr()}},{key:"text",value:function(){var e;if(this.peekType()!==te.TEXT)throw new Error("Missing string");return e=new he(this.curr),this.consume(),e}},{key:"string",value:function(){var e=new de(this.curr);return this.consume(),e}},{key:"number",value:function(){if(this.peekType()===te.NUMBER){var e=new pe(this.curr);return this.consume(),e}throw new Error("Missing number")}},{key:"operator",value:function(){if([te.PLUS,te.MINUS,te.MULT,te.DIV].includes(this.peekType())){var e=this.curr;return this.consume(),e}throw new Error("Missing operator")}},{key:"equals",value:function(){if(this.peekType()!==te.EQUALS)throw new Error("Missing equals sign");this.consume()}},{key:"lparen",value:function(){if(this.peekType()!==te.LPAREN)throw new Error("Missing left parenthesis");this.consume()}},{key:"rparen",value:function(){if(this.peekType()!==te.RPAREN)throw new Error("Missing right parenthesis");this.consume()}},{key:"unaryOp",value:function(){if(![te.PLUS,te.MINUS].includes(this.peekType()))throw new Error("Missing unary operator");var e=this.curr;return this.consume(),new be(e,this.factor())}},{key:"consume",value:function(){this.index<this.tokens.length-1?(this.index++,this.curr=this.tokens[this.index]):this.curr=null}},{key:"isCellRange",value:function(){return this.peekType(0)===te.CELL&&this.peekType(1)===te.COLON&&this.peekType(2)===te.CELL}},{key:"isString",value:function(){return this.peekType(0)===te.DQUOTE&&this.peekType(1)===te.TEXT&&this.peekType(2)===te.DQUOTE}},{key:"peekType",value:function(e){if(!e)return this.curr&&this.curr.type;if(e<0)throw new Error("peak ahead index must be positive");var t=this.index+e;return t<this.tokens.length?this.tokens[t].type:void 0}}]),e}(),Oe=function(){function e(t){Object(A.a)(this,e),this.location=t,this.error=null,this.cache={},this.result=null,this.state=new ue}return Object(N.a)(e,[{key:"interpret",value:function(e){var t,n,i=we.addVertex(this.location,e);try{t=new re(e),n=new me(t.getTokens()),i.ast=n.parse(),we.recalculate(this.location),this.result=i.result}catch(r){return this.error=i.error=r,this.result=i.result=this.errorResponse(),this.result}return this.error=i.error,this.result}},{key:"visitAST",value:function(e){var t=we.getVertex(e);if(!t.ast)return t.result;try{this.result=t.result=this.visitNode(t.ast)}catch(n){throw this.error=t.error=n,this.result=t.result=this.errorResponse(),n}return this.result}},{key:"visitNode",value:function(e){switch(e._name){case"NumberNode":return this.NumberNode(e);case"CellNode":return this.CellNode(e);case"TextNode":return this.TextNode(e);case"StringNode":return this.StringNode(e);case"CellRange":return this.CellRange(e);case"FuncOp":return this.FuncOp(e);case"BinaryOp":return this.BinaryOp(e);case"UnaryOp":return this.UnaryOp(e);default:var t=e._name||(e.constructor||{}).name;throw new Error("Unrecognized AST node ".concat(t))}}},{key:"TextNode",value:function(e){return e.eval()}},{key:"StringNode",value:function(e){return e.eval()}},{key:"NumberNode",value:function(e){return e.eval()}},{key:"UnaryOp",value:function(e){var t=this.visitNode(e.expr);return e.eval(t)}},{key:"CellNode",value:function(e){var t=this.getCellResult(e.location);return void 0===t?0:t}},{key:"BinaryOp",value:function(e){var t=this.visitNode(e.leftNode),n=this.visitNode(e.rightNode);if("number"!==typeof t)throw new Error('term is not a number: "'.concat(t,'"'));if("number"!==typeof n)throw new Error('term is not a number: "'.concat(n,'"'));return e.eval(t,n)}},{key:"CellRange",value:function(e){for(var t=q(e.leftCell.location),n=Object(K.a)(t,2),i=n[0],r=n[1],a=q(e.rightCell.location),o=Object(K.a)(a,2),s=o[0],l=o[1],u=Math.min(i,s),c=Math.max(i,s),h=Math.min(r,l),d=Math.max(r,l),p=[],v=h;v<=d;v++)for(var f=u;f<=c;f++){var b="".concat(X(f),"-").concat(v+1),g=this.getCellResult(b);void 0!==g&&p.push(g)}return p}},{key:"getCellResult",value:function(e){var t;if(!this.isLocationValid(e))throw new Error("Location out of bounds");return void 0!==this.cache[e]?this.cache[e]:(t=we.visitCell(e),this.cache[e]=t,t)}},{key:"FuncOp",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var a,o=e.argNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=this.visitNode(s);"CellRange"===s._name?t.push.apply(t,Object(Z.a)(l)):t.push(l)}}catch(u){i=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return e.eval(t)}},{key:"isLocationValid",value:function(e){var t=q(e),n=Object(K.a)(t,2),i=n[0],r=n[1];return!(Math.min(i,r)<0)&&(!(i>=this.state.columns)&&!(r>=this.state.rows))}},{key:"errorResponse",value:function(){var e=this.error.message;return e.match(/division by zero/i)?"#DIV/0!":e.match(/circular reference/i)?"#REF!":"#ERROR!"}}]),e}(),ke=function e(t){Object(A.a)(this,e),this.entered=t,this.error=null,this.result=null,this.ast=null},Ee=new(function(){function e(){Object(A.a)(this,e),this.adj={},this.pending=null,this.visited=null,this.store=new ue}return Object(N.a)(e,[{key:"recalculate",value:function(e){this.setPendingNodes(),this.dfs(e),this.updateStore()}},{key:"setPendingNodes",value:function(){var e=this;this.pending=new Set,Object.keys(this.adj).forEach(function(t){e.pending.add(t)})}},{key:"dfs",value:function(e){for(var t=this;this.pending.size>0;){e||(e=Object(Z.a)(this.pending)[0]);try{this.visited=new Set([e]),new Oe(e).visitAST(e)}catch(n){}this.visited.forEach(function(e){return t.pending.delete(e)}),e=null}this.visited=null,this.pending=null}},{key:"visitCell",value:function(e){if(this.hasVertex(e)){this.testPathCycle(e),this.pending.delete(e),this.visited.add(e);var t=new Oe(e).visitAST(e);return this.visited.delete(e),t}}},{key:"getCellResult",value:function(e){return e in this.adj?Ee.adj[e].result:""}},{key:"testPathCycle",value:function(e){if(this.visited.has(e))throw new Error("Circular reference")}},{key:"updateStore",value:function(){for(var e=new Set(this.store.locations),t=0,n=Object.entries(this.adj);t<n.length;t++){var i=n[t],r=Object(K.a)(i,2),a=r[0],o=r[1],s=o.entered,l=o.result;e.delete(a),l!==this.store.getCellResult(a)&&this.store.replaceCellData(a,s,l)}var u=!0,c=!1,h=void 0;try{for(var d,p=e[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var v=d.value;this.store.clearCell(v)}}catch(f){c=!0,h=f}finally{try{u||null==p.return||p.return()}finally{if(c)throw h}}}},{key:"addVertex",value:function(e,t){var n=new ke(t);return this.adj[e]=n,n}},{key:"hasVertex",value:function(e){return e in this.adj}},{key:"getVertex",value:function(e){return this.testMissingLocation(e),this.adj[e]}},{key:"delVertex",value:function(e){e in this.adj&&(delete this.adj[e],this.recalculate())}},{key:"resetAll",value:function(){this.adj={},this.pending=null,this.visited=null,this.store=new ue}},{key:"testMissingLocation",value:function(e){if(!this.hasVertex(e))throw new Error("Missing location")}}]),e}()),we=Ee;function je(e){return function(t,n){var i=n().tableData[e];return we.delVertex(e),void 0===i?Promise.resolve():Promise.resolve(t({type:"DELETE_CELL_DATA",payload:e}))}}var Ie=function(){function e(t){Object(A.a)(this,e),this.props=t}return Object(N.a)(e,[{key:"run",value:function(){var e,t=this.props.location,n=this.props.valueEvent.value;this.isWhitespace(n)?this.props.clearCellData(t):(e=this.isFormula(n)?this.sanitizeValue(n):n,this.props.setCellData(t,e))}},{key:"isFormula",value:function(e){return e.length>0&&"="===e[0]}},{key:"isWhitespace",value:function(e){return 0===e.length||Boolean(e.match(/^\s+$/))}},{key:"sanitizeValue",value:function(e){var t=this;return new ae(e).getTokens().map(function(e){var n=t.getTokenValue(e);return(e.whitespace>=1?" ":"")+n}).join("")}},{key:"getTokenValue",value:function(e){switch(e.type){case te.FUNCTION:return e.text.toUpperCase();case te.NUMBER:return e.value;default:return e.text}}}]),e}(),xe=Object(w.a)("div",{target:"e1tu4lq30"})({name:"uwwqev",styles:"width:100%;height:100%;"});var Ce={clearCellData:je,setCellData:function(e,t){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:new Oe(e).interpret(t)}}}}},Ae=Object(s.b)(function(e){return{valueEvent:e.global.inputter.valueEvent}},Ce)(function(e){var t=new Ie(e),n=r.a.createRef();return r.a.createElement(xe,{ref:n,onBlur:function(i){!function(i){n.current.contains(i.targetElement)||"Escape"!==e.keyEvent.key&&t.run()}(i),e.onCommit()}},e.children)}),Ne=Object(w.a)("input",{target:"e2u0rb0"})({name:"11807jv",styles:"height:100%;outline:none;width:100%;z-index:100;"});function Re(e){var t=e.fwdRef,n=e.value,i=e.style,r=e.props,a=e.onChange,o=e.onKeyDown;return Object(c.d)(Ne,Object.assign({ref:t,css:i,value:n,onChange:a,onKeyDown:o},r))}Re.defaultProps={style:{},props:{}};var Me=Re,Te=Object(w.a)("div",{target:"eq6d2e70"})("background:",function(e){return e.theme.colors.dropdown.normal},";margin-top:1px;box-shadow:0 0 5px ",function(e){return e.theme.colors.shadow},";border:1px solid ",function(e){return e.theme.colors.dropdown.active},";width:300px;padding:6px 8px;position:fixed;"),Se=Object(w.a)("pre",{target:"eq6d2e71"})({name:"p8bxbz",styles:"line-height:1em;padding-bottom:3px;font-size:14px;"}),De=Object(w.a)("div",{target:"eq6d2e72"})({name:"11i7ysg",styles:"padding-top:12px;font-size:12px;"}),Ue=Object(w.a)("p",{target:"eq6d2e73"})({name:"kcaog3",styles:"line-height:1em;font-size:13px;"}),Le=Object(w.a)("hr",{target:"eq6d2e74"})("border:0;border-top:1px solid ",function(e){return e.theme.colors.dropdown.active},";"),Pe={name:"1gdm77d",styles:"padding-bottom:6px;"},Fe=function(e){function t(){return Object(A.a)(this,t),Object(R.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(S.a)(t,e),Object(N.a)(t,[{key:"getFnScope",value:function(){var e,t=this.props,n=t.fnScopes,i=t.cursorPos,r=!0,a=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;if(!(i>=u.startIndex+1))break;e=u}}catch(c){a=!0,o=c}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return e&&null===e.endIndex?e:e&&i<=e.endIndex?e:null}},{key:"getFnNode",value:function(e){var t=e.fnName.toUpperCase();return B[t]}},{key:"render",value:function(){var e,t=this.getFnScope(),n=this.context.inputRect;return t?(e=this.getFnNode(t),Object(c.d)(Te,{css:Object(c.c)("top:",n.bottom,"px;left:",n.left,"px;")},Object(c.d)(Se,{css:Pe},e.definition),Object(c.d)(Le,null),Object(c.d)(De,null,"Example"),Object(c.d)(Se,null,e.example),Object(c.d)(De,null,"Summary"),Object(c.d)(Ue,null,e.summary))):null}}]),t}(r.a.PureComponent);Fe.contextType=V;var Ve=Fe,We=n(16),ze=n.n(We),Ge=Object(w.a)("li",{target:"e9dst5h0"})({name:"10b12fz",styles:"outline:none;"});function Be(e){var t=e.item,n=e.index,i=e.isActive,r=e.onMouseEnter;return Object(c.d)(Ge,{tabIndex:0,onMouseEnter:function(){return r(n)}},i&&t.active?t.active:t.base)}Be.defaultProps={onMouseEnter:function(){}};var Ze=Be,Ke=Object(w.a)("ul",{target:"ehyu2mo0"})({name:"rxgulu",styles:"margin:0;padding:0;list-style:none;"}),He=function(e){function t(){return Object(A.a)(this,t),Object(R.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(S.a)(t,e),Object(N.a)(t,[{key:"renderListItems",value:function(){var e=this;return this.props.items.map(function(t,n){return r.a.createElement(Ze,{key:n,index:n,item:t.item,style:Object(d.a)({},e.props.styles.li),isActive:t.isActive,onMouseEnter:e.props.onMouseEnter})})}},{key:"render",value:function(){var e=this.props,t=e.items,n=e.styles;return 0===t.length?null:r.a.createElement(Ke,{tabIndex:-1,style:n.ul},this.renderListItems())}}]),t}(r.a.PureComponent);He.propsTypes={onMouseEnter:ze.a.func,items:ze.a.array.isRequired,styles:ze.a.shape({ul:ze.a.object,li:ze.a.object})};var Ye=He,Qe=Object(w.a)("div",{target:"e8u3mzw0"})({name:"18njgbz",styles:"border:0;position:fixed;"}),Xe={name:"s7sq8v",styles:"padding:6px 8px;"},qe=Object(w.a)("div",{target:"e8u3mzw1"})(Xe," background:",function(e){return e.theme.colors.dropdown.normal},";"),Je=Object(w.a)("div",{target:"e8u3mzw2"})(Xe," background:",function(e){return e.theme.colors.dropdown.active},";"),_e=Object(w.a)("pre",{target:"e8u3mzw3"})({name:"p8bxbz",styles:"line-height:1em;padding-bottom:3px;font-size:14px;"}),$e=Object(w.a)("div",{target:"e8u3mzw4"})({name:"1qxtz39",styles:"font-size:12px;"}),et=function(e){function t(){var e;return Object(A.a)(this,t),(e=Object(R.a)(this,Object(M.a)(t).call(this))).state={listItems:[],itemIndex:0,keyEvent:null,isVisible:!1},e.handleOnClick=e.handleOnClick.bind(Object(T.a)(e)),e.setIndex=e.setIndex.bind(Object(T.a)(e)),e}return Object(S.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({itemIndex:0},function(){e.setListItems()})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.listItems!==t.listItems}},{key:"componentDidUpdate",value:function(e,t){this.updateContextData(t),this.updateListItems(e),this.keyActions()}},{key:"componentWillUnmount",value:function(){this.context.setIsFuncSelectorVisible(!1)}},{key:"updateListItems",value:function(e){var t=this;e.token!==this.props.token&&this.setState({itemIndex:0},function(){t.setListItems()})}},{key:"updateContextData",value:function(e){var t=this.context.keyEvent;e.keyEvent!==t&&(this.setState({keyEvent:t}),this.keyEventSetIndex(t))}},{key:"keyActions",value:function(){var e=this.context.keyEvent;this.state.keyEvent!==e&&["Enter","Tab"].includes(e.key)&&this.state.isVisible&&this.setInputterValueEvent()}},{key:"setInputterValueEvent",value:function(){var e=this.context.valueEvent.value,t=this.props.token,n=this.state.listItems[this.state.itemIndex].fnName,i=t.index+t.text.length,r=e.slice(0,t.index),a=e.slice(i),o="".concat(r).concat(n,"()").concat(a),s=r.length+n.length+1;this.context.setInputterValueEvent(o,s)}},{key:"setListItems",value:function(){var e,t=this,n=this.props.token.text.toUpperCase(),i=Object.keys(B).filter(function(e){return e.startsWith(n)}).sort().map(function(e){return{item:{base:t.itemBase(e),active:t.itemActive(e)},isActive:!1,fnName:e}}),r=!1;e=Math.max(Math.min(i.length-1,this.state.itemIndex),0),i.length>0&&(i[e].isActive=r=!0),this.context.setIsFuncSelectorVisible(r),this.setState({listItems:i,itemIndex:e,isVisible:r})}},{key:"keyEventSetIndex",value:function(e){var t=this,n=this.state.itemIndex;switch(e.key){case"ArrowUp":n=this.state.itemIndex-1;break;case"ArrowDown":n=this.state.itemIndex+1}this.setState({itemIndex:n},function(){t.setListItems()})}},{key:"setIndex",value:function(e){var t=this;this.setState({itemIndex:e},function(){t.setListItems()})}},{key:"itemBase",value:function(e){return Object(c.d)(qe,null,Object(c.d)(_e,null,e))}},{key:"itemActive",value:function(e){return Object(c.d)(Je,null,Object(c.d)(_e,null,e),Object(c.d)($e,null,B[e].summary))}},{key:"getListStyles",value:function(){var e=this.props.theme;return{ul:{marginTop:1,boxShadow:"0 0 5px ".concat(e.colors.shadow),border:"1px solid ".concat(e.colors.dropdown.active),width:300}}}},{key:"handleOnClick",value:function(e){e.nativeEvent.stopPropagation(),this.setInputterValueEvent()}},{key:"render",value:function(){var e=this.state,t=e.listItems,n=e.isVisible,i=this.context.inputRect;return Object(c.d)(Qe,{css:Object(c.c)("top:",i.bottom,"px;left:",i.left,"px;"),open:n,onClick:this.handleOnClick},Object(c.d)(Ye,{items:t,styles:this.getListStyles(),onMouseEnter:this.setIndex}))}}]),t}(r.a.Component);et.contextType=V;var tt=Object(u.b)(et),nt=function(e){function t(){var e,n;Object(A.a)(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(n=Object(R.a)(this,(e=Object(M.a)(t)).call.apply(e,[this].concat(r)))).state={fnScopes:[]},n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){this.setFnScopes()}},{key:"componentDidUpdate",value:function(e){e.tokens!==this.props.tokens&&this.setFnScopes()}},{key:"setFnScopes",value:function(){var e=[],t=[],n=!0,i=!1,r=void 0;try{for(var a,o=this.props.tokens[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.type===te.FUNCTION){var l={fnName:s.text,startIndex:s.index,endIndex:null};e.push(l),t.push(l)}else if(s.type===te.LPAREN)e.push("(");else if(s.type===te.RPAREN){if(e.pop(),e.length>0&&"("!==e[e.length-1])e.pop().endIndex=s.index}}}catch(u){i=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}t.sort(function(e,t){return e.startIndex-t.startIndex}),this.setState({fnScopes:t})}},{key:"getCurrTokenIndex",value:function(e,t){var n;for(n=0;n<e.length;n++){var i=e[n],r=i.index+i.text.length;if(t>i.index&&t<=r)break}return n}},{key:"getCompareTokens",value:function(){var e=this.props,t=e.tokens,n=e.cursorPos,i=this.getCurrTokenIndex(t,n);return[i>0&&t[i-1],t[i],i<t.length-2&&t[i+1]]}},{key:"canSelectFunc",value:function(e,t,n){return!(!e||!t||n||e.type!==te.EQUALS&&"operator"!==e.category||![te.UNKNOWN,te.FUNCTION].includes(t.type))||(!!(e&&t&&!n&&[te.LPAREN,te.COMMA].includes(e.type)&&[te.UNKNOWN,te.FUNCTION].includes(t.type))||(!(!(e&&t&&n)||e.type!==te.EQUALS&&"operator"!==e.category||![te.UNKNOWN,te.FUNCTION].includes(t.type)||"operator"!==n.category)||!!(e&&t&&n&&[te.LPAREN,te.COMMA].includes(e.type)&&[te.UNKNOWN,te.FUNCTION].includes(t.type)&&[te.RPAREN,te.COMMA].includes(n.type))))}},{key:"getFuncSelector",value:function(){var e=this.getCompareTokens(),t=Object(K.a)(e,3),n=t[0],i=t[1],r=t[2];return this.props.tokens.length<2?null:this.canSelectFunc(n,i,r)?{token:i}:void 0}},{key:"render",value:function(){if(void 0===this.props.cursorPos)return null;var e=this.getFuncSelector();return e?r.a.createElement(tt,e):r.a.createElement(Ve,{cursorPos:this.props.cursorPos,fnScopes:this.state.fnScopes})}}]),t}(r.a.PureComponent),it=function(){},rt=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,e))).state={tokens:[],isFuncSelectorVisible:!1,keyEvent:{key:""},width:null},n.refInput=r.a.createRef(),n.history=new le(Object(T.a)(n),20,150),n.handleOnChange=n.handleOnChange.bind(Object(T.a)(n)),n.handleOnKeyDown=n.handleOnKeyDown.bind(Object(T.a)(n)),n.keyboardActions=new oe(Object(T.a)(n)),n.keyboardFocuser=new se(Object(T.a)(n)),n.setInputWidth=n.setInputWidth.bind(Object(T.a)(n)),n.setIsFuncSelectorVisible=n.setIsFuncSelectorVisible.bind(Object(T.a)(n)),n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){this.props.onMount(this.props,this.state,this.refInput.current),this.history.reset()}},{key:"componentDidUpdate",value:function(e,t){e.location!==this.props.location&&this.history.reset(),e.valueEvent!==this.props.valueEvent&&(this.focusInputTag(),this.tokenizeInputValue(),this.history.push(this.props.valueEvent)),t.keyEvent!==this.state.keyEvent&&(this.history.keyAction(),this.keyboardActions.run(),this.keyboardFocuser.run())}},{key:"setInputWidth",value:function(e){this.state.width!==e&&this.setState({width:e})}},{key:"tokenizeInputValue",value:function(){var e=this.props.valueEvent.value,t=new ae(e).getTokens();this.setState({tokens:t})}},{key:"setIsFuncSelectorVisible",value:function(e){this.setState({isFuncSelectorVisible:e})}},{key:"focusInputTag",value:function(){if(this.props.isInteractive){var e=this.refInput.current,t=this.props.valueEvent.cursorPos;e.focus(),e.selectionEnd!==t&&(e.selectionStart=t,e.selectionEnd=t)}}},{key:"setValueEvent",value:function(e){var t=e.target,n=t.value,i=t.selectionStart;this.props.setInputterValueEvent(n,i)}},{key:"setKeyEvent",value:function(e){var t=this,n=e.key,i=e.altKey,r=e.ctrlKey,a=e.shiftKey,o=e.metaKey;setTimeout(function(){var e=t.refInput.current.selectionStart,s={key:n,altKey:i,ctrlKey:r,shiftKey:a,metaKey:o,cursorPos:e};t.setState({keyEvent:s})},0)}},{key:"keyDownEventBehavior",value:function(e){var t=e.key,n=e.metaKey,i=e.ctrlKey;["Tab","Enter"].includes(t)?e.preventDefault():"z"===t&&(n||i)&&e.preventDefault()}},{key:"handleOnChange",value:function(e){this.setValueEvent(e)}},{key:"handleOnKeyDown",value:function(e){this.keyDownEventBehavior(e),this.setKeyEvent(e)}},{key:"renderSuggestions",value:function(){return this.props.isInteractive?r.a.createElement(nt,{tokens:this.state.tokens,cursorPos:this.state.keyEvent.cursorPos}):null}},{key:"render",value:function(){var e=this.refInput.current,t=e&&e.getBoundingClientRect();return r.a.createElement(V.Provider,{value:{inputRect:t,setIsFuncSelectorVisible:this.setIsFuncSelectorVisible,keyEvent:this.state.keyEvent,valueEvent:this.props.valueEvent,setInputterValueEvent:this.props.setInputterValueEvent}},r.a.createElement(Ae,{location:this.props.location,keyEvent:this.state.keyEvent,onCommit:this.props.onCommit},r.a.createElement(Me,{fwdRef:this.refInput,props:this.props.inputTagProps.props,style:this.props.inputTagProps.style,value:this.props.valueEvent.value,onChange:this.handleOnChange,onKeyDown:this.handleOnKeyDown}),this.renderSuggestions()))}}]),t}(r.a.PureComponent);rt.defaultProps={inputTagProps:{},isInteractive:!1,onCommit:it,onEscape:it,onMount:it};var at={resetInputterValueEvent:function(){return function(e,t){var n=t().global.activeCell.location;e(D((t().tableData[n]||{}).entered||""))}},setInputterValueEvent:D},ot=Object(s.b)(function(e){var t=e.global,n=t.activeCell,i=n.entered,r=n.location,a=t.inputter.valueEvent,o=t.rows;return{columns:t.columns,entered:i,location:r,rows:o,valueEvent:a}},at)(rt),st=12,lt=800,ut=12,ct=600;var ht=50,dt=Object(w.a)("div",{target:"e1d5mcq00"})("position:sticky;left:0;font-size:12px;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.table.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.table.borderDark},";background:",function(e){return e.theme.colors.table.labelBkg},";"),pt=Object(w.a)("button",{target:"e1d5mcq01"})("background:transparent;cursor:row-resize;outline:none;position:absolute;width:100%;height:6px;margin:0 0 -3px 0;border:0;padding:0;left:0;bottom:0;z-index:1;:hover{background:",function(e){return e.theme.colors.primary.light},";}"),vt=function(e){function t(){var e;return Object(A.a)(this,t),(e=Object(R.a)(this,Object(M.a)(t).call(this))).state={pageY:0,height:0,btnBottom:0,isResizing:!1},e.refRoot=r.a.createRef(),e.debSetRowHeight=_(function(t){var n=t.pageY-e.state.pageY;e.setState({btnBottom:n})},40),e.handleBtnHeightOnMouseDown=e.handleBtnHeightOnMouseDown.bind(Object(T.a)(e)),e.handleDocumentMouseMove=e.handleDocumentMouseMove.bind(Object(T.a)(e)),e.handleDocumentMouseUp=e.handleDocumentMouseUp.bind(Object(T.a)(e)),e.debSetRowHeight=e.debSetRowHeight.bind(Object(T.a)(e)),e}return Object(S.a)(t,e),Object(N.a)(t,[{key:"getRootStyle",value:function(){var e=this.props.height,t={width:ht};return e?t.height=e:(t.minHeight=28,t.height="auto"),t}},{key:"getBtnHeightStyle",value:function(){if(this.state.isResizing){var e=-(Y(this.state.btnBottom,ut-this.state.height,ct-this.state.height)-4);return function(t){return Object(c.c)("height:1.5px;width:95vw;bottom:",e,"px;background:",t.colors.primary.light,";")}}}},{key:"handleDocumentMouseMove",value:function(e){this.debSetRowHeight(e)}},{key:"handleDocumentMouseUp",value:function(e){var t=e.pageY-this.state.pageY,n=this.state.height+t;this.props.setRowHeight(this.props.label,n),this.setState({btnBottom:0,isResizing:!1}),document.removeEventListener("mousemove",this.handleDocumentMouseMove),document.removeEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"handleBtnHeightOnMouseDown",value:function(e){e.preventDefault(),this.setState({pageY:e.pageY,height:this.props.height||this.refRoot.current.getBoundingClientRect().height,isResizing:!0}),document.addEventListener("mousemove",this.handleDocumentMouseMove),document.addEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"render",value:function(){var e=this.props.label;return Object(c.d)(dt,{ref:this.refRoot,"data-row":e,className:"row-header-width",css:this.getRootStyle()},e,Object(c.d)(pt,{css:this.getBtnHeightStyle(),tabIndex:"-1",onMouseDown:this.handleBtnHeightOnMouseDown,onMouseMove:this.handleBtnHeightOnMouseMove,onMouseUp:this.handleBtnHeightOnMouseUp}))}}]),t}(r.a.PureComponent);var ft={setRowHeight:function(e,t){if("number"!==typeof t)throw new Error("height is not a number");return{type:"SET_ROW_HEIGHT",payload:{rowLabel:e,height:Y(t,ut,ct)}}}},bt=Object(s.b)(function(e,t){return{height:e.tableMeta.rowHeights[t.label]}},ft)(vt),gt=Object(w.a)("div",{target:"e1bzpir00"})("display:flex;border-width:2px 2px 0;border-style:solid;border-color:",function(e){return e.theme.colors.table.borderDark},";position:relative;height:30px;width:100%;z-index:10;"),yt=Object(w.a)("div",{target:"e1bzpir01"})("display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.table.borderDark},";width:",ht+3,"px;color:",function(e){return e.theme.colors.table.borderDark},";font-style:italic;"),mt=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,e))).state={isInteractive:!1},n.refRoot=r.a.createRef(),n.handleOnFocus=n.handleOnFocus.bind(Object(T.a)(n)),n.handleOnBlur=n.handleOnBlur.bind(Object(T.a)(n)),n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"handleOnFocus",value:function(){this.setState({isInteractive:!0}),this.props.scheduleFloatingInputter(!1)}},{key:"handleOnBlur",value:function(e){this.refRoot.current.contains(e.relatedTarget)||(this.props.closeFloatingInputter(),this.setState({isInteractive:!1}))}},{key:"render",value:function(){return r.a.createElement(gt,{ref:this.refRoot,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur},r.a.createElement(yt,null,"\u0192x"),r.a.createElement(ot,{isInteractive:this.state.isInteractive,inputTagProps:F}))}}]),t}(r.a.PureComponent);var Ot={scheduleFloatingInputter:function(e){return function(t,n){var i=n().global.floatingInputter;if(!i.isOpen||i.isInteractive!==e)return Promise.resolve(t({type:"SCHEDULE_FLOATING_INPUTTER",payload:{isInteractive:e}}))}},closeFloatingInputter:L},kt=Object(s.b)(function(e){return{location:e.global.activeCell.location}},Ot)(mt),Et=n(24),wt={style:function(e){return Object(c.c)("align-items:center;background-color:white;border:2px solid salmon;box-shadow:0 0 5px ",e.colors.shadow,";box-sizing:border-box;display:flex;font-size:13px;padding:0 8px 0 2px;")},props:{"data-inputter":"floating"}},jt=Object(w.a)(Ne,{target:"esogvan0"})({name:"14h8fd2",styles:"position:absolute;margin-top:-200vh;visibility:hidden;"}),It=function(e){function t(){var e,n;Object(A.a)(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=Object(R.a)(this,(e=Object(M.a)(t)).call.apply(e,[this].concat(a)))).refInput=r.a.createRef(),n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){this.setInputWidth()}},{key:"componentDidUpdate",value:function(e,t){e.valueEvent!==this.props.valueEvent&&this.setInputWidth()}},{key:"setInputWidth",value:function(){var e=this.refInput.current.scrollWidth,t=e+3>this.props.cellRect.width?Math.ceil(e)+7:this.props.cellRect.width;this.props.setInputWidth(t)}},{key:"render",value:function(){var e=this;return Object(c.d)(jt,{readOnly:!0,ref:this.refInput,value:this.props.valueEvent.value,css:function(t){return[e.props.style(t),"width: ".concat(e.props.cellRect.width,"px;")]}})}}]),t}(r.a.PureComponent);It.defaultProps={style:function(){}};var xt=It,Ct=Object(w.a)("div",{target:"e1k5oeog0"})({name:"1b7bwed",styles:"position:fixed;"}),At=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,e))).state={width:"auto"},n.refRoot=r.a.createRef(),n.handleOnFocus=n.handleOnFocus.bind(Object(T.a)(n)),n.handleOnMount=n.handleOnMount.bind(Object(T.a)(n)),n.setInputWidth=n.setInputWidth.bind(Object(T.a)(n)),n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"setInputWidth",value:function(e){this.state.width!==e&&this.setState({width:e})}},{key:"handleOnMount",value:function(e,t,n){this.props.inputter.isInteractive&&(n.focus(),n.selectionEnd=n.value.length)}},{key:"handleOnFocus",value:function(){this.props.inputter.isInteractive||this.props.setFloatingInputterInteractive(!0)}},{key:"render",value:function(){if(!this.props.inputter.isOpen)return null;var e=this.props.cellRect,t=e.top,n=e.left,i=e.height,r=this.state.width;return Object(c.d)(Ct,{css:Object(Et.a)({top:t,left:n,width:r,height:i}),onFocus:this.handleOnFocus,ref:this.refRoot},Object(c.d)(xt,{cellRect:this.props.cellRect,setInputWidth:this.setInputWidth,style:wt.style,valueEvent:this.props.valueEvent}),Object(c.d)(ot,{inputTagProps:wt,isInteractive:this.props.inputter.isInteractive,onCommit:this.props.closeFloatingInputter,onEscape:this.props.closeFloatingInputter,onMount:this.handleOnMount}))}}]),t}(r.a.PureComponent);At.defaultProps={cellRect:{},isInputterOpen:!1};var Nt={closeFloatingInputter:L,setFloatingInputterInteractive:function(e){return{type:"SET_FLOATING_INPUTTER_INTERACTIVE",payload:e}}},Rt=Object(s.b)(function(e){var t=e.global,n=t.activeCell.location,i=t.inputter.valueEvent,r=t.floatingInputter;return{cellRect:r.cellRect,valueEvent:i,location:n,inputter:{isOpen:r.isOpen,isInteractive:r.isInteractive}}},Nt)(At),Mt=n(28),Tt=Object(w.a)("div",{target:"e11zdtao0"})("position:relative;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.table.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.table.borderDark},";background:",function(e){return e.theme.colors.table.labelBkg},";font-size:12px;"),St=Object(w.a)("button",{target:"e11zdtao1"})("background:transparent;cursor:col-resize;outline:none;position:absolute;height:100%;margin:0 -3px 0 0;width:6px;border:0;padding:0;right:0;top:0;z-index:2;:hover{background:",function(e){return e.theme.colors.primary.light},";}"),Dt=function(e){function t(){var e;return Object(A.a)(this,t),(e=Object(R.a)(this,Object(M.a)(t).call(this))).state={pageX:0,width:0,btnRight:0,isResizing:!1},e.debSetColWidth=_(function(t){var n=t.pageX-e.state.pageX;e.setState({btnRight:n})},40),e.handleBtnWidthOnMouseDown=e.handleBtnWidthOnMouseDown.bind(Object(T.a)(e)),e.handleDocumentMouseMove=e.handleDocumentMouseMove.bind(Object(T.a)(e)),e.handleDocumentMouseUp=e.handleDocumentMouseUp.bind(Object(T.a)(e)),e.debSetColWidth=e.debSetColWidth.bind(Object(T.a)(e)),e}return Object(S.a)(t,e),Object(N.a)(t,[{key:"getBtnWidthStyle",value:function(){if(this.state.isResizing){var e=-(Y(this.state.btnRight,st-this.state.width,lt-this.state.width)-4);return function(t){return Object(c.c)("width:1.5px;height:90vh;right:",e,"px;background:",t.colors.primary.light,";")}}}},{key:"handleDocumentMouseMove",value:function(e){this.debSetColWidth(e)}},{key:"handleDocumentMouseUp",value:function(e){var t=e.pageX-this.state.pageX,n=this.state.width+t;this.props.setColWidth(this.props.label,n),this.setState({btnRight:0,isResizing:!1}),document.removeEventListener("mousemove",this.handleDocumentMouseMove),document.removeEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"handleBtnWidthOnMouseDown",value:function(e){e.preventDefault(),this.setState({pageX:e.pageX,width:this.props.width,isResizing:!0}),document.addEventListener("mousemove",this.handleDocumentMouseMove),document.addEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.label,n=e.width;return Object(c.d)(Tt,{"data-col":t,className:"col-label-height",css:Object(c.c)("width:",n,"px;height:26px;")},t,Object(c.d)(St,{css:this.getBtnWidthStyle(),tabIndex:"-1",onMouseDown:this.handleBtnWidthOnMouseDown,onMouseMove:this.handleBtnWidthOnMouseMove,onMouseUp:this.handleBtnWidthOnMouseUp}))}}]),t}(r.a.PureComponent);Dt.defaultProps={width:140};var Ut={setColWidth:function(e,t){if("number"!==typeof t)throw new Error("width is not a number");return{type:"SET_COL_WIDTH",payload:{colLabel:e,width:Y(t,st,lt)}}}},Lt=Object(s.b)(function(e,t){return{width:e.tableMeta.colWidths[t.label]}},Ut)(Dt),Pt=Object(w.a)("div",{target:"eft810l0"})({name:"1che6bd",styles:"display:flex;width:fit-content;position:sticky;top:0;"}),Ft=Object(w.a)("div",{target:"eft810l1"})("position:sticky;top:0;left:0;z-index:20;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.table.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.table.borderDark},";background:",function(e){return e.theme.colors.table.labelBkg},";");var Vt=function(e){var t=e.colLabels;return Object(c.d)(Pt,{"data-row":"header"},Object(c.d)(Ft,{css:Object(c.c)("width:",ht,"px;height:26px;")}),new Array(t.length).fill(0).map(function(e,n){return Object(c.d)(Lt,{key:n,label:t[n]})}))},Wt=Object(w.a)("div",{target:"e1rvd88v0"})({name:"1f98b2w",styles:"display:flex;align-items:center;border:2px solid transparent;line-height:1.1em;height:100%;width:100%;padding:2px;"});var zt=function(e){var t=e.fwdRef,n=e.isActive,i=e.location,r=e.onClick,a=e.onDoubleClick,o=e.onFocus,s=e.onKeyDown,l=e.result;return Object(c.d)(Wt,{ref:t,"data-cell":"result","data-location":i,css:function(){var e={};return"number"===typeof l&&(e={whiteSpace:"nowrap",textOverflow:"clip",overflow:"hidden"}),n&&(e.border="2px solid salmon"),e}(),tabIndex:"0",onClick:r,onKeyDown:s,onDoubleClick:a,onFocus:o},l)},Gt=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,e))).handleOnClick=n.handleOnClick.bind(Object(T.a)(n)),n.handleOnDoubleClick=n.handleOnDoubleClick.bind(Object(T.a)(n)),n.handleOnFocus=n.handleOnFocus.bind(Object(T.a)(n)),n.handleOnKeyDown=n.handleOnKeyDown.bind(Object(T.a)(n)),n.refDatum=e.fwdRef,n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"componentDidUpdate",value:function(){this.scheduledFloatingInputter()}},{key:"scheduledFloatingInputter",value:function(){if(this.props.isActive&&this.props.scheduledFloatingInputter.willOpen){var e=this.props.scheduledFloatingInputter.isInteractive;this.props.unscheduleFloatingInputter(),this.openFloatingInputter(e)}}},{key:"openFloatingInputter",value:function(e,t){var n=this.refDatum.current.getBoundingClientRect(),i=JSON.parse(JSON.stringify(n));this.props.openFloatingInputter(i,e,t)}},{key:"handleOnFocus",value:function(){this.props.setActiveCell(this.props.location)}},{key:"handleOnClick",value:function(e){e.stopPropagation()}},{key:"handleOnDoubleClick",value:function(e){e.stopPropagation(),this.openFloatingInputter(!0)}},{key:"handleOnKeyDown",value:function(e){var t=e.key;["Delete","Backspace"].includes(t)?(""+this.props.result).length>0&&this.props.clearCellData(this.props.location):1===t.length&&this.openFloatingInputter(!0,t)}},{key:"render",value:function(){return r.a.createElement(zt,{fwdRef:this.refDatum,location:this.props.location,result:this.props.result,isActive:this.props.isActive,onClick:this.handleOnClick,onDoubleClick:this.handleOnDoubleClick,onFocus:this.handleOnFocus,onKeyDown:this.handleOnKeyDown})}}]),t}(r.a.PureComponent);var Bt={clearCellData:je,openFloatingInputter:function(e,t,n){return function(i,r){var a=r();return i(D(n||a.global.activeCell.entered)),Promise.resolve(i({type:"OPEN_FLOATING_INPUTTER",payload:{cellRect:e,isOpen:!0,isInteractive:t,willOpen:!1}}))}},setActiveCell:U,unscheduleFloatingInputter:function(){return{type:"UNSCHEDULE_FLOATING_INPUTTER",payload:null}}},Zt=Object(s.b)(function(e,t){var n=e.global.activeCell.location===t.location,i=e.global.scheduledFloatingInputter,r=e.tableData[t.location];return{result:r?r.result:"",isActive:n,scheduledFloatingInputter:i}},Bt)(Gt),Kt=Object(w.a)("div",{target:"e17q3q8l0"})("cursor:cell;overflow:hidden;font-size:13px;border-right:1px solid ",function(e){return e.theme.colors.table.border},";border-bottom:1px solid ",function(e){return e.theme.colors.table.border},";outline:none;");function Ht(e){var t=e.width,n=e.height,i=e.onClick,r=e.onDoubleClick,a=e.children;return Object(c.d)(Kt,{"data-cell":"border",onClick:i,onDoubleClick:r,css:Object(Et.a)({width:t,height:n&&n})},a)}Ht.defaultProps={width:140};var Yt=Object(s.b)(function(e,t){var n=t.location.split("-"),i=Object(K.a)(n,2),r=i[0],a=i[1];return{width:e.tableMeta.colWidths[r],height:e.tableMeta.rowHeights[a]}})(Ht),Qt=function(e){function t(){var e;return Object(A.a)(this,t),(e=Object(R.a)(this,Object(M.a)(t).call(this))).refDatum=r.a.createRef(),e.handleOnClick=e.handleOnClick.bind(Object(T.a)(e)),e.handleOnDoubleClick=e.handleOnDoubleClick.bind(Object(T.a)(e)),e}return Object(S.a)(t,e),Object(N.a)(t,[{key:"focusDatum",value:function(){var e=this;setTimeout(function(){return e.refDatum.current.focus()},0)}},{key:"handleOnClick",value:function(){this.focusDatum()}},{key:"handleOnDoubleClick",value:function(){this.focusDatum()}},{key:"render",value:function(){var e=this.props.location;return r.a.createElement(Yt,{location:e,onClick:this.handleOnClick,onDoubleClick:this.handleOnDoubleClick},r.a.createElement(Zt,{location:e,fwdRef:this.refDatum}))}}]),t}(r.a.PureComponent),Xt=Object(w.a)("div",{target:"e1qfob7v0"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"});var qt=function(e){var t=e.rowNumber,n=e.colLabels;return r.a.createElement(Xt,{"data-row":t},r.a.createElement(bt,{label:t}),new Array(n.length).fill(0).map(function(e,i){var a="".concat(n[i],"-").concat(t);return r.a.createElement(Qt,{key:i,location:a})}))};var Jt={id:"keyboardNav",initial:"idle",context:{columns:null,rows:null,keyEvent:null,colIndex:null,rowIndex:null,endLocation:null,wasFocused:!1},states:{idle:{on:{MOVE_FOCUS:{actions:["setNewContext","calcTargetLocation"],target:"focusTarget"}}},focusTarget:{invoke:{src:function(e){return e.endLocation?new Promise(function(t){setTimeout(function(){var n='[data-location="'.concat(e.endLocation,'"]'),i=document.querySelector(n);i&&i.focus(),t(!0)},0)}):Promise.resolve(!1)},onDone:{actions:Object(Mt.b)({wasFocused:function(e,t){return t.data}}),target:"idle"}}}}},_t={actions:{setNewContext:Object(Mt.b)(function(e,t){var n=t.keyEvent,i=q(t.location),r=Object(K.a)(i,2);return{colIndex:r[0],rowIndex:r[1],keyEvent:n}}),calcTargetLocation:Object(Mt.b)({endLocation:function(e){return function(e){var t=e.rows,n=e.columns,i=e.rowIndex,r=e.colIndex,a=e.keyEvent,o=a.key,s=(a.altKey,a.ctrlKey,a.shiftKey);if("ArrowUp"===o)i=Math.max(0,i-1);else if("ArrowRight"===o||"Tab"===o&&!s)r=Math.min(n-1,r+1);else if(["ArrowDown","Enter"].includes(o))i=Math.min(t-1,i+1);else{if(!("ArrowLeft"===o||"Tab"===o&&s))return null;r=Math.max(0,r-1)}var l=X(r),u=""+(i+1);return"".concat(l,"-").concat(u)}(e)}})}};var $t=function(e,t){var n=Object(d.a)({},Jt.context,{columns:t,rows:e});return Object(Mt.a)(Jt,_t,n)},en=Object(w.a)("div",{target:"e13nwjgw0"})("display:flex;flex-direction:column;width:100%;height:60vh;min-height:300px;border-top:2px solid ",function(e){return e.theme.colors.table.borderDark},";border-left:2px solid ",function(e){return e.theme.colors.table.borderDark},";border-right:1px solid ",function(e){return e.theme.colors.table.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.table.borderDark},";overflow:scroll;*{box-sizing:border-box;}"),tn=function(e){function t(e){var n;return Object(A.a)(this,t),(n=Object(R.a)(this,Object(M.a)(t).call(this,e))).keyboardNavMachine=$t(n.props.rows,n.props.columns),n.focusService=Object(Mt.c)(n.keyboardNavMachine),n.refGrid=r.a.createRef(),n.handleOnClick=n.handleOnClick.bind(Object(T.a)(n)),n.handleOnKeyDown=n.handleOnKeyDown.bind(Object(T.a)(n)),n.colLabels=Q(e.columns),n}return Object(S.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){this.focusService.start(),this.props.setActiveCell("A-1"),this.focusA_1()}},{key:"componentWillUnmount",value:function(){this.focusService.stop()}},{key:"focusA_1",value:function(){var e=document.querySelector('[data-location="A-1"]');e&&e.focus()}},{key:"handleOnClick",value:function(e){e.stopPropagation()}},{key:"handleOnKeyDown",value:function(e){e.stopPropagation(),e.preventDefault(),e.target.dataset.location&&this.moveFocus(e,e.target.dataset.location)}},{key:"moveFocus",value:function(e,t){var n={key:e.key,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey};this.focusService.send({type:"MOVE_FOCUS",keyEvent:n,location:t})}},{key:"renderColHeaderRow",value:function(e){return r.a.createElement(Vt,{key:e,rows:this.props.rows,colLabels:this.colLabels})}},{key:"renderDataRows",value:function(e){return r.a.createElement(qt,{key:e,rowNumber:e,colLabels:this.colLabels})}},{key:"renderRows",value:function(){var e=this;return new Array(this.props.rows+1).fill(0).map(function(t,n){return 0===n?e.renderColHeaderRow(n):e.renderDataRows(n)})}},{key:"render",value:function(){return r.a.createElement(en,{ref:this.refGrid,"data-table":"app",onClick:this.handleOnClick,onKeyDown:this.handleOnKeyDown},this.renderRows())}}]),t}(r.a.PureComponent),nn={setActiveCell:U},rn=Object(s.b)(function(e){var t=e.global;return{rows:t.rows,columns:t.columns}},nn)(tn),an=Object(w.a)("div",{target:"e1xqz1hh0"})({name:"1a0e06c",styles:"width:400px;padding-left:60px;"}),on=Object(w.a)("h3",{target:"e1xqz1hh1"})({name:"jh3a5k",styles:"padding-bottom:15px;"}),sn=Object(w.a)("ul",{target:"e1xqz1hh2"})({name:"1lw6t4p",styles:"list-style:none;column-count:3;"}),ln=Object(w.a)("li",{target:"e1xqz1hh3"})({name:"1kuy7z7",styles:"font-size:14px;"});var un=function(){return r.a.createElement(an,null,r.a.createElement(on,null,"Available Functions"),r.a.createElement(sn,null,r.a.createElement(ln,null,"AVERAGE"),r.a.createElement(ln,null,"AVG"),r.a.createElement(ln,null,"CONCAT"),r.a.createElement(ln,null,"COUNT"),r.a.createElement(ln,null,"MAX"),r.a.createElement(ln,null,"MIN"),r.a.createElement(ln,null,"POW"),r.a.createElement(ln,null,"POWER"),r.a.createElement(ln,null,"SQRT"),r.a.createElement(ln,null,"SUM")))},cn=n(50),hn=n.n(cn),dn=Object(w.a)("div",{target:"e1bdfjz70"})({name:"2rp4wo",styles:"font-size:14px;display:flex;align-items:center;"}),pn=Object(w.a)("img",{target:"e1bdfjz71"})({name:"1ur44gk",styles:"width:52px;margin-top:-4px;"});var vn=function(){return r.a.createElement(dn,null,"Source code on",r.a.createElement("a",{href:"https://github.com/julianhr/app-spreadsheet",rel:"noopener noreferrer",target:"_blank"},r.a.createElement(pn,{src:hn.a,alt:"GitHub source code"})))},fn=Object(w.a)("div",{target:"e3r68ca0"})({name:"eoyqv6",styles:"display:flex;padding:40px;justify-content:space-evenly;"});var bn=function(){return r.a.createElement(fn,null,r.a.createElement(un,null),r.a.createElement(vn,null))},gn=Object(w.a)("div",{target:"e4x97se0"})({name:"pl3zfx",styles:'display:grid;grid:"left-blank main right-blank" 100vh / auto minmax(auto,1000px) auto;'}),yn=Object(w.a)("main",{target:"e4x97se1"})({name:"n7iznt",styles:"grid-area:main;"});var mn=function(){return r.a.createElement(gn,null,r.a.createElement(yn,null,r.a.createElement(Rt,null),r.a.createElement("div",{"data-dummy-focus-stop":!0,tabIndex:"0"}),r.a.createElement(C,null),r.a.createElement(kt,null),r.a.createElement(rn,null),r.a.createElement(bn,null)))};var On=function(){return r.a.createElement(s.a,{store:g},r.a.createElement(l.a,null,r.a.createElement(u.a,{theme:k},r.a.createElement(c.a,{styles:E}),r.a.createElement(mn,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(On,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[54,1,2]]]);
//# sourceMappingURL=main.fa2c4ff5.chunk.js.map
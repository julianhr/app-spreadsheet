{"version":3,"sources":["reducers/globalReducer.js","reducers/tableDataReducer.js","reducers/tableMetaReducer.js","reducers/index.js","styles/theme.js","styles/globalStyles.js","components/header/Header.jsx","actions/globalActions.js","components/FormulaBar/inputTagProps.js","formulas/ReduxConnect.js","actions/tableDataActions.js","formulas/Token.js","formulas/formulaFunctions.js","library/utils.js","formulas/TokenSanitizer.js","formulas/LexerRule.js","formulas/Lexer.js","formulas/ast.js","formulas/Parser.js","formulas/Interpreter.js","formulas/graph.js","components/Inputter/InputContext.js","components/Inputter/KeyboardActions.js","components/Inputter/KeyboardFocuser.js","components/Inputter/CellValueSetter.js","components/Inputter/InputTag.jsx","components/Inputter/FuncDescription.jsx","library/InteractiveListItem.jsx","library/InteractiveList.jsx","components/Inputter/FuncSelector.jsx","components/Inputter/Suggestions.jsx","components/Inputter/Inputter.jsx","library/constants.js","components/cell/RowHeader.jsx","actions/tableMetaActions.js","components/FormulaBar/FormulaBar.jsx","components/FloatingInputter/inputTagProps.js","components/FloatingInputter/InputSizer.jsx","components/FloatingInputter/KeyboardFocuser.js","components/FloatingInputter/FloatingInputter.jsx","components/cell/ColHeader.jsx","components/table/ColHeaderRow.jsx","components/ResultCell/Datum.jsx","components/ResultCell/Result.jsx","components/ResultCell/OutterBorder.jsx","components/ResultCell/ResultCell.jsx","components/table/DataRow.jsx","components/table/keyboardNavMachine.js","components/table/Table.jsx","components/Instructions/Instructions.jsx","App.jsx","Root.jsx","serviceWorker.js","index.js"],"names":["createReducer","activeCell","entered","location","inputter","valueEvent","value","cursorPos","scheduledFloatingInputter","willOpen","isInteractive","floatingInputter","cellRect","isOpen","rows","columns","SET_TABLE_DIMENSIONS","state","_ref","payload","SET_ACTIVE_CELL","_ref2","SCHEDULE_FLOATING_INPUTTER","_ref3","UNSCHEDULE_FLOATING_INPUTTER","OPEN_FLOATING_INPUTTER","_ref4","Object","objectSpread","SET_FLOATING_INPUTTER_INTERACTIVE","_ref5","CLOSE_FLOATING_INPUTTER","SET_INPUTTER_VALUE_EVENT","_ref6","RESET_FLOATING_INPUTTER","_ref7","SET_CELL_DATA","data","DELETE_CELL_DATA","colWidths","rowHeights","SET_COL_WIDTH","colLabel","width","defineProperty","SET_ROW_HEIGHT","rowLabel","height","appStore","configureStore","reducer","global","globalReducer","tableData","tableDataReducer","tableMeta","tableMetaReducer","breaks","xs","sm","md","lg","breakBump","queries","concat","from","breakPoint","upTo","theme","colors","text","table","border","borderDark","labelBkg","dropdown","normal","active","primary","strong","light","field","background","shadow","globalStyles","css","Root","styled_base_browser_esm","target","name","styles","Header","react_default","a","createElement","setInputterValueEvent","type","undefined","length","setActiveCell","dispatch","getState","Promise","resolve","closeFloatingInputter","createAction","inputTagProps","style","inputTagProps_ref","props","data-inputter","ReduxConnect","store","arguments","classCallCheck","this","globalState","result","replaceCellData","clearCellData","keys","Token","whitespace","category","index","html","testArgsAllNumbers","args","forEach","arg","TypeError","Fn","AVERAGE","fn","_Fn$SUM","_Fn$COUNT","Error","SUM","apply","COUNT","definition","example","summary","CONCAT","_len","Array","_key","_i","_args","push","join","MAX","_len2","_key2","Math","max","MIN","_len3","_key3","min","POWER","_len4","_key4","base","exp","pow","SQRT","_len5","_key5","sqrt","_len6","_key6","reduce","prev","curr","AVG","POW","BASE_CODE_POINT","codePointAt","clamp","getColumnNames","cols","names","prevNames","remainCols","newNames","outerLoop","_prevNames","colName","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","letter","err","return","toConsumableArray","getColumnLabel","num","label","basePoint","codePoint","String","fromCodePoint","floor","reverse","parseLocation","_location$split","split","_location$split2","slicedToArray","col","row","charCodeAt","isNumber","numStr","isPeriodsAndDigits","Boolean","match","periodCount","debounce","time","timeout","setTimeout","clearTimeout","TokenSanitizer","tokens","_this","map","token","t","NUMBER","number","CELL","cell","FUNCTION","function","STRING","string","parseFloat","UNKNOWN","getCellLabel","getFunction","slice","toUpperCase","fnName","fnNode","formulaFuncs","LexerRule","regex","groupIndex","lastIndex","input","exec","TOKENS","EOF","EQUALS","COMMA","COLON","LPAREN","RPAREN","PLUS","MINUS","MULT","DIV","TEXT","GRAMMAR","Lexer","char","initChar","markers","nextToken","sanitizer","sanitize","isFormula","tokenTEXTorNUMBER","whitespaceLen","getWhitespaceLen","_GRAMMAR","rule","setIndex","test","consume","tokenUNKNOWN","chars","isEOF","isSeparator","isWhitespace","count","AST","_name","TextNode","textNode","possibleConstructorReturn","getPrototypeOf","call","node","StringNode","_this2","NumberNode","_this3","CellNode","_this4","CellRange","leftCell","rightCell","_this5","UnaryOp","opNode","expr","_this6","evaluatedExpr","FuncOp","funcNode","argNodes","_this7","evaluatedArgs","BinaryOp","leftNode","rightNode","_this8","left","right","Parser","ast","peekType","equals","operator","term","includes","factor","enclosedExpr","unaryOp","func","lparen","rparen","isCellRange","_this$invertCellRange","invertCellRange","_this$invertCellRange2","temp","list","listNode","cellRange","DQUOTE","stepsAhead","Interpreter","error","cache","lexer","parser","vertex","graph","addVertex","getTokens","parse","recalculate","errorResponse","getVertex","visitNode","nodeName","constructor","eval","getCellResult","_parseLocation","_parseLocation2","leftColIndex","leftRowIndex","_parseLocation3","_parseLocation4","rightColIndex","rightRowIndex","colIndexStart","colIndexEnd","rowIndexStart","rowIndexEnd","rowI","colI","otherLocation","isLocationValid","visitCell","childNode","_parseLocation5","_parseLocation6","colIndex","rowIndex","errorMsg","message","Vertex","Graph","adj","pending","visited","setPendingNodes","dfs","updateStore","Set","add","size","visitAST","delete","hasVertex","testPathCycle","has","locationKeys","locations","_Object$entries","entries","clearCell","testMissingLocation","delVertex","InputContext","React","createContext","KeyboardActions","component","c","disabledKeys","keyEvent","key","resetInputterValueEvent","isFuncSelectorVisible","cellValueSetter","run","refInput","current","selectionEnd","KeyboardFocuser","elementId","funcSelectorElId","defaultElId","focusElement","defaultEnter","nextRowIndex","endLocation","id","el","document","querySelector","activeElement","focus","CellValueSetter","cellValue","inputValue","sanitizeValue","setCellData","Input","InputTag","fwdRef","onChange","onKeyDown","core_browser_esm","assign","ref","defaultProps","Pre","Subtitle","P","Hr","FuncDescription","currScope","_this$props","fnScopes","scope","startIndex","endIndex","getFnScope","inputRect","context","getFnNode","FuncDescription_Root","bottom","FuncDescription_ref","PureComponent","contextType","Li","DropdownItem","item","isActive","onMouseEnter","tabIndex","Ul","InteractiveList","items","InteractiveListItem","li","ul","renderListItems","propsTypes","PropTypes","array","isRequired","shape","object","baseItemStyle","ItemBaseRoot","ItemActiveRoot","FuncSelector","listItems","itemIndex","isVisible","handleOnClick","bind","assertThisInitialized","setState","setListItems","nextProps","nextState","prevProps","prevState","updateContextData","updateListItems","keyActions","setIsFuncSelectorVisible","keyEventSetIndex","currInputValue","rightChunkIndex","leftChunk","rightChunk","filter","startsWith","sort","itemBase","itemActive","FuncSelector_Pre","FuncSelector_Subtitle","marginTop","boxShadow","event","nativeEvent","stopPropagation","_this$state","FuncSelector_Root","open","onClick","library_InteractiveList","getListStyles","Component","withTheme","Suggestions","setFnScopes","stack","pop","b","getCurrTokenIndex","_this$getCompareToken","getCompareTokens","_this$getCompareToken2","tokenBefore","tokenCurr","tokenAfter","option1","option2","Inputter_FuncSelector","renderedFuncSelector","getFuncSelector","Inputter_FuncDescription","NoOp","Inputter","_React$PureComponent","createRef","handleOnChange","handleOnKeyDown","keyboardActions","keyboardFocuser","setInputWidth","inherits","createClass","onMount","focusInputTag","tokenizeInputValue","inputEl","selectionStart","preventDefault","Inputter_Suggestions","getBoundingClientRect","Provider","Inputter_InputTag","renderSuggestions","onUnmount","mapDispatchToProps","interpret","connect","_state$global","_state$global$activeC","MIN_COL_WIDTH","MAX_COL_WIDTH","MIN_ROW_HEIGHT","MAX_ROW_HEIGHT","ROW_HEADER_WIDTH","BtnHeight","RowHeader","pageY","btnBottom","isResizing","refRoot","debSetRowHeight","delta","handleBtnHeightOnMouseDown","handleDocumentMouseMove","handleDocumentMouseUp","minHeight","setRowHeight","removeEventListener","addEventListener","RowHeader_Root","data-row","className","getRootStyle","getBtnHeightStyle","onMouseDown","onMouseMove","handleBtnHeightOnMouseMove","onMouseUp","handleBtnHeightOnMouseUp","ownProps","Fx","FormulaBar","handleOnFocus","handleOnBlur","scheduleFloatingInputter","contains","relatedTarget","components_Inputter_Inputter","FormulaBar_Root","onFocus","onBlur","renderInputter","mapDispatchtoProps","FloatingInputter_inputTagProps","BaseInput","InputSizer","textWidth","scrollWidth","ceil","InputSizer_Input","readOnly","INIT_KEY_EVENT","FloatingInputter","handleInputterOnMount","setFloatingInputterInteractive","_this$props$cellRect","top","FloatingInputter_Root","css_browser_esm","FloatingInputter_InputSizer","isInputterOpen","_state$global$floatin","BtnWidth","ColHeader","pageX","btnRight","debSetColWidth","handleBtnWidthOnMouseDown","setColWidth","ColHeader_Root","data-col","getBtnWidthStyle","handleBtnWidthOnMouseMove","handleBtnWidthOnMouseUp","Row","InnerBorder","ColHeaderRow","colLabels","fill","_","i","cell_ColHeader","Datum","onDoubleClick","Datum_Root","data-cell","data-location","whiteSpace","textOverflow","overflow","getStyle","Result","handleOnDoubleClick","refDatum","unscheduleFloatingInputter","openFloatingInputter","willReplaceValue","datumRect","JSON","stringify","ResultCell_Datum","OutterBorder","children","OutterBorder_Root","_ownProps$location$sp","_ownProps$location$sp2","ResultCell","focusDatum","ResultCell_OutterBorder","ResultCell_Result","DataRow","rowNumber","DataRow_Row","cell_RowHeader","components_ResultCell_ResultCell","initial","wasFocused","states","idle","on","MOVE_FOCUS","actions","focusTarget","invoke","src","ctx","onDone","setNewContext","calcTargetLocation","getTargetLocation","getKeyboardNavMachine","newContext","Machine","Grid","Table","keyboardNavMachine","focusService","refGrid","start","focusA_1","stop","dataset","moveFocus","send","table_ColHeaderRow","table_DataRow","renderColHeaderRow","renderDataRows","data-table","renderRows","mapDisptachToProps","Wrapper","Title","Instructions","Instructions_Root","Instructions_Ul","Instructions_Li","Container","Main","App","components_FloatingInputter_FloatingInputter","data-dummy-focus-stop","header_Header","components_FormulaBar_FormulaBar","table_Table","Instructions_Instructions","es","react_router_dom","emotion_theming_browser_esm","src_App","window","hostname","ReactDOM","render","src_Root","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"gOA0BeA,cAxBc,CAC3BC,WAAY,CACVC,QAAS,GACTC,SAAU,IAEZC,SAAU,CACRC,WAAY,CACVC,MAAO,GACPC,UAAW,IAGfC,0BAA2B,CACzBC,UAAU,EACVC,eAAe,GAEjBC,iBAAkB,CAChBC,SAAU,GACVC,QAAQ,EACRH,eAAe,GAEjBI,KAAM,GACNC,QAAS,IAGiC,CAC1CC,qBAAwB,SAACC,EAADC,GAAwB,IAAdC,EAAcD,EAAdC,QAChCF,EAAMH,KAAOK,EAAQL,KACrBG,EAAMF,QAAUI,EAAQJ,SAG1BK,gBAAmB,SAACH,EAADI,GAAwB,IAAdF,EAAcE,EAAdF,QAC3BF,EAAMhB,WAAakB,GAGrBG,2BAA8B,SAACL,EAADM,GAAwB,IAC5Cb,EAD4Ca,EAAdJ,QAC9BT,cAERO,EAAMT,0BAA4B,CAChCC,UAAU,EACVC,kBAIJc,6BAAgC,SAACP,GAC/BA,EAAMT,0BAA4B,CAChCC,UAAU,EACVC,eAAe,IAInBe,uBAA0B,SAACR,EAADS,GAAwB,IAAdP,EAAcO,EAAdP,QAClCF,EAAMN,iBAANgB,OAAAC,EAAA,EAAAD,CAAA,GAA8BV,EAAMN,iBAAqBQ,IAG3DU,kCAAqC,SAACZ,EAADa,GAAwB,IAAdX,EAAcW,EAAdX,QAC7CF,EAAMN,iBAANgB,OAAAC,EAAA,EAAAD,CAAA,GAA8BV,EAAMN,iBAApC,CAAsDD,cAAeS,KAGvEY,wBAA2B,SAACd,GAC1BA,EAAMN,iBAAiBE,QAAS,GAGlCmB,yBAA4B,SAACf,EAADgB,GAAwB,IAAdd,EAAcc,EAAdd,QACpCF,EAAMb,SAASC,WAAac,GAG9Be,wBAA2B,SAACjB,EAADkB,GAAwB,IAAdhB,EAAcgB,EAAdhB,QACnCF,EAAMN,iBAANgB,OAAAC,EAAA,EAAAD,CAAA,GAA8BV,EAAMN,iBAAqBQ,MChE9CnB,cAFO,GAEsB,CAC1CoC,cAAiB,SAACnB,EAADC,GAAwB,IAAdC,EAAcD,EAAdC,QACjBhB,EAAmBgB,EAAnBhB,SAAUkC,EAASlB,EAATkB,KAClBpB,EAAMd,GAAYkC,GAGpBC,iBAAoB,SAACrB,EAADI,UACXJ,EADmCI,EAAdF,oBCJjBnB,cALO,CACpBuC,UAAW,GACXC,WAAY,IAG8B,CAE1CC,cAAiB,SAACxB,EAADC,GAAwB,IAAdC,EAAcD,EAAdC,QACjBuB,EAAoBvB,EAApBuB,SAAUC,EAAUxB,EAAVwB,MACVJ,EAActB,EAAdsB,UACRtB,EAAMsB,UAANZ,OAAAC,EAAA,EAAAD,CAAA,GAAuBY,EAAvBZ,OAAAiB,EAAA,EAAAjB,CAAA,GAAmCe,EAAWC,KAGhDE,eAAkB,SAAC5B,EAADI,GAAwB,IAAdF,EAAcE,EAAdF,QAClB2B,EAAqB3B,EAArB2B,SAAUC,EAAW5B,EAAX4B,OACVP,EAAevB,EAAfuB,WACRvB,EAAMuB,WAANb,OAAAC,EAAA,EAAAD,CAAA,GAAwBa,EAAxBb,OAAAiB,EAAA,EAAAjB,CAAA,GAAqCmB,EAAWC,OCErCC,EAZbC,YAAe,CACbC,QAAS,CACPC,OAAQC,EACRC,UAAWC,EACXC,UAAWC,KCSXC,EAAS,CACbC,GAAI,EACJC,GAAI,IACJC,GAAI,IACJC,GAAI,MAGAC,EAAY,CAChBJ,GAAI,KACJC,GAAI,KACJC,GAAI,MAGAG,EAAU,CACdL,GAAE,sBAAAM,OAAwBP,EAAOE,GAAK,EAApC,OACFA,GAAE,sBAAAK,OAAwBP,EAAOE,GAA/B,wBAAAK,OAAwDP,EAAOG,GAAK,EAApE,OACFA,GAAE,sBAAAI,OAAwBP,EAAOG,GAA/B,wBAAAI,OAAwDP,EAAOI,GAAK,EAApE,OACFA,GAAE,sBAAAG,OAAwBP,EAAOI,GAA/B,OACFI,KAAM,SAACC,GAAD,4BAAAF,OAAuCP,EAAOS,GAA9C,QACNC,KAAM,SAACD,GAAD,4BAAAF,OAAuCP,EAAQK,EAAUI,IAAgB,EAAzE,SASOE,EAND,CACZC,OA5Ca,CACbC,KAAM,UACNC,MAAO,CACLC,OAAQ,UACRC,WAAY,OACZC,SAAU,WAEZC,SAAU,CACRC,OAAQ,UACRC,OAAQ,WAEVC,QAAS,CACPC,OAAQ,UACRC,MAAO,UAETC,MAAO,CACLC,WAAY,WAEdC,OAAQ,WA2BR1B,SACAM,WCZaqB,EA5BMC,YAAH,cAELjB,EAAMC,OAAOC,KAFR,kOCFZgB,EAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,UAAA6D,OAAA,aAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,0FAgBKC,MARf,WACE,OACEC,EAAAC,EAAAC,cAACR,EAAD,KACEM,EAAAC,EAAAC,cAAA,2ECFC,SAASC,EAAsBzF,EAAOC,GAC3C,MAAO,CACLyF,KAAM,2BACN7E,QAAS,CACPb,QACAC,eAAyB0F,IAAd1F,EACPD,EAAM4F,OACN3F,IAKH,SAAS4F,EAAchG,GAC5B,OAAO,SAACiG,EAAUC,GAChB,IACMnG,GADWmG,IAAWhD,UAAUlD,IACT,IAAID,SAAW,GAI5C,OAFAkG,EAASL,EAAsB7F,EAASA,EAAQgG,SAEzCI,QAAQC,QACbH,EAAS,CACPJ,KAAM,kBACN7E,QAAS,CACPjB,UACAC,gBAuEH,IAAMqG,EAAwBC,YAAa,uHC3FnCC,EAAA,CAAEC,MAXH,kBAAAC,GAWUC,MAJV,CACZC,gBAAiB,wBCoBJC,aA7Bb,SAAAA,IAA4B,IAAhBC,EAAgBC,UAAAf,OAAA,QAAAD,IAAAgB,UAAA,GAAAA,UAAA,GAAVjE,EAAUrB,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAJ,GAAA,IACVK,EAAgBJ,EAAMX,WAA9BlD,OACRgE,KAAKH,MAAQA,EACbG,KAAKrG,KAAOsG,EAAYtG,KACxBqG,KAAKpG,QAAUqG,EAAYrG,kEAWfZ,GACZ,IAAMkC,EAAO8E,KAAK9D,UAAUlD,GAC5B,OAAOkC,GAAQA,EAAKgF,+CAGNlH,EAAUD,EAASmH,GACjCF,KAAKH,MAAMZ,SCXR,SAAyBjG,EAAUD,EAASmH,GACjD,MAAO,CACLrB,KAAM,gBACN7E,QAAS,CAAEhB,WAAUkC,KAAM,CAAEnC,UAASmH,YDQlBC,CAAgBnH,EAAUD,EAASmH,sCAG/ClH,GACRgH,KAAKH,MAAMZ,SAASmB,GAAcpH,sCAjBlC,OAAOgH,KAAKH,MAAMX,WAAWhD,4CAI7B,OAAO1B,OAAO6F,KAAKL,KAAK9D,oBELboE,EAXb,SAAAA,EAAYzB,EAAM1B,EAAMoD,EAAYC,EAAUC,GAAQjG,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAM,GACpDN,KAAKnB,KAAOA,EACZmB,KAAKQ,SAAWA,EAChBR,KAAK7C,KAAOA,EACZ6C,KAAKO,WAAaA,EAClBP,KAAKS,MAAQA,EACbT,KAAK7G,MAAQ,KACb6G,KAAKU,KAAO,MCRhB,SAASC,EAAmBC,GAC1BA,EAAKC,QAAQ,SAAAC,GACX,GAAmB,kBAARA,EACT,MAAM,IAAIC,UAAJ,mCAAAlE,OAAiDiE,MAK7D,IAAME,EAAK,CACTC,QAAS,CACPC,GAAI,WAAa,IAAAC,EAAAC,EACf,GAAoB,IAAhBtB,UAAKf,OACP,MAAM,IAAIsC,MAAM,kBAGlB,OAAOF,EAAAH,EAAGM,KAAIJ,GAAPK,MAAAJ,EAAArB,YAAqBsB,EAAAJ,EAAGQ,OAAMN,GAATK,MAAAH,EAAAtB,YAE9B2B,WAAY,+BACZC,QAAS,oBACTC,QAAS,iDAGXC,OAAQ,CACNV,GAAI,WAAa,IACf,IAAIhB,EAAS,GADE2B,EAAA/B,UAAAf,OAAT6B,EAAS,IAAAkB,MAAAD,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAATnB,EAASmB,GAAAjC,UAAAiC,GAGf,GAAoB,IAAhBnB,EAAK7B,OACP,MAAM,IAAIsC,MAAM,kBAGlB,QAAAW,EAAA,EAAAC,EAAgBrB,EAAhBoB,EAAAC,EAAAlD,OAAAiD,IAAsB,CAAjB,IAAIlB,EAAGmB,EAAAD,GACV,GAAmB,kBAARlB,EACT,MAAM,IAAIO,MAAJ,4BAAAxE,OAAsCiE,IAG9CZ,EAAOgC,KAAKpB,GAGd,OAAOZ,EAAOiC,KAAK,KAErBV,WAAY,gCACZC,QAAS,uBACTC,QAAS,kEAGXH,MAAO,CACLN,GAAI,kBAAapB,UAAKf,QACtB0C,WAAY,iCACZC,QAAS,sBACTC,QAAS,sDAGXS,IAAK,CACHlB,GAAI,WAAa,QAAAmB,EAAAvC,UAAAf,OAAT6B,EAAS,IAAAkB,MAAAO,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAT1B,EAAS0B,GAAAxC,UAAAwC,GACf,GAAoB,IAAhB1B,EAAK7B,OACP,MAAM,IAAIsC,MAAM,kBAIlB,OADAV,EAAmBC,GACZ2B,KAAKC,IAALjB,MAAAgB,KAAY3B,IAErBa,WAAY,2BACZC,QAAS,oBACTC,QAAS,sDAGXc,IAAK,CACHvB,GAAI,WAAa,QAAAwB,EAAA5C,UAAAf,OAAT6B,EAAS,IAAAkB,MAAAY,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAT/B,EAAS+B,GAAA7C,UAAA6C,GACf,GAAoB,IAAhB/B,EAAK7B,OACP,MAAM,IAAIsC,MAAM,kBAIlB,OADAV,EAAmBC,GACZ2B,KAAKK,IAALrB,MAAAgB,KAAY3B,IAErBa,WAAY,2BACZC,QAAS,oBACTC,QAAS,uDAGXkB,MAAO,CACL3B,GAAI,WAAa,QAAA4B,EAAAhD,UAAAf,OAAT6B,EAAS,IAAAkB,MAAAgB,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAATnC,EAASmC,GAAAjD,UAAAiD,GACf,GAAoB,IAAhBnC,EAAK7B,OACP,MAAM,IAAIsC,MAAM,mCAGlBV,EAAmBC,GALJ,IAMRoC,EAAapC,EANL,GAMFqC,EAAOrC,EANL,GAOf,OAAO2B,KAAKW,IAAIF,EAAMC,IAExBxB,WAAY,wBACZC,QAAS,cACTC,QAAS,2CAGXwB,KAAM,CACJjC,GAAI,WAAa,QAAAkC,EAAAtD,UAAAf,OAAT6B,EAAS,IAAAkB,MAAAsB,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAATzC,EAASyC,GAAAvD,UAAAuD,GACf,GAAoB,IAAhBzC,EAAK7B,OACP,MAAM,IAAIsC,MAAJ,kCAIR,OADAV,EAAmBC,GACZ2B,KAAKe,KAAK1C,EAAK,KAExBa,WAAY,cACZC,QAAS,sBACTC,QAAS,wCAGXL,IAAK,CACHJ,GAAI,WAAa,QAAAqC,EAAAzD,UAAAf,OAAT6B,EAAS,IAAAkB,MAAAyB,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAT5C,EAAS4C,GAAA1D,UAAA0D,GACf,GAAoB,IAAhB5C,EAAK7B,OACP,MAAM,IAAIsC,MAAM,kBAIlB,OADAV,EAAmBC,GACZA,EAAK6C,OAAO,SAACC,EAAMC,GAAP,OAAiBA,EAAOD,GAAO,IAEpDjC,WAAY,2BACZC,QAAS,oBACTC,QAAS,6CAKbX,EAAG4C,IAAHpJ,OAAAC,EAAA,EAAAD,CAAA,GACKwG,EAAGC,QADR,CAEEQ,WAAY,2BACZC,QAAS,kBAGXV,EAAG6C,IAAHrJ,OAAAC,EAAA,EAAAD,CAAA,GACKwG,EAAG6B,MADR,CAEEpB,WAAY,sBACZC,QAAS,cAGIV,QCzIT8C,EAAkB,IAAIC,YAAY,GAOjC,SAASC,EAAM7K,EAAOyJ,EAAKJ,GAChC,OAAOD,KAAKK,IAAKL,KAAKC,IAAIrJ,EAAOyJ,GAAMJ,GAelC,SAASyB,EAAeC,GAM7B,IALA,IACIC,EAAQ,GACRC,EAAY,CAAC,IACbC,EAAaH,EAEVG,EAAa,GAAG,CACrB,IAAMC,EAAW,GAEjBC,EACA,QAAAvC,EAAA,EAAAwC,EAAoBJ,EAApBpC,EAAAwC,EAAAzF,OAAAiD,IAA+B,CAA1B,IAAIyC,EAAOD,EAAAxC,GAAe0C,GAAA,EAAAC,GAAA,EAAAC,OAAA9F,EAAA,IAC7B,QAAA+F,EAAAC,EAVa,6BAUbC,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAA6B,KAApBS,EAAoBN,EAAA1L,MAC3B,GAAmB,IAAfkL,EAAqB,MAAME,EAC/BD,EAASpC,KAAT,GAAArF,OAAiB4H,GAAjB5H,OAA2BsI,IAC3Bd,GAAc,GAJa,MAAAe,GAAAT,GAAA,EAAAC,EAAAQ,EAAA,YAAAV,GAAA,MAAAI,EAAAO,QAAAP,EAAAO,SAAA,WAAAV,EAAA,MAAAC,IAQ/BR,EAAYE,EACZH,EAAK,GAAAtH,OAAArC,OAAA8K,EAAA,EAAA9K,CAAO2J,GAAUG,GAGxB,OAAOH,EAyBF,SAASoB,EAAeC,GAC7B,IAAMC,EAAQ,GACRC,EAAY5B,EACdH,EAAO6B,EAAM,EAEjB,EAAG,CAED,IACMG,EAAYD,GAFlB/B,GAAQ,GACsB,GAExBwB,EAASS,OAAOC,cAAcF,GACpCF,EAAMvD,KAAKiD,GAEXxB,EAAOpB,KAAKuD,MAAMnC,EAAO,UAClBA,EAAO,GAEhB,OAAO8B,EAAMM,UAAU5D,KAAK,IAGvB,SAAS6D,EAAchN,GAAU,IAAAiN,EACrBjN,EAASkN,MAAM,KADMC,EAAA3L,OAAA4L,EAAA,EAAA5L,CAAAyL,EAAA,GACjCI,EADiCF,EAAA,GAC5BG,EAD4BH,EAAA,GAKtC,MAAO,CAH4BE,EA5BVH,MAAM,IACPzC,OAAO,SAACC,EAAMyB,GAAP,OACtB,GAAPzB,EAAYyB,EAAOoB,WAAW,GAAKzC,EAAkB,GACpD,GAEc,GAwBCwC,EAAM,GAKnB,SAASE,EAASC,GACvB,IAAMC,EAAqBC,QAAQF,EAAOG,MAAM,aAC1CC,GAAeJ,EAAOG,MAAM,QAAU,IAAI7H,OAEhD,QAAK2H,MACDG,EAAc,KACI,IAAlBJ,EAAO1H,QAA8B,MAAd0H,EAAO,KAI7B,SAASK,EAASC,EAAM7F,GAC7B,IAAI8F,EAEJ,OAAO,WACDA,IAEJ9F,EAAEK,WAAF,EAAAzB,WAEAkH,EAAUC,WAAW,WACnBC,aAAaF,GACbA,EAAU,MACTD,SC3CQI,aApEb,SAAAA,EAAYC,GAAS5M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAmH,GACnBnH,KAAKoH,OAASA,yDAGL,IAAAC,EAAArH,KACT,OAAOA,KAAKoH,OAAOE,IAAI,SAAAC,GACrB,OAAOA,EAAM1I,MACX,KAAK2I,EAAEC,OACL,OAAOJ,EAAKK,OAAOH,GACrB,KAAKC,EAAEG,KACL,OAAON,EAAKO,KAAKL,GACnB,KAAKC,EAAEK,SACL,OAAOR,EAAKS,SAASP,GACvB,KAAKC,EAAEO,OACL,OAAOV,EAAKW,OAAOT,GACrB,QACE,OAAOA,oCAKRA,GACL,OAAKf,EAASe,EAAMpK,OAKpBoK,EAAMpO,MAAQ8O,WAAWV,EAAMpK,MACxBoK,IALLA,EAAM1I,KAAO2I,EAAEU,QACRX,gCAONA,GAEH,OADAA,EAAMpO,MAAQ6G,KAAKmI,aAAaZ,GACzBA,mCAGAA,GACP,IAAMrG,EAAKlB,KAAKoI,YAAYb,GAQ5B,OANIrG,EACFqG,EAAMpO,MAAQ+H,EAEdqG,EAAM1I,KAAO2I,EAAEU,QAGVX,iCAGFA,GAEL,OADAA,EAAMpO,MAAQoO,EAAMpK,KAAKkL,MAAM,GAAI,GAC5Bd,uCAGIA,GAAO,IACVpK,EAASoK,EAATpK,KACAsD,EAAUtD,EAAKyJ,MAAM,OAArBnG,MACF4F,EAAMlJ,EAAKkL,MAAM,EAAG5H,GAAO6H,cAC3BhC,EAAMnJ,EAAKkL,MAAM5H,GACvB,SAAA5D,OAAUwJ,EAAV,KAAAxJ,OAAiByJ,uCAGPiB,GACV,IAAMgB,EAAShB,EAAMpK,KAAKmL,cACpBE,EAASC,EAAaF,GAC5B,OAAOC,GAAUA,EAAOtH,YCrDbwH,aAhBb,SAAAA,EAAYC,EAAOC,EAAYrB,EAAO/G,GAAWhG,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA0I,GAC/C1I,KAAK2I,MAAQA,EACb3I,KAAK4I,WAAaA,EAClB5I,KAAKuH,MAAQA,EACbvH,KAAKQ,SAAWA,uDAGTC,GACPT,KAAK2I,MAAME,UAAYpI,+BAGpBqI,GACH,OAAO9I,KAAK2I,MAAMI,KAAKD,YCPrBE,EAAS,CAEbC,IAAK,MAELC,OAAQ,SACRC,MAAO,QACPC,MAAO,QACPC,OAAQ,SACRC,OAAQ,SAERC,KAAM,OACNC,MAAO,QACPC,KAAM,OACNC,IAAK,MAELC,KAAM,OACNhC,KAAM,OACNI,OAAQ,SACRN,OAAQ,SACRI,SAAU,WACVK,QAAS,WAGLV,GAAIwB,EAEJY,GAAU,CAEd,IAAIlB,EAAU,KAAM,EAAGlB,GAAE0B,OAAQ,aACjC,IAAIR,EAAU,KAAM,EAAGlB,GAAE2B,MAAO,aAChC,IAAIT,EAAU,KAAM,EAAGlB,GAAE4B,MAAO,aAChC,IAAIV,EAAU,MAAO,EAAGlB,GAAE6B,OAAQ,aAClC,IAAIX,EAAU,MAAO,EAAGlB,GAAE8B,OAAQ,aAElC,IAAIZ,EAAU,MAAO,EAAGlB,GAAE+B,KAAM,YAChC,IAAIb,EAAU,MAAO,EAAGlB,GAAEgC,MAAO,YACjC,IAAId,EAAU,MAAO,EAAGlB,GAAEiC,KAAM,YAChC,IAAIf,EAAU,MAAO,EAAGlB,GAAEkC,IAAK,YAE/B,IAAIhB,EAAU,aAAc,EAAGlB,GAAEO,OAAQ,UACzC,IAAIW,EAAU,WAAY,EAAGlB,GAAEC,OAAQ,UACvC,IAAIiB,EAAU,gBAAiB,EAAGlB,GAAEG,KAAM,UAC1C,IAAIe,EAAU,eAAgB,EAAGlB,GAAEK,SAAU,WAIzCgC,cACJ,SAAAA,EAAYf,GAAQtO,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA6J,GAClB7J,KAAK8I,MAAQA,EACb9I,KAAKS,MAAQ,EACbT,KAAK8J,KAAO9J,KAAK+J,SAASjB,GAC1B9I,KAAKgK,QAAU,GACfhK,KAAKoH,OAAS,2DAId,KAAOpH,KAAK8J,OAAStC,GAAEyB,KAAK,CAC1B,IAAM1B,EAAQvH,KAAKiK,YACnBjK,KAAKoH,OAAOlF,KAAKqF,GAGnB,IAAM2C,EAAY,IAAI/C,EAAenH,KAAKoH,QAE1C,OADApH,KAAKoH,OAAS8C,EAAUC,WACjBnK,KAAKoH,2CAIZ,GAAIpH,KAAK8J,OAAStC,GAAEyB,IAClB,OAAO,IAAI3I,EAAMkH,GAAEyB,IAAKzB,GAAEyB,IAAK,EAAG,MAAOjJ,KAAKS,OAGhD,IAAKT,KAAKoK,YACR,OAAOpK,KAAKqK,oBAMd,IAHA,IACI9C,EADE+C,EAAgBtK,KAAKuK,mBAG3BvI,EAAA,EAAAwI,EAAiBZ,GAAjB5H,EAAAwI,EAAAzL,OAAAiD,IAA0B,CAArB,IAAIyI,EAAID,EAAAxI,GACXyI,EAAKC,SAAS1K,KAAKS,OACnB,IAAMmG,EAAQ6D,EAAKE,KAAK3K,KAAK8I,OAE7B,GAAIlC,GAASA,EAAMnG,QAAUT,KAAKS,MAAO,CACvC,IAAMtD,EAAOyJ,EAAM6D,EAAK7B,YACxBrB,EAAQ,IAAIjH,EAAMmK,EAAKlD,MAAOpK,EAAMmN,EAAeG,EAAKjK,SAAUR,KAAKS,OACvET,KAAKS,OAAStD,EAAK4B,OAAS,EAC5BiB,KAAK4K,UACL,OAQJ,OAJKrD,IACHA,EAAQvH,KAAK6K,aAAaP,IAGrB/C,mCAGAuB,GAMP,OAL0B,IAAtB9I,KAAK8I,MAAM/J,SACbiB,KAAK8I,MAAQ,IACb9I,KAAKS,OAAS,GAGTqI,EAAM9I,KAAKS,4CAGPF,GAGX,IAFA,IAAMuK,EAAQ,KAEL9K,KAAK+K,SAAW/K,KAAKgL,eAAiBhL,KAAKiL,iBAClDH,EAAM5I,KAAKlC,KAAK8J,MAChB9J,KAAK4K,UAGP,IAAMzN,EAAO2N,EAAM3I,KAAK,IACxB,OAAO,IAAI7B,EAAMkH,GAAEU,QAAS/K,EAAMoD,EAAY,SAAUP,KAAKS,MAAQtD,EAAK4B,oDAI1E,IAAIwI,EAUJ,OAPEA,EADEf,EAASxG,KAAK8I,OACR,IAAIxI,EAAMkH,GAAEC,OAAQzH,KAAK8I,MAAO,EAAG,SAAU9I,KAAKS,OAElD,IAAIH,EAAMkH,GAAEmC,KAAM3J,KAAK8I,MAAO,EAAG,SAAU9I,KAAKS,OAG1DT,KAAKS,MAAQT,KAAK8I,MAAM/J,OAAS,EACjCiB,KAAK4K,UACErD,oCAIPvH,KAAKS,QAEDT,KAAKS,MAAQT,KAAK8I,MAAM/J,OAC1BiB,KAAK8J,KAAO9J,KAAK8I,MAAM9I,KAAKS,OAE5BT,KAAK8J,KAAOtC,GAAEyB,wCAKhB,MAAyB,MAAlBjJ,KAAK8I,MAAM,mCAIlB,OAAO9I,KAAK8J,OAAStC,GAAEyB,2CAIvB,OAAQjJ,KAAK+K,SAAWpE,QAAQ3G,KAAK8J,KAAKlD,MAAM,6CAIhD,OAAOD,QAAQ3G,KAAK8J,KAAKlD,MAAM,8DAM/B,IAFA,IAAIsE,EAAQ,EAELlL,KAAKiL,gBACVC,IACAlL,KAAK4K,UAGP,OAAOM,WAIIrB,MC7KTsB,cACJ,SAAAA,EAAY7M,GAAO9D,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAmL,GACjBnL,KAAKoL,MAAQ9M,qDAIb,MAAM,IAAI+C,MAAM,8BAIdgK,eACJ,SAAAA,EAAYC,GAAU,IAAAjE,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAqL,IACpBhE,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAA6Q,GAAAI,KAAAzL,KAAM,cACD0L,KAAOJ,EAFQjE,sEAMpB,OAAOrH,KAAK0L,KAAKvO,YAPEgO,IAWjBQ,eACJ,SAAAA,EAAYD,GAAM,IAAAE,EAAA,OAAApR,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA2L,IAChBC,EAAApR,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAmR,GAAAF,KAAAzL,KAAM,gBACD0L,KAAOA,EAFIE,sEAMhB,OAAO5L,KAAK0L,KAAKvS,aAPIgS,IAWnBU,eACJ,SAAAA,EAAYH,GAAM,IAAAI,EAAA,OAAAtR,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA6L,IAChBC,EAAAtR,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAqR,GAAAJ,KAAAzL,KAAM,gBACD0L,KAAOA,EAFII,sEAMhB,OAAO9L,KAAK0L,KAAKvS,aAPIgS,IAWnBY,eACJ,SAAAA,EAAYxE,GAAO,IAAAyE,EAAA,OAAAxR,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA+L,IACjBC,EAAAxR,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAuR,GAAAN,KAAAzL,KAAM,cACD4H,KAAOL,EAFKyE,wEAMjB,OAAOhM,KAAK4H,KAAKzO,aAPEgS,IAWjBc,eACJ,SAAAA,EAAYC,EAAUC,GAAW,IAAAC,EAAA,OAAA5R,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAiM,IAC/BG,EAAA5R,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAyR,GAAAR,KAAAzL,KAAM,eACDkM,SAAWA,EAChBE,EAAKD,UAAYA,EAHcC,6BADXjB,IAQlBkB,eACJ,SAAAA,EAAYC,EAAQC,GAAM,IAAAC,EAAA,OAAAhS,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAqM,IACxBG,EAAAhS,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAA6R,GAAAZ,KAAAzL,KAAM,aACDsM,OAASA,EACdE,EAAKD,KAAOA,EAHYC,oEAMrBC,GACH,OAAIzM,KAAKsM,OAAOzN,OAAS2I,EAAE+B,KAClBkD,EACEzM,KAAKsM,OAAOzN,OAAS2I,EAAEgC,OACxBiD,OADH,SAVWtB,IAgBhBuB,eACJ,SAAAA,EAAYC,EAAUC,GAAU,IAAAC,EAAA,OAAArS,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA0M,IAC9BG,EAAArS,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAkS,GAAAjB,KAAAzL,KAAM,YACD2M,SAAWA,EAChBE,EAAKD,SAAWA,EAHcC,oEAM3BC,GAEH,OADW9M,KAAK2M,SAASxT,MAChBoI,WAAF,EAAA/G,OAAA8K,EAAA,EAAA9K,CAAMsS,WATI3B,IAaf4B,eACJ,SAAAA,EAAYC,EAAUV,EAAQW,GAAW,IAAAC,EAAA,OAAA1S,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA+M,IACvCG,EAAA1S,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAuS,GAAAtB,KAAAzL,KAAM,cACDgN,SAAWA,EAChBE,EAAKZ,OAASA,EACdY,EAAKD,UAAYA,EAJsBC,oEAOpCC,EAAMC,GACT,OAAOpN,KAAKsM,OAAOzN,MACjB,KAAK2I,EAAE+B,KACL,OAAO4D,EAAOC,EAChB,KAAK5F,EAAEgC,MACL,OAAO2D,EAAOC,EAChB,KAAK5F,EAAEkC,IACL,GAAc,IAAV0D,EACF,MAAM,IAAI/L,MAAJ,qBAAAxE,OAA+BsQ,EAA/B,KAAAtQ,OAAuCuQ,IAE7C,OAAOD,EAAOC,EAElB,KAAK5F,EAAEiC,KACL,OAAO0D,EAAOC,EAChB,QACE,MAAM,IAAI/L,MAAJ,yBAAAxE,OAAmCmD,KAAKuH,MAAMpK,KAA9C,cAvBSgO,ICyMRkC,cAzRb,SAAAA,EAAYjG,GAAS5M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAqN,GACnBrN,KAAKS,MAAQ,EACbT,KAAKoH,OAASA,EACdpH,KAAK2D,KAAO3D,KAAKoH,OAAO,GACxBpH,KAAKsN,IAAM,yDAIX,OAAQtN,KAAKuN,YACX,KAAK/F,EAAEmC,KACL3J,KAAKsN,IAAMtN,KAAK7C,OAChB,MACF,KAAKqK,EAAEC,OACLzH,KAAKsN,IAAMtN,KAAK0H,SAChB,MACF,QACE1H,KAAKwN,SACLxN,KAAKsN,IAAMtN,KAAKuM,OAIpB,GAAkB,OAAdvM,KAAK2D,KACP,MAAM,IAAItC,MAAJ,4BAAAxE,OAAsCmD,KAAKS,MAA3C,OAAA5D,OAAsDmD,KAAK2D,KAAKxG,KAAhE,MAGR,OAAO6C,KAAKsN,mCAKZ,IAAI5B,EAAM+B,EAAUL,EAIpB,IAFA1B,EAAO1L,KAAK0N,OAEJ,CAAClG,EAAE+B,KAAM/B,EAAEgC,OAAOmE,SAAS3N,KAAKuN,aACtCE,EAAWzN,KAAKyN,WAChBL,EAAQpN,KAAK0N,OACbhC,EAAO,IAAIqB,GAASrB,EAAM+B,EAAUL,GAGtC,OAAO1B,iCAKP,IAAIA,EAAM+B,EAAUL,EAIpB,IAFA1B,EAAO1L,KAAK4N,SAEJ,CAACpG,EAAEiC,KAAMjC,EAAEkC,KAAKiE,SAAS3N,KAAKuN,aACpCE,EAAWzN,KAAKyN,WAChBL,EAAQpN,KAAK4N,SACblC,EAAO,IAAIqB,GAASrB,EAAM+B,EAAUL,GAGtC,OAAO1B,mCAOP,OAAQ1L,KAAKuN,YACX,KAAK/F,EAAE6B,OACL,OAAOrJ,KAAK6N,eACd,KAAKrG,EAAE+B,KACP,KAAK/B,EAAEgC,MACL,OAAOxJ,KAAK8N,UACd,KAAKtG,EAAEC,OACL,OAAOzH,KAAK0H,SACd,KAAKF,EAAEG,KACL,OAAO3H,KAAK4H,OACd,KAAKJ,EAAEK,SACL,OAAO7H,KAAK+N,OACd,KAAKvG,EAAE8B,OACL,MAAM,IAAIjI,MAAJ,4BAAAxE,OAAsCmD,KAAKS,MAA3C,OAAA5D,OAAsDmD,KAAK2D,KAAKxG,KAAhE,MACR,QACE,MAAM,IAAIkE,MAAM,0DAKpBrB,KAAKgO,SACL,IAAMtC,EAAO1L,KAAKuM,OAElB,OADAvM,KAAKiO,SACEvC,iCAIP,GAAI1L,KAAKuN,aAAe/F,EAAEG,KACxB,MAAM,IAAItG,MAAM,qBAGlB,IAAMqK,EAAO,IAAIK,GAAS/L,KAAK2D,MAE/B,OADA3D,KAAK4K,UACEc,sCAIP,IAAIyB,EAAMC,EAEV,IAAKpN,KAAKkO,cACR,MAAM,IAAI7M,MAAM,sBASlB,GANA8L,EAAO,IAAIpB,GAAS/L,KAAK2D,MACzB3D,KAAK4K,UACL5K,KAAK4K,UACLwC,EAAQ,IAAIrB,GAAS/L,KAAK2D,MAC1B3D,KAAK4K,UAEDwC,EAAMpU,SAAWmU,EAAKnU,SAAU,KAAAmV,EAClBnO,KAAKoO,gBAAgBjB,EAAMC,GADTiB,EAAA7T,OAAA4L,EAAA,EAAA5L,CAAA2T,EAAA,GACjChB,EADiCkB,EAAA,GAC3BjB,EAD2BiB,EAAA,GAIpC,OAAO,IAAIpC,GAAUkB,EAAMC,2CAGbD,EAAMC,GACpBpN,KAAKoH,OAAOpH,KAAKS,MAAQ,GAAK2M,EAAMxF,KACpC5H,KAAKoH,OAAOpH,KAAKS,OAAS0M,EAAKvF,KAC/B,IAAI0G,EAAOnB,EAGX,MAAO,CAFPA,EAAOC,EACPA,EAAQkB,kCAKR,GAAItO,KAAKuN,aAAe/F,EAAEK,SACxB,MAAM,IAAIxG,MAAM,oBAGlB,IAAM0M,EAAO/N,KAAK2D,KAClB3D,KAAK4K,UACL5K,KAAKgO,SACL,IAAMpN,EAAOZ,KAAKuO,OAElB,OADAvO,KAAKiO,SACE,IAAIvB,GAAOqB,EAAMnN,kCAIxB,IACI8K,EADE6C,EAAO,GAMb,IAHA7C,EAAO1L,KAAKwO,WACZD,EAAKrM,KAAKwJ,GAEH1L,KAAKuN,aAAe/F,EAAE2B,OAC3BnJ,KAAK4K,UACLc,EAAO1L,KAAKwO,WACZD,EAAKrM,KAAKwJ,GAGZ,OAAO6C,qCAIP,OAAIvO,KAAKkO,cACAlO,KAAKyO,YACHzO,KAAKuN,aAAe/F,EAAEO,OACxB/H,KAAKgI,SAELhI,KAAKuM,sCAKd,IAAIb,EAEJ,GAAI1L,KAAKuN,aAAe/F,EAAEmC,KACxB,MAAM,IAAItI,MAAM,kBAKlB,OAFAqK,EAAO,IAAIL,GAASrL,KAAK2D,MACzB3D,KAAK4K,UACEc,mCAIP,IAAMA,EAAO,IAAIC,GAAW3L,KAAK2D,MAEjC,OADA3D,KAAK4K,UACEc,mCAIP,GAAI1L,KAAKuN,aAAe/F,EAAEC,OAAQ,CAChC,IAAMiE,EAAO,IAAIG,GAAW7L,KAAK2D,MAEjC,OADA3D,KAAK4K,UACEc,EAEP,MAAM,IAAIrK,MAAM,qDAKlB,GAAI,CAACmG,EAAE+B,KAAM/B,EAAEgC,MAAOhC,EAAEiC,KAAMjC,EAAEkC,KAAKiE,SAAS3N,KAAKuN,YAAa,CAC9D,IAAM7B,EAAO1L,KAAK2D,KAElB,OADA3D,KAAK4K,UACEc,EAEP,MAAM,IAAIrK,MAAM,qDAKlB,GAAIrB,KAAKuN,aAAe/F,EAAE0B,OACxB,MAAM,IAAI7H,MAAM,uBAGlBrB,KAAK4K,2CAIL,GAAI5K,KAAKuN,aAAe/F,EAAE6B,OACxB,MAAM,IAAIhI,MAAM,4BAGlBrB,KAAK4K,2CAIL,GAAI5K,KAAKuN,aAAe/F,EAAE8B,OACxB,MAAM,IAAIjI,MAAM,6BAGlBrB,KAAK4K,4CAIL,IAAK,CAACpD,EAAE+B,KAAM/B,EAAEgC,OAAOmE,SAAS3N,KAAKuN,YACnC,MAAM,IAAIlM,MAAM,0BAGlB,IAAMsC,EAAO3D,KAAK2D,KAGlB,OAFA3D,KAAK4K,UACQ,IAAIyB,GAAQ1I,EAAM3D,KAAK4N,4CAKhC5N,KAAKS,MAAQT,KAAKoH,OAAOrI,OAAS,GACpCiB,KAAKS,QACLT,KAAK2D,KAAO3D,KAAKoH,OAAOpH,KAAKS,QAE7BT,KAAK2D,KAAO,2CAKd,OACE3D,KAAKuN,SAAS,KAAO/F,EAAEG,MACpB3H,KAAKuN,SAAS,KAAO/F,EAAE4B,OACvBpJ,KAAKuN,SAAS,KAAO/F,EAAEG,wCAK5B,OACE3H,KAAKuN,SAAS,KAAO/F,EAAEkH,QACpB1O,KAAKuN,SAAS,KAAO/F,EAAEmC,MACvB3J,KAAKuN,SAAS,KAAO/F,EAAEkH,wCAIrBC,GACP,IAAIA,EAWF,OAAO3O,KAAK2D,MAAQ3D,KAAK2D,KAAK9E,KAV9B,GAAI8P,EAAa,EACf,MAAM,IAAItN,MAAM,qCAGlB,IAAMZ,EAAQT,KAAKS,MAAQkO,EAE3B,OAAIlO,EAAQT,KAAKoH,OAAOrI,OACfiB,KAAKoH,OAAO3G,GAAO5B,UAD5B,WChFS+P,cAlMb,SAAAA,EAAY5V,GAAWwB,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA4O,GACrB5O,KAAKhH,SAAWA,EAChBgH,KAAK6O,MAAQ,KACb7O,KAAK8O,MAAQ,GACb9O,KAAKE,OAAS,KACdF,KAAKlG,MAAQ,IAAI8F,wDAGTkJ,GACR,IACIiG,EAAOC,EADLC,EAASC,GAAMC,UAAUnP,KAAKhH,SAAU8P,GAG9C,IACEiG,EAAQ,IAAIlF,GAAMf,GAClBkG,EAAS,IAAI3B,GAAQ0B,EAAMK,aAC3BH,EAAO3B,IAAM0B,EAAOK,QACpBH,GAAMI,YAAYtP,KAAKhH,UACvBgH,KAAKE,OAAS+O,EAAO/O,OACrB,MAAO2O,GAGP,OAFA7O,KAAK6O,MAAQI,EAAOJ,MAAQA,EAC5B7O,KAAKE,OAAS+O,EAAO/O,OAASF,KAAKuP,gBAC5BvP,KAAKE,OAId,OADAF,KAAK6O,MAAQI,EAAOJ,MACb7O,KAAKE,wCAGLlH,GACP,IAAMiW,EAASC,GAAMM,UAAUxW,GAE/B,IAAKiW,EAAO3B,IACV,OAAO2B,EAAO/O,OAGhB,IACEF,KAAKE,OAAS+O,EAAO/O,OAASF,KAAKyP,UAAUR,EAAO3B,KACpD,MAAOuB,GAGP,MAFA7O,KAAK6O,MAAQI,EAAOJ,MAAQA,EAC5B7O,KAAKE,OAAS+O,EAAO/O,OAASF,KAAKuP,gBAC7BV,EAGR,OAAO7O,KAAKE,yCAGJwL,GACR,OAAQA,EAAKN,OACX,IAAK,aACH,OAAOpL,KAAK6L,WAAWH,GACzB,IAAK,WACH,OAAO1L,KAAK+L,SAASL,GACvB,IAAK,WACH,OAAO1L,KAAKqL,SAASK,GACvB,IAAK,aACH,OAAO1L,KAAK2L,WAAWD,GACzB,IAAK,YACH,OAAO1L,KAAKiM,UAAUP,GACxB,IAAK,SACH,OAAO1L,KAAK0M,OAAOhB,GACrB,IAAK,WACH,OAAO1L,KAAK+M,SAASrB,GACvB,IAAK,UACH,OAAO1L,KAAKqM,QAAQX,GACtB,QACE,IAAMgE,EAAWhE,EAAKN,QAAUM,EAAKiE,aAAe,IAAIrR,KACxD,MAAM,IAAI+C,MAAJ,yBAAAxE,OAAmC6S,sCAQtChE,GACP,OAAOA,EAAKkE,0CAGHlE,GACT,OAAOA,EAAKkE,0CAGHlE,GACT,OAAOA,EAAKkE,uCAONlE,GACN,IAAMxL,EAASF,KAAKyP,UAAU/D,EAAKa,MACnC,OAAOb,EAAKkE,KAAK1P,oCAGVwL,GACP,IAAMxL,EAASF,KAAK6P,cAAcnE,EAAK1S,UACvC,YAAkB8F,IAAXoB,EACH,EACAA,mCAGGwL,GACP,IAAMyB,EAAOnN,KAAKyP,UAAU/D,EAAKsB,UAC3BI,EAAQpN,KAAKyP,UAAU/D,EAAKuB,WAElC,GAAoB,kBAATE,EACT,MAAM,IAAI9L,MAAJ,0BAAAxE,OAAoCsQ,EAApC,MAGR,GAAqB,kBAAVC,EACT,MAAM,IAAI/L,MAAJ,0BAAAxE,OAAoCuQ,EAApC,MAGR,OAAO1B,EAAKkE,KAAKzC,EAAMC,qCAGf1B,GASR,IATc,IAAAoE,EACuB9J,EAAc0F,EAAKQ,SAASlT,UADnD+W,EAAAvV,OAAA4L,EAAA,EAAA5L,CAAAsV,EAAA,GACPE,EADOD,EAAA,GACOE,EADPF,EAAA,GAAAG,EAEyBlK,EAAc0F,EAAKS,UAAUnT,UAFtDmX,EAAA3V,OAAA4L,EAAA,EAAA5L,CAAA0V,EAAA,GAEPE,EAFOD,EAAA,GAEQE,EAFRF,EAAA,GAGRG,EAAgB/N,KAAKK,IAAIoN,EAAcI,GACvCG,EAAchO,KAAKC,IAAIwN,EAAcI,GACrCI,EAAgBjO,KAAKK,IAAIqN,EAAcI,GACvCI,EAAclO,KAAKC,IAAIyN,EAAcI,GACrC9B,EAAO,GAEJmC,EAAOF,EAAeE,GAAQD,EAAaC,IAClD,IAAK,IAAIC,EAAOL,EAAeK,GAAQJ,EAAaI,IAAQ,CAC1D,IAAM3X,EAAQ,GAAA6D,OAAM0I,EAAeoL,GAArB,KAAA9T,OAA8B6T,EAAO,GAC7CxQ,EAASF,KAAK6P,cAAc7W,QAEnB8F,IAAXoB,GACFqO,EAAKrM,KAAKhC,GAKhB,OAAOqO,wCAGKqC,GACZ,IAAI1Q,EAEJ,IAAKF,KAAK6Q,gBAAgBD,GACxB,MAAM,IAAIvP,MAAM,0BAGlB,YAAkCvC,IAA9BkB,KAAK8O,MAAM8B,GACN5Q,KAAK8O,MAAM8B,IAGpB1Q,EAASgP,GAAM4B,UAAUF,GACzB5Q,KAAK8O,MAAM8B,GAAiB1Q,EACrBA,kCAGFwL,GACL,IAAMoB,EAAgB,GADXpI,GAAA,EAAAC,GAAA,EAAAC,OAAA9F,EAAA,IAGX,QAAA+F,EAAAC,EAAsB4G,EAAKkB,SAA3B7H,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAqC,KAA5BqM,EAA4BlM,EAAA1L,MAC7B+G,EAASF,KAAKyP,UAAUsB,GAEN,cAApBA,EAAU3F,MACZ0B,EAAc5K,KAAdX,MAAAuL,EAAatS,OAAA8K,EAAA,EAAA9K,CAAS0F,IAEtB4M,EAAc5K,KAAKhC,IATZ,MAAAkF,GAAAT,GAAA,EAAAC,EAAAQ,EAAA,YAAAV,GAAA,MAAAI,EAAAO,QAAAP,EAAAO,SAAA,WAAAV,EAAA,MAAAC,GAaX,OAAO8G,EAAKkE,KAAK9C,2CAGH9T,GAAU,IAAAgY,EACKhL,EAAchN,GADnBiY,EAAAzW,OAAA4L,EAAA,EAAA5L,CAAAwW,EAAA,GACjBE,EADiBD,EAAA,GACPE,EADOF,EAAA,GAGxB,QAAI1O,KAAKK,IAAIsO,EAAUC,GAAY,OAC/BD,GAAYlR,KAAKlG,MAAMF,YACvBuX,GAAYnR,KAAKlG,MAAMH,+CAIb,IACGyX,EAAapR,KAAK6O,MAA3BwC,QAER,OAAID,EAASxK,MAAM,qBA7LM,UA+LdwK,EAASxK,MAAM,uBA9LC,QACX,mBCLd0K,GACJ,SAAAA,EAAYvY,GAAUyB,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAsR,GACpBtR,KAAKjH,QAAUA,EACfiH,KAAK6O,MAAQ,KACb7O,KAAKE,OAAS,KACdF,KAAKsN,IAAM,MAgIT4B,GAAQ,eA3HZ,SAAAqC,IAAe/W,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAuR,GACbvR,KAAKwR,IAAM,GACXxR,KAAKyR,QAAU,KACfzR,KAAK0R,QAAU,KACf1R,KAAKH,MAAQ,IAAID,0DAGP5G,GACVgH,KAAK2R,kBACL3R,KAAK4R,IAAI5Y,GACTgH,KAAK6R,wDAGW,IAAAxK,EAAArH,KAChBA,KAAKyR,QAAU,IAAIK,IAEnBtX,OAAO6F,KAAKL,KAAKwR,KAAK3Q,QAAQ,SAAAoO,GAC5B5H,EAAKoK,QAAQM,IAAI9C,iCAIjBjW,GACF,IADY,IAAA4S,EAAA5L,KACLA,KAAKyR,QAAQO,KAAO,GAAG,CACvBhZ,IACHA,EAAWwB,OAAA8K,EAAA,EAAA9K,CAAIwF,KAAKyR,SAAS,IAG/B,IACEzR,KAAK0R,QAAU,IAAII,IAAI,CAAC9Y,IACJ,IAAI4V,GAAY5V,GACxBiZ,SAASjZ,GACrB,MAAO6V,IAET7O,KAAK0R,QAAQ7Q,QAAQ,SAAA7H,GAAQ,OAAI4S,EAAK6F,QAAQS,OAAOlZ,KACrDA,EAAW,KAGbgH,KAAK0R,QAAU,KACf1R,KAAKyR,QAAU,uCAGPzY,GACR,GAAKgH,KAAKmS,UAAUnZ,GAApB,CAIAgH,KAAKoS,cAAcpZ,GACnBgH,KAAKyR,QAAQS,OAAOlZ,GACpBgH,KAAK0R,QAAQK,IAAI/Y,GACjB,IACMkH,EADc,IAAI0O,GAAY5V,GACTiZ,SAASjZ,GAEpC,OADAgH,KAAK0R,QAAQQ,OAAOlZ,GACbkH,yCAGKlH,GACZ,OAAIA,KAAYgH,KAAKwR,IACZtC,GAAMsC,IAAIxY,GAAUkH,OAEpB,yCAIGlH,GACZ,GAAIgH,KAAK0R,QAAQW,IAAIrZ,GACnB,MAAM,IAAIqI,MAAM,4DAOlB,IAFA,IAAMiR,EAAe,IAAIR,IAAI9R,KAAKH,MAAM0S,WAExCvQ,EAAA,EAAAwQ,EAA+BhY,OAAOiY,QAAQzS,KAAKwR,KAAnDxP,EAAAwQ,EAAAzT,OAAAiD,IAAyD,KAAA5H,EAAAoY,EAAAxQ,GAAA9H,EAAAM,OAAA4L,EAAA,EAAA5L,CAAAJ,EAAA,GAA/CpB,EAA+CkB,EAAA,GAArC+U,EAAqC/U,EAAA,GAC/CnB,EAAoBkW,EAApBlW,QAASmH,EAAW+O,EAAX/O,OAEjBoS,EAAaJ,OAAOlZ,GAEhBkH,IAAWF,KAAKH,MAAMgQ,cAAc7W,IACtCgH,KAAKH,MAAMM,gBAAgBnH,EAAUD,EAASmH,GATtC,IAAAwE,GAAA,EAAAC,GAAA,EAAAC,OAAA9F,EAAA,IAaZ,QAAA+F,EAAAC,EAAqBwN,EAArBvN,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAmC,KAA1B1L,EAA0B6L,EAAA1L,MACjC6G,KAAKH,MAAM6S,UAAU1Z,IAdX,MAAAoM,GAAAT,GAAA,EAAAC,EAAAQ,EAAA,YAAAV,GAAA,MAAAI,EAAAO,QAAAP,EAAAO,SAAA,WAAAV,EAAA,MAAAC,sCAkBJ5L,EAAUD,GAClB,IAAMkW,EAAS,IAAIqC,GAAOvY,GAE1B,OADAiH,KAAKwR,IAAIxY,GAAYiW,EACdA,oCAGCjW,GACR,OAAOA,KAAYgH,KAAKwR,sCAGhBxY,GAER,OADAgH,KAAK2S,oBAAoB3Z,GAClBgH,KAAKwR,IAAIxY,qCAGRA,GACJA,KAAYgH,KAAKwR,aACZxR,KAAKwR,IAAIxY,GAChBgH,KAAKsP,kDAKPtP,KAAKwR,IAAM,GACXxR,KAAKyR,QAAU,KACfzR,KAAK0R,QAAU,KACf1R,KAAKH,MAAQ,IAAID,8CAGC5G,GAClB,IAAKgH,KAAKmS,UAAUnZ,GAClB,MAAM,IAAIqI,MAAM,8BAQP6N,MVtHR,SAAS9O,GAAcpH,GAC5B,OAAO,SAACiG,EAAUC,GAChB,IAAM/F,EAAQ+F,IAAWhD,UAAUlD,GAInC,OAFAkW,GAAM0D,UAAU5Z,QAEF8F,IAAV3F,EACKgG,QAAQC,UAIVD,QAAQC,QAAQH,EAAS,CAC9BJ,KAAM,mBACN7E,QAAShB,MWhCR,IAAM6Z,GAAeC,IAAMC,gBC8BnBC,cAhCb,SAAAA,EAAYC,GAAYzY,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAgT,GACtBhT,KAAKkT,EAAID,EACTjT,KAAKmT,aAAe,qDAUpB,OAFgBnT,KAAKkT,EAAEpZ,MAAMsZ,SAArBC,KAGN,IAAK,SACHrT,KAAKkT,EAAExT,MAAM4T,0BACb,MACF,IAAK,QACL,IAAK,MACH,GAAItT,KAAKuT,sBAAyB,OAClCvT,KAAKkT,EAAEM,gBAAgBC,MACvB,MACF,IAAK,YACL,IAAK,aACHzT,KAAKkT,EAAEtU,sBACLoB,KAAKkT,EAAExT,MAAMxG,WAAWC,MACxB6G,KAAKkT,EAAEQ,SAASC,QAAQC,6DAnB9B,OAAO5T,KAAKkT,EAAEpZ,MAAMyZ,+BCuDTM,cA1Db,SAAAA,EAAYZ,GAAYzY,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA6T,GACtB7T,KAAKkT,EAAID,oDAGL,IAGAa,EAFIT,EAAQrT,KAAKkT,EAAEpZ,MAAMsZ,SAArBC,IACAra,EAAagH,KAAKkT,EAAExT,MAApB1G,SAIN8a,EADE9T,KAAKkT,EAAEpZ,MAAMyZ,sBACHvT,KAAK+T,iBAAiBV,EAAKra,GAE3BgH,KAAKgU,YAAYX,EAAKra,GAGpCgH,KAAKiU,aAAaH,4CAGHT,EAAKra,GACpB,GAAY,WAARqa,EACF,6CAAAxW,OAA8C7D,EAA9C,0CAIQqa,EAAKra,GACf,OAAQqa,GACN,IAAK,MACH,6CAAAxW,OAA8C7D,EAA9C,MACF,IAAK,QACH,OAAOgH,KAAKkU,aAAalb,GAC3B,IAAK,SACH,6CAAA6D,OAA8C7D,EAA9C,4CAMOA,GAAU,IAAA8W,EACQ9J,EAAchN,GADtB+W,EAAAvV,OAAA4L,EAAA,EAAA5L,CAAAsV,EAAA,GACdoB,EADcnB,EAAA,GACJoB,EADIpB,EAAA,GAEfoE,EAAe5R,KAAKK,IAAI5C,KAAKkT,EAAExT,MAAM/F,KAAO,EAAGwX,EAAW,GAC1D5V,EAAWgK,EAAe2L,GAC1BvV,EAAW,IAAMwY,EAAe,GAChCC,EAAW,GAAAvX,OAAMtB,EAAN,KAAAsB,OAAkBlB,GAEnC,6CAAAkB,OAA8CuX,EAA9C,2CAGWC,GACX,GAAKA,EAAL,CAEA,IAAMC,EAAKC,SAASC,cAAcH,GAE9BE,SAASE,gBAAkBH,GAC7BA,EAAGI,kBCHMC,cAlDb,SAAAA,EAAY1B,GAAYzY,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA2U,GACtB3U,KAAKkT,EAAID,oDAGL,IAGA2B,EAFI5b,EAAagH,KAAKkT,EAAExT,MAApB1G,SACF6b,EAAa7U,KAAKkT,EAAExT,MAAMxG,WAAWC,MAGvC6G,KAAKiL,aAAa4J,GACpB7U,KAAKkT,EAAExT,MAAMU,cAAcpH,IAK3B4b,EADE5U,KAAKoK,UAAUyK,GACL7U,KAAK8U,cAAcD,GAEnBA,EAGd7U,KAAKkT,EAAExT,MAAMqV,YAAY/b,EAAU4b,sCAG3BzX,GACR,OAAOA,EAAK4B,OAAS,GAAiB,MAAZ5B,EAAK,wCAGpBA,GACX,OAAuB,IAAhBA,EAAK4B,QAAgB4H,QAAQxJ,EAAKyJ,MAAM,gDAGnCzN,GAIZ,OAHc,IAAI0Q,GAAM1Q,GACHiW,YAGlB9H,IAAI,SAAAC,GACH,OAAQA,EAAM1I,MACZ,KAAK2I,EAAEK,SACL,OAAON,EAAMpK,KAAKmL,cACpB,KAAKd,EAAEC,OACL,OAAOF,EAAMpO,MACf,QACE,OAAOoO,EAAMpK,QAGlBgF,KAAK,aC3CC6S,GAAKxa,OAAA4D,EAAA,EAAA5D,CAAA,SAAA6D,OAAA,WAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,qDAOlB,SAAS0W,GAATlb,GAAwE,IAApDmb,EAAoDnb,EAApDmb,OAAQ/b,EAA4CY,EAA5CZ,MAAOqG,EAAqCzF,EAArCyF,MAAOE,EAA8B3F,EAA9B2F,MAAOyV,EAAuBpb,EAAvBob,SAAUC,EAAarb,EAAbqb,UACzD,OACE5a,OAAA6a,EAAA,EAAA7a,CAACwa,GAADxa,OAAA8a,OAAA,CACEC,IAAKL,EACLhX,IAAKsB,EACLrG,MAAOA,EACPgc,SAAUA,EACVC,UAAWA,GACP1V,IAiBVuV,GAASO,aAAe,CACtBhW,MAAO,GACPE,MAAO,IAGMuV,UClCT9W,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,cACM,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOM,SAASC,QAD3C,sCAGc,SAAAiC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOc,QAH1C,qBAIY,SAAA0B,GAAK,OAAIA,EAAMzC,MAAMC,OAAOM,SAASE,QAJjD,gDAUJ+X,GAAGjb,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,uDAMHmX,GAAQlb,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,qCAKRoX,GAACnb,OAAA4D,EAAA,EAAA5D,CAAA,KAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,oCAKDqX,GAAEpb,OAAA4D,EAAA,EAAA5D,CAAA,MAAA6D,OAAA,YAAA7D,CAAA,iCAEkB,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOM,SAASE,QAFvD,sDAKFmY,wLASS,IAEPC,EAFOC,EACqB/V,KAAKN,MAA7BsW,EADGD,EACHC,SAAU5c,EADP2c,EACO3c,UADPsL,GAAA,EAAAC,GAAA,EAAAC,OAAA9F,EAAA,IAIX,QAAA+F,EAAAC,EAAkBkR,EAAlBjR,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAA4B,KAAnBuR,EAAmBpR,EAAA1L,MAC1B,KAAIC,GAAa6c,EAAMC,WAAa,GAGlC,MAFAJ,EAAYG,GANL,MAAA7Q,GAAAT,GAAA,EAAAC,EAAAQ,EAAA,YAAAV,GAAA,MAAAI,EAAAO,QAAAP,EAAAO,SAAA,WAAAV,EAAA,MAAAC,GAYX,OAAIkR,GAAoC,OAAvBA,EAAUK,SAA4BL,EACnDA,GAAa1c,EAAY,EAAI0c,EAAUK,SAAmBL,EACvD,uCAGCG,GACR,IAAM5C,EAAM4C,EAAM1N,OAAOD,cACzB,OAAOG,EAAa4K,oCAIpB,IAEI7K,EAFEyN,EAAQjW,KAAKoW,aACXC,EAAcrW,KAAKsW,QAAnBD,UAGR,OAAKJ,GACLzN,EAASxI,KAAKuW,UAAUN,GAGtBzb,OAAA6a,EAAA,EAAA7a,CAACgc,GAAD,CACEtY,IAAKA,YAAF,OACMmY,EAAUI,OADhB,WAEOJ,EAAUlJ,KAFjB,QAKH3S,OAAA6a,EAAA,EAAA7a,CAACib,GAAD,CACEvX,IAAGwY,IAIFlO,EAAO/G,YAEVjH,OAAA6a,EAAA,EAAA7a,CAACob,GAAD,MACApb,OAAA6a,EAAA,EAAA7a,CAACkb,GAAD,gBACAlb,OAAA6a,EAAA,EAAA7a,CAACib,GAAD,KAAMjN,EAAO9G,SACblH,OAAA6a,EAAA,EAAA7a,CAACkb,GAAD,gBACAlb,OAAA6a,EAAA,EAAA7a,CAACmb,GAAD,KAAInN,EAAO7G,WArBM,YApCKmR,IAAM6D,eAA9Bd,GAEGe,YAAc/D,GAkERgD,8BCpGTgB,GAAErc,OAAA4D,EAAA,EAAA5D,CAAA,MAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,kBAIR,SAASuY,GAAT/c,GAA+D,IAAvCgd,EAAuChd,EAAvCgd,KAAMtW,EAAiC1G,EAAjC0G,MAAOuW,EAA0Bjd,EAA1Bid,SAAUC,EAAgBld,EAAhBkd,aAC7C,OACEzc,OAAA6a,EAAA,EAAA7a,CAACqc,GAAD,CACEK,SAAU,EACVD,aAAc,kBAAMA,EAAaxW,KAEhCuW,GAAYD,EAAKrZ,OAASqZ,EAAKrZ,OAASqZ,EAAK/T,MAepD8T,GAAatB,aAAe,CAC1ByB,aA5BW,cA+BEH,UC9BTK,GAAE3c,OAAA4D,EAAA,EAAA5D,CAAA,MAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,wCAMF6Y,6LAWc,IAAA/P,EAAArH,KAChB,OAAOA,KAAKN,MAAM2X,MACf/P,IAAI,SAACyP,EAAMtW,GAAP,OACHhC,EAAAC,EAAAC,cAAC2Y,GAAD,CACEjE,IAAK5S,EACLA,MAAOA,EACPsW,KAAMA,EAAKA,KACXvX,MAAKhF,OAAAC,EAAA,EAAAD,CAAA,GAAM6M,EAAK3H,MAAMnB,OAAOgZ,IAC7BP,SAAUD,EAAKC,SACfC,aAAc5P,EAAK3H,MAAMuX,kDAKxB,IAAAlB,EACmB/V,KAAKN,MAAvB2X,EADDtB,EACCsB,MAAO9Y,EADRwX,EACQxX,OAEf,OAAqB,IAAjB8Y,EAAMtY,OAAuB,KAG/BN,EAAAC,EAAAC,cAACwY,GAAD,CACED,UAAW,EACX1X,MAAOjB,EAAOiZ,IAEbxX,KAAKyX,0BAnCgB3E,IAAM6D,eAA9BS,GAEGM,WAAa,CAClBT,aAAcU,KAAU5J,KACxBsJ,MAAOM,KAAUC,MAAMC,WACvBtZ,OAAQoZ,KAAUG,MAAM,CACtBN,GAAIG,KAAUI,OACdR,GAAII,KAAUI,UAkCLX,UC1CTjZ,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,6BAKJyZ,GAAa,CAAA1Z,KAAA,SAAAC,OAAA,oBAIb0Z,GAAYzd,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CACdwd,GADc,eAEF,SAAAtY,GAAK,OAAIA,EAAMzC,MAAMC,OAAOM,SAASC,QAFnC,KAKZya,GAAc1d,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAChBwd,GADgB,eAEJ,SAAAtY,GAAK,OAAIA,EAAMzC,MAAMC,OAAOM,SAASE,QAFjC,KAKd+X,GAAGjb,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,uDAMHmX,GAAQlb,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,oBAIR4Z,eAiBJ,SAAAA,IAAc,IAAA9Q,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAmY,IACZ9Q,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAA2d,GAAA1M,KAAAzL,QARFlG,MAAQ,CACNse,UAAW,GACXC,UAAW,EACXjF,SAAU,KACVkF,WAAW,GAKXjR,EAAKkR,cAAgBlR,EAAKkR,cAAcC,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAKqD,SAAWrD,EAAKqD,SAAS8N,KAAdhe,OAAAie,EAAA,EAAAje,CAAA6M,IAHJA,mFAMM,IAAAuE,EAAA5L,KAClBA,KAAK0Y,SAAS,CAAEL,UAAW,GAAK,WAC9BzM,EAAK+M,+DAIaC,EAAWC,GAC/B,OAAO7Y,KAAKlG,MAAMse,YAAcS,EAAUT,qDAGzBU,EAAWC,GAC5B/Y,KAAKgZ,kBAAkBD,GACvB/Y,KAAKiZ,gBAAgBH,GACrB9Y,KAAKkZ,4DAILlZ,KAAKsW,QAAQ6C,0BAAyB,2CAGxBL,GAAW,IAAAhN,EAAA9L,KACrB8Y,EAAUvR,QAAUvH,KAAKN,MAAM6H,OAEnCvH,KAAK0Y,SAAS,CAAEL,UAAW,GAAK,WAC9BvM,EAAK6M,2DAISI,GAAW,IACnB3F,EAAapT,KAAKsW,QAAlBlD,SAEJ2F,EAAU3F,WAAaA,IACzBpT,KAAK0Y,SAAS,CAAEtF,aAChBpT,KAAKoZ,iBAAiBhG,yCAIb,IACHA,EAAapT,KAAKsW,QAAlBlD,SACJpT,KAAKlG,MAAMsZ,WAAaA,GACxB,CAAC,QAAS,OAAOzF,SAASyF,EAASC,MAAQrT,KAAKlG,MAAMwe,WACxDtY,KAAKpB,wEAKP,IAAMya,EAAiBrZ,KAAKsW,QAAQpd,WAAWC,MACvCoO,EAAUvH,KAAKN,MAAf6H,MACAgB,EAAWvI,KAAKlG,MAAMse,UAAUpY,KAAKlG,MAAMue,WAA3C9P,OACF+Q,EAAkB/R,EAAM9G,MAAQ8G,EAAMpK,KAAK4B,OAC3Cwa,EAAYF,EAAehR,MAAM,EAAGd,EAAM9G,OAC1C+Y,EAAaH,EAAehR,MAAMiR,GAClCngB,EAAK,GAAA0D,OAAM0c,GAAN1c,OAAkB0L,EAAlB,KAAA1L,OAA4B2c,GACjCpgB,EAAYmgB,EAAUxa,OAASwJ,EAAOxJ,OAAS,EACrDiB,KAAKsW,QAAQ1X,sBAAsBzF,EAAOC,0CAG7B,IAgBTif,EAhBSrM,EAAAhM,KAEP7C,EADY6C,KAAKN,MAAf6H,MACWpK,KAAKmL,cAClB8P,EAAY5d,OACf6F,KAAKoI,GACLgR,OAAO,SAAAlR,GAAM,OAAIA,EAAOmR,WAAWvc,KACnCwc,OACArS,IAAI,SAAAiB,GAAM,MAAK,CACdwO,KAAM,CACJ/T,KAAMgJ,EAAK4N,SAASrR,GACpB7K,OAAQsO,EAAK6N,WAAWtR,IAE1ByO,UAAU,EACVzO,YAEA+P,GAAY,EAGhBD,EAAY9V,KAAKC,IAAID,KAAKK,IAAIwV,EAAUrZ,OAAS,EAAGiB,KAAKlG,MAAMue,WAAY,GAEvED,EAAUrZ,OAAS,IACrBqZ,EAAUC,GAAWrB,SAAWsB,GAAY,GAG9CtY,KAAKsW,QAAQ6C,yBAAyBb,GACtCtY,KAAK0Y,SAAS,CAAEN,YAAWC,YAAWC,uDAGvBlF,GAAU,IAAAhH,EAAApM,KACrBqY,EAAYrY,KAAKlG,MAAMue,UAE3B,OAAQjF,EAASC,KACf,IAAK,UACDgF,EAAYrY,KAAKlG,MAAMue,UAAY,EACrC,MACF,IAAK,YACDA,EAAYrY,KAAKlG,MAAMue,UAAY,EAIzCrY,KAAK0Y,SAAS,CAAEL,aAAa,WAC3BjM,EAAKuM,kDAIAN,GAAW,IAAA7L,EAAAxM,KAClBA,KAAK0Y,SAAS,CAAEL,aAAa,WAC3B7L,EAAKmM,kDAIApQ,GACP,OACE/N,OAAA6a,EAAA,EAAA7a,CAACyd,GAAD,KACEzd,OAAA6a,EAAA,EAAA7a,CAACsf,GAAD,KACGvR,uCAMEA,GACT,OACE/N,OAAA6a,EAAA,EAAA7a,CAAC0d,GAAD,KACE1d,OAAA6a,EAAA,EAAA7a,CAACsf,GAAD,KACGvR,GAEH/N,OAAA6a,EAAA,EAAA7a,CAACuf,GAAD,KACGtR,EAAaF,GAAQ5G,kDAMd,IACN1E,EAAU+C,KAAKN,MAAfzC,MAER,MAAO,CACLua,GAAI,CACFwC,UAAW,EACXC,UAAS,WAAApd,OAAaI,EAAMC,OAAOc,QACnCX,OAAM,aAAAR,OAAeI,EAAMC,OAAOM,SAASE,QAC3ClC,MAAO,4CAKC0e,GACZA,EAAMC,YAAYC,kBAClBpa,KAAKpB,yDAGE,IAAAyb,EAC0Bra,KAAKlG,MAA9Bse,EADDiC,EACCjC,UAAWE,EADZ+B,EACY/B,UACXjC,EAAcrW,KAAKsW,QAAnBD,UAER,OACE7b,OAAA6a,EAAA,EAAA7a,CAAC8f,GAAD,CACEpc,IAAKA,YAAF,OACMmY,EAAUI,OADhB,WAEOJ,EAAUlJ,KAFjB,OAIHoN,KAAMjC,EACNkC,QAASxa,KAAKuY,eAEd/d,OAAA6a,EAAA,EAAA7a,CAACigB,GAAD,CACEpD,MAAOe,EACP7Z,OAAQyB,KAAK0a,gBACbzD,aAAcjX,KAAK0K,mBA5LFoI,IAAM6H,WAA3BxC,GAEGvB,YAAc/D,GAiMR+H,mBAAUzC,IChHV0C,8MA9Gb/gB,MAAQ,CACNkc,SAAU,uFAIVhW,KAAK8a,yDAGYhC,GACbA,EAAU1R,SAAWpH,KAAKN,MAAM0H,QAClCpH,KAAK8a,oDAKP,IAAMC,EAAQ,GACR/E,EAAW,GAFLtR,GAAA,EAAAC,GAAA,EAAAC,OAAA9F,EAAA,IAIZ,QAAA+F,EAAAC,EAAkB9E,KAAKN,MAAM0H,OAA7BrC,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAqC,KAA5B6C,EAA4B1C,EAAA1L,MACnC,GAAIoO,EAAM1I,OAAS2I,EAAEK,SAAU,CAC7B,IAAMoO,EAAQ,CAAE1N,OAAQhB,EAAMpK,KAAM+Y,WAAY3O,EAAM9G,MAAO0V,SAAU,MACvE4E,EAAM7Y,KAAK+T,GACXD,EAAS9T,KAAK+T,QACT,GAAI1O,EAAM1I,OAAS2I,EAAE6B,OAC1B0R,EAAM7Y,KAAK,UACN,GAAIqF,EAAM1I,OAAS2I,EAAE8B,OAAQ,CAElC,GADAyR,EAAMC,MACFD,EAAMhc,OAAS,GAAiC,MAA5Bgc,EAAMA,EAAMhc,OAAS,GAC7Bgc,EAAMC,MACd7E,SAAW5O,EAAM9G,MAAQ,IAfzB,MAAA2E,GAAAT,GAAA,EAAAC,EAAAQ,EAAA,YAAAV,GAAA,MAAAI,EAAAO,QAAAP,EAAAO,SAAA,WAAAV,EAAA,MAAAC,GAoBZoR,EAAS2D,KAAK,SAACjb,EAAGuc,GAAJ,OAAUvc,EAAEwX,WAAa+E,EAAE/E,aACzClW,KAAK0Y,SAAS,CAAE1C,uDAGA5O,EAAQhO,GACxB,IAAIqH,EAEJ,IAAKA,EAAQ,EAAGA,EAAQ2G,EAAOrI,OAAQ0B,IAAS,CAC9C,IAAM8G,EAAQH,EAAO3G,GACf0V,EAAW5O,EAAM9G,MAAQ8G,EAAMpK,KAAK4B,OAE1C,GAAI3F,EAAYmO,EAAM9G,OAASrH,GAAa+c,EAC1C,MAIJ,OAAO1V,6CAGU,IAAAsV,EACa/V,KAAKN,MAA3B0H,EADS2O,EACT3O,OAAQhO,EADC2c,EACD3c,UACVqH,EAAQT,KAAKkb,kBAAkB9T,EAAQhO,GAI7C,MAAO,CAHaqH,EAAQ,GAAK2G,EAAO3G,EAAQ,GAC9B2G,EAAO3G,GACNA,EAAQ2G,EAAOrI,OAAS,GAAKqI,EAAO3G,EAAQ,8CAI/C,IAAA0a,EAC+Bnb,KAAKob,mBADpCC,EAAA7gB,OAAA4L,EAAA,EAAA5L,CAAA2gB,EAAA,GACRG,EADQD,EAAA,GACKE,EADLF,EAAA,GACgBG,EADhBH,EAAA,GAGhB,GAAIrb,KAAKN,MAAM0H,OAAOrI,OAAS,EAAK,OAAO,KAE3C,IAAM0c,EACJH,GACGC,GACAC,GACyB,aAAzBF,EAAY9a,UACZ,CAACgH,EAAEU,QAASV,EAAEK,UAAU8F,SAAS4N,EAAU1c,OAC3C2c,EAAW3c,OAAS2I,EAAE6B,OAGrBqS,EACJJ,GACGC,IACCC,GACD,CAAChU,EAAEU,QAASV,EAAEK,UAAU8F,SAAS4N,EAAU1c,MAGhD,OAAI4c,GAAWC,EAEXjd,EAAAC,EAAAC,cAACgd,GAAD,CACIpU,MAAOgU,SAHf,mCAUA,QAA6Bzc,IAAzBkB,KAAKN,MAAMtG,UAA2B,OAAO,KAEjD,IAAMwiB,EAAuB5b,KAAK6b,kBAElC,OAAID,GAIAnd,EAAAC,EAAAC,cAACmd,GAAD,CACE1iB,UAAW4G,KAAKN,MAAMtG,UACtB4c,SAAUhW,KAAKlG,MAAMkc,kBA9GLlD,IAAM6D,eCO1BoF,GAAO,aAEAC,GAAb,SAAAC,GA4BE,SAAAD,EAAYtc,GAAO,IAAA2H,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAgc,IACjB3U,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAwhB,GAAAvQ,KAAAzL,KAAMN,KAUR5F,MAAQ,CACNsN,OAAQ,GACRmM,uBAAuB,EACvBH,SAAU,CAAEC,IAAK,IACjB7X,MAAO,MAfU6L,EAkBnBqM,SAAWZ,IAAMoJ,YAhBf7U,EAAKmM,gBAAkB,IAAImB,GAAJna,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAK8U,eAAiB9U,EAAK8U,eAAe3D,KAApBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACtBA,EAAK+U,gBAAkB/U,EAAK+U,gBAAgB5D,KAArBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKgV,gBAAkB,IAAIrJ,GAAJxY,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKiV,gBAAkB,IAAIzI,GAAJrZ,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKkV,cAAgBlV,EAAKkV,cAAc/D,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAK8R,yBAA2B9R,EAAK8R,yBAAyBX,KAA9Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IARfA,EA5BrB,OAAA7M,OAAAgiB,EAAA,EAAAhiB,CAAAwhB,EAAAC,GAAAzhB,OAAAiiB,EAAA,EAAAjiB,CAAAwhB,EAAA,EAAA3I,IAAA,oBAAAla,MAAA,WAiDI6G,KAAKN,MAAMgd,QAAQ1c,KAAKN,MAAOM,KAAKlG,MAAOkG,KAAK0T,SAASC,WAjD7D,CAAAN,IAAA,qBAAAla,MAAA,SAoDqB2f,EAAWC,GACxBA,EAAU3F,WAAapT,KAAKlG,MAAMsZ,WACpCpT,KAAKsc,gBAAgB7I,MACrBzT,KAAKqc,gBAAgB5I,OAGnBqF,EAAU5f,aAAe8G,KAAKN,MAAMxG,aACtC8G,KAAK2c,gBACL3c,KAAK4c,wBA5DX,CAAAvJ,IAAA,uBAAAla,MAAA,WAiEI6G,KAAKN,MAAMgd,QAAQ1c,KAAKN,MAAOM,KAAKlG,MAAOkG,KAAK0T,SAASC,WAjE7D,CAAAN,IAAA,gBAAAla,MAAA,SAoEgBqC,GACRwE,KAAKlG,MAAM0B,QAAUA,GACvBwE,KAAK0Y,SAAS,CAAEld,YAtEtB,CAAA6X,IAAA,qBAAAla,MAAA,WA0EuB,IACXA,EAAU6G,KAAKN,MAAMxG,WAArBC,MAEFiO,EADQ,IAAIyC,GAAM1Q,GACHiW,YACrBpP,KAAK0Y,SAAS,CAAEtR,aA9EpB,CAAAiM,IAAA,2BAAAla,MAAA,SAiF2Boa,GACvBvT,KAAK0Y,SAAS,CAAEnF,4BAlFpB,CAAAF,IAAA,gBAAAla,MAAA,WAsFI,GAAK6G,KAAKN,MAAMnG,cAAhB,CAEA,IAAMsjB,EAAU7c,KAAK0T,SAASC,QACtBva,EAAc4G,KAAKN,MAAMxG,WAAzBE,UAERyjB,EAAQnI,QAEJmI,EAAQjJ,eAAiBxa,IAC3ByjB,EAAQC,eAAiB1jB,EACzByjB,EAAQjJ,aAAexa,MA/F7B,CAAAia,IAAA,iBAAAla,MAAA,SAmGiB+gB,GAAO,IACF/gB,EAAY+gB,EAAtB7b,OAAUlF,MACZC,EAAY8gB,EAAM7b,OAAOye,eAC/B9c,KAAKN,MAAMd,sBAAsBzF,EAAOC,KAtG5C,CAAAia,IAAA,kBAAAla,MAAA,SAyGkB+gB,GAAO,IACb7G,EAAQ6G,EAAR7G,IAEJrT,KAAKlG,MAAMyZ,uBAAyB,CAAC,MAAO,SAAS5F,SAAS0F,IAChE6G,EAAM6C,iBAGR/c,KAAK0Y,SAAS,CAAEtF,SAAU,CAAEC,WAhHhC,CAAAA,IAAA,oBAAAla,MAAA,WAoHI,OAAK6G,KAAKN,MAAMnG,cAGdkF,EAAAC,EAAAC,cAACqe,GAAD,CACE5V,OAAQpH,KAAKlG,MAAMsN,OACnBhO,UAAW4G,KAAKN,MAAMxG,WAAWE,YALG,OApH5C,CAAAia,IAAA,SAAAla,MAAA,WA+HI,IAAM0jB,EAAU7c,KAAK0T,SAASC,QACxB0C,EAAYwG,GAAWA,EAAQI,wBAErC,OACExe,EAAAC,EAAAC,cAACkU,GAAaqK,SAAd,CACE/jB,MAAO,CACLkd,YACA8C,yBAA0BnZ,KAAKmZ,yBAC/B/F,SAAUpT,KAAKlG,MAAMsZ,SACrBla,WAAY8G,KAAKN,MAAMxG,WACvB0F,sBAAuBoB,KAAKN,MAAMd,wBAGpCH,EAAAC,EAAAC,cAACwe,GAAD,CACEjI,OAAQlV,KAAK0T,SACbva,MAAO6G,KAAKN,MAAMxG,WAAWC,MAC7BqG,MAAOQ,KAAKN,MAAMH,cAAcC,MAChCE,MAAOM,KAAKN,MAAMH,cAAcG,MAChCyV,SAAUnV,KAAKmc,eACf/G,UAAWpV,KAAKoc,kBAEjBpc,KAAKod,yBApJdpB,EAAA,CAA8BlJ,IAAM6D,eAAvBqF,GAqBJxG,aAAe,CACpBkH,QAASX,GACTsB,UAAWtB,GACXxiB,eAAe,EACfgG,cAAe,IAyJnB,IAAM+d,GAAqB,CACzBld,iBACAkT,wBxB7HK,WACL,OAAO,SAACrU,EAAUC,GAChB,IAAMlG,EAAWkG,IAAWlD,OAAOlD,WAAWE,SAI9CiG,EAASL,GAHQM,IAAWhD,UAAUlD,IACT,IAAID,SAAW,OwB0H9Cgc,YrBlMK,SAAqB/b,EAAUD,GAKpC,MAAO,CACL8F,KAAM,gBACN7E,QAAS,CAAEhB,WAAUkC,KAAM,CAAEnC,UAASmH,OANpB,IAAI0O,GAAY5V,GACTukB,UAAUxkB,OqBiMrC6F,yBAGa4e,eA/Bf,SAAyB1jB,GAAO,IAAA2jB,EAa1B3jB,EAXFkC,OAF4B0hB,EAAAD,EAG1B3kB,WACEC,EAJwB2kB,EAIxB3kB,QACAC,EALwB0kB,EAKxB1kB,SAGAE,EARwBukB,EAO1BxkB,SACEC,WAEFS,EAV0B8jB,EAU1B9jB,KAKJ,MAAO,CACLC,QAhB4B6jB,EAW1B7jB,QAMFb,UACAC,WACAW,OACAT,eAWoCokB,GAAzBE,CAA6CxB,ICzM/C2B,GAAgB,GAChBC,GAAgB,IAEhBC,GAAiB,GACjBC,GAAiB,ICOvB,IAAMC,GAAmB,GAE1B5f,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,kHAMkB,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YANpD,4BAOmB,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YAPrD,eAQM,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAMG,UARxC,KAWJygB,GAASxjB,OAAA4D,EAAA,EAAA5D,CAAA,UAAA6D,OAAA,aAAA7D,CAAA,kLAeG,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOS,QAAQE,OAfvC,MAmBTogB,eAQJ,SAAAA,IAAc,IAAA5W,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAie,IACZ5W,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAyjB,GAAAxS,KAAAzL,QAOFlG,MAAQ,CACNokB,MAAO,EACPtiB,OAAQ,EACRuiB,UAAW,EACXC,YAAY,GAZA/W,EAedgX,QAAUvL,IAAMoJ,YAfF7U,EAiDdiX,gBAAkBxX,EAAS,GAAI,SAACoT,GAC9B,IAAMqE,EAAQrE,EAAMgE,MAAQ7W,EAAKvN,MAAMokB,MACvC7W,EAAKqR,SAAS,CAAEyF,UAAWI,MAjD3BlX,EAAKmX,2BAA6BnX,EAAKmX,2BAA2BhG,KAAhChe,OAAAie,EAAA,EAAAje,CAAA6M,IAClCA,EAAKoX,wBAA0BpX,EAAKoX,wBAAwBjG,KAA7Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IAC/BA,EAAKqX,sBAAwBrX,EAAKqX,sBAAsBlG,KAA3Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IAC7BA,EAAKiX,gBAAkBjX,EAAKiX,gBAAgB9F,KAArBhe,OAAAie,EAAA,EAAAje,CAAA6M,IALXA,8EAiBC,IACLzL,EAAWoE,KAAKN,MAAhB9D,OACF4D,EAAQ,CACZhE,MAAOuiB,IAUT,OAPIniB,EACF4D,EAAM5D,OAASA,GAEf4D,EAAMmf,UD3EsB,GC4E5Bnf,EAAM5D,OAAS,QAGV4D,8CAIP,GAAKQ,KAAKlG,MAAMskB,WAAhB,CAEA,IAGM3H,IAAWzS,EAHChE,KAAKlG,MAAMqkB,UACXN,GAAiB7d,KAAKlG,MAAM8B,OAC5BkiB,GAAiB9d,KAAKlG,MAAM8B,QACY,GAE1D,OAAO,SAACqB,GAAD,OAAWiB,WAAX,mCAGKuY,EAHL,iBAISxZ,EAAMC,OAAOS,QAAQE,MAJ9B,uDAaeqc,GACtBla,KAAKse,gBAAgBpE,iDAGDA,GACpB,IAAMqE,EAAQrE,EAAMgE,MAAQle,KAAKlG,MAAMokB,MACjCtiB,EAASoE,KAAKlG,MAAM8B,OAAS2iB,EAEnCve,KAAKN,MAAMkf,aAAa5e,KAAKN,MAAM+F,MAAO7J,GAC1CoE,KAAK0Y,SAAS,CAAEyF,UAAW,EAAGC,YAAY,IAC1C7J,SAASsK,oBAAoB,YAAa7e,KAAKye,yBAC/ClK,SAASsK,oBAAoB,UAAW7e,KAAK0e,0EAGpBxE,GACzBA,EAAM6C,iBAEN/c,KAAK0Y,SAAS,CACZwF,MAAOhE,EAAMgE,MACbtiB,OAAQoE,KAAKN,MAAM9D,QAAUoE,KAAKqe,QAAQ1K,QAAQsJ,wBAAwBrhB,OAC1EwiB,YAAY,IAGd7J,SAASuK,iBAAiB,YAAa9e,KAAKye,yBAC5ClK,SAASuK,iBAAiB,UAAW9e,KAAK0e,wDAGnC,IACCjZ,EAAUzF,KAAKN,MAAf+F,MAER,OACEjL,OAAA6a,EAAA,EAAA7a,CAACukB,GAAD,CACExJ,IAAKvV,KAAKqe,QACVW,WAAUvZ,EACVwZ,UAAU,mBACV/gB,IAAK8B,KAAKkf,gBAETzZ,EACDjL,OAAA6a,EAAA,EAAA7a,CAACwjB,GAAD,CACE9f,IAAK8B,KAAKmf,oBACVjI,SAAS,KACTkI,YAAapf,KAAKwe,2BAClBa,YAAarf,KAAKsf,2BAClBC,UAAWvf,KAAKwf,mCAzGF1M,IAAM6D,eAqH9B,IAAM2G,GAAqB,CAAEsB,aC7ItB,SAAsBjjB,EAAUC,GACrC,GAAsB,kBAAXA,EACT,MAAM,IAAIyF,MAAM,0BAGlB,MAAO,CACLxC,KAAM,iBACN7E,QAAS,CAAE2B,WAAUC,OAAQoI,EAAMpI,EAAQiiB,GAAgBC,QDwIhDN,eAPf,SAAyB1jB,EAAO2lB,GAE9B,MAAO,CAAE7jB,OADM9B,EAAMsC,UAAUf,WAAWokB,EAASha,SAMb6X,GAAzBE,CAA6CS,IExJtD9f,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,uEAIQ,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YAJ1C,yDAWJoiB,GAAEllB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,iFAIoB,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YAJtD,UAKGygB,GAAmB,EALtB,YAMG,SAAAre,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YANrC,uBAUFqiB,eAQJ,SAAAA,EAAYjgB,GAAO,IAAA2H,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA2f,IACjBtY,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAmlB,GAAAlU,KAAAzL,KAAMN,KAKR5F,MAAQ,CACNP,eAAe,GAPE8N,EAUnBgX,QAAUvL,IAAMoJ,YARd7U,EAAKuY,cAAgBvY,EAAKuY,cAAcpH,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAKwY,aAAexY,EAAKwY,aAAarH,KAAlBhe,OAAAie,EAAA,EAAAje,CAAA6M,IAHHA,+EAajBrH,KAAK0Y,SAAS,CAAEnf,eAAe,IAC/ByG,KAAKN,MAAMogB,0BAAyB,wCAGzB5F,GACNla,KAAKqe,QAAQ1K,QAAQoM,SAAS7F,EAAM8F,iBACvChgB,KAAKN,MAAML,wBACXW,KAAK0Y,SAAS,CAAEnf,eAAe,8CAKjC,OACEkF,EAAAC,EAAAC,cAACshB,GAAD,CACE1mB,cAAeyG,KAAKlG,MAAMP,cAC1BgG,cAAeA,qCAMnB,OACEd,EAAAC,EAAAC,cAACuhB,GAAD,CACE3K,IAAKvV,KAAKqe,QACV8B,QAASngB,KAAK4f,cACdQ,OAAQpgB,KAAK6f,cAEbphB,EAAAC,EAAAC,cAAC+gB,GAAD,gBACC1f,KAAKqgB,yBAjDWvN,IAAM6D,eAmE/B,IAAM2J,GAAqB,CAAER,yB5BjBtB,SAAkCvmB,GACvC,OAAO,SAAC0F,EAAUC,GAAa,IACrB1F,EAAqB0F,IAAWlD,OAAhCxC,iBAER,IAAIA,EAAiBE,QAAUF,EAAiBD,gBAAkBA,EAIlE,OAAO4F,QAAQC,QACbH,EAAS,CACPJ,KAAM,6BACN7E,QAAS,CACPT,sB4BK6C8F,yBAExCme,eAdf,SAAyB1jB,GASvB,MAAO,CAAEd,SAFLc,EALFkC,OACElD,WACEE,WAUgCsnB,GAAzB9C,CAA6CmC,aCjF7CY,GAAA,CAAE/gB,MAdH,SAAAvC,GAAK,OAAIiB,WAAJ,yFAIKjB,EAAMC,OAAOc,OAJlB,4EAcK0B,MAJV,CACZC,gBAAiB,aCJbqV,GAAQxa,OAAA4D,EAAA,EAAA5D,CAAOgmB,GAAP,CAAAniB,OAAA,YAAA7D,CAAH,CAAA8D,KAAA,UAAAC,OAAA,2DAMLkiB,8MAeJ/M,SAAWZ,IAAMoJ,+FAGflc,KAAKuc,2DAGYzD,EAAWC,GACxBD,EAAU5f,aAAe8G,KAAKN,MAAMxG,YACtC8G,KAAKuc,wDAKP,IACMmE,EADU1gB,KAAK0T,SAASC,QACJgN,YACpBnlB,EAAQklB,EAvCM,EAuCwB1gB,KAAKN,MAAMjG,SAAS+B,MAC5D+G,KAAKqe,KAAKF,GAvCG,EAwCb1gB,KAAKN,MAAMjG,SAAS+B,MAExBwE,KAAKN,MAAM6c,cAAc/gB,oCAGlB,IAAAoQ,EAAA5L,KACP,OACExF,OAAA6a,EAAA,EAAA7a,CAACqmB,GAAD,CACEC,UAAQ,EACRvL,IAAKvV,KAAK0T,SACVva,MAAO6G,KAAKN,MAAMxG,WAAWC,MAC7B+E,IAAK,SAAAjB,GAGH,MAAO,CAFQ2O,EAAKlM,MAAMF,MAAMvC,GACpB,UAAAJ,OAAa+O,EAAKlM,MAAMjG,SAAS+B,MAAjC,kBA7CGsX,IAAM6D,eAAzB8J,GAWGjL,aAAe,CACpBhW,MAtBS,cA+DEihB,UCxBA5M,cA3Cb,SAAAA,EAAYZ,GAAYzY,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA6T,GACtB7T,KAAKkT,EAAID,oDAGL,IACII,EAAQrT,KAAKkT,EAAEpZ,MAAMsZ,SAArBC,IACAra,EAAagH,KAAKkT,EAAExT,MAApB1G,SACF8a,EAAY9T,KAAKgU,YAAYX,EAAKra,GACxCgH,KAAKiU,aAAaH,uCAGRT,EAAKra,GACf,OAAQqa,GACN,IAAK,MACH,6CAAAxW,OAA8C7D,EAA9C,MACF,IAAK,QACH,OAAOgH,KAAKkU,aAAalb,GAC3B,IAAK,SACH,6CAAA6D,OAA8C7D,EAA9C,4CAIOA,GAAU,IAAA8W,EACQ9J,EAAchN,GADtB+W,EAAAvV,OAAA4L,EAAA,EAAA5L,CAAAsV,EAAA,GACdoB,EADcnB,EAAA,GACJoB,EADIpB,EAAA,GAEfoE,EAAe5R,KAAKK,IAAI5C,KAAKkT,EAAExT,MAAM/F,KAAO,EAAGwX,EAAW,GAC1D5V,EAAWgK,EAAe2L,GAC1BvV,EAAW,IAAMwY,EAAe,GAChCC,EAAW,GAAAvX,OAAMtB,EAAN,KAAAsB,OAAkBlB,GAEnC,6CAAAkB,OAA8CuX,EAA9C,2CAGWN,GACX,GAAKA,EAAL,CAEA,IAAMQ,EAAKC,SAASC,cAAcV,GAE9BQ,GAAMC,SAASE,gBAAkBH,GACnCA,EAAGI,kBC7BHqM,GAAiB,CAAE1N,IAAK,IAExBlV,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,oBAIGyiB,GAAb,SAAA/E,GAmBE,SAAA+E,IAAc,IAAA3Z,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAghB,IACZ3Z,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAwmB,GAAAvV,KAAAzL,QASFlG,MAAQ,CACNsZ,SAAU2N,GACVvlB,MAAO,QAZK6L,EAedgX,QAAUvL,IAAMoJ,YAbd7U,EAAK4Z,sBAAwB5Z,EAAK4Z,sBAAsBzI,KAA3Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IAC7BA,EAAKwY,aAAexY,EAAKwY,aAAarH,KAAlBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACpBA,EAAKuY,cAAgBvY,EAAKuY,cAAcpH,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAK+U,gBAAkB/U,EAAK+U,gBAAgB5D,KAArBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKiV,gBAAkB,IAAIzI,GAAJrZ,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKkV,cAAgBlV,EAAKkV,cAAc/D,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IAPTA,EAnBhB,OAAA7M,OAAAgiB,EAAA,EAAAhiB,CAAAwmB,EAAA/E,GAAAzhB,OAAAiiB,EAAA,EAAAjiB,CAAAwmB,EAAA,EAAA3N,IAAA,qBAAAla,MAAA,WAqCQ6G,KAAKN,MAAMzG,SAASM,eACtByG,KAAKsc,gBAAgB7I,QAtC3B,CAAAJ,IAAA,gBAAAla,MAAA,SA0CgBqC,GACRwE,KAAKlG,MAAM0B,QAAUA,GACvBwE,KAAK0Y,SAAS,CAAEld,YA5CtB,CAAA6X,IAAA,wBAAAla,MAAA,SAgDwBuG,EAAO5F,EAAO+iB,GAC9B7c,KAAKN,MAAMzG,SAASM,gBACtBsjB,EAAQnI,QACRmI,EAAQjJ,aAAeiJ,EAAQ1jB,MAAM4F,QAEvCiB,KAAK0Y,SAAS,CAAEtF,SAAU2N,OArD9B,CAAA1N,IAAA,kBAAAla,MAAA,SAwDkB+gB,GAAO,IACb7G,EAAQ6G,EAAR7G,IACRrT,KAAK0Y,SAAS,CAAEtF,SAAU,CAAEC,WA1DhC,CAAAA,IAAA,gBAAAla,MAAA,WA8DS6G,KAAKN,MAAMzG,SAASM,eACvByG,KAAKN,MAAMwhB,gCAA+B,KA/DhD,CAAA7N,IAAA,eAAAla,MAAA,SAmEe+gB,GACNla,KAAKqe,QAAQ1K,QAAQoM,SAAS7F,EAAM8F,gBACvChgB,KAAKN,MAAML,0BArEjB,CAAAgU,IAAA,SAAAla,MAAA,WA0EI,IAAK6G,KAAKN,MAAMzG,SAASS,OAAU,OAAO,KADnC,IAAAynB,EAGuBnhB,KAAKN,MAAMjG,SAAjC2nB,EAHDD,EAGCC,IAAKjU,EAHNgU,EAGMhU,KAAMvR,EAHZulB,EAGYvlB,OACXJ,EAAUwE,KAAKlG,MAAf0B,MAER,OACEhB,OAAA6a,EAAA,EAAA7a,CAAC6mB,GAAD,CACE9L,IAAKvV,KAAKqe,QACVngB,IAAG1D,OAAA8mB,GAAA,EAAA9mB,CAAE,CAAE4mB,MAAKjU,OAAM3R,QAAOI,WACzBwZ,UAAWpV,KAAKoc,gBAChB+D,QAASngB,KAAK4f,cACdQ,OAAQpgB,KAAK6f,cAEbrlB,OAAA6a,EAAA,EAAA7a,CAAC+mB,GAAD,CACEroB,WAAY8G,KAAKN,MAAMxG,WACvBO,SAAUuG,KAAKN,MAAMjG,SACrB8iB,cAAevc,KAAKuc,cACpB/c,MAAOD,GAAcC,QAEvBhF,OAAA6a,EAAA,EAAA7a,CAACylB,GAAD,CACE1mB,cAAeyG,KAAKN,MAAMzG,SAASM,cACnCmjB,QAAS1c,KAAKihB,sBACd1hB,cAAeA,UAhGzByhB,EAAA,CAAsClO,IAAM6D,eAA/BqK,GAcJxL,aAAe,CACpB/b,SAAU,GACV+nB,gBAAgB,GAgHpB,IAAMlE,GAAqB,CAAEje,wBAAuB6hB,+BhCxG7C,SAAwC3nB,GAC7C,MAAO,CACLsF,KAAM,oCACN7E,QAAST,KgCuGEikB,eA3Bf,SAAyB1jB,GAAO,IAAA2jB,EAe1B3jB,EAbFkC,OAEIhD,EAJwBykB,EAG1B3kB,WACEE,SAGAE,EAPwBukB,EAM1BxkB,SACEC,WAPwBuoB,EAAAhE,EAS1BjkB,iBAaJ,MAAO,CAAEC,SAtBqBgoB,EAUxBhoB,SAYaP,aAAYF,WAAUC,SALxB,CACfS,OAlB4B+nB,EAWxB/nB,OAQJH,cAnB4BkoB,EAYxBloB,iBAegC+jB,GAAzBE,CAA6CwD,aC1IxD7iB,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,mGAKoB,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YALtD,4BAMqB,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YANvD,eAOQ,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAMG,UAP1C,oBAWFmkB,GAAQlnB,OAAA4D,EAAA,EAAA5D,CAAA,UAAA6D,OAAA,aAAA7D,CAAA,gLAeI,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOS,QAAQE,OAfxC,MAmBR8jB,eAYJ,SAAAA,IAAc,IAAAta,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAA2hB,IACZta,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAAmnB,GAAAlW,KAAAzL,QAOFlG,MAAQ,CACN8nB,MAAO,EACPpmB,MAAO,EACPqmB,SAAU,EACVzD,YAAY,GAZA/W,EA+Bdya,eAAiBhb,EAAS,GAAI,SAACoT,GAC7B,IAAMqE,EAAQrE,EAAM0H,MAAQva,EAAKvN,MAAM8nB,MACvCva,EAAKqR,SAAS,CAAEmJ,SAAUtD,MA/B1BlX,EAAK0a,0BAA4B1a,EAAK0a,0BAA0BvJ,KAA/Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IACjCA,EAAKoX,wBAA0BpX,EAAKoX,wBAAwBjG,KAA7Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IAC/BA,EAAKqX,sBAAwBrX,EAAKqX,sBAAsBlG,KAA3Bhe,OAAAie,EAAA,EAAAje,CAAA6M,IAC7BA,EAAKya,eAAiBza,EAAKya,eAAetJ,KAApBhe,OAAAie,EAAA,EAAAje,CAAA6M,IALVA,kFAgBZ,GAAKrH,KAAKlG,MAAMskB,WAAhB,CAEA,IAGMhR,IAAUpJ,EAHChE,KAAKlG,MAAM+nB,SACXlE,GAAgB3d,KAAKlG,MAAM0B,MAC3BoiB,GAAgB5d,KAAKlG,MAAM0B,OACU,GAEtD,OAAO,SAACyB,GAAD,OAAWiB,WAAX,kCAGIkP,EAHJ,iBAISnQ,EAAMC,OAAOS,QAAQE,MAJ9B,uDAaeqc,GACtBla,KAAK8hB,eAAe5H,iDAGAA,GACpB,IAAMqE,EAAQrE,EAAM0H,MAAQ5hB,KAAKlG,MAAM8nB,MACjCpmB,EAAQwE,KAAKlG,MAAM0B,MAAQ+iB,EAEjCve,KAAKN,MAAMsiB,YAAYhiB,KAAKN,MAAM+F,MAAOjK,GACzCwE,KAAK0Y,SAAS,CAAEmJ,SAAU,EAAGzD,YAAY,IACzC7J,SAASsK,oBAAoB,YAAa7e,KAAKye,yBAC/ClK,SAASsK,oBAAoB,UAAW7e,KAAK0e,yEAGrBxE,GACxBA,EAAM6C,iBAEN/c,KAAK0Y,SAAS,CACZkJ,MAAO1H,EAAM0H,MACbpmB,MAAOwE,KAAKN,MAAMlE,MAClB4iB,YAAY,IAGd7J,SAASuK,iBAAiB,YAAa9e,KAAKye,yBAC5ClK,SAASuK,iBAAiB,UAAW9e,KAAK0e,wDAYnC,IAAA3I,EACkB/V,KAAKN,MAAtB+F,EADDsQ,EACCtQ,MAAOjK,EADRua,EACQva,MAEf,OACEhB,OAAA6a,EAAA,EAAA7a,CAACynB,GAAD,CACEC,WAAUzc,EACVwZ,UAAU,mBACV/gB,IAAKA,YAAF,SACQ1C,EADR,oBAKFiK,EACDjL,OAAA6a,EAAA,EAAA7a,CAACknB,GAAD,CACExjB,IAAK8B,KAAKmiB,mBACVjL,SAAS,KACTkI,YAAapf,KAAK+hB,0BAClB1C,YAAarf,KAAKoiB,0BAClB7C,UAAWvf,KAAKqiB,kCAtGFvP,IAAM6D,eAAxBgL,GAQGnM,aAAe,CACpBha,MRnD6B,KQ4JjC,IAAM8hB,GAAqB,CAAE0E,YNnJtB,SAAqBzmB,EAAUC,GACpC,GAAqB,kBAAVA,EACT,MAAM,IAAI6F,MAAM,yBAGlB,MAAO,CACLxC,KAAM,gBACN7E,QAAS,CAAEuB,WAAUC,MAAOwI,EAAMxI,EAAOmiB,GAAeC,QM8I7CJ,eAPf,SAAyB1jB,EAAO2lB,GAE9B,MAAO,CAAEjkB,MADK1B,EAAMsC,UAAUhB,UAAUqkB,EAASha,SAMX6X,GAAzBE,CAA6CmE,ICpJtDW,GAAG9nB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,oCAKHgkB,GAAW/nB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,iFAIW,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YAJ7C,4BAKY,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YAL9C,eAMD,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAMG,UANjC,KA0CFilB,OAjCf,SAAAzoB,GAAqC,IAAb0oB,EAAa1oB,EAAb0oB,UAmBtB,OACEjoB,OAAA6a,EAAA,EAAA7a,CAAC8nB,GAAD,CACEtD,WAAS,UAnBXxkB,OAAA6a,EAAA,EAAA7a,CAAC+nB,GAAD,CACErkB,IAAKA,YAAF,SACQ6f,GADR,qBAQL,IAAIjc,MAAM2gB,EAAU1jB,QAAQ2jB,KAAK,GAAGpb,IAAI,SAACqb,EAAGC,GAAJ,OACtCpoB,OAAA6a,EAAA,EAAA7a,CAACqoB,GAAD,CACExP,IAAKuP,EACLnd,MAAOgd,EAAUG,SC/BnBzkB,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,uHAqEKukB,OA3Df,SAAA/oB,GASG,IARDmb,EAQCnb,EARDmb,OACA8B,EAOCjd,EAPDid,SACAhe,EAMCe,EANDf,SACAwhB,EAKCzgB,EALDygB,QACAuI,EAIChpB,EAJDgpB,cACA5C,EAGCpmB,EAHDomB,QACA/K,EAECrb,EAFDqb,UACAlV,EACCnG,EADDmG,OAqBA,OACE1F,OAAA6a,EAAA,EAAA7a,CAACwoB,GAAD,CACEzN,IAAKL,EACL+N,YAAU,SACVC,gBAAelqB,EACfkF,IAvBa,WACf,IAAIsB,EAAQ,GAcZ,MAZsB,kBAAXU,IACTV,EAAQ,CACN2jB,WAAY,SACZC,aAAc,OACdC,SAAU,WAIVrM,IACFxX,EAAMnC,OAAS,oBAGVmC,EAQA8jB,GACLpM,SAAS,IACTsD,QAASA,EACTpF,UAAWA,EACX2N,cAAeA,EACf5C,QAASA,GAEVjgB,IChDQqjB,GAAb,SAAAtH,GAsBE,SAAAsH,EAAY7jB,GAAO,IAAA2H,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAujB,IACjBlc,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAA+oB,GAAA9X,KAAAzL,KAAMN,KACD6Y,cAAgBlR,EAAKkR,cAAcC,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAKmc,oBAAsBnc,EAAKmc,oBAAoBhL,KAAzBhe,OAAAie,EAAA,EAAAje,CAAA6M,IAC3BA,EAAKuY,cAAgBvY,EAAKuY,cAAcpH,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAK+U,gBAAkB/U,EAAK+U,gBAAgB5D,KAArBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKoc,SAAW/jB,EAAMwV,OANL7N,EAtBrB,OAAA7M,OAAAgiB,EAAA,EAAAhiB,CAAA+oB,EAAAtH,GAAAzhB,OAAAiiB,EAAA,EAAAjiB,CAAA+oB,EAAA,EAAAlQ,IAAA,qBAAAla,MAAA,WAgCI6G,KAAK3G,8BAhCT,CAAAga,IAAA,4BAAAla,MAAA,WAoCI,GAAK6G,KAAKN,MAAMsX,UACXhX,KAAKN,MAAMrG,0BAA0BC,SAA1C,CAF0B,IAIlBC,EAAkByG,KAAKN,MAAMrG,0BAA7BE,cACRyG,KAAKN,MAAMgkB,6BACX1jB,KAAK2jB,sBAAqB,EAAOpqB,MAzCrC,CAAA8Z,IAAA,uBAAAla,MAAA,SA4CuByqB,EAAkBrqB,GACrC,IAAMsqB,EAAY7jB,KAAKyjB,SAAS9P,QAAQsJ,wBAClCxjB,EAAWqqB,KAAKzU,MAAMyU,KAAKC,UAAUF,IAC3C7jB,KAAKN,MAAMikB,qBAAqBlqB,EAAUmqB,EAAkBrqB,KA/ChE,CAAA8Z,IAAA,gBAAAla,MAAA,WAmDI,IAAI6G,KAAKN,MAAMsX,SAEf,MAAO,CACL3Z,OAAQ,sBAtDd,CAAAgW,IAAA,gBAAAla,MAAA,WA2DI6G,KAAKN,MAAMV,cAAcgB,KAAKN,MAAM1G,YA3DxC,CAAAqa,IAAA,gBAAAla,MAAA,SA8DgB+gB,GACZA,EAAME,oBA/DV,CAAA/G,IAAA,sBAAAla,MAAA,SAkEsB+gB,GAClBA,EAAME,kBACNpa,KAAK2jB,sBAAqB,GAAO,KApErC,CAAAtQ,IAAA,kBAAAla,MAAA,SAAAY,GAuE2B,IAAPsZ,EAAOtZ,EAAPsZ,IACZ,CAAC,SAAU,aAAa1F,SAAS0F,IAClB,GAAKrT,KAAKN,MAAMQ,QAEpBnB,OAAS,GACpBiB,KAAKN,MAAMU,cAAcJ,KAAKN,MAAM1G,UAId,IAAfqa,EAAItU,QACbiB,KAAK2jB,sBAAqB,GAAM,KAjFtC,CAAAtQ,IAAA,SAAAla,MAAA,WAsFI,OACEsF,EAAAC,EAAAC,cAACqlB,GAAD,CACE9O,OAAQlV,KAAKyjB,SACbzqB,SAAUgH,KAAKN,MAAM1G,SACrBkH,OAAQF,KAAKN,MAAMQ,OACnBsa,QAASxa,KAAKuY,cACdwK,cAAe/iB,KAAKwjB,oBACpBrD,QAASngB,KAAK4f,cACdxK,UAAWpV,KAAKoc,gBAChBpF,SAAUhX,KAAKN,MAAMsX,eA/F7BuM,EAAA,CAA4BzQ,IAAM6D,eA6GlC,IAAM2G,GAAqB,CACzBld,iBACAujB,qBpCtEK,SAA8BlqB,EAAUmqB,EAAkBrqB,GAC/D,OAAO,SAAC0F,EAAUC,GAChB,IAAMpF,EAAQoF,IAKd,OAFAD,EAASL,EAFKglB,EAAmB,GAAK9pB,EAAMkC,OAAOlD,WAAWC,UAIvDoG,QAAQC,QACbH,EAAS,CACPJ,KAAM,yBACN7E,QAAS,CACPP,WACAC,QAAQ,EACRH,gBACAD,UAAU,QoCyDlB0F,gBACA0kB,2BpCtBK,WACL,MAAO,CACL7kB,KAAM,+BACN7E,QAAS,QoCsBEwjB,eAff,SAAyB1jB,EAAO2lB,GAC9B,IAAMzI,EAAWld,EAAMkC,OAAOlD,WAAWE,WAAaymB,EAASzmB,SACvDK,EAA8BS,EAAMkC,OAApC3C,0BACFuO,EAAO9N,EAAMoC,UAAUujB,EAASzmB,UAEtC,MAAO,CAAEkH,OADM0H,EAAOA,EAAK1H,OAAS,GACnB8W,WAAU3d,8BAUWikB,GAAzBE,CAA6C+F,ICpHtDplB,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,qEAIkB,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAMC,QAJpD,4BAKmB,SAAAqC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAMC,QALrD,kBASH,SAAS4mB,GAATlqB,GAA2E,IAAnDyB,EAAmDzB,EAAnDyB,MAAOI,EAA4C7B,EAA5C6B,OAAQ4e,EAAoCzgB,EAApCygB,QAASuI,EAA2BhpB,EAA3BgpB,cAAemB,EAAYnqB,EAAZmqB,SACpE,OACE1pB,OAAA6a,EAAA,EAAA7a,CAAC2pB,GAAD,CACElB,YAAU,SACVzI,QAASA,EACTuI,cAAeA,EACf7kB,IAAG1D,OAAA8mB,GAAA,EAAA9mB,CAAE,CACHgB,QACAI,OAAQA,GAAUA,KAGnBsoB,GAaPD,GAAazO,aAAe,CAC1Bha,MZ5C+B,KYsDlBgiB,mBAPf,SAAyB1jB,EAAO2lB,GAAU,IAAA2E,EACX3E,EAASzmB,SAASkN,MAAM,KADbme,EAAA7pB,OAAA4L,EAAA,EAAA5L,CAAA4pB,EAAA,GACjC7oB,EADiC8oB,EAAA,GACvB1oB,EADuB0oB,EAAA,GAIxC,MAAO,CAAE7oB,MAFK1B,EAAMsC,UAAUhB,UAAUG,GAExBK,OADD9B,EAAMsC,UAAUf,WAAWM,KAI7B6hB,CAAyByG,ICJzBK,eApCb,SAAAA,IAAc,IAAAjd,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAskB,IACZjd,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAA8pB,GAAA7Y,KAAAzL,QAHFyjB,SAAW3Q,IAAMoJ,YAIf7U,EAAKkR,cAAgBlR,EAAKkR,cAAcC,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAKmc,oBAAsBnc,EAAKmc,oBAAoBhL,KAAzBhe,OAAAie,EAAA,EAAAje,CAAA6M,IAHfA,4EAMD,IAAAuE,EAAA5L,KACXiH,WAAW,kBAAM2E,EAAK6X,SAAS9P,QAAQe,SAAS,2CAIhD1U,KAAKukB,2DAILvkB,KAAKukB,8CAGE,IACCvrB,EAAagH,KAAKN,MAAlB1G,SAER,OACEyF,EAAAC,EAAAC,cAAC6lB,GAAD,CACEhK,QAASxa,KAAKuY,cACdwK,cAAe/iB,KAAKwjB,oBACpBxqB,SAAUA,GAEVyF,EAAAC,EAAAC,cAAC8lB,GAAD,CACEzrB,SAAUA,EACVkc,OAAQlV,KAAKyjB,mBArCE3Q,IAAM6D,eCEzB2L,GAAG9nB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,oCAmCMmmB,OA9Bf,SAAA3qB,GAA2C,IAAxB4qB,EAAwB5qB,EAAxB4qB,UAAWlC,EAAa1oB,EAAb0oB,UAa5B,OACEhkB,EAAAC,EAAAC,cAACimB,GAAD,CACE5F,WAAU2F,GAEVlmB,EAAAC,EAAAC,cAACkmB,GAAD,CACEpf,MAAOkf,IAhBX,IAAI7iB,MAAM2gB,EAAU1jB,QAAQ2jB,KAAK,GAAGpb,IAAI,SAACqb,EAAGC,GAC1C,IAAM5pB,EAAQ,GAAA6D,OAAM4lB,EAAUG,GAAhB,KAAA/lB,OAAsB8nB,GACpC,OACElmB,EAAAC,EAAAC,cAACmmB,GAAD,CACEzR,IAAKuP,EACL5pB,SAAUA,QCuBpB,IAAMc,GAAQ,CACZua,GAAI,cACJ0Q,QAAS,OACTzO,QAAS,CACP1c,QAAS,KACTD,KAAM,KACN0Z,IAAK,KACLnC,SAAU,KACVC,SAAU,KACViD,YAAa,KACb4Q,YAAY,GAEdC,OAAQ,CACNC,KAAM,CACJC,GAAI,CACFC,WAAc,CACZC,QAAS,CAAC,gBAAiB,sBAC3BhnB,OAAQ,iBAIdinB,YAAa,CACXC,OAAQ,CACNC,IApCR,SAAyBC,GACvB,OAAKA,EAAIrR,YAEF,IAAIjV,QAAQ,SAAAC,GACjB6H,WAAW,WACT,IAAMoN,EAAE,mBAAAxX,OAAsB4oB,EAAIrR,YAA1B,MACFxM,EAAO2M,SAASC,cAAcH,GAChCzM,GAAQA,EAAK8M,QACjBtV,GAAQ,IACP,KAR0BD,QAAQC,SAAQ,IAoCzCsmB,OAAQ,CACNL,QAAS/P,aAAO,CAAE0P,WAAY,SAACS,EAAKvL,GAAN,OAAgBA,EAAMhf,QACpDmD,OAAQ,YAOZgnB,GAAU,CACdA,QAAS,CACPM,cAAerQ,aAAO,SAACmQ,EAADvrB,GAA4B,IAApBmZ,EAAoBnZ,EAApBmZ,IAAoBvD,EACnB9J,EADmB9L,EAAflB,UAAe+W,EAAAvV,OAAA4L,EAAA,EAAA5L,CAAAsV,EAAA,GAEhD,MAAO,CAAEoB,SAFuCnB,EAAA,GAE7BoB,SAF6BpB,EAAA,GAEnBsD,SAE/BuS,mBAAoBtQ,aAAO,CACzBlB,YAAa,SAACqR,GACZ,OA/ER,SAAA1rB,GAAuE,IAA1CJ,EAA0CI,EAA1CJ,KAAMC,EAAoCG,EAApCH,QAASuX,EAA2BpX,EAA3BoX,SAAUD,EAAiBnX,EAAjBmX,SACpD,OADqEnX,EAAPsZ,KAE5D,IAAK,UACHlC,EAAW5O,KAAKC,IAAI,EAAG2O,EAAW,GAClC,MACF,IAAK,aACHD,EAAW3O,KAAKK,IAAIhJ,EAAU,EAAGsX,EAAW,GAC5C,MACF,IAAK,YACL,IAAK,QACHC,EAAW5O,KAAKK,IAAIjJ,EAAO,EAAGwX,EAAW,GACzC,MACF,IAAK,YACHD,EAAW3O,KAAKC,IAAI,EAAG0O,EAAW,GAClC,MACF,QACE,OAAO,KAGX,IAAM3V,EAAWgK,EAAe2L,GAC1BvV,EAAW,IAAMwV,EAAW,GAElC,SAAAtU,OAAUtB,EAAV,KAAAsB,OAAsBlB,GAyDTkqB,CAAkBJ,QAuBlBK,OAjBf,SAA+BnsB,EAAMC,GACnC,IAAMmsB,EAAUvrB,OAAAC,EAAA,EAAAD,CAAA,GACXV,GAAMwc,QADK,CAEd1c,UACAD,SAGF,OAAOqsB,aAAQlsB,GAAOurB,GAASU,ICpF3BE,GAAIzrB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,aAAA7D,CAAA,mGAMgB,SAAAkF,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YANlD,0BAOiB,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YAPnD,2BAQkB,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YARpD,4BASmB,SAAAoC,GAAK,OAAIA,EAAMzC,MAAMC,OAAOE,MAAME,YATrD,8CAiBG4oB,GAAb,SAAAjK,GAOE,SAAAiK,EAAYxmB,GAAO,IAAA2H,EAAA,OAAA7M,OAAAuF,EAAA,EAAAvF,CAAAwF,KAAAkmB,IACjB7e,EAAA7M,OAAA+Q,EAAA,EAAA/Q,CAAAwF,KAAAxF,OAAAgR,EAAA,EAAAhR,CAAA0rB,GAAAza,KAAAzL,KAAMN,KAMRymB,mBAAqBL,GAAsBze,EAAK3H,MAAM/F,KAAM0N,EAAK3H,MAAM9F,SAPpDyN,EAQnB+e,aAAe7I,aAAUlW,EAAK8e,oBARX9e,EASnBgf,QAAUvT,IAAMoJ,YAPd7U,EAAKkR,cAAgBlR,EAAKkR,cAAcC,KAAnBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACrBA,EAAK+U,gBAAkB/U,EAAK+U,gBAAgB5D,KAArBhe,OAAAie,EAAA,EAAAje,CAAA6M,IACvBA,EAAKob,UAAYxe,EAAevE,EAAM9F,SAJrByN,EAPrB,OAAA7M,OAAAgiB,EAAA,EAAAhiB,CAAA0rB,EAAAjK,GAAAzhB,OAAAiiB,EAAA,EAAAjiB,CAAA0rB,EAAA,EAAA7S,IAAA,oBAAAla,MAAA,WAmBI6G,KAAKomB,aAAaE,QAClBtmB,KAAKN,MAAMV,cAAc,OACzBgB,KAAKumB,aArBT,CAAAlT,IAAA,uBAAAla,MAAA,WAyBI6G,KAAKomB,aAAaI,SAzBtB,CAAAnT,IAAA,WAAAla,MAAA,WA6BI,IAAMmb,EAAKC,SAASC,cAAc,yBAClCF,GAAMA,EAAGI,UA9Bb,CAAArB,IAAA,gBAAAla,MAAA,SAiCgB+gB,GACZA,EAAME,oBAlCV,CAAA/G,IAAA,kBAAAla,MAAA,SAqCkB+gB,GACdA,EAAME,kBACNF,EAAM6C,iBAEe7C,EAAM7b,OAAOooB,QAA1BztB,UAGNgH,KAAK0mB,UAAUxM,EAAM7G,IAAK6G,EAAM7b,OAAOooB,QAAQztB,YA5CrD,CAAAqa,IAAA,YAAAla,MAAA,SAgDYka,EAAKra,GACbgH,KAAKomB,aAAaO,KAAK,CAAE9nB,KAAM,aAAcwU,MAAKra,eAjDtD,CAAAqa,IAAA,qBAAAla,MAAA,SAoDqBypB,GACjB,OACEnkB,EAAAC,EAAAC,cAACioB,GAAD,CACEvT,IAAKuP,EACLjpB,KAAMqG,KAAKN,MAAM/F,KACjB8oB,UAAWziB,KAAKyiB,cAzDxB,CAAApP,IAAA,iBAAAla,MAAA,SA8DiBwrB,GACb,OACElmB,EAAAC,EAAAC,cAACkoB,GAAD,CACExT,IAAKsR,EACLA,UAAWA,EACXlC,UAAWziB,KAAKyiB,cAnExB,CAAApP,IAAA,aAAAla,MAAA,WAwEe,IAAAyS,EAAA5L,KACX,OAAO,IAAI8B,MAAM9B,KAAKN,MAAM/F,KAAO,GAAG+oB,KAAK,GAAGpb,IAAI,SAACqb,EAAGC,GACpD,OAAU,IAANA,EACKhX,EAAKkb,mBAAmBlE,GAExBhX,EAAKmb,eAAenE,OA7EnC,CAAAvP,IAAA,SAAAla,MAAA,WAmFI,OACEsF,EAAAC,EAAAC,cAACsnB,GAAD,CACE1Q,IAAKvV,KAAKqmB,QACVW,aAAW,MACXxM,QAASxa,KAAKuY,cACdnD,UAAWpV,KAAKoc,iBAEfpc,KAAKinB,kBA1Fdf,EAAA,CAA2BpT,IAAM6D,eAqG3BuQ,GAAqB,CAAEloB,iBAEdwe,eAPS,SAAC1jB,GAAU,IAAA2jB,EACP3jB,EAAMkC,OAChC,MAAO,CAAErC,KAFwB8jB,EACzB9jB,KACOC,QAFkB6jB,EACnB7jB,UAMwBstB,GAAzB1J,CAA6C0I,IChItD/nB,GAAI3D,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,qDAMJ4oB,GAAO3sB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,mCAKP6oB,GAAK5sB,OAAA4D,EAAA,EAAA5D,CAAA,MAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,yBAIL4Y,GAAE3c,OAAA4D,EAAA,EAAA5D,CAAA,MAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,oCAKFsY,GAAErc,OAAA4D,EAAA,EAAA5D,CAAA,MAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,UAAAC,OAAA,oBA0BO8oB,OAtBf,WACE,OACE5oB,EAAAC,EAAAC,cAAC2oB,GAAD,KACE7oB,EAAAC,EAAAC,cAACwoB,GAAD,KACE1oB,EAAAC,EAAAC,cAACyoB,GAAD,4BACA3oB,EAAAC,EAAAC,cAAC4oB,GAAD,KACE9oB,EAAAC,EAAAC,cAAC6oB,GAAD,gBACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,YACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,eACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,cACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,YACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,YACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,YACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,cACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,aACA/oB,EAAAC,EAAAC,cAAC6oB,GAAD,gBChCJC,GAASjtB,OAAA4D,EAAA,EAAA5D,CAAA,OAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,2FAOTmpB,GAAIltB,OAAA4D,EAAA,EAAA5D,CAAA,QAAA6D,OAAA,YAAA7D,CAAA,CAAA8D,KAAA,SAAAC,OAAA,oBAuBKopB,OAnBf,WACE,OACElpB,EAAAC,EAAAC,cAAC8oB,GAAD,KACEhpB,EAAAC,EAAAC,cAAC+oB,GAAD,KACEjpB,EAAAC,EAAAC,cAACipB,GAAD,MACAnpB,EAAAC,EAAAC,cAAA,OAAKkpB,yBAAA,EAAsB3Q,SAAS,MACpCzY,EAAAC,EAAAC,cAACmpB,EAAD,MACArpB,EAAAC,EAAAC,cAACopB,GAAD,MACAtpB,EAAAC,EAAAC,cAACqpB,GAAD,MACAvpB,EAAAC,EAAAC,cAACspB,GAAD,SCNO9pB,OAbf,WACE,OACEM,EAAAC,EAAAC,cAACupB,EAAA,EAAD,CAAUroB,MAAOhE,GACf4C,EAAAC,EAAAC,cAACwpB,EAAA,EAAD,KACE1pB,EAAAC,EAAAC,cAACypB,EAAA,EAAD,CAAenrB,MAAOA,GACpBwB,EAAAC,EAAAC,cAAC0W,EAAA,EAAD,CAAQ9W,OAAQN,IAChBQ,EAAAC,EAAAC,cAAC0pB,GAAD,UCPU1hB,QACW,cAA7B2hB,OAAOtvB,SAASuvB,UAEe,UAA7BD,OAAOtvB,SAASuvB,UAEhBD,OAAOtvB,SAASuvB,SAAS3hB,MACvB,2DCbN4hB,IAASC,OAAOhqB,EAAAC,EAAAC,cAAC+pB,GAAD,MAAUnU,SAASoU,eAAe,SD4H5C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,KAAK,SAAAC,GACjCA,EAAaC","file":"static/js/main.8cc2cde9.chunk.js","sourcesContent":["import { createReducer } from 'redux-starter-kit'\n\nexport const INITIAL_STATE = {\n  activeCell: {\n    entered: '',\n    location: '',\n  },\n  inputter: {\n    valueEvent: {\n      value: '',\n      cursorPos: 0,\n    }\n  },\n  scheduledFloatingInputter: {\n    willOpen: false,\n    isInteractive: false,\n  },\n  floatingInputter: {\n    cellRect: {},\n    isOpen: false,\n    isInteractive: false,\n  },\n  rows: 30,\n  columns: 10,\n}\n\nexport default createReducer(INITIAL_STATE, {\n  'SET_TABLE_DIMENSIONS': (state, { payload }) => {\n    state.rows = payload.rows\n    state.columns = payload.columns\n  },\n  \n  'SET_ACTIVE_CELL': (state, { payload }) => {\n    state.activeCell = payload\n  },\n\n  'SCHEDULE_FLOATING_INPUTTER': (state, { payload }) => {\n    const { isInteractive } = payload\n\n    state.scheduledFloatingInputter = {\n      willOpen: true,\n      isInteractive,\n    }\n  },\n\n  'UNSCHEDULE_FLOATING_INPUTTER': (state) => {\n    state.scheduledFloatingInputter = {\n      willOpen: false,\n      isInteractive: false,\n    }\n  },\n\n  'OPEN_FLOATING_INPUTTER': (state, { payload }) => {\n    state.floatingInputter = { ...state.floatingInputter, ...payload }\n  },\n\n  'SET_FLOATING_INPUTTER_INTERACTIVE': (state, { payload }) => {\n    state.floatingInputter = { ...state.floatingInputter, isInteractive: payload }\n  },\n\n  'CLOSE_FLOATING_INPUTTER': (state) => {\n    state.floatingInputter.isOpen = false\n  },\n\n  'SET_INPUTTER_VALUE_EVENT': (state, { payload }) => {\n    state.inputter.valueEvent = payload\n  },\n\n  'RESET_FLOATING_INPUTTER': (state, { payload }) => {\n    state.floatingInputter = { ...state.floatingInputter, ...payload }\n  },\n})\n\n","import { createReducer } from 'redux-starter-kit'\n\n\nconst INITIAL_STATE = {}\n\nexport default createReducer(INITIAL_STATE, {\n  'SET_CELL_DATA': (state, { payload }) => {\n    const { location, data } = payload\n    state[location] = data\n  },\n\n  'DELETE_CELL_DATA': (state, { payload }) => {\n    delete state[payload]\n  }\n})\n","import { createReducer } from 'redux-starter-kit'\n\nconst INITIAL_STATE = {\n  colWidths: {},\n  rowHeights: {},\n}\n\nexport default createReducer(INITIAL_STATE, {\n\n  'SET_COL_WIDTH': (state, { payload }) => {\n    const { colLabel, width } = payload\n    const { colWidths } = state\n    state.colWidths = { ...colWidths, [colLabel]: width }\n  },\n\n  'SET_ROW_HEIGHT': (state, { payload }) => {\n    const { rowLabel, height } = payload\n    const { rowHeights } = state\n    state.rowHeights = { ...rowHeights, [rowLabel]: height }\n  },\n\n})\n","import { configureStore } from 'redux-starter-kit'\n\nimport globalReducer from './globalReducer'\nimport tableDataReducer from './tableDataReducer'\nimport tableMetaReducer from './tableMetaReducer'\n\n\nconst appStoreGen = () => (\n  configureStore({\n    reducer: {\n      global: globalReducer,\n      tableData: tableDataReducer,\n      tableMeta: tableMetaReducer,\n    }\n  })\n)\n\nconst appStore = appStoreGen()\n\n\nexport default appStore\nexport { appStoreGen }\n","const colors = {\n  text: '#3D3D3D',\n  table: {\n    border: '#dfdfdf',\n    borderDark: '#CCC',\n    labelBkg: '#F5F5F5'\n  },\n  dropdown: {\n    normal: '#fafafa',\n    active: '#ebebeb',\n  },\n  primary: {\n    strong: '#E10D75',\n    light: 'salmon',\n  },\n  field: {\n    background: '#F0F0F0',\n  },\n  shadow: '#939393',\n}\n\nconst breaks = {\n  xs: 0,\n  sm: 420,\n  md: 900,\n  lg: 1200,\n}\n\nconst breakBump = {\n  xs: 'sm',\n  sm: 'md',\n  md: 'lg',\n}\n\nconst queries = {\n  xs: `@media (max-width: ${breaks.sm - 1}px)`,\n  sm: `@media (min-width: ${breaks.sm}px) and (max-width: ${breaks.md - 1}px)`,\n  md: `@media (min-width: ${breaks.md}px) and (max-width: ${breaks.lg - 1}px)`,\n  lg: `@media (min-width: ${breaks.lg}px)`,\n  from: (breakPoint) => (`@media (min-width: ${breaks[breakPoint]}px)`),\n  upTo: (breakPoint) => (`@media (max-width: ${breaks[ breakBump[breakPoint] ] - 1}px)`),\n}\n\nconst theme = {\n  colors,\n  breaks,\n  queries,\n}\n\nexport default theme\n","/* @jsx jsx */\nimport { jsx, css } from '@emotion/core'\n\nimport theme from './theme'\n\n\nconst globalStyles = css`\n  body {\n    color: ${theme.colors.text};\n    line-height: 1.3em;\n    font-family: Arial, Helvetica, sans-serif;\n  }\n\n  table, th, td {\n    border: 0;\n    border-spacing: 0;\n    border-collapse: collapse;\n  }\n\n  td {\n    padding: 0;\n    line-height: 1.2em;\n  }\n\n  pre, p, h1, h2, h3, h4, h5, h6 {\n    margin: 0;\n  }\n\n  ul, li {\n    margin: 0;\n    padding: 0;\n  }\n`\n\nexport default globalStyles\n","import React from 'react'\nimport styled from '@emotion/styled'\n\n\nconst Root = styled.header`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 30px 0 30px;\n`\n\nfunction Header() {\n  return (\n    <Root>\n      <h3>Spreadsheet App</h3>\n    </Root>\n  )\n}\n\nexport default Header\n","import { createAction } from 'redux-starter-kit'\n\n\nexport function setTableDimensions(rows, columns) {\n  return {\n    type: 'SET_TABLE_DIMENSIONS',\n    payload: {\n      rows,\n      columns,\n    }\n  }\n}\n\nexport function setInputterValueEvent(value, cursorPos) {\n  return {\n    type: 'SET_INPUTTER_VALUE_EVENT',\n    payload: {\n      value,\n      cursorPos: cursorPos === undefined\n        ? value.length\n        : cursorPos\n    }\n  }\n}\n\nexport function setActiveCell(location) {\n  return (dispatch, getState) => {\n    const cellData = getState().tableData[location]\n    const entered = (cellData || {}).entered || ''\n\n    dispatch(setInputterValueEvent(entered, entered.length))\n\n    return Promise.resolve(\n      dispatch({\n        type: 'SET_ACTIVE_CELL',\n        payload: {\n          entered,\n          location,\n        }\n      })\n    )\n  }\n}\n\nexport function setFloatingInputterInteractive(isInteractive) {\n  return {\n    type: 'SET_FLOATING_INPUTTER_INTERACTIVE',\n    payload: isInteractive\n  }\n}\n\nexport function openFloatingInputter(cellRect, willReplaceValue, isInteractive) {\n  return (dispatch, getState) => {\n    const state = getState()\n    const value = willReplaceValue ? '' : state.global.activeCell.entered\n\n    dispatch(setInputterValueEvent(value))\n\n    return Promise.resolve(\n      dispatch({\n        type: 'OPEN_FLOATING_INPUTTER',\n        payload: {\n          cellRect,\n          isOpen: true,\n          isInteractive,\n          willOpen: false,\n        }\n      })\n    )\n  }\n}\n\nexport function resetInputterValueEvent() {\n  return (dispatch, getState) => {\n    const location = getState().global.activeCell.location\n    const cellData = getState().tableData[location]\n    const entered = (cellData || {}).entered || ''\n\n    dispatch(setInputterValueEvent(entered))\n  }\n}\n\nexport function scheduleFloatingInputter(isInteractive) {\n  return (dispatch, getState) => {\n    const { floatingInputter } = getState().global\n\n    if (floatingInputter.isOpen && floatingInputter.isInteractive === isInteractive) {\n      return\n    }\n\n    return Promise.resolve(\n      dispatch({\n        type: 'SCHEDULE_FLOATING_INPUTTER',\n        payload: {\n          isInteractive\n        },\n      })\n    )\n  }\n}\n\nexport function unscheduleFloatingInputter() {\n  return {\n    type: 'UNSCHEDULE_FLOATING_INPUTTER',\n    payload: null,\n  }\n}\n\nexport const closeFloatingInputter = createAction('CLOSE_FLOATING_INPUTTER')\n","\n/* @jsx jsx */\nimport React from 'react' // eslint-disable-line\nimport { jsx, css } from '@emotion/core'\n\n\nconst style = () => css`\n  border: 0;\n  display: flex;\n  font-size: 13px;\n  height: unset;\n  padding: 0 8px;\n`\nconst props = {\n  'data-inputter': 'bar',\n}\n\nexport default { style, props }\n","import appStore from '~/reducers/'\nimport { clearCellData, replaceCellData } from '~/actions/tableDataActions'\n\n\nclass ReduxConnect {\n  constructor(store=appStore) {\n    const { global: globalState } = store.getState()\n    this.store = store\n    this.rows = globalState.rows\n    this.columns = globalState.columns\n  }\n\n  get tableData() {\n    return this.store.getState().tableData\n  }\n\n  get locations() {\n    return Object.keys(this.tableData)\n  }\n\n  getCellResult(location) {\n    const data = this.tableData[location]\n    return data && data.result\n  }\n\n  replaceCellData(location, entered, result) {\n    this.store.dispatch(replaceCellData(location, entered, result))\n  }\n\n  clearCell(location) {\n    this.store.dispatch(clearCellData(location))\n  }\n}\n\nexport default ReduxConnect\nexport { appStore }\n","import graph from '~/formulas/graph'\nimport Interpreter from '../formulas/Interpreter'\n\n\nexport function setCellData(location, entered) {\n  const interpreter = new Interpreter(location)\n  const result = interpreter.interpret(entered)\n\n\n  return {\n    type: 'SET_CELL_DATA',\n    payload: { location, data: { entered, result } },\n  }\n}\n\nexport function replaceCellData(location, entered, result) {\n  return {\n    type: 'SET_CELL_DATA',\n    payload: { location, data: { entered, result } },\n  }\n}\n\nexport function clearCellData(location) {\n  return (dispatch, getState) => {\n    const value = getState().tableData[location]\n\n    graph.delVertex(location)\n\n    if (value === undefined) {\n      return Promise.resolve()\n    }\n\n\n    return Promise.resolve(dispatch({\n      type: 'DELETE_CELL_DATA',\n      payload: location,\n    }))\n  }\n}\n","class Token {\n  constructor(type, text, whitespace, category, index) {\n    this.type = type\n    this.category = category\n    this.text = text\n    this.whitespace = whitespace\n    this.index = index\n    this.value = null\n    this.html = null\n  }\n}\n\nexport default Token\n","function testArgsAllNumbers(args) {\n  args.forEach(arg => {\n    if (typeof arg !== 'number') {\n      throw new TypeError(`Function argument not a number: ${arg}`)\n    }\n  })\n}\n\nconst Fn = {\n  AVERAGE: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      return Fn.SUM.fn(...args) / Fn.COUNT.fn(...args)\n    },\n    definition: 'AVERAGE(value1, value2, ...)',\n    example: 'AVERAGE(A1:B3, 3)',\n    summary: 'Returns the average from a series of numbers.',\n  },\n\n  CONCAT: {\n    fn: (...args) => {\n      let result = []\n\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      for (let arg of args) {\n        if (typeof arg !== 'string') {\n          throw new Error(`Element is not a string: ${arg}`)\n        }\n\n        result.push(arg)\n      }\n\n      return result.join('')\n    },\n    definition: 'CONCAT(\"text1\", \"text2\", ...)',\n    example: 'CONCAT(\"one\", \"two\")',\n    summary: 'Returns a single concatenated string from a series of strings.',\n  },\n\n  COUNT: {\n    fn: (...args) => args.length,\n    definition: 'COUNT(element1, element2, ...)',\n    example: 'COUNT(A1:B3, 2, C4)',\n    summary: 'Returns the number of non-empty elements in a set.',\n  },\n\n  MAX: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      testArgsAllNumbers(args)\n      return Math.max(...args)\n    },\n    definition: 'MAX(value1, value2, ...)',\n    example: 'MAX(A1:B3, 4, C3)',\n    summary: 'Returns the maximum value from a series of numbers',\n  },\n\n  MIN: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      testArgsAllNumbers(args)\n      return Math.min(...args)\n    },\n    definition: 'MIN(value1, value2, ...)',\n    example: 'MIN(A1:B3, 4, C3)',\n    summary: 'Returns the minimum value from a series of numbers.',\n  },\n\n  POWER: {\n    fn: (...args) => {\n      if (args.length !== 2) {\n        throw new Error('Formula takes only two elements')\n      }\n\n      testArgsAllNumbers(args)\n      const [base, exp] = args\n      return Math.pow(base, exp)\n    },\n    definition: 'POWER(base, exponent)',\n    example: 'POWER(A3,2)',\n    summary: 'Returns a number raised to an exponent.'\n  },\n\n  SQRT: {\n    fn: (...args) => {\n      if (args.length !== 1) {\n        throw new Error(`Formula takes only one element`)\n      }\n\n      testArgsAllNumbers(args)\n      return Math.sqrt(args[0])\n    },\n    definition: 'SQRT(value)',\n    example: 'SQRT(9) or SQRT(A3)',\n    summary: 'Returns the square root of a number.'\n  },\n\n  SUM: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      testArgsAllNumbers(args)\n      return args.reduce((prev, curr) => (curr + prev), 0)\n    },\n    definition: 'SUM(value1, value2, ...)',\n    example: 'SUM(A1:B3, 3, C5)',\n    summary: 'Retuns the sum from a series of numbers.',\n  }\n}\n\n// aliases\nFn.AVG = {\n  ...Fn.AVERAGE,\n  definition: 'AVG(value1, value2, ...)',\n  example: 'AVG(A1:B3, 3)',\n}\n\nFn.POW = {\n  ...Fn.POWER,\n  definition: 'POW(base, exponent)',\n  example: 'POW(A3,2)',\n}\n\nexport default Fn\n","const BASE_CODE_POINT = 'A'.codePointAt(0)\n\nexport function buildUrl(baseUrl, query={}) {\n  const urlQuery = Object.entries(query).map(([key, val]) => `${key}=${val}`).join('&')\n  return [baseUrl.trim(), urlQuery].join('?')\n}\n\nexport function clamp(value, min, max) {\n  return Math.min( Math.max(value, min), max )\n}\n\nexport function getRangeArray(min, max, isString=false) {\n  const range = []\n\n  for (let num = min; num <= max; num++) {\n    range.push( isString ? num.toString() : num )\n  }\n\n  return range\n}\n\nexport const sleep = (ms) => new Promise(resolve => setTimeout(() => resolve(), ms))\n\nexport function getColumnNames(cols) {\n  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n  let names = []\n  let prevNames = ['']\n  let remainCols = cols\n\n  while (remainCols > 0) {\n    const newNames = []\n\n    outerLoop:\n    for (let colName of prevNames) {  \n      for (let letter of alphabet) {\n        if (remainCols === 0)  { break outerLoop }\n        newNames.push(`${colName}${letter}`)\n        remainCols -= 1\n      }\n    }\n\n    prevNames = newNames\n    names = [...names, ...newNames]\n  }\n\n  return names\n}\n\nexport function getCellNames(rows, cols) {\n  const names = []\n  let colNames = getColumnNames(cols)\n\n  for (let row=1; row <= rows; row++) {\n    for (let col of colNames) {\n      names.push(`${col}-${row}`)\n    }\n  }\n\n  return names\n}\n\nexport function getColumnPosition(colLabel) {\n  const letters = colLabel.split('')\n  const oneBase = letters.reduce((prev, letter) => (\n    prev * 26 + letter.charCodeAt(0) - BASE_CODE_POINT + 1\n  ), 0)\n\n  return oneBase - 1\n}\n\nexport function getColumnLabel(num) {\n  const label = []\n  const basePoint = BASE_CODE_POINT\n  let curr = num + 1\n\n  do {\n    curr -= 1\n    const letterPosition = curr % 26\n    const codePoint = basePoint + letterPosition\n    const letter = String.fromCodePoint(codePoint)\n    label.push(letter)\n\n    curr = Math.floor(curr / 26)\n  } while (curr > 0)\n\n  return label.reverse().join('')\n}\n\nexport function parseLocation(location) {\n  let [col, row] = location.split('-')\n  const colIndex = getColumnPosition(col)\n  const rowIndex = +row - 1\n\n  return [colIndex, rowIndex]\n}\n\nexport function isNumber(numStr) {\n  const isPeriodsAndDigits = Boolean(numStr.match(/^[.\\d]+$/))\n  const periodCount = (numStr.match(/\\./g) || []).length\n\n  if (!isPeriodsAndDigits) { return false }\n  if (periodCount > 1) { return false }\n  if (numStr.length === 1 && numStr[0] === '.') { return false }\n  return true\n}\n\nexport function debounce(time, fn) {\n  let timeout\n\n  return (...args) => {\n    if (timeout) { return }\n\n    fn(...args)\n\n    timeout = setTimeout(() => {\n      clearTimeout(timeout)\n      timeout = null\n    }, time)\n  }\n}\n\n","import { TOKENS as t } from './Lexer'\nimport formulaFuncs from './formulaFunctions'\nimport { isNumber } from '~/library/utils'\n\n\nclass TokenSanitizer {\n  constructor(tokens) {\n    this.tokens = tokens\n  }\n\n  sanitize() {\n    return this.tokens.map(token => {\n      switch(token.type) {\n        case t.NUMBER:\n          return this.number(token)\n        case t.CELL:\n          return this.cell(token)\n        case t.FUNCTION:\n          return this.function(token)\n        case t.STRING:\n          return this.string(token)\n        default:\n          return token\n      }\n    })\n  }\n\n  number(token) {\n    if (!isNumber(token.text)) {\n      token.type = t.UNKNOWN\n      return token\n    }\n\n    token.value = parseFloat(token.text)\n    return token\n  }\n\n  cell(token) {\n    token.value = this.getCellLabel(token)\n    return token\n  }\n\n  function(token) {\n    const fn = this.getFunction(token)\n    \n    if (fn) {\n      token.value = fn\n    } else {\n      token.type = t.UNKNOWN\n    }\n\n    return token\n  }\n\n  string(token) {\n    token.value = token.text.slice(1, -1)\n    return token\n  }\n\n  getCellLabel(token) {\n    const { text } = token\n    const { index } = text.match(/\\d+/)\n    const col = text.slice(0, index).toUpperCase()\n    const row = text.slice(index)\n    return `${col}-${row}`\n  }\n\n  getFunction(token) {\n    const fnName = token.text.toUpperCase()\n    const fnNode = formulaFuncs[fnName]\n    return fnNode && fnNode.fn\n  }\n}\n\nexport default TokenSanitizer\n","class LexerRule {\n  constructor(regex, groupIndex, token, category) {\n    this.regex = regex\n    this.groupIndex = groupIndex\n    this.token = token\n    this.category = category\n  }\n\n  setIndex(index) {\n    this.regex.lastIndex = index\n  }\n\n  test(input) {\n    return this.regex.exec(input)\n  }\n}\n\nexport default LexerRule\n","import Token from './Token'\nimport TokenSanitizer from './TokenSanitizer'\nimport LexerRule from './LexerRule'\nimport { isNumber } from '~/library/utils'\n\n\nconst TOKENS = {\n  // internal\n  EOF: 'EOF',\n  // structure\n  EQUALS: 'EQUALS',\n  COMMA: 'COMMA',\n  COLON: 'COLON',\n  LPAREN: 'LPAREN',\n  RPAREN: 'RPAREN',\n  // operators\n  PLUS: 'PLUS',\n  MINUS: 'MINUS',\n  MULT: 'MULT',\n  DIV: 'DIV',\n  // entities\n  TEXT: 'TEXT',\n  CELL: 'CELL',\n  STRING: 'STRING',\n  NUMBER: 'NUMBER',\n  FUNCTION: 'FUNCTION',\n  UNKNOWN: 'UNKNOWN',\n}\n\nconst t = TOKENS\n\nconst GRAMMAR = [\n  // structure\n  new LexerRule(/=/g, 0, t.EQUALS, 'structure'),\n  new LexerRule(/,/g, 0, t.COMMA, 'structure'),\n  new LexerRule(/:/g, 0, t.COLON, 'structure'),\n  new LexerRule(/\\(/g, 0, t.LPAREN, 'structure'),\n  new LexerRule(/\\)/g, 0, t.RPAREN, 'structure'),\n  // operators\n  new LexerRule(/\\+/g, 0, t.PLUS, 'operator'),\n  new LexerRule(/\\-/g, 0, t.MINUS, 'operator'), // eslint-disable-line\n  new LexerRule(/\\*/g, 0, t.MULT, 'operator'),\n  new LexerRule(/\\//g, 0, t.DIV, 'operator'),\n  // multi-character\n  new LexerRule(/(\"[^\"]+\")/g, 1, t.STRING, 'entity'), // eslint-disable-line\n  new LexerRule(/[\\d\\.]+/g, 0, t.NUMBER, 'entity'), // eslint-disable-line\n  new LexerRule(/[a-z]+[\\d]+/gi, 0, t.CELL, 'entity'),\n  new LexerRule(/([a-z]+)\\(/gi, 1, t.FUNCTION, 'entity'),\n]\n\n\nclass Lexer {\n  constructor(input) {\n    this.input = input\n    this.index = 0\n    this.char = this.initChar(input)\n    this.markers = []\n    this.tokens = []\n  }\n\n  getTokens() {\n    while (this.char !== t.EOF) {\n      const token = this.nextToken()\n      this.tokens.push(token)\n    }\n\n    const sanitizer = new TokenSanitizer(this.tokens)\n    this.tokens = sanitizer.sanitize()\n    return this.tokens\n  }\n\n  nextToken() {\n    if (this.char === t.EOF) {\n      return new Token(t.EOF, t.EOF, 0, 'eof', this.index)\n    }\n\n    if (!this.isFormula()) {\n      return this.tokenTEXTorNUMBER()\n    }\n\n    const whitespaceLen = this.getWhitespaceLen()\n    let token\n\n    for (let rule of GRAMMAR) {\n      rule.setIndex(this.index)\n      const match = rule.test(this.input)\n\n      if (match && match.index === this.index) {\n        const text = match[rule.groupIndex]\n        token = new Token(rule.token, text, whitespaceLen, rule.category, this.index)\n        this.index += text.length - 1\n        this.consume()\n        break\n      }\n    }\n\n    if (!token) {\n      token = this.tokenUNKNOWN(whitespaceLen)\n    }\n\n    return token\n  }\n\n  initChar(input) {\n    if (this.input.length === 0) {\n      this.input = '0'\n      this.index = -1\n    }\n\n    return input[this.index]\n  }\n\n  tokenUNKNOWN(whitespace) {\n    const chars = []\n\n    while (!(this.isEOF() || this.isSeparator() || this.isWhitespace())) {\n      chars.push(this.char)\n      this.consume()\n    }\n\n    const text = chars.join('')\n    return new Token(t.UNKNOWN, text, whitespace, 'entity', this.index - text.length)\n  }\n\n  tokenTEXTorNUMBER() {\n    let token\n\n    if (isNumber(this.input)) {\n      token = new Token(t.NUMBER, this.input, 0, 'entity', this.index)\n    } else {\n      token = new Token(t.TEXT, this.input, 0, 'entity', this.index)\n    }\n\n    this.index = this.input.length - 1\n    this.consume()\n    return token\n  }\n\n  consume() {\n    this.index++\n\n    if (this.index < this.input.length) {\n      this.char = this.input[this.index]\n    } else {\n      this.char = t.EOF\n    }\n  }\n\n  isFormula() {\n    return this.input[0] === '='\n  }\n\n  isEOF() {\n    return this.char === t.EOF\n  }\n\n  isWhitespace() {\n    return !this.isEOF() && Boolean(this.char.match(/\\s/))\n  }\n\n  isSeparator() {\n    return Boolean(this.char.match(/[\\(\\)\\+\\-\\/\\*]/)) // eslint-disable-line\n  }\n\n  getWhitespaceLen() {\n    let count = 0\n\n    while (this.isWhitespace()) {\n      count++\n      this.consume()\n    }\n\n    return count\n  }\n}\n\nexport default Lexer\nexport { GRAMMAR, TOKENS, Lexer }\n","import { TOKENS as t } from './Lexer'\n\n\nclass AST {\n  constructor(name) {\n    this._name = name\n  }\n\n  eval() {\n    throw new Error('Implement method.')\n  }\n}\n\nclass TextNode extends AST {\n  constructor(textNode) {\n    super('TextNode')\n    this.node = textNode\n  }\n\n  eval() {\n    return this.node.text\n  }\n}\n\nclass StringNode extends AST {\n  constructor(node) {\n    super('StringNode')\n    this.node = node\n  }\n\n  eval() {\n    return this.node.value\n  }\n}\n\nclass NumberNode extends AST {\n  constructor(node) {\n    super('NumberNode')\n    this.node = node\n  }\n\n  eval() {\n    return this.node.value\n  }\n}\n\nclass CellNode extends AST {\n  constructor(token) {\n    super('CellNode')\n    this.cell = token\n  }\n\n  get location() {\n    return this.cell.value\n  }\n}\n\nclass CellRange extends AST {\n  constructor(leftCell, rightCell) {\n    super('CellRange')\n    this.leftCell = leftCell\n    this.rightCell = rightCell\n  }\n}\n\nclass UnaryOp extends AST {\n  constructor(opNode, expr) {\n    super('UnaryOp')\n    this.opNode = opNode\n    this.expr = expr\n  }\n\n  eval(evaluatedExpr) {\n    if (this.opNode.type === t.PLUS) {\n      return evaluatedExpr\n    } else if (this.opNode.type === t.MINUS) {\n      return -evaluatedExpr\n    }\n  }\n}\n\nclass FuncOp extends AST {\n  constructor(funcNode, argNodes) {\n    super('FuncOp')\n    this.funcNode = funcNode\n    this.argNodes = argNodes\n  }\n\n  eval(evaluatedArgs) {\n    const fn = this.funcNode.value\n    return fn(...evaluatedArgs)\n  }\n}\n\nclass BinaryOp extends AST {\n  constructor(leftNode, opNode, rightNode) {\n    super('BinaryOp')\n    this.leftNode = leftNode\n    this.opNode = opNode\n    this.rightNode = rightNode\n  }\n\n  eval(left, right) {\n    switch(this.opNode.type) {\n      case t.PLUS:\n        return left + right\n      case t.MINUS:\n        return left - right\n      case t.DIV:\n        if (right === 0) {\n          throw new Error(`Division by zero: ${left}/${right}`)\n        } else {\n          return left / right\n        }\n      case t.MULT:\n        return left * right\n      default:\n        throw new Error(`Unsupported operator \"${this.token.text}\"`)\n    }\n  }\n}\n\nexport {\n  TextNode,\n  StringNode,\n  NumberNode,\n  CellNode,\n  CellRange,\n  BinaryOp,\n  UnaryOp,\n  FuncOp,\n}\n","import { TOKENS as t } from './Lexer'\nimport {\n  TextNode,\n  StringNode,\n  NumberNode,\n  CellNode,\n  CellRange,\n  BinaryOp,\n  UnaryOp,\n  FuncOp\n} from './ast'\n\n\nclass Parser {\n  constructor(tokens) {\n    this.index = 0\n    this.tokens = tokens\n    this.curr = this.tokens[0]\n    this.ast = null\n  }\n\n  parse() {\n    switch (this.peekType()) {\n      case t.TEXT:\n        this.ast = this.text()\n        break\n      case t.NUMBER:\n        this.ast = this.number()\n        break\n      default:\n        this.equals()\n        this.ast = this.expr()\n        break\n    }\n\n    if (this.curr !== null) {\n      throw new Error(`Unexpected term at index ${this.index}: \"${this.curr.text}\"`)\n    }\n\n    return this.ast\n  }\n\n  expr() {\n    // expr : term ( ( PLUS | MINUS ) term ) *\n    let node, operator, right\n\n    node = this.term()\n\n    while ( [t.PLUS, t.MINUS].includes(this.peekType()) ) {\n      operator = this.operator()\n      right = this.term()\n      node = new BinaryOp(node, operator, right)\n    }\n\n    return node\n  }\n\n  term() {\n    // term : factor ( ( MULT | DIV ) factor ) *\n    let node, operator, right\n\n    node = this.factor()\n\n    while ( [t.MULT, t.DIV].includes(this.peekType()) ) {\n      operator = this.operator()\n      right = this.factor()\n      node = new BinaryOp(node, operator, right)\n    }\n\n    return node\n  }\n\n  factor() {\n    // factor : ( PLUS | MINUS ) ( NUMBER | CELL )\n    //          | LPAREN expr RPAREN\n    //          | FUNCTION LPAREN list RPAREN\n    switch (this.peekType()) {\n      case t.LPAREN:\n        return this.enclosedExpr()\n      case t.PLUS:\n      case t.MINUS:\n        return this.unaryOp()\n      case t.NUMBER:\n        return this.number()\n      case t.CELL:\n        return this.cell()\n      case t.FUNCTION:\n        return this.func()\n      case t.RPAREN:\n        throw new Error(`Unexpected term at index ${this.index}: \"${this.curr.text}\"`)\n      default:\n        throw new Error('Missing factor')\n    }\n  }\n\n  enclosedExpr() {\n    this.lparen()\n    const node = this.expr()\n    this.rparen()\n    return node\n  }\n\n  cell() {\n    if (this.peekType() !== t.CELL) {\n      throw new Error('Missing cell node')\n    }\n\n    const node = new CellNode(this.curr)\n    this.consume()\n    return node\n  }\n\n  cellRange() {\n    let left, right\n\n    if (!this.isCellRange()) {\n      throw new Error('Missing cell range')\n    }\n\n    left = new CellNode(this.curr)\n    this.consume() // skip colon\n    this.consume()\n    right = new CellNode(this.curr)\n    this.consume()\n\n    if (right.location < left.location) {\n      [left, right] = this.invertCellRange(left, right)\n    }\n\n    return new CellRange(left, right)\n  }\n\n  invertCellRange(left, right) {\n    this.tokens[this.index - 2] = right.cell\n    this.tokens[this.index] = left.cell\n    let temp = left\n    left = right\n    right = temp\n    return [left, right]\n  }\n\n  func() {\n    if (this.peekType() !== t.FUNCTION) {\n      throw new Error('Missing function')\n    }\n\n    const func = this.curr\n    this.consume()\n    this.lparen()\n    const args = this.list()\n    this.rparen()\n    return new FuncOp(func, args)\n  }\n\n  list() {\n    const list = []\n    let node\n\n    node = this.listNode()\n    list.push(node)\n\n    while (this.peekType() === t.COMMA) {\n      this.consume() // skip comma token\n      node = this.listNode()\n      list.push(node)\n    }\n\n    return list\n  }\n\n  listNode() {\n    if (this.isCellRange()) {\n      return this.cellRange()\n    } else if (this.peekType() === t.STRING) {\n      return this.string()\n    } else {\n      return this.expr()\n    }\n  }\n\n  text() {\n    let node\n\n    if (this.peekType() !== t.TEXT) {\n      throw new Error('Missing string')\n    }\n\n    node = new TextNode(this.curr)\n    this.consume()\n    return node\n  }\n\n  string() {\n    const node = new StringNode(this.curr)\n    this.consume()\n    return node\n  }\n\n  number() {\n    if (this.peekType() === t.NUMBER) {\n      const node = new NumberNode(this.curr)\n      this.consume()\n      return node\n    } else {\n      throw new Error('Missing number')\n    }\n  }\n\n  operator() {\n    if ([t.PLUS, t.MINUS, t.MULT, t.DIV].includes(this.peekType())) {\n      const node = this.curr\n      this.consume()\n      return node\n    } else {\n      throw new Error('Missing operator')\n    }\n  }\n\n  equals() {\n    if (this.peekType() !== t.EQUALS) {\n      throw new Error('Missing equals sign')\n    }\n\n    this.consume()\n  }\n\n  lparen() {\n    if (this.peekType() !== t.LPAREN) {\n      throw new Error('Missing left parenthesis')\n    }\n\n    this.consume()\n  }\n\n  rparen() {\n    if (this.peekType() !== t.RPAREN) {\n      throw new Error('Missing right parenthesis')\n    }\n\n    this.consume()\n  }\n\n  unaryOp() {\n    if (![t.PLUS, t.MINUS].includes(this.peekType())) {\n      throw new Error('Missing unary operator')\n    }\n\n    const curr = this.curr\n    this.consume()\n    const node = new UnaryOp(curr, this.factor())\n    return node\n  }\n\n  consume() {\n    if (this.index < this.tokens.length - 1) {\n      this.index++\n      this.curr = this.tokens[this.index]\n    } else {\n      this.curr = null\n    }\n  }\n\n  isCellRange() {\n    return (\n      this.peekType(0) === t.CELL\n      && this.peekType(1) === t.COLON\n      && this.peekType(2) === t.CELL\n    )\n  }\n\n  isString() {\n    return (\n      this.peekType(0) === t.DQUOTE\n      && this.peekType(1) === t.TEXT\n      && this.peekType(2) === t.DQUOTE\n    )\n  }\n\n  peekType(stepsAhead) {\n    if (stepsAhead) {\n      if (stepsAhead < 0) {\n        throw new Error('peak ahead index must be positive')\n      }\n\n      const index = this.index + stepsAhead\n\n      if (index < this.tokens.length) {\n        return this.tokens[index].type\n      }\n    } else {\n      return this.curr && this.curr.type\n    }\n  }\n}\n\nexport default Parser\n","import { Lexer } from './Lexer'\nimport { parseLocation, getColumnLabel } from '~/library/utils'\nimport graph from '~/formulas/graph'\nimport Parser from './Parser'\nimport ReduxConnect from './ReduxConnect'\n\n\nconst ERR_DIVISION_BY_ZERO = '#DIV/0!'\nconst ERR_CIRCULAR_REFERENCE = '#REF!'\nconst ERR_GENERIC = '#ERROR!'\n\nclass Interpreter {\n  constructor(location) {\n    this.location = location\n    this.error = null\n    this.cache = {}\n    this.result = null\n    this.state = new ReduxConnect()\n  }\n\n  interpret(input) {\n    const vertex = graph.addVertex(this.location, input)\n    let lexer, parser\n\n    try {\n      lexer = new Lexer(input)\n      parser = new Parser( lexer.getTokens() )\n      vertex.ast = parser.parse()\n      graph.recalculate(this.location)\n      this.result = vertex.result\n    } catch (error) {\n      this.error = vertex.error = error\n      this.result = vertex.result = this.errorResponse()\n      return this.result\n    }\n\n    this.error = vertex.error\n    return this.result\n  }\n\n  visitAST(location) {\n    const vertex = graph.getVertex(location)\n\n    if (!vertex.ast) {\n      return vertex.result\n    }\n\n    try {\n      this.result = vertex.result = this.visitNode(vertex.ast)\n    } catch (error) {\n      this.error = vertex.error = error\n      this.result = vertex.result = this.errorResponse()\n      throw error\n    }\n\n    return this.result\n  }\n\n  visitNode(node) {\n    switch (node._name) {\n      case 'NumberNode':\n        return this.NumberNode(node)\n      case 'CellNode':\n        return this.CellNode(node)\n      case 'TextNode':\n        return this.TextNode(node)\n      case 'StringNode':\n        return this.StringNode(node)\n      case 'CellRange':\n        return this.CellRange(node)\n      case 'FuncOp':\n        return this.FuncOp(node)\n      case 'BinaryOp':\n        return this.BinaryOp(node)\n      case 'UnaryOp':\n        return this.UnaryOp(node)\n      default:\n        const nodeName = node._name || (node.constructor || {}).name\n        throw new Error(`Unrecognized AST node ${nodeName}`)\n    }\n  }\n  \n  /* ***************************************\n   * Nodes that don't require processing\n   ****************************************/\n\n  TextNode(node) {\n    return node.eval()\n  }\n\n  StringNode(node) {\n    return node.eval()\n  }\n\n  NumberNode(node) {\n    return node.eval()\n  }\n\n  /* ***************************************\n   * Nodes requiring processing\n   ****************************************/\n\n  UnaryOp(node) {\n    const result = this.visitNode(node.expr)\n    return node.eval(result)\n  }\n\n  CellNode(node) {\n    const result = this.getCellResult(node.location)\n    return result === undefined\n      ? 0\n      : result\n  }\n\n  BinaryOp(node) {\n    const left = this.visitNode(node.leftNode)\n    const right = this.visitNode(node.rightNode)\n\n    if (typeof left !== 'number') {\n      throw new Error(`term is not a number: \"${left}\"`)\n    }\n\n    if (typeof right !== 'number') {\n      throw new Error(`term is not a number: \"${right}\"`)\n    }\n\n    return node.eval(left, right)\n  }\n\n  CellRange(node) {\n    const [leftColIndex, leftRowIndex] = parseLocation(node.leftCell.location)\n    const [rightColIndex, rightRowIndex] = parseLocation(node.rightCell.location)\n    const colIndexStart = Math.min(leftColIndex, rightColIndex)\n    const colIndexEnd = Math.max(leftColIndex, rightColIndex)\n    const rowIndexStart = Math.min(leftRowIndex, rightRowIndex)\n    const rowIndexEnd = Math.max(leftRowIndex, rightRowIndex)\n    const list = []\n\n    for (let rowI = rowIndexStart; rowI <= rowIndexEnd; rowI++) {\n      for (let colI = colIndexStart; colI <= colIndexEnd; colI++) {\n        const location = `${getColumnLabel(colI)}-${rowI + 1}`\n        const result = this.getCellResult(location)\n\n        if (result !== undefined) {\n          list.push(result)\n        }\n      }\n    }\n\n    return list\n  }\n\n  getCellResult(otherLocation) {\n    let result\n\n    if (!this.isLocationValid(otherLocation)) {\n      throw new Error('Location out of bounds')\n    }\n\n    if (this.cache[otherLocation] !== undefined) {\n      return this.cache[otherLocation]\n    }\n\n    result = graph.visitCell(otherLocation)\n    this.cache[otherLocation] = result\n    return result\n  }\n\n  FuncOp(node) {\n    const evaluatedArgs = []\n\n    for (let childNode of node.argNodes) {\n      const result = this.visitNode(childNode)\n\n      if (childNode._name === 'CellRange') {\n        evaluatedArgs.push(...result)\n      } else {\n        evaluatedArgs.push(result)\n      }\n    }\n\n    return node.eval(evaluatedArgs)\n  }\n\n  isLocationValid(location) {\n    const [colIndex, rowIndex] = parseLocation(location)\n\n    if (Math.min(colIndex, rowIndex) < 0) { return false }\n    if (colIndex >= this.state.columns) { return false }\n    if (rowIndex >= this.state.rows) { return false }\n    return true\n  }\n\n  errorResponse() {\n    const { message: errorMsg } = this.error\n\n    if (errorMsg.match(/division by zero/i)) {\n      return ERR_DIVISION_BY_ZERO\n    } else if (errorMsg.match(/circular reference/i)) {\n      return ERR_CIRCULAR_REFERENCE\n    } else {\n      return ERR_GENERIC\n    }\n  }\n}\n\nexport default Interpreter\nexport {\n  ERR_DIVISION_BY_ZERO,\n  ERR_CIRCULAR_REFERENCE,\n  ERR_GENERIC,\n}\n","import ReduxConnect from './ReduxConnect'\nimport Interpreter from './Interpreter'\n\n\nclass Vertex {\n  constructor(entered) {\n    this.entered = entered\n    this.error = null\n    this.result = null\n    this.ast = null\n  }\n}\n\nclass Graph {\n  constructor() {\n    this.adj = {}\n    this.pending = null\n    this.visited = null\n    this.store = new ReduxConnect()\n  }\n\n  recalculate(location) {\n    this.setPendingNodes()\n    this.dfs(location)\n    this.updateStore()\n  }\n\n  setPendingNodes() {\n    this.pending = new Set()\n\n    Object.keys(this.adj).forEach(vertex => {\n      this.pending.add(vertex)\n    })\n  }\n\n  dfs(location) {\n    while (this.pending.size > 0) {\n      if (!location) {\n        location = [...this.pending][0]\n      }\n\n      try {\n        this.visited = new Set([location])\n        const interpreter = new Interpreter(location)\n        interpreter.visitAST(location)\n      } catch (error) {}\n\n      this.visited.forEach(location => this.pending.delete(location))\n      location = null\n    }\n\n    this.visited = null\n    this.pending = null\n  }\n\n  visitCell(location) {\n    if (!this.hasVertex(location)) {\n      return\n    }\n\n    this.testPathCycle(location)\n    this.pending.delete(location)\n    this.visited.add(location)\n    const interpreter = new Interpreter(location)\n    const result = interpreter.visitAST(location)\n    this.visited.delete(location)\n    return result\n  }\n\n  getCellResult(location) {\n    if (location in this.adj) {\n      return graph.adj[location].result\n    } else {\n      return ''\n    }\n  }\n\n  testPathCycle(location) {\n    if (this.visited.has(location)) {\n      throw new Error('Circular reference')\n    }\n  }\n\n  updateStore() {\n    const locationKeys = new Set(this.store.locations)\n\n    for (let [location, vertex] of Object.entries(this.adj)) {\n      const { entered, result } = vertex\n\n      locationKeys.delete(location)\n\n      if (result !== this.store.getCellResult(location)) {\n        this.store.replaceCellData(location, entered, result)\n      }\n    }\n\n    for (let location of locationKeys) {\n      this.store.clearCell(location)\n    }\n  }\n\n  addVertex(location, entered) {\n    const vertex = new Vertex(entered)\n    this.adj[location] = vertex\n    return vertex\n  }\n\n  hasVertex(location) {\n    return location in this.adj\n  }\n\n  getVertex(location) {\n    this.testMissingLocation(location)\n    return this.adj[location]\n  }\n\n  delVertex(location) {\n    if (location in this.adj) {\n      delete this.adj[location]\n      this.recalculate()\n    }\n  }\n\n  resetAll() {\n    this.adj = {}\n    this.pending = null\n    this.visited = null\n    this.store = new ReduxConnect()\n  }\n\n  testMissingLocation(location) {\n    if (!this.hasVertex(location)) {\n      throw new Error('Missing location')\n    }\n  }\n}\n\nconst graph = new Graph()\n\n\nexport default graph\nexport {\n  Vertex,\n  Graph,\n}\n","import React from 'react'\n\n\nexport const InputContext = React.createContext()\n","class KeyboardActions {\n  constructor(component) {\n    this.c = component\n    this.disabledKeys = {}\n  }\n\n  get isFuncSelectorVisible() {\n    return this.c.state.isFuncSelectorVisible \n  }\n\n  run() {\n    const { key } = this.c.state.keyEvent\n\n    switch (key) { // eslint-disable-line\n      case 'Escape':\n        this.c.props.resetInputterValueEvent()\n        break\n      case 'Enter':\n      case 'Tab':\n        if (this.isFuncSelectorVisible) { return }\n        this.c.cellValueSetter.run()\n        break\n      case 'ArrowLeft':\n      case 'ArrowRight':\n        this.c.setInputterValueEvent(\n          this.c.props.valueEvent.value,\n          this.c.refInput.current.selectionEnd\n        )\n        break\n    }\n  }\n}\n\nexport default KeyboardActions\n","import { parseLocation, getColumnLabel } from '~/library/utils'\n\n\nclass KeyboardFocuser {\n  constructor(component) {\n    this.c = component\n  }\n\n  run() {\n    const { key } = this.c.state.keyEvent\n    const { location } = this.c.props\n    let elementId\n\n    if (this.c.state.isFuncSelectorVisible) {\n      elementId = this.funcSelectorElId(key, location)\n    } else {\n      elementId = this.defaultElId(key, location)\n    }\n\n    this.focusElement(elementId)\n  }\n\n  funcSelectorElId(key, location) {\n    if (key === 'Escape') {\n      return `[data-cell=\"result\"][data-location=\"${location}\"]`\n    }\n  }\n\n  defaultElId(key, location) {\n    switch (key) {\n      case 'Tab':\n        return `[data-cell=\"result\"][data-location=\"${location}\"]`\n      case 'Enter':\n        return this.defaultEnter(location)\n      case 'Escape':\n        return `[data-cell=\"result\"][data-location=\"${location}\"]`\n      default:\n        // this.c.refInput.current.focus()\n    }\n  }\n\n  defaultEnter(location) {\n    const [colIndex, rowIndex] = parseLocation(location)\n    const nextRowIndex = Math.min(this.c.props.rows - 1, rowIndex + 1)\n    const colLabel = getColumnLabel(colIndex)\n    const rowLabel = '' + (nextRowIndex + 1)\n    const endLocation = `${colLabel}-${rowLabel}`\n\n    return `[data-cell=\"result\"][data-location=\"${endLocation}\"]`\n  }\n\n  focusElement(id) {\n    if (!id) { return }\n\n    const el = document.querySelector(id)\n\n    if (document.activeElement !== el) {\n      el.focus()\n    }\n  }\n}\n\nexport default KeyboardFocuser\n","import Lexer, { TOKENS as t } from '~/formulas/Lexer'\n\n\nclass CellValueSetter {\n  constructor(component) {\n    this.c = component\n  }\n\n  run() {\n    const { location } = this.c.props\n    const inputValue = this.c.props.valueEvent.value\n    let cellValue\n\n    if (this.isWhitespace(inputValue)) {\n      this.c.props.clearCellData(location)\n      return\n    }\n\n    if (this.isFormula(inputValue)) {\n      cellValue = this.sanitizeValue(inputValue)\n    } else {\n      cellValue = inputValue\n    }\n\n    this.c.props.setCellData(location, cellValue)\n  }\n\n  isFormula(text) {\n    return text.length > 0 && text[0] === '='\n  }\n\n  isWhitespace(text) {\n    return text.length === 0 || Boolean(text.match(/^\\s+$/))\n  }\n\n  sanitizeValue(value) {\n    const lexer = new Lexer(value)\n    const tokens = lexer.getTokens()\n\n    return tokens\n      .map(token => {\n        switch (token.type) {\n          case t.FUNCTION:\n            return token.text.toUpperCase()\n          case t.NUMBER:\n            return token.value\n          default:\n            return token.text\n        }\n      })\n      .join('')\n  }\n}\n\nexport default CellValueSetter\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\n\n\nexport const Input = styled.input`\n  height: 100%;\n  outline: none;\n  width: 100%;\n  z-index: 100;\n`\n\nfunction InputTag({ fwdRef, value, style, props, onChange, onKeyDown }) {\n  return (\n    <Input\n      ref={fwdRef}\n      css={style}\n      value={value}\n      onChange={onChange}\n      onKeyDown={onKeyDown}\n      {...props}\n    />\n  )\n}\n\nInputTag.propTypes = {\n  fwdRef: PropTypes.object.isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onKeyDown: PropTypes.func.isRequired,\n  style: PropTypes.oneOfType([\n    PropTypes.object,\n    PropTypes.func,\n  ]),\n  props: PropTypes.object,\n}\n\nInputTag.defaultProps = {\n  style: {},\n  props: {},\n}\n\nexport default InputTag\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\n\nimport formulaFuncs from '~/formulas/formulaFunctions'\nimport { InputContext } from './InputContext'\n\n\nconst Root = styled.div`\n  background: ${props => props.theme.colors.dropdown.normal};\n  margin-top: 1px;\n  box-shadow: 0 0 5px ${props => props.theme.colors.shadow};\n  border: 1px solid ${props => props.theme.colors.dropdown.active};\n  width: 300px;\n  padding: 6px 8px;\n  position: fixed;\n`\n\nconst Pre = styled.pre`\n  line-height: 1em;\n  padding-bottom: 3px;\n  font-size: 14px;\n`\n\nconst Subtitle = styled.div`\n  padding-top: 12px;\n  font-size: 12px;\n`\n\nconst P = styled.p`\n  line-height: 1em;\n  font-size: 13px;\n`\n\nconst Hr = styled.hr`\n  border: 0;\n  border-top: 1px solid ${props => props.theme.colors.dropdown.active};\n`\n\nclass FuncDescription extends React.PureComponent {\n\n  static contextType = InputContext\n\n  static propTypes = {\n    cursorPos: PropTypes.number,\n    fnScopes: PropTypes.array,\n  }\n\n  getFnScope() {\n    const { fnScopes, cursorPos } = this.props\n    let currScope\n\n    for (let scope of fnScopes) {\n      if (cursorPos >= scope.startIndex + 1) {\n        currScope = scope\n      } else {\n        break\n      }\n    }\n\n    if (currScope && currScope.endIndex === null) { return currScope}\n    if (currScope && cursorPos - 1 < currScope.endIndex) { return currScope }\n    return null\n  }\n\n  getFnNode(scope) {\n    const key = scope.fnName.toUpperCase()\n    return formulaFuncs[key]\n  }\n\n  render() {\n    const scope = this.getFnScope()\n    const { inputRect } = this.context\n    let fnNode\n\n    if (!scope) { return null }\n    fnNode = this.getFnNode(scope)\n\n    return (\n      <Root\n        css={css`\n          top: ${inputRect.bottom}px;\n          left: ${inputRect.left}px;\n        `}\n      >\n        <Pre\n          css={css`\n            padding-bottom: 6px;\n          `}\n        >\n          {fnNode.definition}\n        </Pre>\n        <Hr />\n        <Subtitle>Example</Subtitle>\n        <Pre>{fnNode.example}</Pre>\n        <Subtitle>Summary</Subtitle>\n        <P>{fnNode.summary}</P>\n      </Root>\n    )\n  }\n}\n\nFuncDescription.propTypes = {\n  cursorPos: PropTypes.number,\n  fnScopes: PropTypes.array,\n}\n\nexport default FuncDescription\n\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport styled from '@emotion/styled'\n\n\nconst NoOp = () => {}\n\nconst Li = styled.li`\n  outline: none;\n`\n\nfunction DropdownItem({ item, index, isActive, onMouseEnter }) {\n  return (\n    <Li\n      tabIndex={0}\n      onMouseEnter={() => onMouseEnter(index)}\n    >\n      {isActive && item.active ? item.active : item.base}\n    </Li>\n  )\n}\n\nDropdownItem.propTypes = {\n  item: PropTypes.shape({\n    base: PropTypes.node.isRequired,\n    active: PropTypes.node,\n  }),\n  index: PropTypes.number.isRequired,\n  isActive: PropTypes.bool.isRequired,\n  onMouseEnter: PropTypes.func,\n}\n\nDropdownItem.defaultProps = {\n  onMouseEnter: NoOp,\n}\n\nexport default DropdownItem\n","\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\n\nimport InteractiveListItem from './InteractiveListItem'\n\n\nconst Ul = styled.ul`\n  margin: 0;\n  padding: 0;\n  list-style: none;\n`\n\nclass InteractiveList extends React.PureComponent {\n\n  static propsTypes = {\n    onMouseEnter: PropTypes.func,\n    items: PropTypes.array.isRequired,\n    styles: PropTypes.shape({\n      ul: PropTypes.object,\n      li: PropTypes.object,\n    }),\n  }\n\n  renderListItems() {\n    return this.props.items\n      .map((item, index) => (\n        <InteractiveListItem\n          key={index}\n          index={index}\n          item={item.item}\n          style={{...this.props.styles.li}}\n          isActive={item.isActive}\n          onMouseEnter={this.props.onMouseEnter}\n        />\n      ))\n  }\n\n  render() {\n    const { items, styles } = this.props\n\n    if (items.length === 0) { return null }\n\n    return (\n      <Ul\n        tabIndex={-1}\n        style={styles.ul}\n      >\n        {this.renderListItems()}\n      </Ul>\n    )\n  }\n}\n\nexport default InteractiveList\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\n\nimport formulaFuncs from '~/formulas/formulaFunctions'\nimport InteractiveList from '~/library/InteractiveList'\nimport Token from '~/formulas/Token'\nimport { InputContext } from './InputContext'\nimport { withTheme } from 'emotion-theming'\n\n\nconst Root = styled.div`\n  border: 0;\n  position: fixed;\n`\n\nconst baseItemStyle = css`\n  padding: 6px 8px;\n`\n\nconst ItemBaseRoot = styled.div`\n  ${baseItemStyle}\n  background: ${props => props.theme.colors.dropdown.normal};\n`\n\nconst ItemActiveRoot = styled.div`\n  ${baseItemStyle}\n  background: ${props => props.theme.colors.dropdown.active};\n`\n\nconst Pre = styled.pre`\n  line-height: 1em;\n  padding-bottom: 3px;\n  font-size: 14px;\n`\n\nconst Subtitle = styled.div`\n  font-size: 12px;\n`\n\nclass FuncSelector extends React.Component {\n\n  static contextType = InputContext\n\n  static propTypes = {\n    token: PropTypes.instanceOf(Token),\n    colors: PropTypes.object,\n    theme: PropTypes.object,\n  }\n\n  state = {\n    listItems: [],\n    itemIndex: 0,\n    keyEvent: null,\n    isVisible: false,\n  }\n\n  constructor() {\n    super()\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.setIndex = this.setIndex.bind(this)\n  }\n\n  componentDidMount() {\n    this.setState({ itemIndex: 0 }, () => {\n      this.setListItems()\n    })\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return this.state.listItems !== nextState.listItems\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    this.updateContextData(prevState)\n    this.updateListItems(prevProps)\n    this.keyActions()\n  }\n\n  componentWillUnmount() {\n    this.context.setIsFuncSelectorVisible(false)\n  }\n\n  updateListItems(prevProps) {\n    if (prevProps.token === this.props.token) { return }\n\n    this.setState({ itemIndex: 0 }, () => {\n      this.setListItems()\n    })\n  }\n\n  updateContextData(prevState) {\n    const { keyEvent } = this.context\n\n    if (prevState.keyEvent !== keyEvent) {\n      this.setState({ keyEvent })\n      this.keyEventSetIndex(keyEvent)\n    }\n  }\n\n  keyActions() {\n    const { keyEvent } = this.context\n    if (this.state.keyEvent === keyEvent) { return }\n    if (['Enter', 'Tab'].includes(keyEvent.key) && this.state.isVisible) {\n      this.setInputterValueEvent()\n    }\n  }\n\n  setInputterValueEvent() {\n    const currInputValue = this.context.valueEvent.value\n    const { token } = this.props\n    const { fnName } = this.state.listItems[this.state.itemIndex]\n    const rightChunkIndex = token.index + token.text.length\n    const leftChunk = currInputValue.slice(0, token.index)\n    const rightChunk = currInputValue.slice(rightChunkIndex)\n    const value = `${leftChunk}${fnName}(${rightChunk}`\n    const cursorPos = leftChunk.length + fnName.length + 1\n    this.context.setInputterValueEvent(value, cursorPos)\n  }\n\n  setListItems() {\n    const { token } = this.props\n    const text = token.text.toUpperCase()\n    const listItems = Object\n      .keys(formulaFuncs)\n      .filter(fnName => fnName.startsWith(text))\n      .sort()\n      .map(fnName => ({\n        item: {\n          base: this.itemBase(fnName),\n          active: this.itemActive(fnName),\n        },\n        isActive: false,\n        fnName,\n      }))\n    let isVisible = false\n    let itemIndex\n\n    itemIndex = Math.max(Math.min(listItems.length - 1, this.state.itemIndex), 0)\n\n    if (listItems.length > 0) {\n      listItems[itemIndex].isActive = isVisible = true\n    }\n\n    this.context.setIsFuncSelectorVisible(isVisible)\n    this.setState({ listItems, itemIndex, isVisible })\n  }\n\n  keyEventSetIndex(keyEvent) {\n    let itemIndex = this.state.itemIndex\n\n    switch (keyEvent.key) { // eslint-disable-line default-case\n      case 'ArrowUp':\n          itemIndex = this.state.itemIndex - 1\n        break\n      case 'ArrowDown':\n          itemIndex = this.state.itemIndex + 1\n        break\n    }\n\n    this.setState({ itemIndex }, () => {\n      this.setListItems()\n    })\n  }\n\n  setIndex(itemIndex) {\n    this.setState({ itemIndex }, () => {\n      this.setListItems()\n    })\n  }\n\n  itemBase(fnName) {\n    return (\n      <ItemBaseRoot>\n        <Pre>\n          {fnName}\n        </Pre>\n      </ItemBaseRoot>\n    )\n  }\n\n  itemActive(fnName) {\n    return (\n      <ItemActiveRoot>\n        <Pre>\n          {fnName}\n        </Pre>\n        <Subtitle>\n          {formulaFuncs[fnName].summary}\n        </Subtitle>\n      </ItemActiveRoot>\n    )\n  }\n\n  getListStyles() {\n    const { theme } = this.props\n\n    return {\n      ul: {\n        marginTop: 1,\n        boxShadow: `0 0 5px ${theme.colors.shadow}`,\n        border: `1px solid ${theme.colors.dropdown.active}`,\n        width: 300,\n      }\n    }\n  }\n\n  handleOnClick(event) {\n    event.nativeEvent.stopPropagation()\n    this.setInputterValueEvent()\n  }\n\n  render() {\n    const { listItems, isVisible } = this.state\n    const { inputRect } = this.context\n\n    return (\n      <Root\n        css={css`\n          top: ${inputRect.bottom}px;\n          left: ${inputRect.left}px;\n        `}\n        open={isVisible}\n        onClick={this.handleOnClick}\n      >\n        <InteractiveList\n          items={listItems}\n          styles={this.getListStyles()}\n          onMouseEnter={this.setIndex}\n        />\n      </Root>\n    )\n  }\n}\n\nexport default withTheme(FuncSelector)\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport { TOKENS as t } from '~/formulas/Lexer'\nimport FuncDescription from './FuncDescription'\nimport FuncSelector from './FuncSelector'\n\n\nclass Suggestions extends React.PureComponent {\n\n  static propTypes = {\n    tokens: PropTypes.array.isRequired,\n    cursorPos: PropTypes.number,\n  }\n\n  state = {\n    fnScopes: [],\n  }\n\n  componentDidMount() {\n    this.setFnScopes()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.tokens !== this.props.tokens) {\n      this.setFnScopes()\n    }\n  }\n\n  setFnScopes() {\n    const stack = []\n    const fnScopes = []\n\n    for (let token of this.props.tokens) {\n      if (token.type === t.FUNCTION) {\n        const scope = { fnName: token.text, startIndex: token.index, endIndex: null }\n        stack.push(scope)\n        fnScopes.push(scope)\n      } else if (token.type === t.LPAREN) {\n        stack.push('(')\n      } else if (token.type === t.RPAREN) {\n        stack.pop()\n        if (stack.length > 0 && stack[stack.length - 1] !== '(') {\n          const scope = stack.pop()\n          scope.endIndex = token.index - 1\n        }\n      }\n    }\n\n    fnScopes.sort((a, b) => a.startIndex - b.startIndex)\n    this.setState({ fnScopes })\n  }\n\n  getCurrTokenIndex(tokens, cursorPos) {\n    let index\n\n    for (index = 0; index < tokens.length; index++) {\n      const token = tokens[index]\n      const endIndex = token.index + token.text.length\n\n      if (cursorPos > token.index && cursorPos <= endIndex) {\n        break\n      }\n    }\n\n    return index\n  }\n\n  getCompareTokens() {\n    const { tokens, cursorPos } = this.props\n    const index = this.getCurrTokenIndex(tokens, cursorPos)\n    const tokenBefore = index > 0 && tokens[index - 1]\n    const tokenCurr = tokens[index]\n    const tokenAfter = index < tokens.length - 2 && tokens[index + 1]\n    return [ tokenBefore, tokenCurr, tokenAfter ]\n  }\n\n  getFuncSelector() {\n    const [ tokenBefore, tokenCurr, tokenAfter ] = this.getCompareTokens()\n\n    if (this.props.tokens.length < 2) { return null }\n\n    const option1 = (\n      tokenBefore\n      && tokenCurr\n      && tokenAfter\n      && tokenBefore.category === 'operator'\n      && [t.UNKNOWN, t.FUNCTION].includes(tokenCurr.type)\n      && tokenAfter.type !== t.LPAREN\n    )\n\n    const option2 = (\n      tokenBefore\n      && tokenCurr\n      && !tokenAfter\n      && [t.UNKNOWN, t.FUNCTION].includes(tokenCurr.type)\n    )\n\n    if (option1 || option2) {\n      return (\n        <FuncSelector\n            token={tokenCurr}\n        />\n      )\n    }\n  }\n\n  render() {\n    if (this.props.cursorPos === undefined) { return null }\n\n    const renderedFuncSelector = this.getFuncSelector()\n\n    if (renderedFuncSelector) {\n      return renderedFuncSelector\n    } else {\n      return (\n        <FuncDescription\n          cursorPos={this.props.cursorPos}\n          fnScopes={this.state.fnScopes}\n        />\n      )\n    }\n  }\n}\n\nexport default Suggestions\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\n\nimport { setCellData, clearCellData } from '~/actions/tableDataActions'\nimport { setInputterValueEvent, resetInputterValueEvent } from '~/actions/globalActions'\nimport { InputContext } from './InputContext'\nimport Lexer from '~/formulas/Lexer'\nimport KeyboardActions from './KeyboardActions'\nimport KeyboardFocuser from './KeyboardFocuser'\nimport CellValueSetter from './CellValueSetter'\nimport InputTag from './InputTag'\nimport Suggestions from './Suggestions'\n\n\nconst NoOp = () => {}\n\nexport class Inputter extends React.PureComponent {\n\n  static propTypes = {\n    // props\n    isInteractive: PropTypes.bool,\n    // redux\n    clearCellData: PropTypes.func.isRequired,\n    columns: PropTypes.number.isRequired,\n    entered: PropTypes.string.isRequired,\n    inputTagProps: PropTypes.object,\n    location: PropTypes.string.isRequired,\n    resetInputterValueEvent: PropTypes.func.isRequired,\n    rows: PropTypes.number.isRequired,\n    setCellData: PropTypes.func.isRequired,\n    setInputterValueEvent: PropTypes.func.isRequired,\n    valueEvent: PropTypes.object.isRequired,\n    // lifecycle functions\n    onMount: PropTypes.func,\n    onUnmount: PropTypes.func,\n  }\n\n  static defaultProps = {\n    onMount: NoOp,\n    onUnmount: NoOp,\n    isInteractive: false,\n    inputTagProps: {},\n  }\n\n  constructor(props) {\n    super(props)\n    this.cellValueSetter = new CellValueSetter(this)\n    this.handleOnChange = this.handleOnChange.bind(this)\n    this.handleOnKeyDown = this.handleOnKeyDown.bind(this)\n    this.keyboardActions = new KeyboardActions(this)\n    this.keyboardFocuser = new KeyboardFocuser(this)\n    this.setInputWidth = this.setInputWidth.bind(this)\n    this.setIsFuncSelectorVisible = this.setIsFuncSelectorVisible.bind(this)\n  }\n\n  state = {\n    tokens: [],\n    isFuncSelectorVisible: false,\n    keyEvent: { key: '' },\n    width: null,\n  }\n\n  refInput = React.createRef()\n\n  componentDidMount() {\n    this.props.onMount(this.props, this.state, this.refInput.current)\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.keyEvent !== this.state.keyEvent) {\n      this.keyboardFocuser.run()\n      this.keyboardActions.run()\n    }\n\n    if (prevProps.valueEvent !== this.props.valueEvent) {\n      this.focusInputTag()\n      this.tokenizeInputValue()\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.onMount(this.props, this.state, this.refInput.current)\n  }\n\n  setInputWidth(width) {\n    if (this.state.width !== width) {\n      this.setState({ width })\n    }\n  }\n\n  tokenizeInputValue() {\n    const { value } = this.props.valueEvent\n    const lexer = new Lexer(value)\n    const tokens = lexer.getTokens()\n    this.setState({ tokens })\n  }\n\n  setIsFuncSelectorVisible(isFuncSelectorVisible) {\n    this.setState({ isFuncSelectorVisible })\n  }\n\n  focusInputTag() {\n    if (!this.props.isInteractive) { return }\n\n    const inputEl = this.refInput.current\n    const { cursorPos } = this.props.valueEvent\n\n    inputEl.focus()\n\n    if (inputEl.selectionEnd !== cursorPos) {\n      inputEl.selectionStart = cursorPos\n      inputEl.selectionEnd = cursorPos\n    }\n  }\n\n  handleOnChange(event) {\n    const { target: { value } } = event\n    const cursorPos = event.target.selectionStart\n    this.props.setInputterValueEvent(value, cursorPos)\n  }\n\n  handleOnKeyDown(event) {\n    const { key } = event\n\n    if (this.state.isFuncSelectorVisible && ['Tab', 'Enter'].includes(key)) {\n      event.preventDefault()\n    }\n\n    this.setState({ keyEvent: { key } })\n  }\n\n  renderSuggestions() {\n    if (!this.props.isInteractive) { return null }\n\n    return (\n      <Suggestions\n        tokens={this.state.tokens}\n        cursorPos={this.props.valueEvent.cursorPos}\n      />\n    )\n  }\n\n  render() {\n    const inputEl = this.refInput.current\n    const inputRect = inputEl && inputEl.getBoundingClientRect()\n\n    return (\n      <InputContext.Provider\n        value={{\n          inputRect,\n          setIsFuncSelectorVisible: this.setIsFuncSelectorVisible,\n          keyEvent: this.state.keyEvent,\n          valueEvent: this.props.valueEvent,\n          setInputterValueEvent: this.props.setInputterValueEvent\n        }}\n      >\n        <InputTag\n          fwdRef={this.refInput}\n          value={this.props.valueEvent.value}\n          style={this.props.inputTagProps.style}\n          props={this.props.inputTagProps.props}\n          onChange={this.handleOnChange}\n          onKeyDown={this.handleOnKeyDown}\n        />\n        {this.renderSuggestions()}\n      </InputContext.Provider>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  const {\n    global: {\n      activeCell: {\n        entered,\n        location,\n      },\n      inputter: {\n        valueEvent,\n      },\n      rows,\n      columns,\n    }\n  } = state\n\n  return {\n    columns,\n    entered,\n    location,\n    rows,\n    valueEvent,\n  }\n}\n\nconst mapDispatchToProps = {\n  clearCellData,\n  resetInputterValueEvent,\n  setCellData,\n  setInputterValueEvent,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Inputter)\n","export const DEFAULT_COL_WIDTH = 140\nexport const MIN_COL_WIDTH = 12\nexport const MAX_COL_WIDTH = 800\nexport const DEFAULT_ROW_HEIGHT = 28\nexport const MIN_ROW_HEIGHT = 12\nexport const MAX_ROW_HEIGHT = 600\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\nimport { connect } from 'react-redux'\n\nimport { setRowHeight } from '~/actions/tableMetaActions'\nimport { DEFAULT_ROW_HEIGHT, MIN_ROW_HEIGHT, MAX_ROW_HEIGHT } from '~/library/constants'\nimport { debounce, clamp } from '~/library/utils'\n\n\nexport const ROW_HEADER_WIDTH = 50\n\nconst Root = styled.div`\n  position: relative;\n  font-size: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.table.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.table.borderDark};\n  background: ${props => props.theme.colors.table.labelBkg};\n`\n\nconst BtnHeight = styled.button`\n  background: transparent;\n  cursor: row-resize;\n  outline: none;\n  position: absolute;\n  width: 100%;\n  height: 6px;\n  margin: 0 0 -3px 0;\n  border: 0;\n  padding: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 1;\n\n  :hover {\n    background: ${props => props.theme.colors.primary.light};\n  }\n`\n\nclass RowHeader extends React.PureComponent {\n\n  static propTypes = {\n    label: PropTypes.number.isRequired,\n    setRowHeight: PropTypes.func.isRequired,\n    height: PropTypes.number,\n  }\n\n  constructor() {\n    super()\n    this.handleBtnHeightOnMouseDown = this.handleBtnHeightOnMouseDown.bind(this)\n    this.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this)\n    this.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this)\n    this.debSetRowHeight = this.debSetRowHeight.bind(this)\n  }\n\n  state = {\n    pageY: 0,\n    height: 0,\n    btnBottom: 0,\n    isResizing: false,\n  }\n\n  refRoot = React.createRef()\n\n  getRootStyle() {\n    const { height } = this.props\n    const style = {\n      width: ROW_HEADER_WIDTH\n    }\n\n    if (height) {\n      style.height = height\n    } else {\n      style.minHeight = DEFAULT_ROW_HEIGHT\n      style.height = 'auto'\n    }\n\n    return style\n  }\n\n  getBtnHeightStyle() {\n    if (!this.state.isResizing) { return }\n\n    const newBottom = this.state.btnBottom\n    const minBottom = MIN_ROW_HEIGHT - this.state.height\n    const maxBottom = MAX_ROW_HEIGHT - this.state.height\n    const bottom = -(clamp(newBottom, minBottom, maxBottom) - 4)\n\n    return (theme) => css`\n      height: 1.5px;\n      width: 95vw;\n      bottom: ${bottom}px;\n      background: ${theme.colors.primary.light};\n    `\n  }\n\n  debSetRowHeight = debounce(40, (event) => {\n    const delta = event.pageY - this.state.pageY\n    this.setState({ btnBottom: delta, })\n  })\n\n  handleDocumentMouseMove(event) {\n    this.debSetRowHeight(event)\n  }\n\n  handleDocumentMouseUp(event) {\n    const delta = event.pageY - this.state.pageY\n    const height = this.state.height + delta\n\n    this.props.setRowHeight(this.props.label, height)\n    this.setState({ btnBottom: 0, isResizing: false })\n    document.removeEventListener('mousemove', this.handleDocumentMouseMove)\n    document.removeEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n\n  handleBtnHeightOnMouseDown(event) {\n    event.preventDefault()\n\n    this.setState({\n      pageY: event.pageY,\n      height: this.props.height || this.refRoot.current.getBoundingClientRect().height,\n      isResizing: true,\n    })\n\n    document.addEventListener('mousemove', this.handleDocumentMouseMove)\n    document.addEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n\n  render() {\n    const { label } = this.props\n\n    return (\n      <Root\n        ref={this.refRoot}\n        data-row={label}\n        className='row-header-width'\n        css={this.getRootStyle()}\n      >\n        {label}\n        <BtnHeight\n          css={this.getBtnHeightStyle()}\n          tabIndex='-1'\n          onMouseDown={this.handleBtnHeightOnMouseDown}\n          onMouseMove={this.handleBtnHeightOnMouseMove}\n          onMouseUp={this.handleBtnHeightOnMouseUp}\n        />\n      </Root>\n    )\n  }\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const height = state.tableMeta.rowHeights[ownProps.label]\n  return { height }\n}\n\nconst mapDispatchToProps = { setRowHeight }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RowHeader)\n","import { clamp } from '~/library/utils'\nimport {\n  MIN_COL_WIDTH,\n  MAX_COL_WIDTH,\n  MIN_ROW_HEIGHT,\n  MAX_ROW_HEIGHT,\n} from '~/library/constants'\n\n\nexport function setColWidth(colLabel, width) {\n  if (typeof width !== 'number') {\n    throw new Error('width is not a number')\n  }\n\n  return {\n    type: 'SET_COL_WIDTH',\n    payload: { colLabel, width: clamp(width, MIN_COL_WIDTH, MAX_COL_WIDTH) }\n  }\n}\n\nexport function setRowHeight(rowLabel, height) {\n  if (typeof height !== 'number') {\n    throw new Error('height is not a number')\n  }\n\n  return {\n    type: 'SET_ROW_HEIGHT',\n    payload: { rowLabel, height: clamp(height, MIN_ROW_HEIGHT, MAX_ROW_HEIGHT) }\n  }\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { connect } from 'react-redux'\n\nimport { scheduleFloatingInputter, closeFloatingInputter } from '~/actions/globalActions'\nimport inputTagProps from './inputTagProps'\nimport Inputter from '../Inputter/Inputter'\nimport { ROW_HEADER_WIDTH } from '../cell/RowHeader'\n\n\nconst Root = styled.div`\n  display: flex;\n  border-width: 2px 2px 0;\n  border-style: solid;\n  border-color: ${props => props.theme.colors.table.borderDark};\n  position: relative;\n  height: 30px;\n  width: 100%;\n  z-index: 10;\n`\n\nconst Fx = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.table.borderDark};\n  width: ${ROW_HEADER_WIDTH + 3}px;\n  color: ${props => props.theme.colors.table.borderDark};\n  font-style: italic;\n`\n\nclass FormulaBar extends React.PureComponent {\n\n  static propTypes = {\n    location: PropTypes.string,\n    scheduleFloatingInputter: PropTypes.func.isRequired,\n    closeFloatingInputter: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props)\n    this.handleOnFocus = this.handleOnFocus.bind(this)\n    this.handleOnBlur = this.handleOnBlur.bind(this)\n  }\n\n  state = {\n    isInteractive: false,\n  }\n\n  refRoot = React.createRef()\n\n  handleOnFocus() {\n    this.setState({ isInteractive: true })\n    this.props.scheduleFloatingInputter(false)\n  }\n\n  handleOnBlur(event) {\n    if (!this.refRoot.current.contains(event.relatedTarget)) {\n      this.props.closeFloatingInputter()\n      this.setState({ isInteractive: false })\n    }\n  }\n\n  renderInputter() {\n    return (\n      <Inputter\n        isInteractive={this.state.isInteractive}\n        inputTagProps={inputTagProps}\n      />\n    )\n  }\n\n  render() {\n    return (\n      <Root\n        ref={this.refRoot}\n        onFocus={this.handleOnFocus}\n        onBlur={this.handleOnBlur}\n      >\n        <Fx>ƒx</Fx>\n        {this.renderInputter()}\n      </Root>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  const {\n    global: {\n      activeCell: {\n        location,\n      },\n    }\n  } = state\n\n  return { location }\n}\n\nconst mapDispatchtoProps = { scheduleFloatingInputter, closeFloatingInputter }\n\nexport default connect(mapStateToProps, mapDispatchtoProps)(FormulaBar)\n","\n/* @jsx jsx */\nimport React from 'react' // eslint-disable-line\nimport { jsx, css } from '@emotion/core'\n\n\nconst style = theme => css`\n  align-items: center;\n  background-color: white;\n  border: 2px solid salmon;\n  box-shadow: 0 0 5px ${theme.colors.shadow};\n  box-sizing: border-box;\n  display: flex;\n  font-size: 13px;\n  padding: 0 8px 0 2px;\n`\nconst props = {\n  'data-inputter': 'floating',\n}\n\nexport default { style, props }\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { css, jsx } from '@emotion/core' // eslint-disable-line\n\nimport { Input as BaseInput } from '../Inputter/InputTag'\n\n\nconst NoOp = () => {}\nconst PADDING_COMPARE = 3\nconst PADDING_SIZE = 7\n\nconst Input = styled(BaseInput)`\n  position: absolute;\n  margin-top: -200vh;\n  visibility: hidden;\n`\n\nclass InputSizer extends React.PureComponent {\n\n  static propTypes = {\n    // props\n    setInputWidth: PropTypes.func.isRequired,\n    style: PropTypes.func,\n    // redux\n    cellRect: PropTypes.object,\n    valueEvent: PropTypes.object,\n  }\n\n  static defaultProps = {\n    style: NoOp,\n  }\n\n  refInput = React.createRef()\n\n  componentDidMount() {\n    this.setInputWidth()\n  }\n\n  componentDidUpdate(prevProps, prevState) { // eslint-disable-line\n    if (prevProps.valueEvent !== this.props.valueEvent) {\n      this.setInputWidth()\n    }\n  }\n\n  setInputWidth() {\n    const inputEl = this.refInput.current\n    const textWidth = inputEl.scrollWidth\n    const width = textWidth + PADDING_COMPARE > this.props.cellRect.width\n      ? Math.ceil(textWidth) + PADDING_SIZE\n      : this.props.cellRect.width\n\n    this.props.setInputWidth(width)\n  }\n\n  render() {\n    return (\n      <Input\n        readOnly\n        ref={this.refInput}\n        value={this.props.valueEvent.value}\n        css={theme => {\n          const style1 = this.props.style(theme)\n          const style2 = `width: ${this.props.cellRect.width}px;`\n          return [style1, style2]\n        }}\n      />\n    )\n  }\n}\n\nexport default InputSizer\n","import { parseLocation, getColumnLabel } from '~/library/utils'\n\n\nclass KeyboardFocuser {\n\n  constructor(component) {\n    this.c = component\n  }\n\n  run() {\n    const { key } = this.c.state.keyEvent\n    const { location } = this.c.props\n    const elementId = this.defaultElId(key, location)\n    this.focusElement(elementId)\n  }\n\n  defaultElId(key, location) {\n    switch (key) { // eslint-disable-line\n      case 'Tab':\n        return `[data-cell=\"result\"][data-location=\"${location}\"]`\n      case 'Enter':\n        return this.defaultEnter(location)\n      case 'Escape':\n        return `[data-cell=\"result\"][data-location=\"${location}\"]`\n    }\n  }\n\n  defaultEnter(location) {\n    const [colIndex, rowIndex] = parseLocation(location)\n    const nextRowIndex = Math.min(this.c.props.rows - 1, rowIndex + 1)\n    const colLabel = getColumnLabel(colIndex)\n    const rowLabel = '' + (nextRowIndex + 1)\n    const endLocation = `${colLabel}-${rowLabel}`\n\n    return `[data-cell=\"result\"][data-location=\"${endLocation}\"]`\n  }\n\n  focusElement(elementId) {\n    if (!elementId) { return }\n\n    const el = document.querySelector(elementId)\n\n    if (el && document.activeElement !== el) {\n      el.focus()\n    }\n  }\n}\n\nexport default KeyboardFocuser\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport { connect } from 'react-redux'\n\nimport { closeFloatingInputter, setFloatingInputterInteractive } from '~/actions/globalActions'\nimport inputTagProps from './inputTagProps'\nimport Inputter from '../Inputter/Inputter'\nimport InputSizer from './InputSizer'\nimport KeyboardFocuser from './KeyboardFocuser'\n\n\nconst INIT_KEY_EVENT = { key: '' }\n\nconst Root = styled.div`\n  position: fixed;\n`\n\nexport class FloatingInputter extends React.PureComponent {\n\n  static propTypes = {\n    // redux\n    cellRect: PropTypes.object,\n    closeFloatingInputter: PropTypes.func.isRequired,\n    setFloatingInputterInteractive: PropTypes.func.isRequired,\n    inputter: PropTypes.shape({\n      isOpen: PropTypes.bool.isRequired,\n      isInteractive: PropTypes.bool.isRequired,\n    }),\n    isInputterOpen: PropTypes.bool,\n  }\n\n  static defaultProps = {\n    cellRect: {},\n    isInputterOpen: false,\n  }\n\n  constructor() {\n    super()\n    this.handleInputterOnMount = this.handleInputterOnMount.bind(this)\n    this.handleOnBlur = this.handleOnBlur.bind(this)\n    this.handleOnFocus = this.handleOnFocus.bind(this)\n    this.handleOnKeyDown = this.handleOnKeyDown.bind(this)\n    this.keyboardFocuser = new KeyboardFocuser(this)\n    this.setInputWidth = this.setInputWidth.bind(this)\n  }\n\n  state = {\n    keyEvent: INIT_KEY_EVENT,\n    width: 'auto',\n  }\n\n  refRoot = React.createRef()\n\n  componentDidUpdate() {\n    if (this.props.inputter.isInteractive) {\n      this.keyboardFocuser.run()\n    }\n  }\n\n  setInputWidth(width) {\n    if (this.state.width !== width) {\n      this.setState({ width })\n    }\n  }\n\n  handleInputterOnMount(props, state, inputEl) {\n    if (this.props.inputter.isInteractive) {\n      inputEl.focus()\n      inputEl.selectionEnd = inputEl.value.length\n    }\n    this.setState({ keyEvent: INIT_KEY_EVENT })\n  }\n\n  handleOnKeyDown(event) {\n    const { key } = event\n    this.setState({ keyEvent: { key } })\n  }\n\n  handleOnFocus() {\n    if (!this.props.inputter.isInteractive) {\n      this.props.setFloatingInputterInteractive(true)\n    }\n  }\n\n  handleOnBlur(event) {\n    if (!this.refRoot.current.contains(event.relatedTarget)) {\n      this.props.closeFloatingInputter()\n    }\n  }\n\n  render() {\n    if (!this.props.inputter.isOpen) { return null }\n\n    const { top, left, height } = this.props.cellRect\n    const { width } = this.state\n\n    return (\n      <Root\n        ref={this.refRoot}\n        css={{ top, left, width, height }}\n        onKeyDown={this.handleOnKeyDown}\n        onFocus={this.handleOnFocus}\n        onBlur={this.handleOnBlur}\n      >\n        <InputSizer\n          valueEvent={this.props.valueEvent}\n          cellRect={this.props.cellRect}\n          setInputWidth={this.setInputWidth}\n          style={inputTagProps.style}\n        />\n        <Inputter\n          isInteractive={this.props.inputter.isInteractive}\n          onMount={this.handleInputterOnMount}\n          inputTagProps={inputTagProps}\n        />\n      </Root>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  const {\n    global: {\n      activeCell: {\n        location,\n      },\n      inputter: {\n        valueEvent,\n      },\n      floatingInputter: {\n        cellRect,\n        isOpen,\n        isInteractive,\n      }\n    }\n  } = state\n\n  const inputter = {\n    isOpen,\n    isInteractive,\n  }\n\n  return { cellRect, valueEvent, location, inputter }\n}\n\nconst mapDispatchToProps = { closeFloatingInputter, setFloatingInputterInteractive }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FloatingInputter)\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport { connect } from 'react-redux'\n\nimport { setColWidth } from '~/actions/tableMetaActions'\nimport { DEFAULT_COL_WIDTH, MIN_COL_WIDTH, MAX_COL_WIDTH } from '~/library/constants'\nimport { debounce, clamp } from '~/library/utils'\n\n\nlet Root = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.table.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.table.borderDark};\n  background: ${props => props.theme.colors.table.labelBkg};\n  font-size: 12px;\n`\n\nconst BtnWidth = styled.button`\n  background: transparent;\n  cursor: col-resize;\n  outline: none;\n  position: absolute;\n  height: 100%;\n  margin: 0 -3px 0 0;\n  width: 6px;\n  border: 0;\n  padding: 0;\n  right: 0;\n  top: 0;\n  z-index: 2;\n\n  :hover {\n    background: ${props => props.theme.colors.primary.light};\n  }\n`\n\nclass ColHeader extends React.PureComponent {\n\n  static propTypes = {\n    label: PropTypes.string.isRequired,\n    setColWidth: PropTypes.func.isRequired,\n    width: PropTypes.number.isRequired,\n  }\n\n  static defaultProps = {\n    width: DEFAULT_COL_WIDTH,\n  }\n\n  constructor() {\n    super()\n    this.handleBtnWidthOnMouseDown = this.handleBtnWidthOnMouseDown.bind(this)\n    this.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this)\n    this.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this)\n    this.debSetColWidth = this.debSetColWidth.bind(this)\n  }\n\n  state = {\n    pageX: 0,\n    width: 0,\n    btnRight: 0,\n    isResizing: false,\n  }\n\n  getBtnWidthStyle() {\n    if (!this.state.isResizing) { return }\n\n    const newRight = this.state.btnRight\n    const minRight = MIN_COL_WIDTH - this.state.width\n    const maxRight = MAX_COL_WIDTH - this.state.width\n    const right = -(clamp(newRight, minRight, maxRight) - 4)\n\n    return (theme) => css`\n      width: 1.5px;\n      height: 90vh;\n      right: ${right}px;\n      background: ${theme.colors.primary.light};\n    `\n  }\n\n  debSetColWidth = debounce(40, (event) => {\n    const delta = event.pageX - this.state.pageX\n    this.setState({ btnRight: delta, })\n  })\n\n  handleDocumentMouseMove(event) {\n    this.debSetColWidth(event)\n  }\n\n  handleDocumentMouseUp(event) {\n    const delta = event.pageX - this.state.pageX\n    const width = this.state.width + delta\n\n    this.props.setColWidth(this.props.label, width)\n    this.setState({ btnRight: 0, isResizing: false })\n    document.removeEventListener('mousemove', this.handleDocumentMouseMove)\n    document.removeEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n\n  handleBtnWidthOnMouseDown(event) {\n    event.preventDefault()\n\n    this.setState({\n      pageX: event.pageX,\n      width: this.props.width,\n      isResizing: true,\n    })\n\n    document.addEventListener('mousemove', this.handleDocumentMouseMove)\n    document.addEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n  \n  // handleBtnWidthOnMouseMove(event) {\n  //   if (!this.state.isSettingWidth) { return }\n  //   document.addEventListener('mousemove', (event) => {\n\n  //   })\n  //   const { pageX, pageY } = event\n  //   console.log('handle', pageX, pageY)\n  // }\n\n  render() {\n    const { label, width } = this.props\n\n    return (\n      <Root\n        data-col={label}\n        className='col-label-height'\n        css={css`\n          width: ${width}px;\n          height: 26px;\n        `}\n      >\n        {label}\n        <BtnWidth\n          css={this.getBtnWidthStyle()}\n          tabIndex='-1'\n          onMouseDown={this.handleBtnWidthOnMouseDown}\n          onMouseMove={this.handleBtnWidthOnMouseMove}\n          onMouseUp={this.handleBtnWidthOnMouseUp}\n        />\n      </Root>\n    )\n  }\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const width = state.tableMeta.colWidths[ownProps.label]\n  return { width }\n}\n\nconst mapDispatchToProps = { setColWidth }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColHeader)\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\n\nimport ColHeader from '../cell/ColHeader'\nimport { ROW_HEADER_WIDTH } from '../cell/RowHeader'\n\n\nconst Row = styled.div`\n  display: flex;\n  width: fit-content;\n`\n\nconst InnerBorder = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.table.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.table.borderDark};\n  background: ${props => props.theme.colors.table.labelBkg};\n`\n\nfunction ColHeaderRow({ colLabels }) {\n  const renderCornerCell = () => (\n    <InnerBorder\n      css={css`\n        width: ${ROW_HEADER_WIDTH}px;\n        height: 26px;\n      `}\n    />\n  )\n\n  const renderLabelCells = () => (\n    new Array(colLabels.length).fill(0).map((_, i) => (\n      <ColHeader\n        key={i}\n        label={colLabels[i]}\n      />\n    )\n  ))\n\n  return (\n    <Row\n      data-row='header'\n    >\n      {renderCornerCell()}\n      {renderLabelCells()}\n    </Row>\n  )\n}\n\nColHeaderRow.propTypes = {\n  colLabels: PropTypes.arrayOf(PropTypes.string)\n}\n\nexport default ColHeaderRow\n\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\n\n\nconst Root = styled.div`\n  display: flex;\n  align-items: center;\n  border: 2px solid transparent;\n  line-height: 1.1em;\n  height: 100%;\n  width: 100%;\n  padding: 2px;\n`\n\nfunction Datum({\n  fwdRef,\n  isActive,\n  location,\n  onClick,\n  onDoubleClick,\n  onFocus,\n  onKeyDown,\n  result,\n}) {\n\n  const getStyle = () => {\n    let style = {}\n\n    if (typeof result === 'number') {\n      style = {\n        whiteSpace: 'nowrap',\n        textOverflow: 'clip',\n        overflow: 'hidden',\n      }\n    }\n\n    if (isActive) {\n      style.border = '2px solid salmon'\n    }\n\n    return style\n  }\n\n  return (\n    <Root\n      ref={fwdRef}\n      data-cell='result'\n      data-location={location}\n      css={getStyle()}\n      tabIndex='0'\n      onClick={onClick}\n      onKeyDown={onKeyDown}\n      onDoubleClick={onDoubleClick}\n      onFocus={onFocus}\n    >\n    {result}\n  </Root>\n  )\n}\n\nDatum.propTypes = {\n  fwdRef: PropTypes.object.isRequired,\n  result: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]).isRequired,\n  isActive: PropTypes.bool.isRequired,\n  onClick: PropTypes.func.isRequired,\n  onKeyDown: PropTypes.func.isRequired,\n  onDoubleClick: PropTypes.func.isRequired,\n  onFocus: PropTypes.func.isRequired,\n}\n\nexport default Datum\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\n\nimport { unscheduleFloatingInputter } from '~/actions/globalActions'\nimport { clearCellData } from '~/actions/tableDataActions'\nimport { openFloatingInputter, setActiveCell } from '~/actions/globalActions'\nimport Datum from './Datum'\n\n\nexport class Result extends React.PureComponent {\n\n  static propTypes = {\n    // props\n    location: PropTypes.string.isRequired,\n    fwdRef: PropTypes.object.isRequired,\n    // redux\n    clearCellData: PropTypes.func.isRequired,\n    isActive: PropTypes.bool.isRequired,\n    openFloatingInputter: PropTypes.func.isRequired,\n    result: PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.number,\n    ]).isRequired,\n    scheduledFloatingInputter: PropTypes.shape({\n      willOpen: PropTypes.bool,\n      isInteractive: PropTypes.bool,\n    }).isRequired,\n    setActiveCell: PropTypes.func.isRequired,\n    unscheduleFloatingInputter: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props)\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.handleOnDoubleClick = this.handleOnDoubleClick.bind(this)\n    this.handleOnFocus = this.handleOnFocus.bind(this)\n    this.handleOnKeyDown = this.handleOnKeyDown.bind(this)\n    this.refDatum = props.fwdRef\n  }\n\n  componentDidUpdate() {\n    this.scheduledFloatingInputter()\n  }\n\n  scheduledFloatingInputter() {\n    if (!this.props.isActive) { return }\n    if (!this.props.scheduledFloatingInputter.willOpen) { return }\n\n    const { isInteractive } = this.props.scheduledFloatingInputter\n    this.props.unscheduleFloatingInputter()\n    this.openFloatingInputter(false, isInteractive)\n  }\n\n  openFloatingInputter(willReplaceValue, isInteractive) {\n    const datumRect = this.refDatum.current.getBoundingClientRect()\n    const cellRect = JSON.parse(JSON.stringify(datumRect))\n    this.props.openFloatingInputter(cellRect, willReplaceValue, isInteractive)\n  }\n\n  getDatumStyle() {\n    if (this.props.isActive) { return }\n\n    return {\n      border: '2px solid salmon',\n    }\n  }\n\n  handleOnFocus() {\n    this.props.setActiveCell(this.props.location)\n  }\n\n  handleOnClick(event) {\n    event.stopPropagation()\n  }\n\n  handleOnDoubleClick(event) {\n    event.stopPropagation()\n    this.openFloatingInputter(false, true)\n  }\n\n  handleOnKeyDown({ key }) {\n    if (['Delete', 'Backspace'].includes(key)) {\n      const valueStr = '' + this.props.result\n\n      if (valueStr.length > 0) {\n        this.props.clearCellData(this.props.location)\n      }\n      // key pressed is a printable symbol, ex: 'a', '1', ','\n      // can be further refined, but for now it's fine\n    } else if (key.length === 1) {\n      this.openFloatingInputter(true, true)\n    }\n  }\n\n  render() {\n    return (\n      <Datum\n        fwdRef={this.refDatum}\n        location={this.props.location}\n        result={this.props.result}\n        onClick={this.handleOnClick}\n        onDoubleClick={this.handleOnDoubleClick}\n        onFocus={this.handleOnFocus}\n        onKeyDown={this.handleOnKeyDown}\n        isActive={this.props.isActive}\n      />\n    )\n  }\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const isActive = state.global.activeCell.location === ownProps.location\n  const { scheduledFloatingInputter } = state.global\n  const cell = state.tableData[ownProps.location]\n  const result = cell ? cell.result : ''\n  return { result, isActive, scheduledFloatingInputter }\n}\n\nconst mapDispatchToProps = {\n  clearCellData,\n  openFloatingInputter,\n  setActiveCell,\n  unscheduleFloatingInputter,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Result)\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport { connect } from 'react-redux'\n\nimport { DEFAULT_COL_WIDTH } from '~/library/constants'\n\n\nconst Root = styled.div`\n  cursor: cell;\n  overflow: hidden;\n  font-size: 13px;\n  border-right: 1px solid ${props => props.theme.colors.table.border};\n  border-bottom: 1px solid ${props => props.theme.colors.table.border};\n  outline: none;\n`\n\nexport function OutterBorder({ width, height, onClick, onDoubleClick, children }) {\n  return (\n    <Root\n      data-cell='border'\n      onClick={onClick}\n      onDoubleClick={onDoubleClick}\n      css={{\n        width,\n        height: height && height\n      }}\n    >\n      {children}\n    </Root>\n  )\n}\n\nOutterBorder.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  onDoubleClick: PropTypes.func.isRequired,\n  location: PropTypes.string.isRequired,\n  width: PropTypes.number,\n  height: PropTypes.number,\n}\n\nOutterBorder.defaultProps = {\n  width: DEFAULT_COL_WIDTH,\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const [colLabel, rowLabel] = ownProps.location.split('-')\n  const width = state.tableMeta.colWidths[colLabel]\n  const height = state.tableMeta.rowHeights[rowLabel]\n  return { width, height }\n}\n\nexport default connect(mapStateToProps)(OutterBorder)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Result from './Result'\nimport OutterBorder from './OutterBorder'\n\n\nclass ResultCell extends React.PureComponent {\n\n  static propTypes = {\n    location: PropTypes.string.isRequired,\n  }\n\n  refDatum = React.createRef()\n\n  constructor() {\n    super()\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.handleOnDoubleClick = this.handleOnDoubleClick.bind(this)\n  }\n\n  focusDatum() {\n    setTimeout(() => this.refDatum.current.focus(), 0)\n  }\n\n  handleOnClick() {\n    this.focusDatum()\n  }\n\n  handleOnDoubleClick() {\n    this.focusDatum()\n  }\n\n  render() {\n    const { location } = this.props\n\n    return (\n      <OutterBorder\n        onClick={this.handleOnClick}\n        onDoubleClick={this.handleOnDoubleClick}\n        location={location}\n      >\n        <Result\n          location={location}\n          fwdRef={this.refDatum}\n        />\n      </OutterBorder>\n    )\n  }\n}\n\nexport default ResultCell\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\n\nimport RowHeader from '../cell/RowHeader'\nimport ResultCell from '../ResultCell/ResultCell'\n\n\nconst Row = styled.div`\n  display: flex;\n  width: fit-content;\n`\n\nfunction DataRow({ rowNumber, colLabels }) {\n  const dataCells = () => (\n    new Array(colLabels.length).fill(0).map((_, i) => {\n      const location = `${colLabels[i]}-${rowNumber}`\n      return (\n        <ResultCell\n          key={i}\n          location={location}\n        />\n      )\n    })\n  )\n\n  return (\n    <Row\n      data-row={rowNumber}\n    >\n      <RowHeader\n        label={rowNumber}\n      />\n      {dataCells()}\n    </Row>\n  )\n}\n\nDataRow.propTypes = {\n  rowNumber: PropTypes.number,\n  colLabels: PropTypes.arrayOf(PropTypes.string),\n}\n\nexport default DataRow\n\n","import { Machine, assign } from 'xstate'\n\nimport { parseLocation, getColumnLabel } from '~/library/utils'\n\n\nfunction getTargetLocation({ rows, columns, rowIndex, colIndex, key }) {\n  switch (key) {\n    case 'ArrowUp':\n      rowIndex = Math.max(0, rowIndex - 1)\n      break\n    case 'ArrowRight':\n      colIndex = Math.min(columns - 1, colIndex + 1)\n      break\n    case 'ArrowDown':\n    case 'Enter':\n      rowIndex = Math.min(rows - 1, rowIndex + 1)\n      break\n    case 'ArrowLeft':\n      colIndex = Math.max(0, colIndex - 1)\n      break\n    default:\n      return null\n  }\n\n  const colLabel = getColumnLabel(colIndex)\n  const rowLabel = '' + (rowIndex + 1)\n\n  return `${colLabel}-${rowLabel}`\n}\n\nfunction focusTargetCell(ctx) {\n  if (!ctx.endLocation) { return Promise.resolve(false) }\n\n  return new Promise(resolve => {\n    setTimeout(() => {\n      const id = `[data-location=\"${ctx.endLocation}\"]`\n      const cell = document.querySelector(id)\n      if (cell) { cell.focus() }\n      resolve(true)\n    }, 0)\n  })\n}\n\nconst state = {\n  id: 'keyboardNav',\n  initial: 'idle',\n  context: {\n    columns: null,\n    rows: null,\n    key: null,\n    colIndex: null,\n    rowIndex: null,\n    endLocation: null,\n    wasFocused: false,\n  },\n  states: {\n    idle: {\n      on: {\n        'MOVE_FOCUS': {\n          actions: ['setNewContext', 'calcTargetLocation'],\n          target: 'focusTarget',\n        }\n      }\n    },\n    focusTarget: {\n      invoke: {\n        src: focusTargetCell,\n        onDone: {\n          actions: assign({ wasFocused: (ctx, event) => event.data }),\n          target: 'idle',\n        },\n      },\n    },\n  },\n}\n\nconst actions = {\n  actions: {\n    setNewContext: assign((ctx, { key, location }) => {\n      const [colIndex, rowIndex] = parseLocation(location)\n      return { colIndex, rowIndex, key }\n    }),\n    calcTargetLocation: assign({\n      endLocation: (ctx) => {\n        return getTargetLocation(ctx)\n      }\n    }),\n  },\n}\n\nfunction getKeyboardNavMachine(rows, columns) {\n  const newContext = {\n    ...state.context,\n    columns,\n    rows,\n  }\n\n  return Machine(state, actions, newContext)\n}\n\nexport {\n  state,\n  actions,\n  getTargetLocation,\n  focusTargetCell,\n}\n\nexport default getKeyboardNavMachine\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { connect } from 'react-redux'\nimport { interpret } from 'xstate'\n\nimport { setActiveCell } from '~/actions/globalActions'\nimport ColHeaderRow from './ColHeaderRow'\nimport DataRow from './DataRow'\nimport { getColumnNames } from '~/library/utils'\nimport getKeyboardNavMachine from './keyboardNavMachine'\n\n\nconst Grid = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 60vh;\n  min-height: 300px;\n  border-top: 2px solid ${props => props.theme.colors.table.borderDark};\n  border-left: 2px solid ${props => props.theme.colors.table.borderDark};\n  border-right: 1px solid ${props => props.theme.colors.table.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.table.borderDark};\n  overflow: scroll;\n\n  * {\n    box-sizing: border-box;\n  }\n`\n\nexport class Table extends React.PureComponent {\n  static propTypes = {\n    rows: PropTypes.number.isRequired,\n    columns: PropTypes.number.isRequired,\n    setActiveCell: PropTypes.func.isRequired,\n  }\n\n  constructor(props) {\n    super(props)\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.handleOnKeyDown = this.handleOnKeyDown.bind(this)\n    this.colLabels = getColumnNames(props.columns)\n  }\n\n  keyboardNavMachine = getKeyboardNavMachine(this.props.rows, this.props.columns)\n  focusService = interpret(this.keyboardNavMachine)\n  refGrid = React.createRef()\n\n  componentDidMount() {\n    this.focusService.start()\n    this.props.setActiveCell('A-1')\n    this.focusA_1()\n  }\n\n  componentWillUnmount() {\n    this.focusService.stop()\n  }\n\n  focusA_1() {\n    const el = document.querySelector('[data-location=\"A-1\"]')\n    el && el.focus()\n  }\n\n  handleOnClick(event) {\n    event.stopPropagation()\n  }\n\n  handleOnKeyDown(event) {\n    event.stopPropagation()\n    event.preventDefault()\n\n    const { location } = event.target.dataset\n\n    if (location) {\n      this.moveFocus(event.key, event.target.dataset.location)\n    }\n  }\n\n  moveFocus(key, location) {\n    this.focusService.send({ type: 'MOVE_FOCUS', key, location })\n  }\n\n  renderColHeaderRow(i) {\n    return (\n      <ColHeaderRow\n        key={i}\n        rows={this.props.rows}\n        colLabels={this.colLabels}\n      />\n    )\n  }\n\n  renderDataRows(rowNumber) {\n    return (\n      <DataRow\n        key={rowNumber}\n        rowNumber={rowNumber}\n        colLabels={this.colLabels}\n      />\n    )\n  }\n\n  renderRows() {\n    return new Array(this.props.rows + 1).fill(0).map((_, i) => {\n      if (i === 0) {\n        return this.renderColHeaderRow(i)\n      } else {\n        return this.renderDataRows(i)\n      }\n    })\n  }\n\n  render() {\n    return (\n      <Grid\n        ref={this.refGrid}\n        data-table='app'\n        onClick={this.handleOnClick}\n        onKeyDown={this.handleOnKeyDown}\n      >\n        {this.renderRows()}\n      </Grid>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const { rows, columns } = state.global\n  return { rows, columns }\n}\n\nconst mapDisptachToProps = { setActiveCell }\n\nexport default connect(mapStateToProps, mapDisptachToProps)(Table)\n","import React from 'react'\n// import PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\n\n\nconst Root = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 40px;\n`\n\nconst Wrapper = styled.div`\n  width: 400px;\n  padding-left: 60px;\n`\n\nconst Title = styled.h3`\n  padding-bottom: 15px;\n`\n\nconst Ul = styled.ul`\n  list-style: none;\n  column-count: 3;\n`\n\nconst Li = styled.li`\n  font-size: 14px;\n`\n\nfunction Instructions() {\n  return (\n    <Root>\n      <Wrapper>\n        <Title>Available Functions</Title>\n        <Ul>\n          <Li>AVERAGE</Li>\n          <Li>AVG</Li>\n          <Li>CONCAT</Li>\n          <Li>COUNT</Li>\n          <Li>MAX</Li>\n          <Li>MIN</Li>\n          <Li>POW</Li>\n          <Li>POWER</Li>\n          <Li>SQRT</Li>\n          <Li>SUM</Li>\n        </Ul>\n      </Wrapper>\n    </Root>\n  )\n}\n\nexport default Instructions\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\n\nimport Header from './components/header/Header'\nimport FormulaBar from './components/FormulaBar/FormulaBar'\nimport FloatingInputter from './components/FloatingInputter/FloatingInputter'\nimport Table from './components/table/Table'\nimport Instructions from './components/Instructions/Instructions'\n\n\n\nconst Container = styled.div`\n  display: grid;\n  grid:\n    \"left-blank main right-blank\" 100vh\n    / auto minmax(auto, 1000px) auto;\n`\n\nconst Main = styled.main`\n  grid-area: main;\n`\n\nfunction App() {\n  return (\n    <Container>\n      <Main>\n        <FloatingInputter />\n        <div data-dummy-focus-stop tabIndex=\"0\" />\n        <Header />\n        <FormulaBar />\n        <Table />\n        <Instructions />\n      </Main>\n    </Container>\n  )\n}\n\nApp.propTypes = {\n  setActiveCell: PropTypes.func,\n}\n\nexport default App\n","import React from 'react'\nimport { Provider } from 'react-redux'\nimport { BrowserRouter } from 'react-router-dom'\nimport { ThemeProvider } from 'emotion-theming'\nimport { Global } from '@emotion/core'\nimport 'sanitize.css'\n\nimport appStore from './reducers/'\nimport globalStyles from './styles/globalStyles'\nimport theme from './styles/theme'\nimport App from './App'\n\n\nfunction Root() {\n  return (\n    <Provider store={appStore}>\n      <BrowserRouter>\n        <ThemeProvider theme={theme}>\n          <Global styles={globalStyles} />\n          <App />\n        </ThemeProvider>\n      </BrowserRouter>\n    </Provider>\n  )\n}\n\nexport default Root\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Root from './Root'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<Root />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}
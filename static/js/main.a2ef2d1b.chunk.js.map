{"version":3,"sources":["library/utils.js","formulas/formulaFunctions.js","formulas/TokenSanitizer.js","formulas/LexerRule.js","formulas/Lexer.js","formulas/Token.js","components/CellInputter/InputContext.js","reducers/globalReducer.js","reducers/tableDataReducer.js","reducers/tableMetaReducer.js","reducers/index.js","actions/globalActions.js","formulas/ReduxConnect.js","formulas/ast.js","formulas/Parser.js","formulas/Interpreter.js","formulas/graph.js","actions/tableDataActions.js","components/CellInputter/Inputter.jsx","components/CellInputter/CellInputter.jsx","components/CellInputter/HiddenInput.jsx","components/CellInputter/FuncDescription.jsx","library/InteractiveListItem.jsx","library/InteractiveList.jsx","components/CellInputter/FuncSelector.jsx","components/CellInputter/Suggestions.jsx","styles/theme.js","styles/globalStyles.js","components/header/Header.jsx","library/constants.js","components/cell/ColHeader.jsx","actions/tableMetaActions.js","components/table/ColHeaderRow.jsx","components/cell/RowHeader.jsx","components/ResultCell/Datum.jsx","components/ResultCell/Result.jsx","components/ResultCell/OutterBorder.jsx","components/ResultCell/ResultCell.jsx","components/table/DataRow.jsx","components/table/keyboardNavMachine.js","components/table/Table.jsx","App.jsx","Root.jsx","serviceWorker.js","index.js"],"names":["BASE_CODE_POINT","codePointAt","clamp","value","min","max","Math","getColumnNames","cols","names","prevNames","remainCols","newNames","outerLoop","_i","_prevNames","length","colName","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","letter","push","concat","err","return","Object","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","getColumnLabel","num","label","basePoint","curr","codePoint","String","fromCodePoint","floor","reverse","join","parseLocation","location","_location$split","split","_location$split2","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","col","row","reduce","prev","charCodeAt","isNumber","numStr","isPeriodsAndDigits","Boolean","match","periodCount","debounce","time","fn","timeout","apply","arguments","setTimeout","clearTimeout","testArgsAllNumbers","args","forEach","arg","TypeError","Fn","AVERAGE","_Fn$SUM","_Fn$COUNT","Error","SUM","COUNT","definition","example","summary","CONCAT","_len","Array","_key","MAX","_len2","_key2","MIN","_len3","_key3","POWER","_len4","_key4","base","exp","pow","SQRT","_len5","_key5","sqrt","_len6","_key6","AVG","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","POW","TokenSanitizer","tokens","classCallCheck","this","_this","map","token","type","t","NUMBER","number","CELL","cell","FUNCTION","function","STRING","string","text","parseFloat","UNKNOWN","getCellLabel","getFunction","slice","index","toUpperCase","fnName","fnNode","formulaFuncs","LexerRule","regex","groupIndex","category","lastIndex","input","exec","TOKENS","EOF","EQUALS","COMMA","COLON","LPAREN","RPAREN","PLUS","MINUS","MULT","DIV","TEXT","GRAMMAR","Lexer","char","initChar","markers","nextToken","sanitizer","sanitize","Token","isFormula","tokenTEXTorNUMBER","whitespaceLen","getWhitespaceLen","_GRAMMAR","rule","setIndex","test","consume","tokenUNKNOWN","whitespace","chars","isEOF","isSeparator","isWhitespace","count","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","html","__webpack_require__","d","__webpack_exports__","InputContext","react__WEBPACK_IMPORTED_MODULE_0__","n","React","createContext","createReducer","activeCell","cellInputter","rows","columns","SET_ACTIVE_CELL","state","_ref","payload","OPEN_CELL_INPUTTER","_ref2","CLOSE_CELL_INPUTTER","objectSpread","isCellInputterOpen","SET_CELL_DATA","data","DELETE_CELL_DATA","colWidths","rowHeights","SET_COL_WIDTH","colLabel","width","defineProperty","SET_ROW_HEIGHT","rowLabel","height","appStore","configureStore","reducer","global","globalReducer","tableData","tableDataReducer","tableMeta","tableMetaReducer","setActiveCell","openCellInputter","closeCellInputter","redux_starter_kit__WEBPACK_IMPORTED_MODULE_0__","dispatch","getState","entered","Promise","resolve","cellRect","willReplaceValue","newEntered","createAction","ReduxConnect","store","globalState","result","replaceCellData","clearCellData","keys","AST","name","_name","TextNode","textNode","possibleConstructorReturn","getPrototypeOf","call","node","StringNode","_this2","NumberNode","_this3","CellNode","_this4","CellRange","leftCell","rightCell","_this5","UnaryOp","opNode","expr","_this6","evaluatedExpr","FuncOp","funcNode","argNodes","_this7","evaluatedArgs","toConsumableArray","BinaryOp","leftNode","rightNode","_this8","left","right","Parser","ast","peekType","equals","operator","term","includes","factor","enclosedExpr","unaryOp","func","lparen","rparen","isCellRange","_this$invertCellRange","invertCellRange","_this$invertCellRange2","slicedToArray","temp","list","listNode","cellRange","DQUOTE","stepsAhead","Interpreter","error","cache","lexer","parser","vertex","graph","addVertex","getTokens","parse","recalculate","errorResponse","getVertex","visitNode","nodeName","constructor","eval","getCellResult","_parseLocation","_parseLocation2","leftColIndex","leftRowIndex","_parseLocation3","_parseLocation4","rightColIndex","rightRowIndex","colIndexStart","colIndexEnd","rowIndexStart","rowIndexEnd","rowI","colI","otherLocation","isLocationValid","visitCell","childNode","_parseLocation5","_parseLocation6","colIndex","rowIndex","errorMsg","message","Vertex","Graph","adj","pending","visited","setPendingNodes","dfs","updateStore","Set","add","size","visitAST","delete","hasVertex","testPathCycle","has","locationKeys","locations","_Object$entries","entries","_ref3","clearCell","testMissingLocation","setCellData","interpret","delVertex","tableDataActions_replaceCellData","Input","_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__","target","props","theme","colors","shadow","Root","_emotion_styled_base__WEBPACK_IMPORTED_MODULE_7__","styles","CellInputter","_React$PureComponent","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","isFuncSelectorVisible","inputValue","keyEvent","key","cursorPos","refInput","createRef","handleOnKeyDown","bind","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","handleOnBlur","handleOnChange","setIsFuncSelectorVisible","setInputValue","setInputWidth","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__","focusInputTag","prevProps","prevState","setFocus","keyActions","tokenizeInputValue","setState","current","selectionEnd","setCellValue","inputEl","setImmediate","focus","selectionStart","el","elId","_home_travis_build_julianhr_app_spreadsheet_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","nextRowIndex","endLocation","document","querySelector","activeElement","cellValue","event","preventDefault","_this$props$cellRect","top","cellWidth","inputRect","getBoundingClientRect","_emotion_core__WEBPACK_IMPORTED_MODULE_9__","_InputContext__WEBPACK_IMPORTED_MODULE_15__","Provider","css","getRootStyle","_HiddenInput__WEBPACK_IMPORTED_MODULE_17__","_Inputter__WEBPACK_IMPORTED_MODULE_18__","ref","data-cell","data-location","onChange","onKeyDown","onBlur","_Suggestions__WEBPACK_IMPORTED_MODULE_14__","PureComponent","mapDispatchToProps","connect","_state$global","_state$global$cellInp","_state$global$activeC","_emotion_styled_base__WEBPACK_IMPORTED_MODULE_6__","BaseInput","HiddenInput","textWidth","scrollWidth","_emotion_core__WEBPACK_IMPORTED_MODULE_8__","defaultValue","_emotion_css__WEBPACK_IMPORTED_MODULE_0__","styled_base_browser_esm","dropdown","normal","active","Pre","Subtitle","P","Hr","FuncDescription","currScope","_this$props","fnScopes","scope","startIndex","endIndex","getFnScope","context","bottom","getFnNode","core_browser_esm","css_browser_esm","FuncDescription_ref","contextType","Li","DropdownItem","item","isActive","onMouseEnter","tabIndex","defaultProps","Ul","InteractiveList","items","react_default","a","createElement","InteractiveListItem","style","li","ul","renderListItems","propsTypes","PropTypes","array","isRequired","shape","object","Dialog","baseItemStyle","ItemBaseRoot","ItemActiveRoot","FuncSelector","listItems","itemIndex","isVisible","handleOnClick","assertThisInitialized","setListItems","nextProps","nextState","updateContextData","updateListItems","keyEventSetIndex","updateInputValue","currInputValue","rightChunkIndex","leftChunk","rightChunk","newInputValue","filter","startsWith","sort","itemBase","itemActive","FuncSelector_Pre","FuncSelector_Subtitle","marginTop","boxShadow","border","_this$state","open","onClick","library_InteractiveList","round","getListStyles","Component","withTheme","Suggestions","setFnScopes","stack","pop","b","getCurrTokenIndex","_this$getCompareToken","getCompareTokens","_this$getCompareToken2","tokenBefore","tokenCurr","tokenAfter","option1","option2","CellInputter_FuncSelector","renderedFuncSelector","getFuncSelector","CellInputter_FuncDescription","breaks","xs","sm","md","lg","breakBump","queries","from","breakPoint","upTo","borderDark","labelBkg","primary","strong","light","field","background","globalStyles","Header","MIN_COL_WIDTH","MAX_COL_WIDTH","MIN_ROW_HEIGHT","MAX_ROW_HEIGHT","BtnWidth","ColHeader","pageX","btnRight","isResizing","debSetColWidth","delta","handleBtnWidthOnMouseDown","handleDocumentMouseMove","handleDocumentMouseUp","newRight","minRight","maxRight","setColWidth","removeEventListener","addEventListener","ColHeader_Root","data-col","className","getBtnWidthStyle","onMouseDown","onMouseMove","handleBtnWidthOnMouseMove","onMouseUp","handleBtnWidthOnMouseUp","ownProps","Row","InnerBorder","ColHeaderRow","colLabels","data-row","ColHeaderRow_ref","fill","_","i","cell_ColHeader","BtnHeight","RowHeader","pageY","btnBottom","refRoot","debSetRowHeight","handleBtnHeightOnMouseDown","minHeight","newBottom","minBottom","maxBottom","setRowHeight","RowHeader_Root","getBtnHeightStyle","handleBtnHeightOnMouseMove","handleBtnHeightOnMouseUp","Datum","fwdRef","onDoubleClick","onFocus","Datum_Root","whiteSpace","textOverflow","overflow","getStyle","Result","handleOnDoubleClick","handleOnFocus","refDatum","inherits","createClass","datumRect","JSON","stringify","stopPropagation","ResultCell_Datum","OutterBorder","children","OutterBorder_Root","_ownProps$location$sp","_ownProps$location$sp2","ResultCell","focusDatum","ResultCell_OutterBorder","ResultCell_Result","DataRow","rowNumber","DataRow_Row","cell_RowHeader","components_ResultCell_ResultCell","id","initial","wasFocused","states","idle","on","MOVE_FOCUS","actions","focusTarget","invoke","src","ctx","onDone","assign","setNewContext","calcTargetLocation","getTargetLocation","getKeyboardNavMachine","newContext","Machine","Grid","Table","keyboardNavMachine","focusService","handleTableOnClick","handleTableOnKeyDown","start","stop","dataset","moveFocus","send","table_ColHeaderRow","table_DataRow","renderColHeaderRow","renderDataRows","data-table","renderRows","Container","Main","data-dummy-focus-stop","header_Header","table_Table","es","react_router_dom","emotion_theming_browser_esm","src_App","window","hostname","ReactDOM","render","src_Root","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"6SAAMA,EAAkB,IAAIC,YAAY,GAOjC,SAASC,EAAMC,EAAOC,EAAKC,GAChC,OAAOC,KAAKF,IAAKE,KAAKD,IAAIF,EAAOC,GAAMC,GAelC,SAASE,EAAeC,GAM7B,IALA,IACIC,EAAQ,GACRC,EAAY,CAAC,IACbC,EAAaH,EAEVG,EAAa,GAAG,CACrB,IAAMC,EAAW,GAEjBC,EACA,QAAAC,EAAA,EAAAC,EAAoBL,EAApBI,EAAAC,EAAAC,OAAAF,IAA+B,CAA1B,IAAIG,EAAOF,EAAAD,GAAeI,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAC7B,QAAAC,EAAAC,EAVa,6BAUbC,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAA6B,KAApBU,EAAoBN,EAAAnB,MAC3B,GAAmB,IAAfQ,EAAqB,MAAME,EAC/BD,EAASiB,KAAT,GAAAC,OAAiBb,GAAjBa,OAA2BF,IAC3BjB,GAAc,GAJa,MAAAoB,GAAAZ,GAAA,EAAAC,EAAAW,EAAA,YAAAb,GAAA,MAAAK,EAAAS,QAAAT,EAAAS,SAAA,WAAAb,EAAA,MAAAC,IAQ/BV,EAAYE,EACZH,EAAK,GAAAqB,OAAAG,OAAAC,EAAA,EAAAD,CAAOxB,GAAUG,GAGxB,OAAOH,EAyBF,SAAS0B,EAAeC,GAC7B,IAAMC,EAAQ,GACRC,EAAYtC,EACduC,EAAOH,EAAM,EAEjB,EAAG,CAED,IACMI,EAAYF,GAFlBC,GAAQ,GACsB,GAExBX,EAASa,OAAOC,cAAcF,GACpCH,EAAMR,KAAKD,GAEXW,EAAOjC,KAAKqC,MAAMJ,EAAO,UAClBA,EAAO,GAEhB,OAAOF,EAAMO,UAAUC,KAAK,IAGvB,SAASC,EAAcC,GAAU,IAAAC,EACrBD,EAASE,MAAM,KADMC,EAAAjB,OAAAkB,EAAA,EAAAlB,CAAAe,EAAA,GACjCI,EADiCF,EAAA,GAC5BG,EAD4BH,EAAA,GAKtC,MAAO,CAH4BE,EA5BVH,MAAM,IACPK,OAAO,SAACC,EAAM3B,GAAP,OACtB,GAAP2B,EAAY3B,EAAO4B,WAAW,GAAKxD,EAAkB,GACpD,GAEc,GAwBCqD,EAAM,GAKnB,SAASI,EAASC,GACvB,IAAMC,EAAqBC,QAAQF,EAAOG,MAAM,aAC1CC,GAAeJ,EAAOG,MAAM,QAAU,IAAI7C,OAEhD,QAAK2C,MACDG,EAAc,KACI,IAAlBJ,EAAO1C,QAA8B,MAAd0C,EAAO,KAI7B,SAASK,EAASC,EAAMC,GAC7B,IAAIC,EAEJ,OAAO,WACDA,IAEJD,EAAEE,WAAF,EAAAC,WAEAF,EAAUG,WAAW,WACnBC,aAAaJ,GACbA,EAAU,MACTF,mDCrHP,SAASO,EAAmBC,GAC1BA,EAAKC,QAAQ,SAAAC,GACX,GAAmB,kBAARA,EACT,MAAM,IAAIC,UAAJ,mCAAA7C,OAAiD4C,MAK7D,IAAME,EAAK,CACTC,QAAS,CACPZ,GAAI,WAAa,IAAAa,EAAAC,EACf,GAAoB,IAAhBX,UAAKpD,OACP,MAAM,IAAIgE,MAAM,kBAGlB,OAAOF,EAAAF,EAAGK,KAAIhB,GAAPE,MAAAW,EAAAV,YAAqBW,EAAAH,EAAGM,OAAMjB,GAATE,MAAAY,EAAAX,YAE9Be,WAAY,+BACZC,QAAS,oBACTC,QAAS,iDAGXC,OAAQ,CACNrB,GAAI,WAAa,QAAAsB,EAAAnB,UAAApD,OAATwD,EAAS,IAAAgB,MAAAD,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAATjB,EAASiB,GAAArB,UAAAqB,GACf,GAAoB,IAAhBjB,EAAKxD,OACP,MAAM,IAAIgE,MAAM,kBAGlB,OAAOR,EAAKlB,OAAO,SAACC,EAAMhB,GAAP,OAAiBgB,EAAOhB,GAAO,KAEpD4C,WAAY,gCACZC,QAAS,uBACTC,QAAS,kEAGXH,MAAO,CACLjB,GAAI,kBAAaG,UAAKpD,QACtBmE,WAAY,iCACZC,QAAS,sBACTC,QAAS,sDAGXK,IAAK,CACHzB,GAAI,WAAa,QAAA0B,EAAAvB,UAAApD,OAATwD,EAAS,IAAAgB,MAAAG,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAATpB,EAASoB,GAAAxB,UAAAwB,GACf,GAAoB,IAAhBpB,EAAKxD,OACP,MAAM,IAAIgE,MAAM,kBAIlB,OADAT,EAAmBC,GACZlE,KAAKD,IAAL8D,MAAA7D,KAAYkE,IAErBW,WAAY,2BACZC,QAAS,oBACTC,QAAS,sDAGXQ,IAAK,CACH5B,GAAI,WAAa,QAAA6B,EAAA1B,UAAApD,OAATwD,EAAS,IAAAgB,MAAAM,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAATvB,EAASuB,GAAA3B,UAAA2B,GACf,GAAoB,IAAhBvB,EAAKxD,OACP,MAAM,IAAIgE,MAAM,kBAIlB,OADAT,EAAmBC,GACZlE,KAAKF,IAAL+D,MAAA7D,KAAYkE,IAErBW,WAAY,2BACZC,QAAS,oBACTC,QAAS,uDAGXW,MAAO,CACL/B,GAAI,WAAa,QAAAgC,EAAA7B,UAAApD,OAATwD,EAAS,IAAAgB,MAAAS,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAT1B,EAAS0B,GAAA9B,UAAA8B,GACf,GAAoB,IAAhB1B,EAAKxD,OACP,MAAM,IAAIgE,MAAM,mCAGlBT,EAAmBC,GALJ,IAMR2B,EAAa3B,EANL,GAMF4B,EAAO5B,EANL,GAOf,OAAOlE,KAAK+F,IAAIF,EAAMC,IAExBjB,WAAY,wBACZC,QAAS,cACTC,QAAS,2CAGXiB,KAAM,CACJrC,GAAI,WAAa,QAAAsC,EAAAnC,UAAApD,OAATwD,EAAS,IAAAgB,MAAAe,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAThC,EAASgC,GAAApC,UAAAoC,GACf,GAAoB,IAAhBhC,EAAKxD,OACP,MAAM,IAAIgE,MAAJ,kCAIR,OADAT,EAAmBC,GACZlE,KAAKmG,KAAKjC,EAAK,KAExBW,WAAY,cACZC,QAAS,sBACTC,QAAS,wCAGXJ,IAAK,CACHhB,GAAI,WAAa,QAAAyC,EAAAtC,UAAApD,OAATwD,EAAS,IAAAgB,MAAAkB,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAATnC,EAASmC,GAAAvC,UAAAuC,GACf,GAAoB,IAAhBnC,EAAKxD,OACP,MAAM,IAAIgE,MAAM,kBAIlB,OADAT,EAAmBC,GACZA,EAAKlB,OAAO,SAACC,EAAMhB,GAAP,OAAiBA,EAAOgB,GAAO,IAEpD4B,WAAY,2BACZC,QAAS,oBACTC,QAAS,6CAKbT,EAAGgC,IAAH3E,OAAA4E,EAAA,EAAA5E,CAAA,GACK2C,EAAGC,QADR,CAEEM,WAAY,2BACZC,QAAS,kBAGXR,EAAGkC,IAAH7E,OAAA4E,EAAA,EAAA5E,CAAA,GACK2C,EAAGoB,MADR,CAEEb,WAAY,sBACZC,QAAS,cAGIR,gFCrDAmC,aApEb,SAAAA,EAAYC,GAAS/E,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAH,GACnBG,KAAKF,OAASA,yDAGL,IAAAG,EAAAD,KACT,OAAOA,KAAKF,OAAOI,IAAI,SAAAC,GACrB,OAAOA,EAAMC,MACX,KAAKC,EAAEC,OACL,OAAOL,EAAKM,OAAOJ,GACrB,KAAKE,EAAEG,KACL,OAAOP,EAAKQ,KAAKN,GACnB,KAAKE,EAAEK,SACL,OAAOT,EAAKU,SAASR,GACvB,KAAKE,EAAEO,OACL,OAAOX,EAAKY,OAAOV,GACrB,QACE,OAAOA,oCAKRA,GACL,OAAK5D,YAAS4D,EAAMW,OAKpBX,EAAMlH,MAAQ8H,WAAWZ,EAAMW,MACxBX,IALLA,EAAMC,KAAOC,EAAEW,QACRb,gCAONA,GAEH,OADAA,EAAMlH,MAAQ+G,KAAKiB,aAAad,GACzBA,mCAGAA,GACP,IAAMpD,EAAKiD,KAAKkB,YAAYf,GAQ5B,OANIpD,EACFoD,EAAMlH,MAAQ8D,EAEdoD,EAAMC,KAAOC,EAAEW,QAGVb,iCAGFA,GAEL,OADAA,EAAMlH,MAAQkH,EAAMW,KAAKK,MAAM,GAAI,GAC5BhB,uCAGIA,GAAO,IACVW,EAASX,EAATW,KACAM,EAAUN,EAAKnE,MAAM,OAArByE,MACFlF,EAAM4E,EAAKK,MAAM,EAAGC,GAAOC,cAC3BlF,EAAM2E,EAAKK,MAAMC,GACvB,SAAAxG,OAAUsB,EAAV,KAAAtB,OAAiBuB,uCAGPgE,GACV,IAAMmB,EAASnB,EAAMW,KAAKO,cACpBE,EAASC,IAAaF,GAC5B,OAAOC,GAAUA,EAAOxE,YCrDb0E,aAhBb,SAAAA,EAAYC,EAAOC,EAAYxB,EAAOyB,GAAW7G,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAyB,GAC/CzB,KAAK0B,MAAQA,EACb1B,KAAK2B,WAAaA,EAClB3B,KAAKG,MAAQA,EACbH,KAAK4B,SAAWA,uDAGTR,GACPpB,KAAK0B,MAAMG,UAAYT,+BAGpBU,GACH,OAAO9B,KAAK0B,MAAMK,KAAKD,4ECP3B,IAAME,EAAS,CAEbC,IAAK,MAELC,OAAQ,SACRC,MAAO,QACPC,MAAO,QACPC,OAAQ,SACRC,OAAQ,SAERC,KAAM,OACNC,MAAO,QACPC,KAAM,OACNC,IAAK,MAELC,KAAM,OACNnC,KAAM,OACNI,OAAQ,SACRN,OAAQ,SACRI,SAAU,WACVM,QAAS,WAGLX,EAAI2B,EAEJY,EAAU,CAEd,IAAInB,EAAU,KAAM,EAAGpB,EAAE6B,OAAQ,aACjC,IAAIT,EAAU,KAAM,EAAGpB,EAAE8B,MAAO,aAChC,IAAIV,EAAU,KAAM,EAAGpB,EAAE+B,MAAO,aAChC,IAAIX,EAAU,MAAO,EAAGpB,EAAEgC,OAAQ,aAClC,IAAIZ,EAAU,MAAO,EAAGpB,EAAEiC,OAAQ,aAElC,IAAIb,EAAU,MAAO,EAAGpB,EAAEkC,KAAM,YAChC,IAAId,EAAU,MAAO,EAAGpB,EAAEmC,MAAO,YACjC,IAAIf,EAAU,MAAO,EAAGpB,EAAEoC,KAAM,YAChC,IAAIhB,EAAU,MAAO,EAAGpB,EAAEqC,IAAK,YAE/B,IAAIjB,EAAU,aAAc,EAAGpB,EAAEO,OAAQ,UACzC,IAAIa,EAAU,WAAY,EAAGpB,EAAEC,OAAQ,UACvC,IAAImB,EAAU,gBAAiB,EAAGpB,EAAEG,KAAM,UAC1C,IAAIiB,EAAU,eAAgB,EAAGpB,EAAEK,SAAU,WAIzCmC,aACJ,SAAAA,EAAYf,GAAQ/G,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA6C,GAClB7C,KAAK8B,MAAQA,EACb9B,KAAKoB,MAAQ,EACbpB,KAAK8C,KAAO9C,KAAK+C,SAASjB,GAC1B9B,KAAKgD,QAAU,GACfhD,KAAKF,OAAS,2DAId,KAAOE,KAAK8C,OAASzC,EAAE4B,KAAK,CAC1B,IAAM9B,EAAQH,KAAKiD,YACnBjD,KAAKF,OAAOnF,KAAKwF,GAGnB,IAAM+C,EAAY,IAAIrD,EAAeG,KAAKF,QAE1C,OADAE,KAAKF,OAASoD,EAAUC,WACjBnD,KAAKF,2CAIZ,GAAIE,KAAK8C,OAASzC,EAAE4B,IAClB,OAAO,IAAImB,IAAM/C,EAAE4B,IAAK5B,EAAE4B,IAAK,EAAG,MAAOjC,KAAKoB,OAGhD,IAAKpB,KAAKqD,YACR,OAAOrD,KAAKsD,oBAMd,IAHA,IACInD,EADEoD,EAAgBvD,KAAKwD,mBAG3B5J,EAAA,EAAA6J,EAAiBb,EAAjBhJ,EAAA6J,EAAA3J,OAAAF,IAA0B,CAArB,IAAI8J,EAAID,EAAA7J,GACX8J,EAAKC,SAAS3D,KAAKoB,OACnB,IAAMzE,EAAQ+G,EAAKE,KAAK5D,KAAK8B,OAE7B,GAAInF,GAASA,EAAMyE,QAAUpB,KAAKoB,MAAO,CACvC,IAAMN,EAAOnE,EAAM+G,EAAK/B,YACxBxB,EAAQ,IAAIiD,IAAMM,EAAKvD,MAAOW,EAAMyC,EAAeG,EAAK9B,SAAU5B,KAAKoB,OACvEpB,KAAKoB,OAASN,EAAKhH,OAAS,EAC5BkG,KAAK6D,UACL,OAQJ,OAJK1D,IACHA,EAAQH,KAAK8D,aAAaP,IAGrBpD,mCAGA2B,GAMP,OAL0B,IAAtB9B,KAAK8B,MAAMhI,SACbkG,KAAK8B,MAAQ,IACb9B,KAAKoB,OAAS,GAGTU,EAAM9B,KAAKoB,4CAGP2C,GAGX,IAFA,IAAMC,EAAQ,KAELhE,KAAKiE,SAAWjE,KAAKkE,eAAiBlE,KAAKmE,iBAClDH,EAAMrJ,KAAKqF,KAAK8C,MAChB9C,KAAK6D,UAGP,IAAM/C,EAAOkD,EAAMrI,KAAK,IACxB,OAAO,IAAIyH,IAAM/C,EAAEW,QAASF,EAAMiD,EAAY,SAAU/D,KAAKoB,MAAQN,EAAKhH,oDAI1E,IAAIqG,EAUJ,OAPEA,EADE5D,YAASyD,KAAK8B,OACR,IAAIsB,IAAM/C,EAAEC,OAAQN,KAAK8B,MAAO,EAAG,SAAU9B,KAAKoB,OAElD,IAAIgC,IAAM/C,EAAEsC,KAAM3C,KAAK8B,MAAO,EAAG,SAAU9B,KAAKoB,OAG1DpB,KAAKoB,MAAQpB,KAAK8B,MAAMhI,OAAS,EACjCkG,KAAK6D,UACE1D,oCAIPH,KAAKoB,QAEDpB,KAAKoB,MAAQpB,KAAK8B,MAAMhI,OAC1BkG,KAAK8C,KAAO9C,KAAK8B,MAAM9B,KAAKoB,OAE5BpB,KAAK8C,KAAOzC,EAAE4B,wCAKhB,MAAyB,MAAlBjC,KAAK8B,MAAM,mCAIlB,OAAO9B,KAAK8C,OAASzC,EAAE4B,2CAIvB,OAAQjC,KAAKiE,SAAWvH,QAAQsD,KAAK8C,KAAKnG,MAAM,6CAIhD,OAAOD,QAAQsD,KAAK8C,KAAKnG,MAAM,8DAM/B,IAFA,IAAIyH,EAAQ,EAELpE,KAAKmE,gBACVC,IACApE,KAAK6D,UAGP,OAAOO,WAIIvB,kDCpKAO,IAXb,SAAAA,EAAYhD,EAAMU,EAAMiD,EAAYnC,EAAUR,GAAQrG,OAAAsJ,EAAA,EAAAtJ,CAAAiF,KAAAoD,GACpDpD,KAAKI,KAAOA,EACZJ,KAAK4B,SAAWA,EAChB5B,KAAKc,KAAOA,EACZd,KAAK+D,WAAaA,EAClB/D,KAAKoB,MAAQA,EACbpB,KAAK/G,MAAQ,KACb+G,KAAKsE,KAAO,uCCRhBC,EAAAC,EAAAC,EAAA,sBAAAC,IAAA,IAAAC,EAAAJ,EAAA,GAGaG,EAHbH,EAAAK,EAAAD,GAG4BE,EAAMC,qECMnBC,cAPc,CAC3BC,WAAY,GACZC,aAAc,GACdC,KAAM,GACNC,QAAS,GAGiC,CAC1CC,gBAAmB,SAACC,EAADC,GAAwB,IAAdC,EAAcD,EAAdC,QAC3BF,EAAML,WAAaO,GAErBC,mBAAsB,SAACH,EAADI,GAAwB,IAAdF,EAAcE,EAAdF,QAC9BF,EAAMJ,aAAeM,GAGvBG,oBAAuB,SAACL,GACtBA,EAAMJ,aAANlK,OAAA4K,EAAA,EAAA5K,CAAA,GAA0BsK,EAAMJ,aAAhC,CAA8CW,oBAAoB,OCbvDb,cAFO,GAEsB,CAC1Cc,cAAiB,SAACR,EAADC,GAAwB,IAAdC,EAAcD,EAAdC,QACjB1J,EAAmB0J,EAAnB1J,SAAUiK,EAASP,EAATO,KAClBT,EAAMxJ,GAAYiK,GAGpBC,iBAAoB,SAACV,EAADI,UACXJ,EADmCI,EAAdF,oBCJjBR,cALO,CACpBiB,UAAW,GACXC,WAAY,IAG8B,CAE1CC,cAAiB,SAACb,EAADC,GAAwB,IAAdC,EAAcD,EAAdC,QACjBY,EAAoBZ,EAApBY,SAAUC,EAAUb,EAAVa,MACVJ,EAAcX,EAAdW,UACRX,EAAMW,UAANjL,OAAA4K,EAAA,EAAA5K,CAAA,GAAuBiL,EAAvBjL,OAAAsL,EAAA,EAAAtL,CAAA,GAAmCoL,EAAWC,KAGhDE,eAAkB,SAACjB,EAADI,GAAwB,IAAdF,EAAcE,EAAdF,QAClBgB,EAAqBhB,EAArBgB,SAAUC,EAAWjB,EAAXiB,OACVP,EAAeZ,EAAfY,WACRZ,EAAMY,WAANlL,OAAA4K,EAAA,EAAA5K,CAAA,GAAwBkL,EAAxBlL,OAAAsL,EAAA,EAAAtL,CAAA,GAAqCwL,EAAWC,OCD9CC,EATJC,YAAe,CACbC,QAAS,CACPC,OAAQC,EACRC,UAAWC,EACXC,UAAWC,KAQFR,uCCpBflC,EAAAC,EAAAC,EAAA,sBAAAyC,IAAA3C,EAAAC,EAAAC,EAAA,sBAAA0C,IAAA5C,EAAAC,EAAAC,EAAA,sBAAA2C,IAAA,IAAAC,EAAA9C,EAAA,IAGO,SAAS2C,EAAcrL,GAC5B,OAAO,SAACyL,EAAUC,GAChB,IACMC,GADWD,IAAWT,UAAUjL,IACT,IAAI2L,SAAW,GAE5C,OAAOC,QAAQC,QAAQJ,EAAS,CAC9BlH,KAAM,kBACNmF,QAAS,CACP1J,WACA2L,eAMD,SAASL,EAAiBQ,EAAUC,GACzC,OAAO,SAACN,EAAUC,GAChB,IAAIM,EAAaD,EACb,GACAL,IAAWX,OAAO5B,WAAWwC,QAEjC,OAAOC,QAAQC,QAAQJ,EAAS,CAC9BlH,KAAM,qBACNmF,QAAS,CACPK,oBAAoB,EACpBiC,aACAF,gBAMD,IAAMP,EAAoBU,YAAa,kGCD/BC,aA7Bb,SAAAA,IAA4B,IAAhBC,EAAgB9K,UAAApD,OAAA,QAAAK,IAAA+C,UAAA,GAAAA,UAAA,GAAVuJ,IAAU1L,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA+H,GAAA,IACVE,EAAgBD,EAAMT,WAA9BX,OACR5G,KAAKgI,MAAQA,EACbhI,KAAKkF,KAAO+C,EAAY/C,KACxBlF,KAAKmF,QAAU8C,EAAY9C,kEAWftJ,GACZ,IAAMiK,EAAO9F,KAAK8G,UAAUjL,GAC5B,OAAOiK,GAAQA,EAAKoC,+CAGNrM,EAAU2L,EAASU,GACjClI,KAAKgI,MAAMV,SAASa,EAAgBtM,EAAU2L,EAASU,sCAG/CrM,GACRmE,KAAKgI,MAAMV,SAASc,EAAcvM,sCAjBlC,OAAOmE,KAAKgI,MAAMT,WAAWT,4CAI7B,OAAO/L,OAAOsN,KAAKrI,KAAK8G,2DCdtBwB,aACJ,SAAAA,EAAYC,GAAOxN,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAsI,GACjBtI,KAAKwI,MAAQD,qDAIb,MAAM,IAAIzK,MAAM,8BAId2K,cACJ,SAAAA,EAAYC,GAAU,IAAAzI,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAyI,IACpBxI,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAA0N,GAAAI,KAAA7I,KAAM,cACD8I,KAAOJ,EAFQzI,sEAMpB,OAAOD,KAAK8I,KAAKhI,YAPEwH,GAWjBS,cACJ,SAAAA,EAAYD,GAAM,IAAAE,EAAA,OAAAjO,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA+I,IAChBC,EAAAjO,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAgO,GAAAF,KAAA7I,KAAM,gBACD8I,KAAOA,EAFIE,sEAMhB,OAAOhJ,KAAK8I,KAAK7P,aAPIqP,GAWnBW,cACJ,SAAAA,EAAYH,GAAM,IAAAI,EAAA,OAAAnO,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAiJ,IAChBC,EAAAnO,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAkO,GAAAJ,KAAA7I,KAAM,gBACD8I,KAAOA,EAFII,sEAMhB,OAAOlJ,KAAK8I,KAAK7P,aAPIqP,GAWnBa,cACJ,SAAAA,EAAYhJ,GAAO,IAAAiJ,EAAA,OAAArO,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAmJ,IACjBC,EAAArO,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAoO,GAAAN,KAAA7I,KAAM,cACDS,KAAON,EAFKiJ,wEAMjB,OAAOpJ,KAAKS,KAAKxH,aAPEqP,GAWjBe,cACJ,SAAAA,EAAYC,EAAUC,GAAW,IAAAC,EAAA,OAAAzO,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAqJ,IAC/BG,EAAAzO,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAsO,GAAAR,KAAA7I,KAAM,eACDsJ,SAAWA,EAChBE,EAAKD,UAAYA,EAHcC,6BADXlB,GAQlBmB,cACJ,SAAAA,EAAYC,EAAQC,GAAM,IAAAC,EAAA,OAAA7O,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAyJ,IACxBG,EAAA7O,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAA0O,GAAAZ,KAAA7I,KAAM,aACD0J,OAASA,EACdE,EAAKD,KAAOA,EAHYC,oEAMrBC,GACH,OAAI7J,KAAK0J,OAAOtJ,OAASC,IAAEkC,KAClBsH,EACE7J,KAAK0J,OAAOtJ,OAASC,IAAEmC,OACxBqH,OADH,SAVWvB,GAgBhBwB,cACJ,SAAAA,EAAYC,EAAUC,GAAU,IAAAC,EAAA,OAAAlP,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA8J,IAC9BG,EAAAlP,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAA+O,GAAAjB,KAAA7I,KAAM,YACD+J,SAAWA,EAChBE,EAAKD,SAAWA,EAHcC,oEAM3BC,GAEH,OADWlK,KAAK+J,SAAS9Q,MAChBgE,WAAF,EAAAlC,OAAAoP,EAAA,EAAApP,CAAMmP,WATI5B,GAaf8B,cACJ,SAAAA,EAAYC,EAAUX,EAAQY,GAAW,IAAAC,EAAA,OAAAxP,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAoK,IACvCG,EAAAxP,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAqP,GAAAvB,KAAA7I,KAAM,cACDqK,SAAWA,EAChBE,EAAKb,OAASA,EACda,EAAKD,UAAYA,EAJsBC,oEAOpCC,EAAMC,GACT,OAAOzK,KAAK0J,OAAOtJ,MACjB,KAAKC,IAAEkC,KACL,OAAOiI,EAAOC,EAChB,KAAKpK,IAAEmC,MACL,OAAOgI,EAAOC,EAChB,KAAKpK,IAAEqC,IACL,GAAc,IAAV+H,EACF,MAAM,IAAI3M,MAAJ,qBAAAlD,OAA+B4P,EAA/B,KAAA5P,OAAuC6P,IAE7C,OAAOD,EAAOC,EAElB,KAAKpK,IAAEoC,KACL,OAAO+H,EAAOC,EAChB,QACE,MAAM,IAAI3M,MAAJ,yBAAAlD,OAAmCoF,KAAKG,MAAMW,KAA9C,cAvBSwH,GCyMRoC,aAzRb,SAAAA,EAAY5K,GAAS/E,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA0K,GACnB1K,KAAKoB,MAAQ,EACbpB,KAAKF,OAASA,EACdE,KAAK3E,KAAO2E,KAAKF,OAAO,GACxBE,KAAK2K,IAAM,yDAIX,OAAQ3K,KAAK4K,YACX,KAAKvK,IAAEsC,KACL3C,KAAK2K,IAAM3K,KAAKc,OAChB,MACF,KAAKT,IAAEC,OACLN,KAAK2K,IAAM3K,KAAKO,SAChB,MACF,QACEP,KAAK6K,SACL7K,KAAK2K,IAAM3K,KAAK2J,OAIpB,GAAkB,OAAd3J,KAAK3E,KACP,MAAM,IAAIyC,MAAJ,4BAAAlD,OAAsCoF,KAAKoB,MAA3C,OAAAxG,OAAsDoF,KAAK3E,KAAKyF,KAAhE,MAGR,OAAOd,KAAK2K,mCAKZ,IAAI7B,EAAMgC,EAAUL,EAIpB,IAFA3B,EAAO9I,KAAK+K,OAEJ,CAAC1K,IAAEkC,KAAMlC,IAAEmC,OAAOwI,SAAShL,KAAK4K,aACtCE,EAAW9K,KAAK8K,WAChBL,EAAQzK,KAAK+K,OACbjC,EAAO,IAAIsB,EAAStB,EAAMgC,EAAUL,GAGtC,OAAO3B,iCAKP,IAAIA,EAAMgC,EAAUL,EAIpB,IAFA3B,EAAO9I,KAAKiL,SAEJ,CAAC5K,IAAEoC,KAAMpC,IAAEqC,KAAKsI,SAAShL,KAAK4K,aACpCE,EAAW9K,KAAK8K,WAChBL,EAAQzK,KAAKiL,SACbnC,EAAO,IAAIsB,EAAStB,EAAMgC,EAAUL,GAGtC,OAAO3B,mCAOP,OAAQ9I,KAAK4K,YACX,KAAKvK,IAAEgC,OACL,OAAOrC,KAAKkL,eACd,KAAK7K,IAAEkC,KACP,KAAKlC,IAAEmC,MACL,OAAOxC,KAAKmL,UACd,KAAK9K,IAAEC,OACL,OAAON,KAAKO,SACd,KAAKF,IAAEG,KACL,OAAOR,KAAKS,OACd,KAAKJ,IAAEK,SACL,OAAOV,KAAKoL,OACd,KAAK/K,IAAEiC,OACL,MAAM,IAAIxE,MAAJ,4BAAAlD,OAAsCoF,KAAKoB,MAA3C,OAAAxG,OAAsDoF,KAAK3E,KAAKyF,KAAhE,MACR,QACE,MAAM,IAAIhD,MAAM,0DAKpBkC,KAAKqL,SACL,IAAMvC,EAAO9I,KAAK2J,OAElB,OADA3J,KAAKsL,SACExC,iCAIP,GAAI9I,KAAK4K,aAAevK,IAAEG,KACxB,MAAM,IAAI1C,MAAM,qBAGlB,IAAMgL,EAAO,IAAIK,EAASnJ,KAAK3E,MAE/B,OADA2E,KAAK6D,UACEiF,sCAIP,IAAI0B,EAAMC,EAEV,IAAKzK,KAAKuL,cACR,MAAM,IAAIzN,MAAM,sBASlB,GANA0M,EAAO,IAAIrB,EAASnJ,KAAK3E,MACzB2E,KAAK6D,UACL7D,KAAK6D,UACL4G,EAAQ,IAAItB,EAASnJ,KAAK3E,MAC1B2E,KAAK6D,UAED4G,EAAM5O,SAAW2O,EAAK3O,SAAU,KAAA2P,EAClBxL,KAAKyL,gBAAgBjB,EAAMC,GADTiB,EAAA3Q,OAAA4Q,EAAA,EAAA5Q,CAAAyQ,EAAA,GACjChB,EADiCkB,EAAA,GAC3BjB,EAD2BiB,EAAA,GAIpC,OAAO,IAAIrC,EAAUmB,EAAMC,2CAGbD,EAAMC,GACpBzK,KAAKF,OAAOE,KAAKoB,MAAQ,GAAKqJ,EAAMhK,KACpCT,KAAKF,OAAOE,KAAKoB,OAASoJ,EAAK/J,KAC/B,IAAImL,EAAOpB,EAGX,MAAO,CAFPA,EAAOC,EACPA,EAAQmB,kCAKR,GAAI5L,KAAK4K,aAAevK,IAAEK,SACxB,MAAM,IAAI5C,MAAM,oBAGlB,IAAMsN,EAAOpL,KAAK3E,KAClB2E,KAAK6D,UACL7D,KAAKqL,SACL,IAAM/N,EAAO0C,KAAK6L,OAElB,OADA7L,KAAKsL,SACE,IAAIxB,EAAOsB,EAAM9N,kCAIxB,IACIwL,EADE+C,EAAO,GAMb,IAHA/C,EAAO9I,KAAK8L,WACZD,EAAKlR,KAAKmO,GAEH9I,KAAK4K,aAAevK,IAAE8B,OAC3BnC,KAAK6D,UACLiF,EAAO9I,KAAK8L,WACZD,EAAKlR,KAAKmO,GAGZ,OAAO+C,qCAIP,OAAI7L,KAAKuL,cACAvL,KAAK+L,YACH/L,KAAK4K,aAAevK,IAAEO,OACxBZ,KAAKa,SAELb,KAAK2J,sCAKd,IAAIb,EAEJ,GAAI9I,KAAK4K,aAAevK,IAAEsC,KACxB,MAAM,IAAI7E,MAAM,kBAKlB,OAFAgL,EAAO,IAAIL,EAASzI,KAAK3E,MACzB2E,KAAK6D,UACEiF,mCAIP,IAAMA,EAAO,IAAIC,EAAW/I,KAAK3E,MAEjC,OADA2E,KAAK6D,UACEiF,mCAIP,GAAI9I,KAAK4K,aAAevK,IAAEC,OAAQ,CAChC,IAAMwI,EAAO,IAAIG,EAAWjJ,KAAK3E,MAEjC,OADA2E,KAAK6D,UACEiF,EAEP,MAAM,IAAIhL,MAAM,qDAKlB,GAAI,CAACuC,IAAEkC,KAAMlC,IAAEmC,MAAOnC,IAAEoC,KAAMpC,IAAEqC,KAAKsI,SAAShL,KAAK4K,YAAa,CAC9D,IAAM9B,EAAO9I,KAAK3E,KAElB,OADA2E,KAAK6D,UACEiF,EAEP,MAAM,IAAIhL,MAAM,qDAKlB,GAAIkC,KAAK4K,aAAevK,IAAE6B,OACxB,MAAM,IAAIpE,MAAM,uBAGlBkC,KAAK6D,2CAIL,GAAI7D,KAAK4K,aAAevK,IAAEgC,OACxB,MAAM,IAAIvE,MAAM,4BAGlBkC,KAAK6D,2CAIL,GAAI7D,KAAK4K,aAAevK,IAAEiC,OACxB,MAAM,IAAIxE,MAAM,6BAGlBkC,KAAK6D,4CAIL,IAAK,CAACxD,IAAEkC,KAAMlC,IAAEmC,OAAOwI,SAAShL,KAAK4K,YACnC,MAAM,IAAI9M,MAAM,0BAGlB,IAAMzC,EAAO2E,KAAK3E,KAGlB,OAFA2E,KAAK6D,UACQ,IAAI4F,EAAQpO,EAAM2E,KAAKiL,4CAKhCjL,KAAKoB,MAAQpB,KAAKF,OAAOhG,OAAS,GACpCkG,KAAKoB,QACLpB,KAAK3E,KAAO2E,KAAKF,OAAOE,KAAKoB,QAE7BpB,KAAK3E,KAAO,2CAKd,OACE2E,KAAK4K,SAAS,KAAOvK,IAAEG,MACpBR,KAAK4K,SAAS,KAAOvK,IAAE+B,OACvBpC,KAAK4K,SAAS,KAAOvK,IAAEG,wCAK5B,OACER,KAAK4K,SAAS,KAAOvK,IAAE2L,QACpBhM,KAAK4K,SAAS,KAAOvK,IAAEsC,MACvB3C,KAAK4K,SAAS,KAAOvK,IAAE2L,wCAIrBC,GACP,IAAIA,EAWF,OAAOjM,KAAK3E,MAAQ2E,KAAK3E,KAAK+E,KAV9B,GAAI6L,EAAa,EACf,MAAM,IAAInO,MAAM,qCAGlB,IAAMsD,EAAQpB,KAAKoB,MAAQ6K,EAE3B,OAAI7K,EAAQpB,KAAKF,OAAOhG,OACfkG,KAAKF,OAAOsB,GAAOhB,UAD5B,WCzFS8L,aAzLb,SAAAA,EAAYrQ,GAAWd,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAkM,GACrBlM,KAAKnE,SAAWA,EAChBmE,KAAKmM,MAAQ,KACbnM,KAAKoM,MAAQ,GACbpM,KAAKkI,OAAS,KACdlI,KAAKqF,MAAQ,IAAI0C,wDAGTjG,GACR,IACIuK,EAAOC,EADLC,EAASC,EAAMC,UAAUzM,KAAKnE,SAAUiG,GAG9C,IACEuK,EAAQ,IAAIxJ,IAAMf,GAClBwK,EAAS,IAAI5B,EAAQ2B,EAAMK,aAC3BH,EAAO5B,IAAM2B,EAAOK,QACpBH,EAAMI,YAAY5M,KAAKnE,UACvBmE,KAAKkI,OAASqE,EAAOrE,OACrB,MAAOiE,GAGP,OAFAnM,KAAKmM,MAAQI,EAAOJ,MAAQA,EAC5BnM,KAAKkI,OAASqE,EAAOrE,OAASlI,KAAK6M,gBAC5B7M,KAAKkI,OAId,OADAlI,KAAKmM,MAAQI,EAAOJ,MACbnM,KAAKkI,wCAGLrM,GACP,IAAM0Q,EAASC,EAAMM,UAAUjR,GAE/B,IAAK0Q,EAAO5B,IACV,OAAO4B,EAAOrE,OAGhB,IACElI,KAAKkI,OAASqE,EAAOrE,OAASlI,KAAK+M,UAAUR,EAAO5B,KACpD,MAAOwB,GAGP,MAFAnM,KAAKmM,MAAQI,EAAOJ,MAAQA,EAC5BnM,KAAKkI,OAASqE,EAAOrE,OAASlI,KAAK6M,gBAC7BV,EAGR,OAAOnM,KAAKkI,yCAGJY,GACR,OAAQA,EAAKN,OACX,IAAK,aACH,OAAOxI,KAAKiJ,WAAWH,GACzB,IAAK,WACH,OAAO9I,KAAKmJ,SAASL,GACvB,IAAK,WACH,OAAO9I,KAAKyI,SAASK,GACvB,IAAK,aACH,OAAO9I,KAAK+I,WAAWD,GACzB,IAAK,YACH,OAAO9I,KAAKqJ,UAAUP,GACxB,IAAK,SACH,OAAO9I,KAAK8J,OAAOhB,GACrB,IAAK,WACH,OAAO9I,KAAKoK,SAAStB,GACvB,IAAK,UACH,OAAO9I,KAAKyJ,QAAQX,GACtB,QACE,IAAMkE,EAAWlE,EAAKN,QAAUM,EAAKmE,aAAe,IAAI1E,KACxD,MAAM,IAAIzK,MAAJ,yBAAAlD,OAAmCoS,sCAQtClE,GACP,OAAOA,EAAKoE,0CAGHpE,GACT,OAAOA,EAAKoE,0CAGHpE,GACT,OAAOA,EAAKoE,uCAONpE,GACN,IAAMZ,EAASlI,KAAK+M,UAAUjE,EAAKa,MACnC,OAAOb,EAAKoE,KAAKhF,oCAGVY,GACP,IAAMZ,EAASlI,KAAKmN,cAAcrE,EAAKjN,UACvC,YAAkB1B,IAAX+N,EACH,EACAA,mCAGGY,GACP,IAAM0B,EAAOxK,KAAK+M,UAAUjE,EAAKuB,UAC3BI,EAAQzK,KAAK+M,UAAUjE,EAAKwB,WAClC,OAAOxB,EAAKoE,KAAK1C,EAAMC,qCAGf3B,GASR,IATc,IAAAsE,EACuBxR,YAAckN,EAAKQ,SAASzN,UADnDwR,EAAAtS,OAAA4Q,EAAA,EAAA5Q,CAAAqS,EAAA,GACPE,EADOD,EAAA,GACOE,EADPF,EAAA,GAAAG,EAEyB5R,YAAckN,EAAKS,UAAU1N,UAFtD4R,EAAA1S,OAAA4Q,EAAA,EAAA5Q,CAAAyS,EAAA,GAEPE,EAFOD,EAAA,GAEQE,EAFRF,EAAA,GAGRG,EAAgBxU,KAAKF,IAAIoU,EAAcI,GACvCG,EAAczU,KAAKD,IAAImU,EAAcI,GACrCI,EAAgB1U,KAAKF,IAAIqU,EAAcI,GACvCI,EAAc3U,KAAKD,IAAIoU,EAAcI,GACrC9B,EAAO,GAEJmC,EAAOF,EAAeE,GAAQD,EAAaC,IAClD,IAAK,IAAIC,EAAOL,EAAeK,GAAQJ,EAAaI,IAAQ,CAC1D,IAAMpS,EAAQ,GAAAjB,OAAMK,YAAegT,GAArB,KAAArT,OAA8BoT,EAAO,GAC7C9F,EAASlI,KAAKmN,cAActR,QAEnB1B,IAAX+N,GACF2D,EAAKlR,KAAKuN,GAKhB,OAAO2D,wCAGKqC,GACZ,IAAIhG,EAEJ,IAAKlI,KAAKmO,gBAAgBD,GACxB,MAAM,IAAIpQ,MAAM,0BAGlB,YAAkC3D,IAA9B6F,KAAKoM,MAAM8B,GACNlO,KAAKoM,MAAM8B,IAGpBhG,EAASsE,EAAM4B,UAAUF,GACzBlO,KAAKoM,MAAM8B,GAAiBhG,EACrBA,kCAGFY,GACL,IAAMoB,EAAgB,GADXlQ,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAGX,QAAAC,EAAAC,EAAsByO,EAAKkB,SAA3B1P,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAAqC,KAA5BqU,EAA4BjU,EAAAnB,MAC7BiP,EAASlI,KAAK+M,UAAUsB,GAEN,cAApBA,EAAU7F,MACZ0B,EAAcvP,KAAdsC,MAAAiN,EAAanP,OAAAoP,EAAA,EAAApP,CAASmN,IAEtBgC,EAAcvP,KAAKuN,IATZ,MAAArN,GAAAZ,GAAA,EAAAC,EAAAW,EAAA,YAAAb,GAAA,MAAAK,EAAAS,QAAAT,EAAAS,SAAA,WAAAb,EAAA,MAAAC,GAaX,OAAO4O,EAAKoE,KAAKhD,2CAGHrO,GAAU,IAAAyS,EACK1S,YAAcC,GADnB0S,EAAAxT,OAAA4Q,EAAA,EAAA5Q,CAAAuT,EAAA,GACjBE,EADiBD,EAAA,GACPE,EADOF,EAAA,GAGxB,QAAInV,KAAKF,IAAIsV,EAAUC,GAAY,OAC/BD,GAAYxO,KAAKqF,MAAMF,YACvBsJ,GAAYzO,KAAKqF,MAAMH,+CAIb,IACGwJ,EAAa1O,KAAKmM,MAA3BwC,QAER,OAAID,EAAS/R,MAAM,qBApLM,UAsLd+R,EAAS/R,MAAM,uBArLC,QACX,mBCLdiS,EACJ,SAAAA,EAAYpH,GAAUzM,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA4O,GACpB5O,KAAKwH,QAAUA,EACfxH,KAAKmM,MAAQ,KACbnM,KAAKkI,OAAS,KACdlI,KAAK2K,IAAM,MAgIT6B,EAAQ,eA3HZ,SAAAqC,IAAe9T,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA6O,GACb7O,KAAK8O,IAAM,GACX9O,KAAK+O,QAAU,KACf/O,KAAKgP,QAAU,KACfhP,KAAKgI,MAAQ,IAAID,0DAGPlM,GACVmE,KAAKiP,kBACLjP,KAAKkP,IAAIrT,GACTmE,KAAKmP,wDAGW,IAAAlP,EAAAD,KAChBA,KAAK+O,QAAU,IAAIK,IAEnBrU,OAAOsN,KAAKrI,KAAK8O,KAAKvR,QAAQ,SAAAgP,GAC5BtM,EAAK8O,QAAQM,IAAI9C,iCAIjB1Q,GACF,IADY,IAAAmN,EAAAhJ,KACLA,KAAK+O,QAAQO,KAAO,GAAG,CACvBzT,IACHA,EAAWd,OAAAoP,EAAA,EAAApP,CAAIiF,KAAK+O,SAAS,IAG/B,IACE/O,KAAKgP,QAAU,IAAII,IAAI,CAACvT,IACJ,IAAIqQ,EAAYrQ,GACxB0T,SAAS1T,GACrB,MAAOsQ,IAETnM,KAAKgP,QAAQzR,QAAQ,SAAA1B,GAAQ,OAAImN,EAAK+F,QAAQS,OAAO3T,KACrDA,EAAW,KAGbmE,KAAKgP,QAAU,KACfhP,KAAK+O,QAAU,uCAGPlT,GACR,GAAKmE,KAAKyP,UAAU5T,GAApB,CAIAmE,KAAK0P,cAAc7T,GACnBmE,KAAK+O,QAAQS,OAAO3T,GACpBmE,KAAKgP,QAAQK,IAAIxT,GACjB,IACMqM,EADc,IAAIgE,EAAYrQ,GACT0T,SAAS1T,GAEpC,OADAmE,KAAKgP,QAAQQ,OAAO3T,GACbqM,yCAGKrM,GACZ,OAAIA,KAAYmE,KAAK8O,IACZtC,EAAMsC,IAAIjT,GAAUqM,OAEpB,yCAIGrM,GACZ,GAAImE,KAAKgP,QAAQW,IAAI9T,GACnB,MAAM,IAAIiC,MAAM,4DAOlB,IAFA,IAAM8R,EAAe,IAAIR,IAAIpP,KAAKgI,MAAM6H,WAExCjW,EAAA,EAAAkW,EAA+B/U,OAAOgV,QAAQ/P,KAAK8O,KAAnDlV,EAAAkW,EAAAhW,OAAAF,IAAyD,KAAAoW,EAAAF,EAAAlW,GAAA6L,EAAA1K,OAAA4Q,EAAA,EAAA5Q,CAAAiV,EAAA,GAA/CnU,EAA+C4J,EAAA,GAArC8G,EAAqC9G,EAAA,GAC/C+B,EAAoB+E,EAApB/E,QAASU,EAAWqE,EAAXrE,OAEjB0H,EAAaJ,OAAO3T,GAEhBqM,IAAWlI,KAAKgI,MAAMmF,cAActR,IACtCmE,KAAKgI,MAAMG,gBAAgBtM,EAAU2L,EAASU,GATtC,IAAAlO,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAaZ,QAAAC,EAAAC,EAAqBuV,EAArBtV,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAAmC,KAA1B6B,EAA0BzB,EAAAnB,MACjC+G,KAAKgI,MAAMiI,UAAUpU,IAdX,MAAAhB,GAAAZ,GAAA,EAAAC,EAAAW,EAAA,YAAAb,GAAA,MAAAK,EAAAS,QAAAT,EAAAS,SAAA,WAAAb,EAAA,MAAAC,sCAkBJ2B,EAAU2L,GAClB,IAAM+E,EAAS,IAAIqC,EAAOpH,GAE1B,OADAxH,KAAK8O,IAAIjT,GAAY0Q,EACdA,oCAGC1Q,GACR,OAAOA,KAAYmE,KAAK8O,sCAGhBjT,GAER,OADAmE,KAAKkQ,oBAAoBrU,GAClBmE,KAAK8O,IAAIjT,qCAGRA,GACJA,KAAYmE,KAAK8O,aACZ9O,KAAK8O,IAAIjT,GAChBmE,KAAK4M,kDAKP5M,KAAK8O,IAAM,GACX9O,KAAK+O,QAAU,KACf/O,KAAKgP,QAAU,KACfhP,KAAKgI,MAAQ,IAAID,8CAGClM,GAClB,IAAKmE,KAAKyP,UAAU5T,GAClB,MAAM,IAAIiC,MAAM,8BAQP0O,ICxIR,SAAS2D,EAAYtU,EAAU2L,GAKpC,MAAO,CACLpH,KAAM,gBACNmF,QAAS,CAAE1J,WAAUiK,KAAM,CAAE0B,UAASU,OANpB,IAAIgE,EAAYrQ,GACTuU,UAAU5I,MAShC,SAASW,EAAgBtM,EAAU2L,EAASU,GACjD,MAAO,CACL9H,KAAM,gBACNmF,QAAS,CAAE1J,WAAUiK,KAAM,CAAE0B,UAASU,YAInC,SAASE,EAAcvM,GAC5B,OAAO,SAACyL,EAAUC,GAChB,IAAMtO,EAAQsO,IAAWT,UAAUjL,GAInC,OAFA2Q,EAAM6D,UAAUxU,QAEF1B,IAAVlB,EACKwO,QAAQC,UAIVD,QAAQC,QAAQJ,EAAS,CAC9BlH,KAAM,mBACNmF,QAAS1J,MAnCf0I,EAAAC,EAAAC,EAAA,sBAAA0L,IAAA5L,EAAAC,EAAAC,EAAA,sBAAA6L,IAAA/L,EAAAC,EAAAC,EAAA,sBAAA2D,gFCGamI,EAAKxV,OAAAyV,EAAA,EAAAzV,CAAA,SAAA0V,OAAA,YAAA1V,CAAA,wFAIM,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOC,QAJlC,mTCcZC,EAAI/V,OAAAgW,EAAA,EAAAhW,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,oBAIGC,EAAb,SAAAC,GAgBE,SAAAD,IAAc,IAAAhR,EAAA,OAAAlF,OAAAoW,EAAA,EAAApW,CAAAiF,KAAAiR,IACZhR,EAAAlF,OAAAqW,EAAA,EAAArW,CAAAiF,KAAAjF,OAAAsW,EAAA,EAAAtW,CAAAkW,GAAApI,KAAA7I,QASFqF,MAAQ,CACNvF,OAAQ,GACRwR,uBAAuB,EACvBC,WAAY,GACZC,SAAU,CAAEC,IAAK,IACjBC,UAAW,EACXtL,MAAO,MAhBKnG,EAmBd0R,SAAW9M,IAAM+M,YAjBf3R,EAAK4R,gBAAkB5R,EAAK4R,gBAAgBC,KAArB/W,OAAAgX,EAAA,EAAAhX,CAAAkF,IACvBA,EAAK+R,aAAe/R,EAAK+R,aAAaF,KAAlB/W,OAAAgX,EAAA,EAAAhX,CAAAkF,IACpBA,EAAKgS,eAAiBhS,EAAKgS,eAAeH,KAApB/W,OAAAgX,EAAA,EAAAhX,CAAAkF,IACtBA,EAAKiS,yBAA2BjS,EAAKiS,yBAAyBJ,KAA9B/W,OAAAgX,EAAA,EAAAhX,CAAAkF,IAChCA,EAAKkS,cAAgBlS,EAAKkS,cAAcL,KAAnB/W,OAAAgX,EAAA,EAAAhX,CAAAkF,IACrBA,EAAKmS,cAAgBnS,EAAKmS,cAAcN,KAAnB/W,OAAAgX,EAAA,EAAAhX,CAAAkF,IAPTA,EAhBhB,OAAAlF,OAAAsX,EAAA,EAAAtX,CAAAkW,EAAAC,GAAAnW,OAAAuX,EAAA,EAAAvX,CAAAkW,EAAA,EAAAQ,IAAA,oBAAAxY,MAAA,WAsCI+G,KAAKuS,gBACLvS,KAAKmS,cAAcnS,KAAK0Q,MAAM7I,cAvClC,CAAA4J,IAAA,qBAAAxY,MAAA,SA0CqBuZ,EAAWC,GACxBA,EAAUjB,WAAaxR,KAAKqF,MAAMmM,WACpCxR,KAAK0S,SAAS1S,KAAKqF,MAAMmM,SAASC,KAClCzR,KAAK2S,cAGHF,EAAUlB,aAAevR,KAAKqF,MAAMkM,YACtCvR,KAAK4S,uBAjDX,CAAAnB,IAAA,aAAAxY,MAAA,WAqDe,IACHwY,EAAQzR,KAAKqF,MAAMmM,SAAnBC,IAER,GAAIzR,KAAKqF,MAAMiM,sBACb,OAAQG,GACN,IAAK,SACHzR,KAAK0Q,MAAMtJ,oBACX,MACF,IAAK,YACL,IAAK,aACHpH,KAAK6S,SAAS,CAAEnB,UAAW1R,KAAK2R,SAASmB,QAAQC,oBAGrD,OAAQtB,GACN,IAAK,SACHzR,KAAK0Q,MAAMtJ,oBACX,MACF,IAAK,QACHpH,KAAKgT,eACLhT,KAAK0Q,MAAMtJ,oBACX,MACF,IAAK,YACL,IAAK,aACHpH,KAAK6S,SAAS,CAAEnB,UAAW1R,KAAK2R,SAASmB,QAAQC,kBA5E3D,CAAAtB,IAAA,gBAAAxY,MAAA,SAiFgBmN,GACZpG,KAAK6S,SAAS,CAAEzM,YAlFpB,CAAAqL,IAAA,qBAAAxY,MAAA,WAqFuB,IACXsY,EAAevR,KAAKqF,MAApBkM,WAEFzR,EADQ,IAAI+C,IAAM0O,GACH7E,YACrB1M,KAAK6S,SAAS,CAAE/S,aAzFpB,CAAA2R,IAAA,gBAAAxY,MAAA,WA6FI,IAAMga,EAAUjT,KAAK2R,SAASmB,QAE9BI,EAAa,WACXD,EAAQE,QACRF,EAAQG,eAAiBH,EAAQha,MAAMa,WAjG7C,CAAA2X,IAAA,WAAAxY,MAAA,WAqGa,IAILoa,EAAIC,EAHY7B,EAAUzR,KAAKqF,MAA3BmM,SAAYC,IACZ5V,EAAamE,KAAK0Q,MAAlB7U,SAFCuR,EAGoBxR,YAAcC,GAHlCwR,EAAAtS,OAAAwY,EAAA,EAAAxY,CAAAqS,EAAA,GAGFoB,EAHEnB,EAAA,GAGQoB,EAHRpB,EAAA,GAMT,GAAIrN,KAAKqF,MAAMiM,sBAAuB,CACpC,GAAY,WAARG,EAGF,OAFA6B,EAAI,uCAAA1Y,OAA0CiB,EAA1C,WAKN,GAAY,QAAR4V,EACF6B,EAAI,uCAAA1Y,OAA0CiB,EAA1C,WACC,GAAY,UAAR4V,EAAiB,CAC1B,IAAM+B,EAAepa,KAAKF,IAAI8G,KAAK0Q,MAAMxL,KAAO,EAAGuJ,EAAW,GACxDtI,EAAWlL,YAAeuT,GAC1BjI,EAAW,IAAMiN,EAAe,GAChCC,EAAW,GAAA7Y,OAAMuL,EAAN,KAAAvL,OAAkB2L,GACnC+M,EAAI,uCAAA1Y,OAA0C6Y,EAA1C,WAEJH,EADiB,WAAR7B,EACL,uCAAA7W,OAA0CiB,EAA1C,MAEA,sCAAAjB,OAAyCiB,EAAzC,MAIRwX,EAAKK,SAASC,cAAcL,GACxBI,SAASE,gBAAkBP,GAAMA,EAAGF,UAlI5C,CAAA1B,IAAA,eAAAxY,MAAA,WAqIiB,IACL4C,EAAamE,KAAK0Q,MAAlB7U,SACA0V,EAAevR,KAAKqF,MAApBkM,WAER,GAAIvR,KAAKmE,aAAaoN,GACpBvR,KAAK0Q,MAAMtI,cAAcvM,OAD3B,CAKA,IAAMgY,GAAYtC,EAAWzX,OAAS,GAAKyX,EAAW,GAElDA,GAIJvR,KAAK0Q,MAAMP,YAAYtU,EAAUgY,MApJrC,CAAApC,IAAA,eAAAxY,MAAA,SAuJe6H,GACX,OAAuB,IAAhBA,EAAKhH,QAAgB4C,QAAQoE,EAAKnE,MAAM,YAxJnD,CAAA8U,IAAA,2BAAAxY,MAAA,SA2J2BqY,GACvBtR,KAAK6S,SAAS,CAAEvB,4BA5JpB,CAAAG,IAAA,gBAAAxY,MAAA,SA+JgBsY,EAAYG,GACxB,IAAMuB,EAAUjT,KAAK2R,SAASmB,QAE9B9S,KAAK6S,SAAS,CAAEtB,aAAYG,UAAWH,EAAWzX,QAAU,WAC1DmZ,EAAQE,QACRF,EAAQG,eAAiB1B,EACzBuB,EAAQF,aAAerB,MArK7B,CAAAD,IAAA,iBAAAxY,MAAA,SAyKiB6a,GAAO,IACF7a,EAAY6a,EAAtBrD,OAAUxX,MACZyY,EAAYoC,EAAMrD,OAAO2C,eAC/BpT,KAAK6S,SAAS,CAAEtB,WAAYtY,EAAOyY,gBA5KvC,CAAAD,IAAA,kBAAAxY,MAAA,SA+KkB6a,GAAO,IACbrC,EAA2BqC,EAA3BrC,IAAexY,EAAY6a,EAAtBrD,OAAUxX,MAEnB+G,KAAKqF,MAAMiM,uBAAiC,QAARG,GACtCqC,EAAMC,iBAGR/T,KAAK6S,SAAS,CAAErB,SAAU,CAAEC,OAAOF,WAAYtY,MAtLnD,CAAAwY,IAAA,eAAAxY,MAAA,SAyLe6a,GAAO,IAAA9K,EAAAhJ,KACdA,KAAKqF,MAAMiM,uBAEftR,KAAK6S,SAAS,CAAEtB,WAAYuC,EAAMrD,OAAOxX,OAAS,WAChD+P,EAAKgK,eACLhK,EAAK0H,MAAMtJ,wBA9LjB,CAAAqK,IAAA,eAAAxY,MAAA,WAkMiB,IAAA+a,EACmChU,KAAK0Q,MAAM/I,SAAnDsM,EADKD,EACLC,IAAKzJ,EADAwJ,EACAxJ,KAAa0J,EADbF,EACM5N,MAGnB,MAAO,CACL6N,MACAzJ,OACAhE,OAPWwN,EACwBxN,OAOnCJ,MANYpG,KAAKqF,MAAMe,OAAS8N,KApMtC,CAAAzC,IAAA,SAAAxY,MAAA,WA+MI,IAAMga,EAAUjT,KAAK2R,SAASmB,QACxBqB,EAAYlB,GAAWA,EAAQmB,wBAC/BhO,GAAS+N,GAAa,IAAI/N,OAASpG,KAAK0Q,MAAM/I,SAASvB,MAE7D,OACErL,OAAAsZ,EAAA,EAAAtZ,CAACuZ,EAAA,EAAaC,SAAd,CACEtb,MAAO,CACLkb,YACAjC,yBAA0BlS,KAAKkS,yBAC/BC,cAAenS,KAAKmS,cACpBX,SAAUxR,KAAKqF,MAAMmM,SACrBD,WAAYvR,KAAKqF,MAAMkM,aAGzBxW,OAAAsZ,EAAA,EAAAtZ,CAAC+V,EAAD,CACE0D,IAAKxU,KAAKyU,gBAEV1Z,OAAAsZ,EAAA,EAAAtZ,CAAC2Z,EAAA,EAAD,CACEzb,MAAO+G,KAAKqF,MAAMkM,WAClB2C,UAAW9N,EACXgM,cAAepS,KAAKoS,gBAEtBrX,OAAAsZ,EAAA,EAAAtZ,CAAC4Z,EAAA,EAAD,CACEC,IAAK5U,KAAK2R,SACVkD,YAAU,QACVC,gBAAe9U,KAAK0Q,MAAM7U,SAC1B5C,MAAO+G,KAAKqF,MAAMkM,WAClBwD,SAAU/U,KAAKiS,eACf+C,UAAWhV,KAAK6R,gBAChBoD,OAAQjV,KAAKgS,eAEfjX,OAAAsZ,EAAA,EAAAtZ,CAACma,EAAA,EAAD,CACEpV,OAAQE,KAAKqF,MAAMvF,OACnB4R,UAAW1R,KAAKqF,MAAMqM,kBAhPlCT,EAAA,CAAkCpM,IAAMsQ,eA4QxC,IAAMC,EAAqB,CAAEjF,gBAAa/H,kBAAehB,uBAE1CiO,gBAtBf,SAAyBhQ,GAAO,IAAAiQ,EAe1BjQ,EAbFuB,OAF4B2O,EAAAD,EAG1BrQ,aACEW,EAJwB2P,EAIxB3P,mBACAiC,EALwB0N,EAKxB1N,WACAF,EANwB4N,EAMxB5N,SANwB6N,EAAAF,EAQ1BtQ,WASJ,MAAO,CAAEnJ,SAjBqB2Z,EASxB3Z,SAQa2L,QAjBWgO,EAUxBhO,QAOsBK,aAAYjC,qBAAoB+B,WAAUzC,KAjBxCoQ,EAY1BpQ,KAKwEC,QAjB9CmQ,EAa1BnQ,UASkCiQ,EAAzBC,CAA6CpE,4JCxRtDV,EAAQxV,OAAA0a,EAAA,EAAA1a,CAAO2a,IAAP,CAAAjF,OAAA,YAAA1V,CAAH,CAAAwN,KAAA,UAAAyI,OAAA,2DAML2E,6MAQJhE,SAAW9M,IAAM+M,+FAGf5R,KAAKoS,2DAGYI,EAAWC,GAC5BzS,KAAKoS,wDAGS,IACN8B,EAAclU,KAAK0Q,MAAnBwD,UACFjB,EAAUjT,KAAK2R,SAASmB,QACxB8C,EAAY3C,EAAQ4C,YAEpBzP,EAAQwP,EADK3C,EAAQmB,wBACUhO,MACjChN,KAAKD,IAAI+a,EAAW0B,EAhCA,IAiCpB1B,EAEFlU,KAAK0Q,MAAM0B,cAAchM,oCAI3B,OACErL,OAAA+a,EAAA,EAAA/a,CAACwV,EAAD,CACEqE,IAAK5U,KAAK2R,SACVoE,aAAc/V,KAAK0Q,MAAMzX,MACzBub,IAAGzZ,OAAAib,EAAA,EAAAjb,CAAE,CACHqL,MAAOpG,KAAK0Q,MAAMwD,UA5CA,cAQFrP,IAAMsQ,eA2CjBQ,sJClDT7E,EAAI/V,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,cACM,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOsF,SAASC,QAD3C,sCAGc,SAAAzF,GAAK,OAAIA,EAAMC,MAAMC,OAAOC,QAH1C,qBAIY,SAAAH,GAAK,OAAIA,EAAMC,MAAMC,OAAOsF,SAASE,QAJjD,iCASJC,EAAGtb,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,SAAAyI,OAAA,uDAMHsF,EAAQvb,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,qCAKRuF,EAACxb,OAAAkb,EAAA,EAAAlb,CAAA,KAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,SAAAyI,OAAA,oCAKDwF,EAAEzb,OAAAkb,EAAA,EAAAlb,CAAA,MAAA0V,OAAA,YAAA1V,CAAA,iCAEkB,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOsF,SAASE,QAFvD,qDAKFK,uLASS,IAEPC,EAFOC,EACqB3W,KAAK0Q,MAA7BkG,EADGD,EACHC,SAAUlF,EADPiF,EACOjF,UADP1X,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAIX,QAAAC,EAAAC,EAAkBuc,EAAlBtc,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAA4B,KAAnB6c,EAAmBzc,EAAAnB,MAC1B,KAAIyY,GAAamF,EAAMC,WAAa,GAGlC,MAFAJ,EAAYG,GANL,MAAAhc,GAAAZ,GAAA,EAAAC,EAAAW,EAAA,YAAAb,GAAA,MAAAK,EAAAS,QAAAT,EAAAS,SAAA,WAAAb,EAAA,MAAAC,GAYX,OAAIwc,GAAoC,OAAvBA,EAAUK,SAA4BL,EACnDA,GAAahF,EAAY,EAAIgF,EAAUK,SAAmBL,EACvD,uCAGCG,GACR,IAAMpF,EAAMoF,EAAMvV,OAAOD,cACzB,OAAOG,IAAaiQ,oCAIpB,IAAMoF,EAAQ7W,KAAKgX,aACX7C,EAAcnU,KAAKiX,QAAnB9C,UACR,IAAKA,EAAa,OAAO,KAHlB,IAKH5S,EADY0S,EAAcE,EAAtB+C,OAAa1M,EAAS2J,EAAT3J,KAGrB,OAAKqM,GACLtV,EAASvB,KAAKmX,UAAUN,GAGtB9b,OAAAqc,EAAA,EAAArc,CAAC+V,EAAD,CACE0D,IAAGzZ,OAAAsc,EAAA,EAAAtc,CAAE,CAAEkZ,MAAKzJ,UAEZzP,OAAAqc,EAAA,EAAArc,CAACsb,EAAD,CACE7B,IAAG8C,GAIF/V,EAAOtD,YAEVlD,OAAAqc,EAAA,EAAArc,CAACyb,EAAD,MACAzb,OAAAqc,EAAA,EAAArc,CAACub,EAAD,gBACAvb,OAAAqc,EAAA,EAAArc,CAACsb,EAAD,KAAM9U,EAAOrD,SACbnD,OAAAqc,EAAA,EAAArc,CAACub,EAAD,gBACAvb,OAAAqc,EAAA,EAAArc,CAACwb,EAAD,KAAIhV,EAAOpD,WAlBM,YAtCK0G,IAAMsQ,eAA9BsB,EAEGc,YAAc7S,IAiER+R,wCClGTe,EAAEzc,OAAAkb,EAAA,EAAAlb,CAAA,MAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,kBAIR,SAASyG,EAATnS,GAA+D,IAAvCoS,EAAuCpS,EAAvCoS,KAAMtW,EAAiCkE,EAAjClE,MAAOuW,EAA0BrS,EAA1BqS,SAAUC,EAAgBtS,EAAhBsS,aAC7C,OACE7c,OAAAqc,EAAA,EAAArc,CAACyc,EAAD,CACEK,SAAU,EACVD,aAAc,kBAAMA,EAAaxW,KAEhCuW,GAAYD,EAAKtB,OAASsB,EAAKtB,OAASsB,EAAKzY,MAepDwY,EAAaK,aAAe,CAC1BF,aA5BW,cA+BEH,QC9BTM,EAAEhd,OAAAkb,EAAA,EAAAlb,CAAA,MAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,uDAOFgH,4LAac,IAAA/X,EAAAD,KAChB,OAAOA,KAAK0Q,MAAMuH,MACf/X,IAAI,SAACwX,EAAMtW,GAAP,OACH8W,EAAAC,EAAAC,cAACC,EAAD,CACE5G,IAAKrQ,EACLA,MAAOA,EACPsW,KAAMA,EAAKA,KACXY,MAAKvd,OAAA4K,EAAA,EAAA5K,CAAA,GAAMkF,EAAKyQ,MAAMM,OAAOuH,IAC7BZ,SAAUD,EAAKC,SACfC,aAAc3X,EAAKyQ,MAAMkH,kDAKxB,IAAAjB,EAC8B3W,KAAK0Q,MAAlCuH,EADDtB,EACCsB,MAAOhE,EADR0C,EACQ1C,IAAKzJ,EADbmM,EACanM,KAAMwG,EADnB2F,EACmB3F,OAE1B,OAAqB,IAAjBiH,EAAMne,OAAuB,KAG/Boe,EAAAC,EAAAC,cAACL,EAAD,CACEF,UAAW,EACXS,MAAKvd,OAAA4K,EAAA,EAAA5K,CAAA,CAAIkZ,MAAKzJ,QAASwG,EAAOwH,KAE7BxY,KAAKyY,0BArCgB5T,IAAMsQ,eAA9B6C,EAEGU,WAAa,CAClBd,aAAce,IAAUvN,KACxB6M,MAAOU,IAAUC,MAAMC,WACvB5E,IAAK0E,IAAUpY,OAAOsY,WACtBrO,KAAMmO,IAAUpY,OAAOsY,WACvB7H,OAAQ2H,IAAUG,MAAM,CACtBN,GAAIG,IAAUI,OACdR,GAAII,IAAUI,UAkCLf,wBC7CTgB,EAAMje,OAAAkb,EAAA,EAAAlb,CAAA,UAAA0V,OAAA,aAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,cAINiI,EAAa,CAAA1Q,KAAA,SAAAyI,OAAA,oBAIbkI,EAAYne,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CACdke,EADc,eAEF,SAAAvI,GAAK,OAAIA,EAAMC,MAAMC,OAAOsF,SAASC,QAFnC,KAKZgD,EAAcpe,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAChBke,EADgB,eAEJ,SAAAvI,GAAK,OAAIA,EAAMC,MAAMC,OAAOsF,SAASE,QAFjC,KAKdC,EAAGtb,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,CAAAwN,KAAA,SAAAyI,OAAA,uDAMHsF,EAAQvb,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,oBAIRoI,cAiBJ,SAAAA,IAAc,IAAAnZ,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAoZ,IACZnZ,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAqe,GAAAvQ,KAAA7I,QARFqF,MAAQ,CACNgU,UAAW,GACXC,UAAW,EACX9H,SAAU,KACV+H,WAAW,GAKXtZ,EAAKuZ,cAAgBvZ,EAAKuZ,cAAc1H,KAAnB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IACrBA,EAAK0D,SAAW1D,EAAK0D,SAASmO,KAAd/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAHJA,mFAMM,IAAA+I,EAAAhJ,KAClBA,KAAK6S,SAAS,CAAEyG,UAAW,GAAK,WAC9BtQ,EAAK0Q,+DAIaC,EAAWC,GAC/B,OAAO5Z,KAAKqF,MAAMgU,YAAcO,EAAUP,qDAGzB7G,EAAWC,GAC5BzS,KAAK6Z,kBAAkBpH,GACvBzS,KAAK8Z,gBAAgBtH,GACrBxS,KAAK2S,4DAIL3S,KAAKiX,QAAQ/E,0BAAyB,2CAGxBM,GAAW,IAAAtJ,EAAAlJ,KACrBwS,EAAUrS,QAAUH,KAAK0Q,MAAMvQ,OAEnCH,KAAK6S,SAAS,CAAEyG,UAAW,GAAK,WAC9BpQ,EAAKwQ,2DAISjH,GAAW,IACnBjB,EAAaxR,KAAKiX,QAAlBzF,SAEJiB,EAAUjB,WAAaA,IACzBxR,KAAK6S,SAAS,CAAErB,aAChBxR,KAAK+Z,iBAAiBvI,yCAIb,IACHA,EAAaxR,KAAKiX,QAAlBzF,SACJxR,KAAKqF,MAAMmM,WAAaA,GACxB,CAAC,QAAS,OAAOxG,SAASwG,EAASC,MAAQzR,KAAKqF,MAAMkU,WACxDvZ,KAAKga,8DAKP,IAAMC,EAAiBja,KAAKiX,QAAQ1F,WAC5BpR,EAAUH,KAAK0Q,MAAfvQ,MACAmB,EAAWtB,KAAKqF,MAAMgU,UAAUrZ,KAAKqF,MAAMiU,WAA3ChY,OACF4Y,EAAkB/Z,EAAMiB,MAAQjB,EAAMW,KAAKhH,OAC3CqgB,EAAYF,EAAe9Y,MAAM,EAAGhB,EAAMiB,OAC1CgZ,EAAaH,EAAe9Y,MAAM+Y,GAClCG,EAAa,GAAAzf,OAAMuf,GAANvf,OAAkB0G,EAAlB,KAAA1G,OAA4Bwf,GACzC1I,EAAYyI,EAAUrgB,OAASwH,EAAOxH,OAAS,EACrDkG,KAAKiX,QAAQ9E,cAAckI,EAAe3I,0CAG7B,IAgBT4H,EAhBSlQ,EAAApJ,KAEPc,EADYd,KAAK0Q,MAAfvQ,MACWW,KAAKO,cAClBgY,EAAYte,OACfsN,KAAK7G,KACL8Y,OAAO,SAAAhZ,GAAM,OAAIA,EAAOiZ,WAAWzZ,KACnC0Z,OACAta,IAAI,SAAAoB,GAAM,MAAK,CACdoW,KAAM,CACJzY,KAAMmK,EAAKqR,SAASnZ,GACpB8U,OAAQhN,EAAKsR,WAAWpZ,IAE1BqW,UAAU,EACVrW,YAEAiY,GAAY,EAGhBD,EAAYlgB,KAAKD,IAAIC,KAAKF,IAAImgB,EAAUvf,OAAS,EAAGkG,KAAKqF,MAAMiU,WAAY,GAEvED,EAAUvf,OAAS,IACrBuf,EAAUC,GAAW3B,SAAW4B,GAAY,GAG9CvZ,KAAKiX,QAAQ/E,yBAAyBqH,GACtCvZ,KAAK6S,SAAS,CAAEwG,YAAWC,YAAWC,uDAGvB/H,GAAU,IAAAhI,EAAAxJ,KACrBsZ,EAAYtZ,KAAKqF,MAAMiU,UAE3B,OAAQ9H,EAASC,KACf,IAAK,UACD6H,EAAYtZ,KAAKqF,MAAMiU,UAAY,EACrC,MACF,IAAK,YACDA,EAAYtZ,KAAKqF,MAAMiU,UAAY,EAIzCtZ,KAAK6S,SAAS,CAAEyG,aAAa,WAC3B9P,EAAKkQ,kDAIAJ,GAAW,IAAA1P,EAAA5J,KAClBA,KAAK6S,SAAS,CAAEyG,aAAa,WAC3B1P,EAAK8P,kDAIApY,GACP,OACEvG,OAAAqc,EAAA,EAAArc,CAACme,EAAD,KACEne,OAAAqc,EAAA,EAAArc,CAAC4f,EAAD,KACGrZ,uCAMEA,GACT,OACEvG,OAAAqc,EAAA,EAAArc,CAACoe,EAAD,KACEpe,OAAAqc,EAAA,EAAArc,CAAC4f,EAAD,KACGrZ,GAEHvG,OAAAqc,EAAA,EAAArc,CAAC6f,EAAD,KACGpZ,IAAaF,GAAQnD,kDAMd,IACNwS,EAAU3Q,KAAK0Q,MAAfC,MAER,MAAO,CACL6H,GAAI,CACFqC,UAAW,EACXC,UAAS,WAAAlgB,OAAa+V,EAAMC,OAAOC,QACnCkK,OAAM,aAAAngB,OAAe+V,EAAMC,OAAOsF,SAASE,QAC3ChQ,MAAO,8CAMXpG,KAAKga,oDAGE,IAAAgB,EAC0Bhb,KAAKqF,MAA9BgU,EADD2B,EACC3B,UAAWE,EADZyB,EACYzB,UACXpF,EAAcnU,KAAKiX,QAAnB9C,UAER,OACEpZ,OAAAqc,EAAA,EAAArc,CAACie,EAAD,CACEiC,KAAM1B,EACN2B,QAASlb,KAAKwZ,eAEdze,OAAAqc,EAAA,EAAArc,CAACogB,EAAD,CACElD,MAAOoB,EACPpF,IAAK7a,KAAKgiB,MAAMjH,EAAU+C,QAC1B1M,KAAMpR,KAAKgiB,MAAMjH,EAAU3J,MAC3BwG,OAAQhR,KAAKqb,gBACbzD,aAAc5X,KAAK2D,mBAzLFkB,IAAMyW,WAA3BlC,EAEG7B,YAAc7S,IA8LR6W,kBAAUnC,GCjOnBoC,6MAWJnW,MAAQ,CACNuR,SAAU,uFAIV5W,KAAKyb,yDAGYjJ,GACbA,EAAU1S,SAAWE,KAAK0Q,MAAM5Q,QAClCE,KAAKyb,oDAKP,IAAMC,EAAQ,GACR9E,EAAW,GAFL5c,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAIZ,QAAAC,EAAAC,EAAkB2F,KAAK0Q,MAAM5Q,OAA7BxF,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAAqC,KAA5BmG,EAA4B/F,EAAAnB,MACnC,GAAIkH,EAAMC,OAASC,IAAEK,SAAU,CAC7B,IAAMmW,EAAQ,CAAEvV,OAAQnB,EAAMW,KAAMgW,WAAY3W,EAAMiB,MAAO2V,SAAU,MACvE2E,EAAM/gB,KAAKkc,GACXD,EAASjc,KAAKkc,QACT,GAAI1W,EAAMC,OAASC,IAAEgC,OAC1BqZ,EAAM/gB,KAAK,UACN,GAAIwF,EAAMC,OAASC,IAAEiC,OAAQ,CAElC,GADAoZ,EAAMC,MACFD,EAAM5hB,OAAS,GAAiC,MAA5B4hB,EAAMA,EAAM5hB,OAAS,GAC7B4hB,EAAMC,MACd5E,SAAW5W,EAAMiB,MAAQ,IAfzB,MAAAvG,GAAAZ,GAAA,EAAAC,EAAAW,EAAA,YAAAb,GAAA,MAAAK,EAAAS,QAAAT,EAAAS,SAAA,WAAAb,EAAA,MAAAC,GAoBZ0c,EAAS4D,KAAK,SAACrC,EAAGyD,GAAJ,OAAUzD,EAAErB,WAAa8E,EAAE9E,aACzC9W,KAAK6S,SAAS,CAAE+D,uDAGA9W,EAAQ4R,GACxB,IAAItQ,EAEJ,IAAKA,EAAQ,EAAGA,EAAQtB,EAAOhG,OAAQsH,IAAS,CAC9C,IAAMjB,EAAQL,EAAOsB,GACf2V,EAAW5W,EAAMiB,MAAQjB,EAAMW,KAAKhH,OAE1C,GAAI4X,EAAYvR,EAAMiB,OAASsQ,GAAaqF,EAC1C,MAIJ,OAAO3V,6CAGU,IAAAuV,EACa3W,KAAK0Q,MAA3B5Q,EADS6W,EACT7W,OAAQ4R,EADCiF,EACDjF,UACVtQ,EAAQpB,KAAK6b,kBAAkB/b,EAAQ4R,GAI7C,MAAO,CAHatQ,EAAQ,GAAKtB,EAAOsB,EAAQ,GAC9BtB,EAAOsB,GACNA,EAAQtB,EAAOhG,OAAS,GAAKgG,EAAOsB,EAAQ,8CAI/C,IAAA0a,EAC+B9b,KAAK+b,mBADpCC,EAAAjhB,OAAA4Q,EAAA,EAAA5Q,CAAA+gB,EAAA,GACRG,EADQD,EAAA,GACKE,EADLF,EAAA,GACgBG,EADhBH,EAAA,GAGhB,GAAIhc,KAAK0Q,MAAM5Q,OAAOhG,OAAS,EAAK,OAAO,KAE3C,IAAMsiB,EACJH,GACGC,GACAC,GACyB,aAAzBF,EAAYra,UACZ,CAACvB,IAAEW,QAASX,IAAEK,UAAUsK,SAASkR,EAAU9b,OAC3C+b,EAAW/b,OAASC,IAAEiC,OAGrB+Z,EACJJ,GACGC,IACCC,GACD,CAAC9b,IAAEW,QAASX,IAAEK,UAAUsK,SAASkR,EAAU9b,MAGhD,OAAIgc,GAAWC,EAEXnE,EAAAC,EAAAC,cAACkE,EAAD,CACInc,MAAO+b,SAHf,mCAUA,IAAMK,EAAuBvc,KAAKwc,kBAElC,OAAID,GAIArE,EAAAC,EAAAC,cAACqE,EAAD,CACE/K,UAAW1R,KAAK0Q,MAAMgB,UACtBkF,SAAU5W,KAAKqF,MAAMuR,kBAhHL/R,IAAMsQ,eAA1BqG,EAOG1D,aAAe,CACpBpG,UAAW,GA+GA8J,sKC1GTkB,EAAS,CACbC,GAAI,EACJC,GAAI,IACJC,GAAI,IACJC,GAAI,MAGAC,EAAY,CAChBJ,GAAI,KACJC,GAAI,KACJC,GAAI,MAGAG,EAAU,CACdL,GAAE,sBAAA/hB,OAAwB8hB,EAAOE,GAAK,EAApC,OACFA,GAAE,sBAAAhiB,OAAwB8hB,EAAOE,GAA/B,wBAAAhiB,OAAwD8hB,EAAOG,GAAK,EAApE,OACFA,GAAE,sBAAAjiB,OAAwB8hB,EAAOG,GAA/B,wBAAAjiB,OAAwD8hB,EAAOI,GAAK,EAApE,OACFA,GAAE,sBAAAliB,OAAwB8hB,EAAOI,GAA/B,OACFG,KAAM,SAACC,GAAD,4BAAAtiB,OAAuC8hB,EAAOQ,GAA9C,QACNC,KAAM,SAACD,GAAD,4BAAAtiB,OAAuC8hB,EAAQK,EAAUG,IAAgB,EAAzE,SASOvM,EAND,CACZC,OA5Ca,CACb9P,KAAM,UACNL,KAAM,CACJsa,OAAQ,UACRqC,WAAY,OACZC,SAAU,WAEZnH,SAAU,CACRC,OAAQ,UACRC,OAAQ,WAEVkH,QAAS,CACPC,OAAQ,UACRC,MAAO,UAETC,MAAO,CACLC,WAAY,WAEd7M,OAAQ,WA2BR6L,SACAM,WCjBaW,EAvBMnJ,YAAH,cAEL7D,EAAMC,OAAO9P,KAFR,wMCFZgQ,EAAI/V,OAAAkb,EAAA,EAAAlb,CAAA,UAAA0V,OAAA,aAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,0FAgBK4M,MARf,WACE,OACE1F,EAAAC,EAAAC,cAACtH,EAAD,KACEoH,EAAAC,EAAAC,cAAA,4FCdOyF,EAAgB,GAChBC,EAAgB,IAEhBC,EAAiB,GACjBC,EAAiB,ICO9B,IAAIlN,EAAI/V,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,mGAKoB,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YALrD,4BAMqB,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YANtD,eAOQ,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK4c,UAPzC,oBAWFY,EAAQljB,OAAAkb,EAAA,EAAAlb,CAAA,UAAA0V,OAAA,aAAA1V,CAAA,gLAeI,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAO0M,QAAQE,OAfxC,MAmBRU,cAYJ,SAAAA,IAAc,IAAAje,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAke,IACZje,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAmjB,GAAArV,KAAA7I,QAOFqF,MAAQ,CACN8Y,MAAO,EACP/X,MAAO,EACPgY,SAAU,EACVC,YAAY,GAZApe,EA+Bdqe,eAAiBzhB,YAAS,GAAI,SAACiX,GAC7B,IAAMyK,EAAQzK,EAAMqK,MAAQle,EAAKoF,MAAM8Y,MACvCle,EAAK4S,SAAS,CAAEuL,SAAUG,MA/B1Bte,EAAKue,0BAA4Bve,EAAKue,0BAA0B1M,KAA/B/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IACjCA,EAAKwe,wBAA0Bxe,EAAKwe,wBAAwB3M,KAA7B/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC/BA,EAAKye,sBAAwBze,EAAKye,sBAAsB5M,KAA3B/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC7BA,EAAKqe,eAAiBre,EAAKqe,eAAexM,KAApB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IALVA,kFAgBZ,GAAKD,KAAKqF,MAAMgZ,WAAhB,CAEA,IAAMM,EAAW3e,KAAKqF,MAAM+Y,SACtBQ,EAAWf,EAAgB7d,KAAKqF,MAAMe,MACtCyY,EAAWf,EAAgB9d,KAAKqF,MAAMe,MACtCqE,IAAUzR,YAAM2lB,EAAUC,EAAUC,GAAY,GAEtD,OAAO,SAAClO,GAAD,OAAW6D,WAAX,kCAGI/J,EAHJ,iBAISkG,EAAMC,OAAO0M,QAAQE,MAJ9B,uDAae1J,GACtB9T,KAAKse,eAAexK,iDAGAA,GACpB,IAAMyK,EAAQzK,EAAMqK,MAAQne,KAAKqF,MAAM8Y,MACjC/X,EAAQpG,KAAKqF,MAAMe,MAAQmY,EAEjCve,KAAK0Q,MAAMoO,YAAY9e,KAAK0Q,MAAMvV,MAAOiL,GACzCpG,KAAK6S,SAAS,CAAEuL,SAAU,EAAGC,YAAY,IACzC3K,SAASqL,oBAAoB,YAAa/e,KAAKye,yBAC/C/K,SAASqL,oBAAoB,UAAW/e,KAAK0e,yEAGrB5K,GACxBA,EAAMC,iBAEN/T,KAAK6S,SAAS,CACZsL,MAAOrK,EAAMqK,MACb/X,MAAOpG,KAAK0Q,MAAMtK,MAClBiY,YAAY,IAGd3K,SAASsL,iBAAiB,YAAahf,KAAKye,yBAC5C/K,SAASsL,iBAAiB,UAAWhf,KAAK0e,wDAYnC,IAAA/H,EACkB3W,KAAK0Q,MAAtBvV,EADDwb,EACCxb,MAAOiL,EADRuQ,EACQvQ,MAEf,OACErL,OAAAqc,EAAA,EAAArc,CAACkkB,EAAD,CACEC,WAAU/jB,EACVgkB,UAAU,mBACV3K,IAAKA,YAAF,SACQpO,EADR,oBAKFjL,EACDJ,OAAAqc,EAAA,EAAArc,CAACkjB,EAAD,CACEzJ,IAAKxU,KAAKof,mBACVvH,SAAS,KACTwH,YAAarf,KAAKwe,0BAClBc,YAAatf,KAAKuf,0BAClBC,UAAWxf,KAAKyf,kCAtGF5a,IAAMsQ,eAAxB+I,EAQGpG,aAAe,CACpB1R,MDnD6B,KC4JjC,IAAMgP,EAAqB,CAAE0J,YCnJtB,SAAqB3Y,EAAUC,GACpC,GAAqB,kBAAVA,EACT,MAAM,IAAItI,MAAM,yBAGlB,MAAO,CACLsC,KAAM,gBACNmF,QAAS,CAAEY,WAAUC,MAAOpN,YAAMoN,EAAOyX,EAAeC,OD8I7CzI,cAPf,SAAyBhQ,EAAOqa,GAE9B,MAAO,CAAEtZ,MADKf,EAAM2B,UAAUhB,UAAU0Z,EAASvkB,SAMXia,EAAzBC,CAA6C6I,GErJtDyB,EAAG5kB,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,oCAKH4O,EAAW7kB,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,iFAIW,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YAJ5C,4BAKY,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YAL7C,eAMD,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK4c,UANhC,wDA0CFwC,MAjCf,SAAApa,GAAqC,IAAbqa,EAAara,EAAbqa,UAmBtB,OACE/kB,OAAAqc,EAAA,EAAArc,CAAC4kB,EAAD,CACEI,WAAS,UAnBXhlB,OAAAqc,EAAA,EAAArc,CAAC6kB,EAAD,CACEpL,IAAGwL,IAQL,IAAI1hB,MAAMwhB,EAAUhmB,QAAQmmB,KAAK,GAAG/f,IAAI,SAACggB,EAAGC,GAAJ,OACtCplB,OAAAqc,EAAA,EAAArc,CAACqlB,EAAD,CACE3O,IAAK0O,EACLhlB,MAAO2kB,EAAUK,SCzBnBrP,EAAI/V,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,kHAMkB,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YANnD,4BAOmB,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YAPpD,eAQM,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK4c,UARvC,KAWJgD,EAAStlB,OAAAkb,EAAA,EAAAlb,CAAA,UAAA0V,OAAA,aAAA1V,CAAA,kLAeG,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAO0M,QAAQE,OAfvC,MAmBT8C,cAQJ,SAAAA,IAAc,IAAArgB,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAAsgB,IACZrgB,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAAulB,GAAAzX,KAAA7I,QAOFqF,MAAQ,CACNkb,MAAO,EACP/Z,OAAQ,EACRga,UAAW,EACXnC,YAAY,GAZApe,EAedwgB,QAAU5b,IAAM+M,YAfF3R,EAiDdygB,gBAAkB7jB,YAAS,GAAI,SAACiX,GAC9B,IAAMyK,EAAQzK,EAAMyM,MAAQtgB,EAAKoF,MAAMkb,MACvCtgB,EAAK4S,SAAS,CAAE2N,UAAWjC,MAjD3Bte,EAAK0gB,2BAA6B1gB,EAAK0gB,2BAA2B7O,KAAhC/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAClCA,EAAKwe,wBAA0Bxe,EAAKwe,wBAAwB3M,KAA7B/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC/BA,EAAKye,sBAAwBze,EAAKye,sBAAsB5M,KAA3B/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC7BA,EAAKygB,gBAAkBzgB,EAAKygB,gBAAgB5O,KAArB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IALXA,8EAiBC,IACLuG,EAAWxG,KAAK0Q,MAAhBlK,OACF8R,EAAQ,CACZlS,MAAO,IAUT,OAPII,EACF8R,EAAM9R,OAASA,GAEf8R,EAAMsI,UJzEsB,GI0E5BtI,EAAM9R,OAAS,QAGV8R,8CAIP,GAAKtY,KAAKqF,MAAMgZ,WAAhB,CAEA,IAAMwC,EAAY7gB,KAAKqF,MAAMmb,UACvBM,EAAY/C,EAAiB/d,KAAKqF,MAAMmB,OACxCua,EAAY/C,EAAiBhe,KAAKqF,MAAMmB,OACxC0Q,IAAWle,YAAM6nB,EAAWC,EAAWC,GAAa,GAE1D,OAAO,SAACpQ,GAAD,OAAW6D,WAAX,mCAGK0C,EAHL,iBAISvG,EAAMC,OAAO0M,QAAQE,MAJ9B,uDAae1J,GACtB9T,KAAK0gB,gBAAgB5M,iDAGDA,GACpB,IAAMyK,EAAQzK,EAAMyM,MAAQvgB,KAAKqF,MAAMkb,MACjC/Z,EAASxG,KAAKqF,MAAMmB,OAAS+X,EAEnCve,KAAK0Q,MAAMsQ,aAAahhB,KAAK0Q,MAAMvV,MAAOqL,GAC1CxG,KAAK6S,SAAS,CAAE2N,UAAW,EAAGnC,YAAY,IAC1C3K,SAASqL,oBAAoB,YAAa/e,KAAKye,yBAC/C/K,SAASqL,oBAAoB,UAAW/e,KAAK0e,0EAGpB5K,GACzBA,EAAMC,iBAEN/T,KAAK6S,SAAS,CACZ0N,MAAOzM,EAAMyM,MACb/Z,OAAQxG,KAAK0Q,MAAMlK,QAAUxG,KAAKygB,QAAQ3N,QAAQsB,wBAAwB5N,OAC1E6X,YAAY,IAGd3K,SAASsL,iBAAiB,YAAahf,KAAKye,yBAC5C/K,SAASsL,iBAAiB,UAAWhf,KAAK0e,wDAGnC,IACCvjB,EAAU6E,KAAK0Q,MAAfvV,MAER,OACEJ,OAAAqc,EAAA,EAAArc,CAACkmB,EAAD,CACErM,IAAK5U,KAAKygB,QACVV,WAAU5kB,EACVgkB,UAAU,mBACV3K,IAAKxU,KAAKyU,gBAETtZ,EACDJ,OAAAqc,EAAA,EAAArc,CAACslB,EAAD,CACE7L,IAAKxU,KAAKkhB,oBACVrJ,SAAS,KACTwH,YAAarf,KAAK2gB,2BAClBrB,YAAatf,KAAKmhB,2BAClB3B,UAAWxf,KAAKohB,mCAzGFvc,IAAMsQ,eAqH9B,IAAMC,EAAqB,CAAE4L,aF3ItB,SAAsBza,EAAUC,GACrC,GAAsB,kBAAXA,EACT,MAAM,IAAI1I,MAAM,0BAGlB,MAAO,CACLsC,KAAM,iBACNmF,QAAS,CAAEgB,WAAUC,OAAQxN,YAAMwN,EAAQuX,EAAgBC,OEsIhD3I,cAPf,SAAyBhQ,EAAOqa,GAE9B,MAAO,CAAElZ,OADMnB,EAAM2B,UAAUf,WAAWyZ,EAASvkB,SAMbia,EAAzBC,CAA6CiL,mBC1JtDxP,EAAI/V,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,uJA0DKqQ,MA5Cf,SAAA/b,GAAyF,IAAxEgc,EAAwEhc,EAAxEgc,OAAQzlB,EAAgEyJ,EAAhEzJ,SAAUqM,EAAsD5C,EAAtD4C,OAAQgT,EAA8C5V,EAA9C4V,QAASlG,EAAqC1P,EAArC0P,UAAWuM,EAA0Bjc,EAA1Bic,cAAeC,EAAWlc,EAAXkc,QAe5E,OACEzmB,OAAAqc,EAAA,EAAArc,CAAC0mB,EAAD,CACE7M,IAAK0M,EACLzM,YAAU,SACVC,gBAAejZ,EACf2Y,IAnBa,WACf,IAAI8D,EAAQ,GAUZ,MARsB,kBAAXpQ,IACToQ,EAAQ,CACNoJ,WAAY,SACZC,aAAc,OACdC,SAAU,WAIPtJ,EAQAuJ,GACLhK,SAAS,IACTqD,QAASA,EACTlG,UAAWA,EACXuM,cAAeA,EACfC,QAASA,GAEVtZ,ICvCQ4Z,EAAb,SAAA5Q,GAgBE,SAAA4Q,EAAYpR,GAAO,IAAAzQ,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA8hB,IACjB7hB,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAA+mB,GAAAjZ,KAAA7I,QACKwZ,cAAgBvZ,EAAKuZ,cAAc1H,KAAnB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IACrBA,EAAK8hB,oBAAsB9hB,EAAK8hB,oBAAoBjQ,KAAzB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC3BA,EAAK+hB,cAAgB/hB,EAAK+hB,cAAclQ,KAAnB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IACrBA,EAAK4R,gBAAkB5R,EAAK4R,gBAAgBC,KAArB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IACvBA,EAAKgiB,SAAWvR,EAAM4Q,OANLrhB,EAhBrB,OAAAlF,OAAAmnB,EAAA,EAAAnnB,CAAA+mB,EAAA5Q,GAAAnW,OAAAonB,EAAA,EAAApnB,CAAA+mB,EAAA,EAAArQ,IAAA,mBAAAxY,MAAA,SAyBmB2O,GACf,IAAMwa,EAAYpiB,KAAKiiB,SAASnP,QAAQsB,wBAClCzM,EAAW0a,KAAK1V,MAAM0V,KAAKC,UAAUF,IAC3CpiB,KAAK0Q,MAAMvJ,iBAAiBQ,EAAUC,KA5B1C,CAAA6J,IAAA,gBAAAxY,MAAA,WAgCI+G,KAAK0Q,MAAMxJ,cAAclH,KAAK0Q,MAAM7U,YAhCxC,CAAA4V,IAAA,gBAAAxY,MAAA,SAmCgB6a,GACZA,EAAMyO,oBApCV,CAAA9Q,IAAA,sBAAAxY,MAAA,SAuCsB6a,GAClBA,EAAMyO,kBACNviB,KAAKmH,kBAAiB,KAzC1B,CAAAsK,IAAA,kBAAAxY,MAAA,SAAAqM,GA4C2B,IAAPmM,EAAOnM,EAAPmM,IACZ,CAAC,SAAU,aAAazG,SAASyG,IAClB,GAAKzR,KAAK0Q,MAAMxI,QAEpBpO,OAAS,GACpBkG,KAAK0Q,MAAMtI,cAAcpI,KAAK0Q,MAAM7U,UAId,IAAf4V,EAAI3X,QACbkG,KAAKmH,kBAAiB,KAtD5B,CAAAsK,IAAA,SAAAxY,MAAA,WA2DI,OACEif,EAAAC,EAAAC,cAACoK,EAAD,CACElB,OAAQthB,KAAKiiB,SACbpmB,SAAUmE,KAAK0Q,MAAM7U,SACrBqM,OAAQlI,KAAK0Q,MAAMxI,OACnBgT,QAASlb,KAAKwZ,cACd+H,cAAevhB,KAAK+hB,oBACpBP,QAASxhB,KAAKgiB,cACdhN,UAAWhV,KAAK6R,sBAnExBiQ,EAAA,CAA4Bjd,IAAMsQ,eA+ElC,IAAMC,EAAqB,CAAEhN,kBAAejB,qBAAkBD,mBAE/CmO,cARf,SAAyBhQ,EAAOqa,GAC9B,IAAMjf,EAAO4E,EAAMyB,UAAU4Y,EAAS7jB,UAEtC,MAAO,CAAEqM,OADMzH,EAAOA,EAAKyH,OAAS,KAMEkN,EAAzBC,CAA6CyM,oBChFtDhR,GAAI/V,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,qEAIkB,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAKsa,QAJnD,4BAKmB,SAAArK,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAKsa,QALpD,kBASH,SAAS0H,GAATnd,GAA2E,IAAnDc,EAAmDd,EAAnDc,MAAOI,EAA4ClB,EAA5CkB,OAAQ0U,EAAoC5V,EAApC4V,QAASqG,EAA2Bjc,EAA3Bic,cAAemB,EAAYpd,EAAZod,SACpE,OACE3nB,OAAAqc,EAAA,EAAArc,CAAC4nB,GAAD,CACE9N,YAAU,SACVqG,QAASA,EACTqG,cAAeA,EACf/M,IAAGzZ,OAAAsc,GAAA,EAAAtc,CAAE,CACHqL,QACAI,OAAQA,GAAUA,KAGnBkc,GAaPD,GAAa3K,aAAe,CAC1B1R,MP5C+B,KOsDlBiP,mBAPf,SAAyBhQ,EAAOqa,GAAU,IAAAkD,EACXlD,EAAS7jB,SAASE,MAAM,KADb8mB,EAAA9nB,OAAA4Q,EAAA,EAAA5Q,CAAA6nB,EAAA,GACjCzc,EADiC0c,EAAA,GACvBtc,EADuBsc,EAAA,GAIxC,MAAO,CAAEzc,MAFKf,EAAM2B,UAAUhB,UAAUG,GAExBK,OADDnB,EAAM2B,UAAUf,WAAWM,KAI7B8O,CAAyBoN,ICJzBK,eApCb,SAAAA,IAAc,IAAA7iB,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA8iB,IACZ7iB,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAA+nB,GAAAja,KAAA7I,QAHFiiB,SAAWpd,IAAM+M,YAIf3R,EAAKuZ,cAAgBvZ,EAAKuZ,cAAc1H,KAAnB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IACrBA,EAAK8hB,oBAAsB9hB,EAAK8hB,oBAAoBjQ,KAAzB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAHfA,4EAMD,IAAA+I,EAAAhJ,KACX7C,WAAW,kBAAM6L,EAAKiZ,SAASnP,QAAQK,SAAS,2CAIhDnT,KAAK+iB,2DAIL/iB,KAAK+iB,8CAGE,IACClnB,EAAamE,KAAK0Q,MAAlB7U,SAER,OACEqc,EAAAC,EAAAC,cAAC4K,GAAD,CACE9H,QAASlb,KAAKwZ,cACd+H,cAAevhB,KAAK+hB,oBACpBlmB,SAAUA,GAEVqc,EAAAC,EAAAC,cAAC6K,EAAD,CACEpnB,SAAUA,EACVylB,OAAQthB,KAAKiiB,mBArCEpd,IAAMsQ,eCEzBwK,GAAG5kB,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,UAAAyI,OAAA,oCAmCMkS,OA9Bf,SAAA5d,GAA2C,IAAxB6d,EAAwB7d,EAAxB6d,UAAWrD,EAAaxa,EAAbwa,UAa5B,OACE5H,EAAAC,EAAAC,cAACgL,GAAD,CACErD,WAAUoD,GAEVjL,EAAAC,EAAAC,cAACiL,EAAD,CACEloB,MAAOgoB,IAhBX,IAAI7kB,MAAMwhB,EAAUhmB,QAAQmmB,KAAK,GAAG/f,IAAI,SAACggB,EAAGC,GAC1C,IAAMtkB,EAAQ,GAAAjB,OAAMklB,EAAUK,GAAhB,KAAAvlB,OAAsBuoB,GACpC,OACEjL,EAAAC,EAAAC,cAACkL,GAAD,CACE7R,IAAK0O,EACLtkB,SAAUA,iBCuBpB,IAAMwJ,GAAQ,CACZke,GAAI,cACJC,QAAS,OACTvM,QAAS,CACP9R,QAAS,KACTD,KAAM,KACNuM,IAAK,KACLjD,SAAU,KACVC,SAAU,KACVgF,YAAa,KACbgQ,YAAY,GAEdC,OAAQ,CACNC,KAAM,CACJC,GAAI,CACFC,WAAc,CACZC,QAAS,CAAC,gBAAiB,sBAC3BrT,OAAQ,iBAIdsT,YAAa,CACXC,OAAQ,CACNC,IApCR,SAAyBC,GACvB,OAAKA,EAAIzQ,YAEF,IAAIhM,QAAQ,SAAAC,GACjBvK,WAAW,WACT,IAAMomB,EAAE,mBAAA3oB,OAAsBspB,EAAIzQ,YAA1B,MACFhT,EAAOiT,SAASC,cAAc4P,GAChC9iB,GAAQA,EAAK0S,QACjBzL,GAAQ,IACP,KAR0BD,QAAQC,SAAQ,IAoCzCyc,OAAQ,CACNL,QAASM,YAAO,CAAEX,WAAY,SAACS,EAAKpQ,GAAN,OAAgBA,EAAMhO,QACpD2K,OAAQ,YAOZqT,GAAU,CACdA,QAAS,CACPO,cAAeD,YAAO,SAACF,EAADze,GAA4B,IAApBgM,EAAoBhM,EAApBgM,IAAK5V,EAAe4J,EAAf5J,SAAeuR,EACnBxR,YAAcC,GADKwR,EAAAtS,OAAA4Q,EAAA,EAAA5Q,CAAAqS,EAAA,GAEhD,MAAO,CAAEoB,SAFuCnB,EAAA,GAE7BoB,SAF6BpB,EAAA,GAEnBoE,SAE/B6S,mBAAoBF,YAAO,CACzB3Q,YAAa,SAACyQ,GACZ,OA/ER,SAAA5e,GAAuE,IAA1CJ,EAA0CI,EAA1CJ,KAAMC,EAAoCG,EAApCH,QAASsJ,EAA2BnJ,EAA3BmJ,SAAUD,EAAiBlJ,EAAjBkJ,SACpD,OADqElJ,EAAPmM,KAE5D,IAAK,UACHhD,EAAWrV,KAAKD,IAAI,EAAGsV,EAAW,GAClC,MACF,IAAK,aACHD,EAAWpV,KAAKF,IAAIiM,EAAU,EAAGqJ,EAAW,GAC5C,MACF,IAAK,YACL,IAAK,QACHC,EAAWrV,KAAKF,IAAIgM,EAAO,EAAGuJ,EAAW,GACzC,MACF,IAAK,YACHD,EAAWpV,KAAKD,IAAI,EAAGqV,EAAW,GAClC,MACF,QACE,OAAO,KAGX,IAAMrI,EAAWlL,YAAeuT,GAC1BjI,EAAW,IAAMkI,EAAW,GAElC,SAAA7T,OAAUuL,EAAV,KAAAvL,OAAsB2L,GAyDTge,CAAkBL,QAuBlBM,OAjBf,SAA+Btf,EAAMC,GACnC,IAAMsf,EAAU1pB,OAAA4K,GAAA,EAAA5K,CAAA,GACXsK,GAAM4R,QADK,CAEd9R,UACAD,SAGF,OAAOwf,YAAQrf,GAAOye,GAASW,ICrF3BE,GAAI5pB,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,aAAA1V,CAAA,6FAKgB,SAAA2V,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YALjD,0BAMiB,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YANlD,2BAOkB,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YAPnD,4BAQmB,SAAA1M,GAAK,OAAIA,EAAMC,MAAMC,OAAOnQ,KAAK2c,YARpD,8BAeGwH,GAAb,SAAA1T,GAME,SAAA0T,EAAYlU,GAAO,IAAAzQ,EAAA,OAAAlF,OAAAgF,EAAA,EAAAhF,CAAAiF,KAAA4kB,IACjB3kB,EAAAlF,OAAA4N,EAAA,EAAA5N,CAAAiF,KAAAjF,OAAA6N,EAAA,EAAA7N,CAAA6pB,GAAA/b,KAAA7I,KAAM0Q,KAMRmU,mBAAqBL,GAAsBvkB,EAAKyQ,MAAMxL,KAAMjF,EAAKyQ,MAAMvL,SAPpDlF,EAQnB6kB,aAAe1U,YAAUnQ,EAAK4kB,oBAN5B5kB,EAAK8kB,mBAAqB9kB,EAAK8kB,mBAAmBjT,KAAxB/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC1BA,EAAK+kB,qBAAuB/kB,EAAK+kB,qBAAqBlT,KAA1B/W,OAAA0e,EAAA,EAAA1e,CAAAkF,IAC5BA,EAAK6f,UAAYzmB,YAAeqX,EAAMvL,SAJrBlF,EANrB,OAAAlF,OAAAmnB,EAAA,EAAAnnB,CAAA6pB,EAAA1T,GAAAnW,OAAAonB,EAAA,EAAApnB,CAAA6pB,EAAA,EAAAnT,IAAA,oBAAAxY,MAAA,WAiBI+G,KAAK8kB,aAAaG,UAjBtB,CAAAxT,IAAA,uBAAAxY,MAAA,WAqBI+G,KAAK8kB,aAAaI,SArBtB,CAAAzT,IAAA,qBAAAxY,MAAA,SAwBqB6a,GACjBA,EAAMyO,oBAzBV,CAAA9Q,IAAA,uBAAAxY,MAAA,SA4BuB6a,GACnBA,EAAMyO,kBACezO,EAAMrD,OAAO0U,QAA1BtpB,UAGNmE,KAAKolB,UAAUtR,EAAMrC,IAAKqC,EAAMrD,OAAO0U,QAAQtpB,YAjCrD,CAAA4V,IAAA,YAAAxY,MAAA,SAqCYwY,EAAK5V,GACbmE,KAAK8kB,aAAaO,KAAK,CAAEjlB,KAAM,aAAcqR,MAAK5V,eAtCtD,CAAA4V,IAAA,qBAAAxY,MAAA,SAyCqBknB,GACjB,OACEjI,EAAAC,EAAAC,cAACkN,EAAD,CACE7T,IAAK0O,EACLjb,KAAMlF,KAAK0Q,MAAMxL,KACjB4a,UAAW9f,KAAK8f,cA9CxB,CAAArO,IAAA,iBAAAxY,MAAA,SAmDiBkqB,GACb,OACEjL,EAAAC,EAAAC,cAACmN,GAAD,CACE9T,IAAK0R,EACLA,UAAWA,EACXrD,UAAW9f,KAAK8f,cAxDxB,CAAArO,IAAA,aAAAxY,MAAA,WA6De,IAAA+P,EAAAhJ,KACX,OAAO,IAAI1B,MAAM0B,KAAK0Q,MAAMxL,KAAO,GAAG+a,KAAK,GAAG/f,IAAI,SAACggB,EAAGC,GACpD,OAAU,IAANA,EACKnX,EAAKwc,mBAAmBrF,GAExBnX,EAAKyc,eAAetF,OAlEnC,CAAA1O,IAAA,SAAAxY,MAAA,WAwEI,OACEif,EAAAC,EAAAC,cAACuM,GAAD,CACEe,aAAW,MACXxK,QAASlb,KAAK+kB,mBACd/P,UAAWhV,KAAKglB,sBAEfhlB,KAAK2lB,kBA9Edf,EAAA,CAA2B/f,IAAMsQ,eAyFlBE,eALS,SAAChQ,GAAU,IAAAiQ,EACPjQ,EAAMuB,OAChC,MAAO,CAAE1B,KAFwBoQ,EACzBpQ,KACOC,QAFkBmQ,EACnBnQ,UAIDkQ,CAAyBuP,aC1GlCgB,GAAS7qB,OAAAkb,EAAA,EAAAlb,CAAA,OAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,SAAAyI,OAAA,2FAOT6U,GAAI9qB,OAAAkb,EAAA,EAAAlb,CAAA,QAAA0V,OAAA,YAAA1V,CAAA,CAAAwN,KAAA,SAAAyI,OAAA,oBAsBV,IAKeqE,eALS,SAAChQ,GAEvB,MAAO,CAAEO,mBADsBP,EAAMuB,OAAO3B,aAApCW,qBAIKyP,CAvBf,SAAA/P,GAAqC,IAAtBM,EAAsBN,EAAtBM,mBACb,OACEsS,EAAAC,EAAAC,cAACwN,GAAD,KACE1N,EAAAC,EAAAC,cAACyN,GAAD,KACGjgB,GAAuBsS,EAAAC,EAAAC,cAACnH,GAAA,EAAD,MACxBiH,EAAAC,EAAAC,cAAA,OAAK0N,yBAAA,EAAsBjO,SAAS,MACpCK,EAAAC,EAAAC,cAAC2N,EAAD,MACA7N,EAAAC,EAAAC,cAAC4N,GAAD,UCFOlV,OAbf,WACE,OACEoH,EAAAC,EAAAC,cAAC6N,EAAA,EAAD,CAAUje,MAAOvB,KACfyR,EAAAC,EAAAC,cAAC8N,EAAA,EAAD,KACEhO,EAAAC,EAAAC,cAAC+N,EAAA,EAAD,CAAexV,MAAOA,GACpBuH,EAAAC,EAAAC,cAAChB,EAAA,EAAD,CAAQpG,OAAQ2M,IAChBzF,EAAAC,EAAAC,cAACgO,GAAD,UCPU1pB,QACW,cAA7B2pB,OAAOxqB,SAASyqB,UAEe,UAA7BD,OAAOxqB,SAASyqB,UAEhBD,OAAOxqB,SAASyqB,SAAS3pB,MACvB,2DCbN4pB,IAASC,OAAOtO,EAAAC,EAAAC,cAACqO,GAAD,MAAU/S,SAASgT,eAAe,SD4H5C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,KAAK,SAAAC,GACjCA,EAAaC","file":"static/js/main.a2ef2d1b.chunk.js","sourcesContent":["const BASE_CODE_POINT = 'A'.codePointAt(0)\n\nexport function buildUrl(baseUrl, query={}) {\n  const urlQuery = Object.entries(query).map(([key, val]) => `${key}=${val}`).join('&')\n  return [baseUrl.trim(), urlQuery].join('?')\n}\n\nexport function clamp(value, min, max) {\n  return Math.min( Math.max(value, min), max )\n}\n\nexport function getRangeArray(min, max, isString=false) {\n  const range = []\n\n  for (let num = min; num <= max; num++) {\n    range.push( isString ? num.toString() : num )\n  }\n\n  return range\n}\n\nexport const sleep = (ms) => new Promise(resolve => setTimeout(() => resolve(), ms))\n\nexport function getColumnNames(cols) {\n  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n  let names = []\n  let prevNames = ['']\n  let remainCols = cols\n\n  while (remainCols > 0) {\n    const newNames = []\n\n    outerLoop:\n    for (let colName of prevNames) {  \n      for (let letter of alphabet) {\n        if (remainCols === 0)  { break outerLoop }\n        newNames.push(`${colName}${letter}`)\n        remainCols -= 1\n      }\n    }\n\n    prevNames = newNames\n    names = [...names, ...newNames]\n  }\n\n  return names\n}\n\nexport function getCellNames(rows, cols) {\n  const names = []\n  let colNames = getColumnNames(cols)\n\n  for (let row=1; row <= rows; row++) {\n    for (let col of colNames) {\n      names.push(`${col}-${row}`)\n    }\n  }\n\n  return names\n}\n\nexport function getColumnPosition(colLabel) {\n  const letters = colLabel.split('')\n  const oneBase = letters.reduce((prev, letter) => (\n    prev * 26 + letter.charCodeAt(0) - BASE_CODE_POINT + 1\n  ), 0)\n\n  return oneBase - 1\n}\n\nexport function getColumnLabel(num) {\n  const label = []\n  const basePoint = BASE_CODE_POINT\n  let curr = num + 1\n\n  do {\n    curr -= 1\n    const letterPosition = curr % 26\n    const codePoint = basePoint + letterPosition\n    const letter = String.fromCodePoint(codePoint)\n    label.push(letter)\n\n    curr = Math.floor(curr / 26)\n  } while (curr > 0)\n\n  return label.reverse().join('')\n}\n\nexport function parseLocation(location) {\n  let [col, row] = location.split('-')\n  const colIndex = getColumnPosition(col)\n  const rowIndex = +row - 1\n\n  return [colIndex, rowIndex]\n}\n\nexport function isNumber(numStr) {\n  const isPeriodsAndDigits = Boolean(numStr.match(/^[.\\d]+$/))\n  const periodCount = (numStr.match(/\\./g) || []).length\n\n  if (!isPeriodsAndDigits) { return false }\n  if (periodCount > 1) { return false }\n  if (numStr.length === 1 && numStr[0] === '.') { return false }\n  return true\n}\n\nexport function debounce(time, fn) {\n  let timeout\n\n  return (...args) => {\n    if (timeout) { return }\n\n    fn(...args)\n\n    timeout = setTimeout(() => {\n      clearTimeout(timeout)\n      timeout = null\n    }, time)\n  }\n}\n\n","function testArgsAllNumbers(args) {\n  args.forEach(arg => {\n    if (typeof arg !== 'number') {\n      throw new TypeError(`Function argument not a number: ${arg}`)\n    }\n  })\n}\n\nconst Fn = {\n  AVERAGE: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      return Fn.SUM.fn(...args) / Fn.COUNT.fn(...args)\n    },\n    definition: 'AVERAGE(value1, value2, ...)',\n    example: 'AVERAGE(A1:B3, 3)',\n    summary: 'Returns the average from a series of numbers.',\n  },\n\n  CONCAT: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n  \n      return args.reduce((prev, curr) => (prev + curr), '')\n    },\n    definition: 'CONCAT(\"text1\", \"text2\", ...)',\n    example: 'CONCAT(\"one\", \"two\")',\n    summary: 'Returns a single concatenated string from a series of strings.',\n  },\n\n  COUNT: {\n    fn: (...args) => args.length,\n    definition: 'COUNT(element1, element2, ...)',\n    example: 'COUNT(A1:B3, 2, C4)',\n    summary: 'Returns the number of non-empty elements in a set.',\n  },\n\n  MAX: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      testArgsAllNumbers(args)\n      return Math.max(...args)\n    },\n    definition: 'MAX(value1, value2, ...)',\n    example: 'MAX(A1:B3, 4, C3)',\n    summary: 'Returns the maximum value from a series of numbers',\n  },\n\n  MIN: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      testArgsAllNumbers(args)\n      return Math.min(...args)\n    },\n    definition: 'MIN(value1, value2, ...)',\n    example: 'MIN(A1:B3, 4, C3)',\n    summary: 'Returns the minimum value from a series of numbers.',\n  },\n\n  POWER: {\n    fn: (...args) => {\n      if (args.length !== 2) {\n        throw new Error('Formula takes only two elements')\n      }\n\n      testArgsAllNumbers(args)\n      const [base, exp] = args\n      return Math.pow(base, exp)\n    },\n    definition: 'POWER(base, exponent)',\n    example: 'POWER(A3,2)',\n    summary: 'Returns a number raised to an exponent.'\n  },\n\n  SQRT: {\n    fn: (...args) => {\n      if (args.length !== 1) {\n        throw new Error(`Formula takes only one element`)\n      }\n\n      testArgsAllNumbers(args)\n      return Math.sqrt(args[0])\n    },\n    definition: 'SQRT(value)',\n    example: 'SQRT(9) or SQRT(A3)',\n    summary: 'Returns the square root of a number.'\n  },\n\n  SUM: {\n    fn: (...args) => {\n      if (args.length === 0) {\n        throw new Error('Empty elements')\n      }\n\n      testArgsAllNumbers(args)\n      return args.reduce((prev, curr) => (curr + prev), 0)\n    },\n    definition: 'SUM(value1, value2, ...)',\n    example: 'SUM(A1:B3, 3, C5)',\n    summary: 'Retuns the sum from a series of numbers.',\n  }\n}\n\n// aliases\nFn.AVG = {\n  ...Fn.AVERAGE,\n  definition: 'AVG(value1, value2, ...)',\n  example: 'AVG(A1:B3, 3)',\n}\n\nFn.POW = {\n  ...Fn.POWER,\n  definition: 'POW(base, exponent)',\n  example: 'POW(A3,2)',\n}\n\nexport default Fn\n","import { TOKENS as t } from './Lexer'\nimport formulaFuncs from './formulaFunctions'\nimport { isNumber } from '~/library/utils'\n\n\nclass TokenSanitizer {\n  constructor(tokens) {\n    this.tokens = tokens\n  }\n\n  sanitize() {\n    return this.tokens.map(token => {\n      switch(token.type) {\n        case t.NUMBER:\n          return this.number(token)\n        case t.CELL:\n          return this.cell(token)\n        case t.FUNCTION:\n          return this.function(token)\n        case t.STRING:\n          return this.string(token)\n        default:\n          return token\n      }\n    })\n  }\n\n  number(token) {\n    if (!isNumber(token.text)) {\n      token.type = t.UNKNOWN\n      return token\n    }\n\n    token.value = parseFloat(token.text)\n    return token\n  }\n\n  cell(token) {\n    token.value = this.getCellLabel(token)\n    return token\n  }\n\n  function(token) {\n    const fn = this.getFunction(token)\n    \n    if (fn) {\n      token.value = fn\n    } else {\n      token.type = t.UNKNOWN\n    }\n\n    return token\n  }\n\n  string(token) {\n    token.value = token.text.slice(1, -1)\n    return token\n  }\n\n  getCellLabel(token) {\n    const { text } = token\n    const { index } = text.match(/\\d+/)\n    const col = text.slice(0, index).toUpperCase()\n    const row = text.slice(index)\n    return `${col}-${row}`\n  }\n\n  getFunction(token) {\n    const fnName = token.text.toUpperCase()\n    const fnNode = formulaFuncs[fnName]\n    return fnNode && fnNode.fn\n  }\n}\n\nexport default TokenSanitizer\n","class LexerRule {\n  constructor(regex, groupIndex, token, category) {\n    this.regex = regex\n    this.groupIndex = groupIndex\n    this.token = token\n    this.category = category\n  }\n\n  setIndex(index) {\n    this.regex.lastIndex = index\n  }\n\n  test(input) {\n    return this.regex.exec(input)\n  }\n}\n\nexport default LexerRule\n","import Token from './Token'\nimport TokenSanitizer from './TokenSanitizer'\nimport LexerRule from './LexerRule'\nimport { isNumber } from '~/library/utils'\n\n\nconst TOKENS = {\n  // internal\n  EOF: 'EOF',\n  // structure\n  EQUALS: 'EQUALS',\n  COMMA: 'COMMA',\n  COLON: 'COLON',\n  LPAREN: 'LPAREN',\n  RPAREN: 'RPAREN',\n  // operators\n  PLUS: 'PLUS',\n  MINUS: 'MINUS',\n  MULT: 'MULT',\n  DIV: 'DIV',\n  // entities\n  TEXT: 'TEXT',\n  CELL: 'CELL',\n  STRING: 'STRING',\n  NUMBER: 'NUMBER',\n  FUNCTION: 'FUNCTION',\n  UNKNOWN: 'UNKNOWN',\n}\n\nconst t = TOKENS\n\nconst GRAMMAR = [\n  // structure\n  new LexerRule(/=/g, 0, t.EQUALS, 'structure'),\n  new LexerRule(/,/g, 0, t.COMMA, 'structure'),\n  new LexerRule(/:/g, 0, t.COLON, 'structure'),\n  new LexerRule(/\\(/g, 0, t.LPAREN, 'structure'),\n  new LexerRule(/\\)/g, 0, t.RPAREN, 'structure'),\n  // operators\n  new LexerRule(/\\+/g, 0, t.PLUS, 'operator'),\n  new LexerRule(/\\-/g, 0, t.MINUS, 'operator'), // eslint-disable-line\n  new LexerRule(/\\*/g, 0, t.MULT, 'operator'),\n  new LexerRule(/\\//g, 0, t.DIV, 'operator'),\n  // multi-character\n  new LexerRule(/(\"[^\"]+\")/g, 1, t.STRING, 'entity'), // eslint-disable-line\n  new LexerRule(/[\\d\\.]+/g, 0, t.NUMBER, 'entity'), // eslint-disable-line\n  new LexerRule(/[a-z]+[\\d]+/gi, 0, t.CELL, 'entity'),\n  new LexerRule(/([a-z]+)\\(/gi, 1, t.FUNCTION, 'entity'),\n]\n\n\nclass Lexer {\n  constructor(input) {\n    this.input = input\n    this.index = 0\n    this.char = this.initChar(input)\n    this.markers = []\n    this.tokens = []\n  }\n\n  getTokens() {\n    while (this.char !== t.EOF) {\n      const token = this.nextToken()\n      this.tokens.push(token)\n    }\n\n    const sanitizer = new TokenSanitizer(this.tokens)\n    this.tokens = sanitizer.sanitize()\n    return this.tokens\n  }\n\n  nextToken() {\n    if (this.char === t.EOF) {\n      return new Token(t.EOF, t.EOF, 0, 'eof', this.index)\n    }\n\n    if (!this.isFormula()) {\n      return this.tokenTEXTorNUMBER()\n    }\n\n    const whitespaceLen = this.getWhitespaceLen()\n    let token\n\n    for (let rule of GRAMMAR) {\n      rule.setIndex(this.index)\n      const match = rule.test(this.input)\n\n      if (match && match.index === this.index) {\n        const text = match[rule.groupIndex]\n        token = new Token(rule.token, text, whitespaceLen, rule.category, this.index)\n        this.index += text.length - 1\n        this.consume()\n        break\n      }\n    }\n\n    if (!token) {\n      token = this.tokenUNKNOWN(whitespaceLen)\n    }\n\n    return token\n  }\n\n  initChar(input) {\n    if (this.input.length === 0) {\n      this.input = '0'\n      this.index = -1\n    }\n\n    return input[this.index]\n  }\n\n  tokenUNKNOWN(whitespace) {\n    const chars = []\n\n    while (!(this.isEOF() || this.isSeparator() || this.isWhitespace())) {\n      chars.push(this.char)\n      this.consume()\n    }\n\n    const text = chars.join('')\n    return new Token(t.UNKNOWN, text, whitespace, 'entity', this.index - text.length)\n  }\n\n  tokenTEXTorNUMBER() {\n    let token\n\n    if (isNumber(this.input)) {\n      token = new Token(t.NUMBER, this.input, 0, 'entity', this.index)\n    } else {\n      token = new Token(t.TEXT, this.input, 0, 'entity', this.index)\n    }\n\n    this.index = this.input.length - 1\n    this.consume()\n    return token\n  }\n\n  consume() {\n    this.index++\n\n    if (this.index < this.input.length) {\n      this.char = this.input[this.index]\n    } else {\n      this.char = t.EOF\n    }\n  }\n\n  isFormula() {\n    return this.input[0] === '='\n  }\n\n  isEOF() {\n    return this.char === t.EOF\n  }\n\n  isWhitespace() {\n    return !this.isEOF() && Boolean(this.char.match(/\\s/))\n  }\n\n  isSeparator() {\n    return Boolean(this.char.match(/[\\(\\)\\+\\-\\/\\*]/)) // eslint-disable-line\n  }\n\n  getWhitespaceLen() {\n    let count = 0\n\n    while (this.isWhitespace()) {\n      count++\n      this.consume()\n    }\n\n    return count\n  }\n}\n\nexport default Lexer\nexport { GRAMMAR, TOKENS, Lexer }\n","class Token {\n  constructor(type, text, whitespace, category, index) {\n    this.type = type\n    this.category = category\n    this.text = text\n    this.whitespace = whitespace\n    this.index = index\n    this.value = null\n    this.html = null\n  }\n}\n\nexport default Token\n","import React from 'react'\n\n\nexport const InputContext = React.createContext()\n","import { createReducer } from 'redux-starter-kit'\n\nexport const INITIAL_STATE = {\n  activeCell: {},\n  cellInputter: {},\n  rows: 14,\n  columns: 6,\n}\n\nexport default createReducer(INITIAL_STATE, {\n  'SET_ACTIVE_CELL': (state, { payload }) => {\n    state.activeCell = payload\n  },\n  'OPEN_CELL_INPUTTER': (state, { payload }) => {\n    state.cellInputter = payload\n  },\n\n  'CLOSE_CELL_INPUTTER': (state) => {\n    state.cellInputter = { ...state.cellInputter, isCellInputterOpen: false }\n  },\n})\n","import { createReducer } from 'redux-starter-kit'\n\n\nconst INITIAL_STATE = {}\n\nexport default createReducer(INITIAL_STATE, {\n  'SET_CELL_DATA': (state, { payload }) => {\n    const { location, data } = payload\n    state[location] = data\n  },\n\n  'DELETE_CELL_DATA': (state, { payload }) => {\n    delete state[payload]\n  }\n})\n","import { createReducer } from 'redux-starter-kit'\n\nconst INITIAL_STATE = {\n  colWidths: {},\n  rowHeights: {},\n}\n\nexport default createReducer(INITIAL_STATE, {\n\n  'SET_COL_WIDTH': (state, { payload }) => {\n    const { colLabel, width } = payload\n    const { colWidths } = state\n    state.colWidths = { ...colWidths, [colLabel]: width }\n  },\n\n  'SET_ROW_HEIGHT': (state, { payload }) => {\n    const { rowLabel, height } = payload\n    const { rowHeights } = state\n    state.rowHeights = { ...rowHeights, [rowLabel]: height }\n  },\n\n})\n","import { configureStore } from 'redux-starter-kit'\n\nimport globalReducer from './globalReducer'\nimport tableDataReducer from './tableDataReducer'\nimport tableMetaReducer from './tableMetaReducer'\n\n\nconst appStoreGen = () => (\n  configureStore({\n    reducer: {\n      global: globalReducer,\n      tableData: tableDataReducer,\n      tableMeta: tableMetaReducer,\n    }\n  })\n)\n\nconst appStore = appStoreGen()\n\n\nexport default appStore\nexport { appStoreGen }\n","import { createAction } from 'redux-starter-kit'\n\n\nexport function setActiveCell(location) {\n  return (dispatch, getState) => {\n    const cellData = getState().tableData[location]\n    const entered = (cellData || {}).entered || ''\n\n    return Promise.resolve(dispatch({\n      type: 'SET_ACTIVE_CELL',\n      payload: {\n        location,\n        entered,\n      }\n    }))\n  }\n}\n\nexport function openCellInputter(cellRect, willReplaceValue) {\n  return (dispatch, getState) => {\n    let newEntered = willReplaceValue\n      ? ''\n      : getState().global.activeCell.entered\n\n    return Promise.resolve(dispatch({\n      type: 'OPEN_CELL_INPUTTER',\n      payload: {\n        isCellInputterOpen: true,\n        newEntered,\n        cellRect,\n      }\n    }))\n  }\n}\n\nexport const closeCellInputter = createAction('CLOSE_CELL_INPUTTER')\n","import appStore from '~/reducers/'\nimport { clearCellData, replaceCellData } from '~/actions/tableDataActions'\n\n\nclass ReduxConnect {\n  constructor(store=appStore) {\n    const { global: globalState } = store.getState()\n    this.store = store\n    this.rows = globalState.rows\n    this.columns = globalState.columns\n  }\n\n  get tableData() {\n    return this.store.getState().tableData\n  }\n\n  get locations() {\n    return Object.keys(this.tableData)\n  }\n\n  getCellResult(location) {\n    const data = this.tableData[location]\n    return data && data.result\n  }\n\n  replaceCellData(location, entered, result) {\n    this.store.dispatch(replaceCellData(location, entered, result))\n  }\n\n  clearCell(location) {\n    this.store.dispatch(clearCellData(location))\n  }\n}\n\nexport default ReduxConnect\nexport { appStore }\n","import { TOKENS as t } from './Lexer'\n\n\nclass AST {\n  constructor(name) {\n    this._name = name\n  }\n\n  eval() {\n    throw new Error('Implement method.')\n  }\n}\n\nclass TextNode extends AST {\n  constructor(textNode) {\n    super('TextNode')\n    this.node = textNode\n  }\n\n  eval() {\n    return this.node.text\n  }\n}\n\nclass StringNode extends AST {\n  constructor(node) {\n    super('StringNode')\n    this.node = node\n  }\n\n  eval() {\n    return this.node.value\n  }\n}\n\nclass NumberNode extends AST {\n  constructor(node) {\n    super('NumberNode')\n    this.node = node\n  }\n\n  eval() {\n    return this.node.value\n  }\n}\n\nclass CellNode extends AST {\n  constructor(token) {\n    super('CellNode')\n    this.cell = token\n  }\n\n  get location() {\n    return this.cell.value\n  }\n}\n\nclass CellRange extends AST {\n  constructor(leftCell, rightCell) {\n    super('CellRange')\n    this.leftCell = leftCell\n    this.rightCell = rightCell\n  }\n}\n\nclass UnaryOp extends AST {\n  constructor(opNode, expr) {\n    super('UnaryOp')\n    this.opNode = opNode\n    this.expr = expr\n  }\n\n  eval(evaluatedExpr) {\n    if (this.opNode.type === t.PLUS) {\n      return evaluatedExpr\n    } else if (this.opNode.type === t.MINUS) {\n      return -evaluatedExpr\n    }\n  }\n}\n\nclass FuncOp extends AST {\n  constructor(funcNode, argNodes) {\n    super('FuncOp')\n    this.funcNode = funcNode\n    this.argNodes = argNodes\n  }\n\n  eval(evaluatedArgs) {\n    const fn = this.funcNode.value\n    return fn(...evaluatedArgs)\n  }\n}\n\nclass BinaryOp extends AST {\n  constructor(leftNode, opNode, rightNode) {\n    super('BinaryOp')\n    this.leftNode = leftNode\n    this.opNode = opNode\n    this.rightNode = rightNode\n  }\n\n  eval(left, right) {\n    switch(this.opNode.type) {\n      case t.PLUS:\n        return left + right\n      case t.MINUS:\n        return left - right\n      case t.DIV:\n        if (right === 0) {\n          throw new Error(`Division by zero: ${left}/${right}`)\n        } else {\n          return left / right\n        }\n      case t.MULT:\n        return left * right\n      default:\n        throw new Error(`Unsupported operator \"${this.token.text}\"`)\n    }\n  }\n}\n\nexport {\n  TextNode,\n  StringNode,\n  NumberNode,\n  CellNode,\n  CellRange,\n  BinaryOp,\n  UnaryOp,\n  FuncOp,\n}\n","import { TOKENS as t } from './Lexer'\nimport {\n  TextNode,\n  StringNode,\n  NumberNode,\n  CellNode,\n  CellRange,\n  BinaryOp,\n  UnaryOp,\n  FuncOp\n} from './ast'\n\n\nclass Parser {\n  constructor(tokens) {\n    this.index = 0\n    this.tokens = tokens\n    this.curr = this.tokens[0]\n    this.ast = null\n  }\n\n  parse() {\n    switch (this.peekType()) {\n      case t.TEXT:\n        this.ast = this.text()\n        break\n      case t.NUMBER:\n        this.ast = this.number()\n        break\n      default:\n        this.equals()\n        this.ast = this.expr()\n        break\n    }\n\n    if (this.curr !== null) {\n      throw new Error(`Unexpected term at index ${this.index}: \"${this.curr.text}\"`)\n    }\n\n    return this.ast\n  }\n\n  expr() {\n    // expr : term ( ( PLUS | MINUS ) term ) *\n    let node, operator, right\n\n    node = this.term()\n\n    while ( [t.PLUS, t.MINUS].includes(this.peekType()) ) {\n      operator = this.operator()\n      right = this.term()\n      node = new BinaryOp(node, operator, right)\n    }\n\n    return node\n  }\n\n  term() {\n    // term : factor ( ( MULT | DIV ) factor ) *\n    let node, operator, right\n\n    node = this.factor()\n\n    while ( [t.MULT, t.DIV].includes(this.peekType()) ) {\n      operator = this.operator()\n      right = this.factor()\n      node = new BinaryOp(node, operator, right)\n    }\n\n    return node\n  }\n\n  factor() {\n    // factor : ( PLUS | MINUS ) ( NUMBER | CELL )\n    //          | LPAREN expr RPAREN\n    //          | FUNCTION LPAREN list RPAREN\n    switch (this.peekType()) {\n      case t.LPAREN:\n        return this.enclosedExpr()\n      case t.PLUS:\n      case t.MINUS:\n        return this.unaryOp()\n      case t.NUMBER:\n        return this.number()\n      case t.CELL:\n        return this.cell()\n      case t.FUNCTION:\n        return this.func()\n      case t.RPAREN:\n        throw new Error(`Unexpected term at index ${this.index}: \"${this.curr.text}\"`)\n      default:\n        throw new Error('Missing factor')\n    }\n  }\n\n  enclosedExpr() {\n    this.lparen()\n    const node = this.expr()\n    this.rparen()\n    return node\n  }\n\n  cell() {\n    if (this.peekType() !== t.CELL) {\n      throw new Error('Missing cell node')\n    }\n\n    const node = new CellNode(this.curr)\n    this.consume()\n    return node\n  }\n\n  cellRange() {\n    let left, right\n\n    if (!this.isCellRange()) {\n      throw new Error('Missing cell range')\n    }\n\n    left = new CellNode(this.curr)\n    this.consume() // skip colon\n    this.consume()\n    right = new CellNode(this.curr)\n    this.consume()\n\n    if (right.location < left.location) {\n      [left, right] = this.invertCellRange(left, right)\n    }\n\n    return new CellRange(left, right)\n  }\n\n  invertCellRange(left, right) {\n    this.tokens[this.index - 2] = right.cell\n    this.tokens[this.index] = left.cell\n    let temp = left\n    left = right\n    right = temp\n    return [left, right]\n  }\n\n  func() {\n    if (this.peekType() !== t.FUNCTION) {\n      throw new Error('Missing function')\n    }\n\n    const func = this.curr\n    this.consume()\n    this.lparen()\n    const args = this.list()\n    this.rparen()\n    return new FuncOp(func, args)\n  }\n\n  list() {\n    const list = []\n    let node\n\n    node = this.listNode()\n    list.push(node)\n\n    while (this.peekType() === t.COMMA) {\n      this.consume() // skip comma token\n      node = this.listNode()\n      list.push(node)\n    }\n\n    return list\n  }\n\n  listNode() {\n    if (this.isCellRange()) {\n      return this.cellRange()\n    } else if (this.peekType() === t.STRING) {\n      return this.string()\n    } else {\n      return this.expr()\n    }\n  }\n\n  text() {\n    let node\n\n    if (this.peekType() !== t.TEXT) {\n      throw new Error('Missing string')\n    }\n\n    node = new TextNode(this.curr)\n    this.consume()\n    return node\n  }\n\n  string() {\n    const node = new StringNode(this.curr)\n    this.consume()\n    return node\n  }\n\n  number() {\n    if (this.peekType() === t.NUMBER) {\n      const node = new NumberNode(this.curr)\n      this.consume()\n      return node\n    } else {\n      throw new Error('Missing number')\n    }\n  }\n\n  operator() {\n    if ([t.PLUS, t.MINUS, t.MULT, t.DIV].includes(this.peekType())) {\n      const node = this.curr\n      this.consume()\n      return node\n    } else {\n      throw new Error('Missing operator')\n    }\n  }\n\n  equals() {\n    if (this.peekType() !== t.EQUALS) {\n      throw new Error('Missing equals sign')\n    }\n\n    this.consume()\n  }\n\n  lparen() {\n    if (this.peekType() !== t.LPAREN) {\n      throw new Error('Missing left parenthesis')\n    }\n\n    this.consume()\n  }\n\n  rparen() {\n    if (this.peekType() !== t.RPAREN) {\n      throw new Error('Missing right parenthesis')\n    }\n\n    this.consume()\n  }\n\n  unaryOp() {\n    if (![t.PLUS, t.MINUS].includes(this.peekType())) {\n      throw new Error('Missing unary operator')\n    }\n\n    const curr = this.curr\n    this.consume()\n    const node = new UnaryOp(curr, this.factor())\n    return node\n  }\n\n  consume() {\n    if (this.index < this.tokens.length - 1) {\n      this.index++\n      this.curr = this.tokens[this.index]\n    } else {\n      this.curr = null\n    }\n  }\n\n  isCellRange() {\n    return (\n      this.peekType(0) === t.CELL\n      && this.peekType(1) === t.COLON\n      && this.peekType(2) === t.CELL\n    )\n  }\n\n  isString() {\n    return (\n      this.peekType(0) === t.DQUOTE\n      && this.peekType(1) === t.TEXT\n      && this.peekType(2) === t.DQUOTE\n    )\n  }\n\n  peekType(stepsAhead) {\n    if (stepsAhead) {\n      if (stepsAhead < 0) {\n        throw new Error('peak ahead index must be positive')\n      }\n\n      const index = this.index + stepsAhead\n\n      if (index < this.tokens.length) {\n        return this.tokens[index].type\n      }\n    } else {\n      return this.curr && this.curr.type\n    }\n  }\n}\n\nexport default Parser\n","import { Lexer } from './Lexer'\nimport { parseLocation, getColumnLabel } from '~/library/utils'\nimport graph from '~/formulas/graph'\nimport Parser from './Parser'\nimport ReduxConnect from './ReduxConnect'\n\n\nconst ERR_DIVISION_BY_ZERO = '#DIV/0!'\nconst ERR_CIRCULAR_REFERENCE = '#REF!'\nconst ERR_GENERIC = '#ERROR!'\n\nclass Interpreter {\n  constructor(location) {\n    this.location = location\n    this.error = null\n    this.cache = {}\n    this.result = null\n    this.state = new ReduxConnect()\n  }\n\n  interpret(input) {\n    const vertex = graph.addVertex(this.location, input)\n    let lexer, parser\n\n    try {\n      lexer = new Lexer(input)\n      parser = new Parser( lexer.getTokens() )\n      vertex.ast = parser.parse()\n      graph.recalculate(this.location)\n      this.result = vertex.result\n    } catch (error) {\n      this.error = vertex.error = error\n      this.result = vertex.result = this.errorResponse()\n      return this.result\n    }\n\n    this.error = vertex.error\n    return this.result\n  }\n\n  visitAST(location) {\n    const vertex = graph.getVertex(location)\n\n    if (!vertex.ast) {\n      return vertex.result\n    }\n\n    try {\n      this.result = vertex.result = this.visitNode(vertex.ast)\n    } catch (error) {\n      this.error = vertex.error = error\n      this.result = vertex.result = this.errorResponse()\n      throw error\n    }\n\n    return this.result\n  }\n\n  visitNode(node) {\n    switch (node._name) {\n      case 'NumberNode':\n        return this.NumberNode(node)\n      case 'CellNode':\n        return this.CellNode(node)\n      case 'TextNode':\n        return this.TextNode(node)\n      case 'StringNode':\n        return this.StringNode(node)\n      case 'CellRange':\n        return this.CellRange(node)\n      case 'FuncOp':\n        return this.FuncOp(node)\n      case 'BinaryOp':\n        return this.BinaryOp(node)\n      case 'UnaryOp':\n        return this.UnaryOp(node)\n      default:\n        const nodeName = node._name || (node.constructor || {}).name\n        throw new Error(`Unrecognized AST node ${nodeName}`)\n    }\n  }\n  \n  /* ***************************************\n   * Nodes that don't require processing\n   ****************************************/\n\n  TextNode(node) {\n    return node.eval()\n  }\n\n  StringNode(node) {\n    return node.eval()\n  }\n\n  NumberNode(node) {\n    return node.eval()\n  }\n\n  /* ***************************************\n   * Nodes requiring processing\n   ****************************************/\n\n  UnaryOp(node) {\n    const result = this.visitNode(node.expr)\n    return node.eval(result)\n  }\n\n  CellNode(node) {\n    const result = this.getCellResult(node.location)\n    return result === undefined\n      ? 0\n      : result\n  }\n\n  BinaryOp(node) {\n    const left = this.visitNode(node.leftNode)\n    const right = this.visitNode(node.rightNode)\n    return node.eval(left, right)\n  }\n\n  CellRange(node) {\n    const [leftColIndex, leftRowIndex] = parseLocation(node.leftCell.location)\n    const [rightColIndex, rightRowIndex] = parseLocation(node.rightCell.location)\n    const colIndexStart = Math.min(leftColIndex, rightColIndex)\n    const colIndexEnd = Math.max(leftColIndex, rightColIndex)\n    const rowIndexStart = Math.min(leftRowIndex, rightRowIndex)\n    const rowIndexEnd = Math.max(leftRowIndex, rightRowIndex)\n    const list = []\n\n    for (let rowI = rowIndexStart; rowI <= rowIndexEnd; rowI++) {\n      for (let colI = colIndexStart; colI <= colIndexEnd; colI++) {\n        const location = `${getColumnLabel(colI)}-${rowI + 1}`\n        const result = this.getCellResult(location)\n\n        if (result !== undefined) {\n          list.push(result)\n        }\n      }\n    }\n\n    return list\n  }\n\n  getCellResult(otherLocation) {\n    let result\n\n    if (!this.isLocationValid(otherLocation)) {\n      throw new Error('Location out of bounds')\n    }\n\n    if (this.cache[otherLocation] !== undefined) {\n      return this.cache[otherLocation]\n    }\n\n    result = graph.visitCell(otherLocation)\n    this.cache[otherLocation] = result\n    return result\n  }\n\n  FuncOp(node) {\n    const evaluatedArgs = []\n\n    for (let childNode of node.argNodes) {\n      const result = this.visitNode(childNode)\n\n      if (childNode._name === 'CellRange') {\n        evaluatedArgs.push(...result)\n      } else {\n        evaluatedArgs.push(result)\n      }\n    }\n\n    return node.eval(evaluatedArgs)\n  }\n\n  isLocationValid(location) {\n    const [colIndex, rowIndex] = parseLocation(location)\n\n    if (Math.min(colIndex, rowIndex) < 0) { return false }\n    if (colIndex >= this.state.columns) { return false }\n    if (rowIndex >= this.state.rows) { return false }\n    return true\n  }\n\n  errorResponse() {\n    const { message: errorMsg } = this.error\n\n    if (errorMsg.match(/division by zero/i)) {\n      return ERR_DIVISION_BY_ZERO\n    } else if (errorMsg.match(/circular reference/i)) {\n      return ERR_CIRCULAR_REFERENCE\n    } else {\n      return ERR_GENERIC\n    }\n  }\n}\n\nexport default Interpreter\nexport {\n  ERR_DIVISION_BY_ZERO,\n  ERR_CIRCULAR_REFERENCE,\n  ERR_GENERIC,\n}\n","import ReduxConnect from './ReduxConnect'\nimport Interpreter from './Interpreter'\n\n\nclass Vertex {\n  constructor(entered) {\n    this.entered = entered\n    this.error = null\n    this.result = null\n    this.ast = null\n  }\n}\n\nclass Graph {\n  constructor() {\n    this.adj = {}\n    this.pending = null\n    this.visited = null\n    this.store = new ReduxConnect()\n  }\n\n  recalculate(location) {\n    this.setPendingNodes()\n    this.dfs(location)\n    this.updateStore()\n  }\n\n  setPendingNodes() {\n    this.pending = new Set()\n\n    Object.keys(this.adj).forEach(vertex => {\n      this.pending.add(vertex)\n    })\n  }\n\n  dfs(location) {\n    while (this.pending.size > 0) {\n      if (!location) {\n        location = [...this.pending][0]\n      }\n\n      try {\n        this.visited = new Set([location])\n        const interpreter = new Interpreter(location)\n        interpreter.visitAST(location)\n      } catch (error) {}\n\n      this.visited.forEach(location => this.pending.delete(location))\n      location = null\n    }\n\n    this.visited = null\n    this.pending = null\n  }\n\n  visitCell(location) {\n    if (!this.hasVertex(location)) {\n      return\n    }\n\n    this.testPathCycle(location)\n    this.pending.delete(location)\n    this.visited.add(location)\n    const interpreter = new Interpreter(location)\n    const result = interpreter.visitAST(location)\n    this.visited.delete(location)\n    return result\n  }\n\n  getCellResult(location) {\n    if (location in this.adj) {\n      return graph.adj[location].result\n    } else {\n      return ''\n    }\n  }\n\n  testPathCycle(location) {\n    if (this.visited.has(location)) {\n      throw new Error('Circular reference')\n    }\n  }\n\n  updateStore() {\n    const locationKeys = new Set(this.store.locations)\n\n    for (let [location, vertex] of Object.entries(this.adj)) {\n      const { entered, result } = vertex\n\n      locationKeys.delete(location)\n\n      if (result !== this.store.getCellResult(location)) {\n        this.store.replaceCellData(location, entered, result)\n      }\n    }\n\n    for (let location of locationKeys) {\n      this.store.clearCell(location)\n    }\n  }\n\n  addVertex(location, entered) {\n    const vertex = new Vertex(entered)\n    this.adj[location] = vertex\n    return vertex\n  }\n\n  hasVertex(location) {\n    return location in this.adj\n  }\n\n  getVertex(location) {\n    this.testMissingLocation(location)\n    return this.adj[location]\n  }\n\n  delVertex(location) {\n    if (location in this.adj) {\n      delete this.adj[location]\n      this.recalculate()\n    }\n  }\n\n  resetAll() {\n    this.adj = {}\n    this.pending = null\n    this.visited = null\n    this.store = new ReduxConnect()\n  }\n\n  testMissingLocation(location) {\n    if (!this.hasVertex(location)) {\n      throw new Error('Missing location')\n    }\n  }\n}\n\nconst graph = new Graph()\n\n\nexport default graph\nexport {\n  Vertex,\n  Graph,\n}\n","import graph from '~/formulas/graph'\nimport Interpreter from '../formulas/Interpreter'\n\n\nexport function setCellData(location, entered) {\n  const interpreter = new Interpreter(location)\n  const result = interpreter.interpret(entered)\n\n\n  return {\n    type: 'SET_CELL_DATA',\n    payload: { location, data: { entered, result } },\n  }\n}\n\nexport function replaceCellData(location, entered, result) {\n  return {\n    type: 'SET_CELL_DATA',\n    payload: { location, data: { entered, result } },\n  }\n}\n\nexport function clearCellData(location) {\n  return (dispatch, getState) => {\n    const value = getState().tableData[location]\n\n    graph.delVertex(location)\n\n    if (value === undefined) {\n      return Promise.resolve()\n    }\n\n\n    return Promise.resolve(dispatch({\n      type: 'DELETE_CELL_DATA',\n      payload: location,\n    }))\n  }\n}\n","import styled from '@emotion/styled'\n\n\nexport const Input = styled.input`\n  align-items: center;\n  background-color: white;\n  border: 2px solid salmon;\n  box-shadow: 0 0 5px ${props => props.theme.colors.shadow};\n  box-sizing: border-box;\n  display: flex;\n  font-size: 13px;\n  height: 100%;\n  outline: none;\n  padding: 2px;\n  width: 100%;\n`\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { css, jsx } from '@emotion/core' // eslint-disable-line\nimport { connect } from 'react-redux'\n\nimport { setCellData, clearCellData } from '~/actions/tableDataActions'\nimport { parseLocation, getColumnLabel } from '~/library/utils'\nimport Lexer from '~/formulas/Lexer'\nimport Suggestions from './Suggestions'\nimport { InputContext } from './InputContext'\nimport { closeCellInputter } from '~/actions/globalActions'\nimport HiddenInput from './HiddenInput'\nimport { Input } from './Inputter'\n\n\nconst Root = styled.div`\n  position: fixed;\n`\n\nexport class CellInputter extends React.PureComponent {\n\n  static propTypes = {\n    // redux\n    cellRect: PropTypes.object.isRequired,\n    clearCellData: PropTypes.func.isRequired,\n    closeCellInputter: PropTypes.func.isRequired,\n    columns: PropTypes.number.isRequired,\n    entered: PropTypes.string.isRequired,\n    newEntered: PropTypes.string.isRequired,\n    location: PropTypes.string.isRequired,\n    rows: PropTypes.number.isRequired,\n    setCellData: PropTypes.func.isRequired,\n    isCellInputterOpen: PropTypes.bool,\n  }\n\n  constructor() {\n    super()\n    this.handleOnKeyDown = this.handleOnKeyDown.bind(this)\n    this.handleOnBlur = this.handleOnBlur.bind(this)\n    this.handleOnChange = this.handleOnChange.bind(this)\n    this.setIsFuncSelectorVisible = this.setIsFuncSelectorVisible.bind(this)\n    this.setInputValue = this.setInputValue.bind(this)\n    this.setInputWidth = this.setInputWidth.bind(this)\n  }\n\n  state = {\n    tokens: [],\n    isFuncSelectorVisible: false,\n    inputValue: '',\n    keyEvent: { key: '' },\n    cursorPos: 0,\n    width: null,\n  }\n\n  refInput = React.createRef()\n\n  componentDidMount() {\n    this.focusInputTag()\n    this.setInputValue(this.props.newEntered)\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.keyEvent !== this.state.keyEvent) {\n      this.setFocus(this.state.keyEvent.key)\n      this.keyActions()\n    }\n\n    if (prevState.inputValue !== this.state.inputValue) {\n      this.tokenizeInputValue()\n    }\n  }\n\n  keyActions() {\n    const { key } = this.state.keyEvent\n\n    if (this.state.isFuncSelectorVisible) {\n      switch (key) { // eslint-disable-line\n        case 'Escape':\n          this.props.closeCellInputter()\n          break\n        case 'ArrowLeft':\n        case 'ArrowRight':\n          this.setState({ cursorPos: this.refInput.current.selectionEnd })\n      }\n    } else {\n      switch (key) { // eslint-disable-line\n        case 'Escape':\n          this.props.closeCellInputter()\n          break\n        case 'Enter':\n          this.setCellValue()\n          this.props.closeCellInputter()\n          break\n        case 'ArrowLeft':\n        case 'ArrowRight':\n          this.setState({ cursorPos: this.refInput.current.selectionEnd })\n      }\n    }\n  }\n\n  setInputWidth(width) {\n    this.setState({ width })\n  }\n\n  tokenizeInputValue() {\n    const { inputValue } = this.state\n    const lexer = new Lexer(inputValue)\n    const tokens = lexer.getTokens()\n    this.setState({ tokens })\n  }\n\n  focusInputTag() {\n    const inputEl = this.refInput.current\n\n    setImmediate(() => {\n      inputEl.focus()\n      inputEl.selectionStart = inputEl.value.length\n    })\n  }\n\n  setFocus() {\n    const { keyEvent: { key } } = this.state\n    const { location } = this.props\n    const [colIndex, rowIndex] = parseLocation(location)\n    let el, elId\n\n    if (this.state.isFuncSelectorVisible) {\n      if (key === 'Escape') {\n        elId = `[data-cell=\"result\"][data-location=\"${location}\"]`\n      } else {\n        return\n      }\n    } else {\n      if (key === 'Tab') {\n        elId = `[data-cell=\"result\"][data-location=\"${location}\"]`\n      } else if (key === 'Enter') {\n        const nextRowIndex = Math.min(this.props.rows - 1, rowIndex + 1)\n        const colLabel = getColumnLabel(colIndex)\n        const rowLabel = '' + (nextRowIndex + 1)\n        const endLocation = `${colLabel}-${rowLabel}`\n        elId = `[data-cell=\"result\"][data-location=\"${endLocation}\"]`\n      } else if (key === 'Escape') {\n        elId = `[data-cell=\"result\"][data-location=\"${location}\"]`\n      } else {\n        elId = `[data-cell=\"input\"][data-location=\"${location}\"]`\n      }\n    }\n\n    el = document.querySelector(elId)\n    if (document.activeElement !== el) { el.focus() }\n  }\n\n  setCellValue() {\n    const { location } = this.props\n    const { inputValue } = this.state\n\n    if (this.isWhitespace(inputValue)) {\n      this.props.clearCellData(location)\n      return\n    }\n\n    const cellValue = inputValue.length > 0 && inputValue[0] === '='\n      // ? inputValue.toUpperCase()\n      ? inputValue\n      // NOTE: fix!!\n      : inputValue\n\n    this.props.setCellData(location, cellValue)\n  }\n\n  isWhitespace(text) {\n    return text.length === 0 || Boolean(text.match(/^\\s+$/))\n  }\n\n  setIsFuncSelectorVisible(isFuncSelectorVisible) {\n    this.setState({ isFuncSelectorVisible })\n  }\n\n  setInputValue(inputValue, cursorPos) {\n    const inputEl = this.refInput.current\n\n    this.setState({ inputValue, cursorPos: inputValue.length }, () => {\n      inputEl.focus()\n      inputEl.selectionStart = cursorPos\n      inputEl.selectionEnd = cursorPos\n    })\n  }\n\n  handleOnChange(event) {\n    const { target: { value } } = event\n    const cursorPos = event.target.selectionStart\n    this.setState({ inputValue: value, cursorPos })\n  }\n\n  handleOnKeyDown(event) {\n    const { key, target: { value } } = event\n\n    if (this.state.isFuncSelectorVisible && key === 'Tab') {\n      event.preventDefault()\n    }\n\n    this.setState({ keyEvent: { key }, inputValue: value })\n  }\n\n  handleOnBlur(event) {\n    if (this.state.isFuncSelectorVisible) { return }\n\n    this.setState({ inputValue: event.target.value }, () => {\n      this.setCellValue()\n      this.props.closeCellInputter()\n    })\n  }\n\n  getRootStyle() {\n    const { top, left, width: cellWidth, height } = this.props.cellRect\n    const width = this.state.width || cellWidth\n\n    return {\n      top,\n      left,\n      height,\n      width,\n    }\n  }\n\n  render() {\n    const inputEl = this.refInput.current\n    const inputRect = inputEl && inputEl.getBoundingClientRect()\n    const width = (inputRect || {}).width || this.props.cellRect.width\n\n    return (\n      <InputContext.Provider\n        value={{\n          inputRect,\n          setIsFuncSelectorVisible: this.setIsFuncSelectorVisible,\n          setInputValue: this.setInputValue,\n          keyEvent: this.state.keyEvent,\n          inputValue: this.state.inputValue,\n        }}\n      >\n        <Root\n          css={this.getRootStyle()}\n        >\n          <HiddenInput\n            value={this.state.inputValue}\n            cellWidth={width}\n            setInputWidth={this.setInputWidth}\n          />\n          <Input\n            ref={this.refInput}\n            data-cell='input'\n            data-location={this.props.location}\n            value={this.state.inputValue}\n            onChange={this.handleOnChange}\n            onKeyDown={this.handleOnKeyDown}\n            onBlur={this.handleOnBlur}\n          />\n          <Suggestions\n            tokens={this.state.tokens}\n            cursorPos={this.state.cursorPos}\n          />\n        </Root>\n      </InputContext.Provider>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  const {\n    global: {\n      cellInputter: {\n        isCellInputterOpen,\n        newEntered,\n        cellRect,\n      },\n      activeCell: {\n        location,\n        entered,\n      },\n      rows,\n      columns,\n    }\n  } = state\n\n  return { location, entered, newEntered, isCellInputterOpen, cellRect, rows, columns }\n}\n\nconst mapDispatchToProps = { setCellData, clearCellData, closeCellInputter }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CellInputter)\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { css, jsx } from '@emotion/core' // eslint-disable-line\n\nimport { Input as BaseInput } from './Inputter'\n\n\nconst INPUT_PADDING_RIGHT = 15\n\nconst Input = styled(BaseInput)`\n  position: absolute;\n  margin-top: -200vh;\n  visibility: hidden;\n`\n\nclass HiddenInput extends React.PureComponent {\n\n  static propTypes = {\n    value: PropTypes.string.isRequired,\n    cellWidth: PropTypes.number.isRequired,\n    setInputWidth: PropTypes.func.isRequired,\n  }\n\n  refInput = React.createRef()\n\n  componentDidMount() {\n    this.setInputWidth()\n  }\n\n  componentDidUpdate(prevProps, prevState) { // eslint-disable-line\n    this.setInputWidth()\n  }\n\n  setInputWidth() {\n    const { cellWidth } = this.props\n    const inputEl = this.refInput.current\n    const textWidth = inputEl.scrollWidth\n    const clientRect = inputEl.getBoundingClientRect()\n    const width = textWidth > clientRect.width\n      ? Math.max(cellWidth, textWidth + INPUT_PADDING_RIGHT)\n      : cellWidth\n\n      this.props.setInputWidth(width)\n  }\n\n  render() {\n    return (\n      <Input\n        ref={this.refInput}\n        defaultValue={this.props.value}\n        css={{\n          width: this.props.cellWidth - INPUT_PADDING_RIGHT,\n        }}\n      />\n    )\n  }\n}\n\nexport default HiddenInput\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\n\nimport formulaFuncs from '~/formulas/formulaFunctions'\nimport { InputContext } from './InputContext'\n\n\nconst Root = styled.div`\n  background: ${props => props.theme.colors.dropdown.normal};\n  margin-top: 1px;\n  box-shadow: 0 0 5px ${props => props.theme.colors.shadow};\n  border: 1px solid ${props => props.theme.colors.dropdown.active};\n  width: 300px;\n  padding: 6px 8px;\n`\n\nconst Pre = styled.pre`\n  line-height: 1em;\n  padding-bottom: 3px;\n  font-size: 14px;\n`\n\nconst Subtitle = styled.div`\n  padding-top: 12px;\n  font-size: 12px;\n`\n\nconst P = styled.p`\n  line-height: 1em;\n  font-size: 13px;\n`\n\nconst Hr = styled.hr`\n  border: 0;\n  border-top: 1px solid ${props => props.theme.colors.dropdown.active};\n`\n\nclass FuncDescription extends React.PureComponent {\n\n  static contextType = InputContext\n\n  static propTypes = {\n    cursorPos: PropTypes.number,\n    fnScopes: PropTypes.array,\n  }\n\n  getFnScope() {\n    const { fnScopes, cursorPos } = this.props\n    let currScope\n\n    for (let scope of fnScopes) {\n      if (cursorPos >= scope.startIndex + 1) {\n        currScope = scope\n      } else {\n        break\n      }\n    }\n\n    if (currScope && currScope.endIndex === null) { return currScope}\n    if (currScope && cursorPos - 1 < currScope.endIndex) { return currScope }\n    return null\n  }\n\n  getFnNode(scope) {\n    const key = scope.fnName.toUpperCase()\n    return formulaFuncs[key]\n  }\n\n  render() {\n    const scope = this.getFnScope()\n    const { inputRect } = this.context\n    if (!inputRect) { return null }\n    const { bottom: top, left } = inputRect\n    let fnNode\n\n    if (!scope) { return null }\n    fnNode = this.getFnNode(scope)\n\n    return (\n      <Root\n        css={{ top, left }}\n      >\n        <Pre\n          css={css`\n            padding-bottom: 6px;\n          `}\n        >\n          {fnNode.definition}\n        </Pre>\n        <Hr />\n        <Subtitle>Example</Subtitle>\n        <Pre>{fnNode.example}</Pre>\n        <Subtitle>Summary</Subtitle>\n        <P>{fnNode.summary}</P>\n      </Root>\n    )\n  }\n}\n\nFuncDescription.propTypes = {\n  cursorPos: PropTypes.number,\n  fnScopes: PropTypes.array,\n}\n\nexport default FuncDescription\n\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport styled from '@emotion/styled'\n\n\nconst NoOp = () => {}\n\nconst Li = styled.li`\n  outline: none;\n`\n\nfunction DropdownItem({ item, index, isActive, onMouseEnter }) {\n  return (\n    <Li\n      tabIndex={0}\n      onMouseEnter={() => onMouseEnter(index)}\n    >\n      {isActive && item.active ? item.active : item.base}\n    </Li>\n  )\n}\n\nDropdownItem.propTypes = {\n  item: PropTypes.shape({\n    base: PropTypes.node.isRequired,\n    active: PropTypes.node,\n  }),\n  index: PropTypes.number.isRequired,\n  isActive: PropTypes.bool.isRequired,\n  onMouseEnter: PropTypes.func,\n}\n\nDropdownItem.defaultProps = {\n  onMouseEnter: NoOp,\n}\n\nexport default DropdownItem\n","\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\n\nimport InteractiveListItem from './InteractiveListItem'\n\n\nconst Ul = styled.ul`\n  position: fixed;\n  margin: 0;\n  padding: 0;\n  list-style: none;\n`\n\nclass InteractiveList extends React.PureComponent {\n\n  static propsTypes = {\n    onMouseEnter: PropTypes.func,\n    items: PropTypes.array.isRequired,\n    top: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n    styles: PropTypes.shape({\n      ul: PropTypes.object,\n      li: PropTypes.object,\n    }),\n  }\n\n  renderListItems() {\n    return this.props.items\n      .map((item, index) => (\n        <InteractiveListItem\n          key={index}\n          index={index}\n          item={item.item}\n          style={{...this.props.styles.li}}\n          isActive={item.isActive}\n          onMouseEnter={this.props.onMouseEnter}\n        />\n      ))\n  }\n\n  render() {\n    const { items, top, left, styles } = this.props\n\n    if (items.length === 0) { return null }\n\n    return (\n      <Ul\n        tabIndex={-1}\n        style={{ top, left, ...styles.ul }}\n      >\n        {this.renderListItems()}\n      </Ul>\n    )\n  }\n}\n\nexport default InteractiveList\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\n\nimport formulaFuncs from '~/formulas/formulaFunctions'\nimport InteractiveList from '~/library/InteractiveList'\nimport Token from '~/formulas/Token'\nimport { InputContext } from './InputContext'\nimport { withTheme } from 'emotion-theming'\n\n\nconst Dialog = styled.dialog`\n  border: 0;\n`\n\nconst baseItemStyle = css`\n  padding: 6px 8px;\n`\n\nconst ItemBaseRoot = styled.div`\n  ${baseItemStyle}\n  background: ${props => props.theme.colors.dropdown.normal};\n`\n\nconst ItemActiveRoot = styled.div`\n  ${baseItemStyle}\n  background: ${props => props.theme.colors.dropdown.active};\n`\n\nconst Pre = styled.pre`\n  line-height: 1em;\n  padding-bottom: 3px;\n  font-size: 14px;\n`\n\nconst Subtitle = styled.div`\n  font-size: 12px;\n`\n\nclass FuncSelector extends React.Component {\n\n  static contextType = InputContext\n\n  static propTypes = {\n    token: PropTypes.instanceOf(Token),\n    colors: PropTypes.object,\n    theme: PropTypes.object,\n  }\n\n  state = {\n    listItems: [],\n    itemIndex: 0,\n    keyEvent: null,\n    isVisible: false,\n  }\n\n  constructor() {\n    super()\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.setIndex = this.setIndex.bind(this)\n  }\n\n  componentDidMount() {\n    this.setState({ itemIndex: 0 }, () => {\n      this.setListItems()\n    })\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return this.state.listItems !== nextState.listItems\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    this.updateContextData(prevState)\n    this.updateListItems(prevProps)\n    this.keyActions()\n  }\n\n  componentWillUnmount() {\n    this.context.setIsFuncSelectorVisible(false)\n  }\n\n  updateListItems(prevProps) {\n    if (prevProps.token === this.props.token) { return }\n\n    this.setState({ itemIndex: 0 }, () => {\n      this.setListItems()\n    })\n  }\n\n  updateContextData(prevState) {\n    const { keyEvent } = this.context\n\n    if (prevState.keyEvent !== keyEvent) {\n      this.setState({ keyEvent })\n      this.keyEventSetIndex(keyEvent)\n    }\n  }\n\n  keyActions() {\n    const { keyEvent } = this.context\n    if (this.state.keyEvent === keyEvent) { return }\n    if (['Enter', 'Tab'].includes(keyEvent.key) && this.state.isVisible) {\n      this.updateInputValue()\n    }\n  }\n\n  updateInputValue() {\n    const currInputValue = this.context.inputValue\n    const { token } = this.props\n    const { fnName } = this.state.listItems[this.state.itemIndex]\n    const rightChunkIndex = token.index + token.text.length\n    const leftChunk = currInputValue.slice(0, token.index)\n    const rightChunk = currInputValue.slice(rightChunkIndex)\n    const newInputValue = `${leftChunk}${fnName}(${rightChunk}`\n    const cursorPos = leftChunk.length + fnName.length + 1\n    this.context.setInputValue(newInputValue, cursorPos)\n  }\n\n  setListItems() {\n    const { token } = this.props\n    const text = token.text.toUpperCase()\n    const listItems = Object\n      .keys(formulaFuncs)\n      .filter(fnName => fnName.startsWith(text))\n      .sort()\n      .map(fnName => ({\n        item: {\n          base: this.itemBase(fnName),\n          active: this.itemActive(fnName),\n        },\n        isActive: false,\n        fnName,\n      }))\n    let isVisible = false\n    let itemIndex\n\n    itemIndex = Math.max(Math.min(listItems.length - 1, this.state.itemIndex), 0)\n\n    if (listItems.length > 0) {\n      listItems[itemIndex].isActive = isVisible = true\n    }\n\n    this.context.setIsFuncSelectorVisible(isVisible)\n    this.setState({ listItems, itemIndex, isVisible })\n  }\n\n  keyEventSetIndex(keyEvent) {\n    let itemIndex = this.state.itemIndex\n\n    switch (keyEvent.key) { // eslint-disable-line default-case\n      case 'ArrowUp':\n          itemIndex = this.state.itemIndex - 1\n        break\n      case 'ArrowDown':\n          itemIndex = this.state.itemIndex + 1\n        break\n    }\n\n    this.setState({ itemIndex }, () => {\n      this.setListItems()\n    })\n  }\n\n  setIndex(itemIndex) {\n    this.setState({ itemIndex }, () => {\n      this.setListItems()\n    })\n  }\n\n  itemBase(fnName) {\n    return (\n      <ItemBaseRoot>\n        <Pre>\n          {fnName}\n        </Pre>\n      </ItemBaseRoot>\n    )\n  }\n\n  itemActive(fnName) {\n    return (\n      <ItemActiveRoot>\n        <Pre>\n          {fnName}\n        </Pre>\n        <Subtitle>\n          {formulaFuncs[fnName].summary}\n        </Subtitle>\n      </ItemActiveRoot>\n    )\n  }\n\n  getListStyles() {\n    const { theme } = this.props\n\n    return {\n      ul: {\n        marginTop: 1,\n        boxShadow: `0 0 5px ${theme.colors.shadow}`,\n        border: `1px solid ${theme.colors.dropdown.active}`,\n        width: 300,\n      }\n    }\n  }\n\n  handleOnClick() {\n    this.updateInputValue()\n  }\n\n  render() {\n    const { listItems, isVisible } = this.state\n    const { inputRect } = this.context\n\n    return (\n      <Dialog\n        open={isVisible}\n        onClick={this.handleOnClick}\n      >\n        <InteractiveList\n          items={listItems}\n          top={Math.round(inputRect.bottom)}\n          left={Math.round(inputRect.left)}\n          styles={this.getListStyles()}\n          onMouseEnter={this.setIndex}\n        />\n      </Dialog>\n    )\n  }\n}\n\nexport default withTheme(FuncSelector)\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport { TOKENS as t } from '~/formulas/Lexer'\nimport FuncDescription from './FuncDescription'\nimport FuncSelector from './FuncSelector'\n\n\nclass Suggestions extends React.PureComponent {\n\n  static propTypes = {\n    tokens: PropTypes.array.isRequired,\n    cursorPos: PropTypes.number,\n  }\n\n  static defaultProps = {\n    cursorPos: 0,\n  }\n\n  state = {\n    fnScopes: [],\n  }\n\n  componentDidMount() {\n    this.setFnScopes()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.tokens !== this.props.tokens) {\n      this.setFnScopes()\n    }\n  }\n\n  setFnScopes() {\n    const stack = []\n    const fnScopes = []\n\n    for (let token of this.props.tokens) {\n      if (token.type === t.FUNCTION) {\n        const scope = { fnName: token.text, startIndex: token.index, endIndex: null }\n        stack.push(scope)\n        fnScopes.push(scope)\n      } else if (token.type === t.LPAREN) {\n        stack.push('(')\n      } else if (token.type === t.RPAREN) {\n        stack.pop()\n        if (stack.length > 0 && stack[stack.length - 1] !== '(') {\n          const scope = stack.pop()\n          scope.endIndex = token.index - 1\n        }\n      }\n    }\n\n    fnScopes.sort((a, b) => a.startIndex - b.startIndex)\n    this.setState({ fnScopes })\n  }\n\n  getCurrTokenIndex(tokens, cursorPos) {\n    let index\n\n    for (index = 0; index < tokens.length; index++) {\n      const token = tokens[index]\n      const endIndex = token.index + token.text.length\n\n      if (cursorPos > token.index && cursorPos <= endIndex) {\n        break\n      }\n    }\n\n    return index\n  }\n\n  getCompareTokens() {\n    const { tokens, cursorPos } = this.props\n    const index = this.getCurrTokenIndex(tokens, cursorPos)\n    const tokenBefore = index > 0 && tokens[index - 1]\n    const tokenCurr = tokens[index]\n    const tokenAfter = index < tokens.length - 2 && tokens[index + 1]\n    return [ tokenBefore, tokenCurr, tokenAfter ]\n  }\n\n  getFuncSelector() {\n    const [ tokenBefore, tokenCurr, tokenAfter ] = this.getCompareTokens()\n\n    if (this.props.tokens.length < 2) { return null }\n\n    const option1 = (\n      tokenBefore\n      && tokenCurr\n      && tokenAfter\n      && tokenBefore.category === 'operator'\n      && [t.UNKNOWN, t.FUNCTION].includes(tokenCurr.type)\n      && tokenAfter.type !== t.RPAREN\n    )\n\n    const option2 = (\n      tokenBefore\n      && tokenCurr\n      && !tokenAfter\n      && [t.UNKNOWN, t.FUNCTION].includes(tokenCurr.type)\n    )\n\n    if (option1 || option2) {\n      return (\n        <FuncSelector\n            token={tokenCurr}\n        />\n      )\n    }\n  }\n\n  render() {\n    const renderedFuncSelector = this.getFuncSelector()\n\n    if (renderedFuncSelector) {\n      return renderedFuncSelector\n    } else {\n      return (\n        <FuncDescription\n          cursorPos={this.props.cursorPos}\n          fnScopes={this.state.fnScopes}\n        />\n      )\n    }\n  }\n}\n\nexport default Suggestions\n","const colors = {\n  text: '#3D3D3D',\n  cell: {\n    border: '#dfdfdf',\n    borderDark: '#CCC',\n    labelBkg: '#F5F5F5'\n  },\n  dropdown: {\n    normal: '#fafafa',\n    active: '#ebebeb',\n  },\n  primary: {\n    strong: '#E10D75',\n    light: 'salmon',\n  },\n  field: {\n    background: '#F0F0F0',\n  },\n  shadow: '#939393',\n}\n\nconst breaks = {\n  xs: 0,\n  sm: 420,\n  md: 900,\n  lg: 1200,\n}\n\nconst breakBump = {\n  xs: 'sm',\n  sm: 'md',\n  md: 'lg',\n}\n\nconst queries = {\n  xs: `@media (max-width: ${breaks.sm - 1}px)`,\n  sm: `@media (min-width: ${breaks.sm}px) and (max-width: ${breaks.md - 1}px)`,\n  md: `@media (min-width: ${breaks.md}px) and (max-width: ${breaks.lg - 1}px)`,\n  lg: `@media (min-width: ${breaks.lg}px)`,\n  from: (breakPoint) => (`@media (min-width: ${breaks[breakPoint]}px)`),\n  upTo: (breakPoint) => (`@media (max-width: ${breaks[ breakBump[breakPoint] ] - 1}px)`),\n}\n\nconst theme = {\n  colors,\n  breaks,\n  queries,\n}\n\nexport default theme\n","/* @jsx jsx */\nimport { jsx, css } from '@emotion/core'\n\nimport theme from './theme'\n\n\nconst globalStyles = css`\n  body {\n    color: ${theme.colors.text};\n    line-height: 1.3em;\n    font-family: Arial, Helvetica, sans-serif;\n  }\n\n  table, th, td {\n    border: 0;\n    border-spacing: 0;\n    border-collapse: collapse;\n  }\n\n  td {\n    padding: 0;\n    line-height: 1.2em;\n  }\n\n  pre, p, h1, h2, h3, h4, h5, h6 {\n    margin: 0;\n  }\n`\n\nexport default globalStyles\n","import React from 'react'\nimport styled from '@emotion/styled'\n\n\nconst Root = styled.header`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 30px 0 30px;\n`\n\nfunction Header() {\n  return (\n    <Root>\n      <h3>Spreadsheet App</h3>\n    </Root>\n  )\n}\n\nexport default Header\n","export const DEFAULT_COL_WIDTH = 140\nexport const MIN_COL_WIDTH = 12\nexport const MAX_COL_WIDTH = 800\nexport const DEFAULT_ROW_HEIGHT = 28\nexport const MIN_ROW_HEIGHT = 12\nexport const MAX_ROW_HEIGHT = 600\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport { connect } from 'react-redux'\n\nimport { setColWidth } from '~/actions/tableMetaActions'\nimport { DEFAULT_COL_WIDTH, MIN_COL_WIDTH, MAX_COL_WIDTH } from '~/library/constants'\nimport { debounce, clamp } from '~/library/utils'\n\n\nlet Root = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.cell.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.cell.borderDark};\n  background: ${props => props.theme.colors.cell.labelBkg};\n  font-size: 12px;\n`\n\nconst BtnWidth = styled.button`\n  background: transparent;\n  cursor: col-resize;\n  outline: none;\n  position: absolute;\n  height: 100%;\n  margin: 0 -3px 0 0;\n  width: 6px;\n  border: 0;\n  padding: 0;\n  right: 0;\n  top: 0;\n  z-index: 1;\n\n  :hover {\n    background: ${props => props.theme.colors.primary.light};\n  }\n`\n\nclass ColHeader extends React.PureComponent {\n\n  static propTypes = {\n    label: PropTypes.string.isRequired,\n    setColWidth: PropTypes.func.isRequired,\n    width: PropTypes.number.isRequired,\n  }\n\n  static defaultProps = {\n    width: DEFAULT_COL_WIDTH,\n  }\n\n  constructor() {\n    super()\n    this.handleBtnWidthOnMouseDown = this.handleBtnWidthOnMouseDown.bind(this)\n    this.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this)\n    this.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this)\n    this.debSetColWidth = this.debSetColWidth.bind(this)\n  }\n\n  state = {\n    pageX: 0,\n    width: 0,\n    btnRight: 0,\n    isResizing: false,\n  }\n\n  getBtnWidthStyle() {\n    if (!this.state.isResizing) { return }\n\n    const newRight = this.state.btnRight\n    const minRight = MIN_COL_WIDTH - this.state.width\n    const maxRight = MAX_COL_WIDTH - this.state.width\n    const right = -(clamp(newRight, minRight, maxRight) - 4)\n\n    return (theme) => css`\n      width: 1.5px;\n      height: 90vh;\n      right: ${right}px;\n      background: ${theme.colors.primary.light};\n    `\n  }\n\n  debSetColWidth = debounce(40, (event) => {\n    const delta = event.pageX - this.state.pageX\n    this.setState({ btnRight: delta, })\n  })\n\n  handleDocumentMouseMove(event) {\n    this.debSetColWidth(event)\n  }\n\n  handleDocumentMouseUp(event) {\n    const delta = event.pageX - this.state.pageX\n    const width = this.state.width + delta\n\n    this.props.setColWidth(this.props.label, width)\n    this.setState({ btnRight: 0, isResizing: false })\n    document.removeEventListener('mousemove', this.handleDocumentMouseMove)\n    document.removeEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n\n  handleBtnWidthOnMouseDown(event) {\n    event.preventDefault()\n\n    this.setState({\n      pageX: event.pageX,\n      width: this.props.width,\n      isResizing: true,\n    })\n\n    document.addEventListener('mousemove', this.handleDocumentMouseMove)\n    document.addEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n  \n  // handleBtnWidthOnMouseMove(event) {\n  //   if (!this.state.isSettingWidth) { return }\n  //   document.addEventListener('mousemove', (event) => {\n\n  //   })\n  //   const { pageX, pageY } = event\n  //   console.log('handle', pageX, pageY)\n  // }\n\n  render() {\n    const { label, width } = this.props\n\n    return (\n      <Root\n        data-col={label}\n        className='col-label-height'\n        css={css`\n          width: ${width}px;\n          height: 26px;\n        `}\n      >\n        {label}\n        <BtnWidth\n          css={this.getBtnWidthStyle()}\n          tabIndex='-1'\n          onMouseDown={this.handleBtnWidthOnMouseDown}\n          onMouseMove={this.handleBtnWidthOnMouseMove}\n          onMouseUp={this.handleBtnWidthOnMouseUp}\n        />\n      </Root>\n    )\n  }\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const width = state.tableMeta.colWidths[ownProps.label]\n  return { width }\n}\n\nconst mapDispatchToProps = { setColWidth }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColHeader)\n","import { clamp } from '~/library/utils'\nimport {\n  MIN_COL_WIDTH,\n  MAX_COL_WIDTH,\n  MIN_ROW_HEIGHT,\n  MAX_ROW_HEIGHT,\n} from '~/library/constants'\n\n\nexport function setColWidth(colLabel, width) {\n  if (typeof width !== 'number') {\n    throw new Error('width is not a number')\n  }\n\n  return {\n    type: 'SET_COL_WIDTH',\n    payload: { colLabel, width: clamp(width, MIN_COL_WIDTH, MAX_COL_WIDTH) }\n  }\n}\n\nexport function setRowHeight(rowLabel, height) {\n  if (typeof height !== 'number') {\n    throw new Error('height is not a number')\n  }\n\n  return {\n    type: 'SET_ROW_HEIGHT',\n    payload: { rowLabel, height: clamp(height, MIN_ROW_HEIGHT, MAX_ROW_HEIGHT) }\n  }\n}\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\n\nimport ColHeader from '../cell/ColHeader'\n\n\nconst Row = styled.div`\n  display: flex;\n  width: fit-content;\n`\n\nconst InnerBorder = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.cell.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.cell.borderDark};\n  background: ${props => props.theme.colors.cell.labelBkg};\n`\n\nfunction ColHeaderRow({ colLabels }) {\n  const renderCornerCell = () => (\n    <InnerBorder\n      css={css`\n        width: 34px;\n        height: 26px;\n      `}\n    />\n  )\n\n  const renderLabelCells = () => (\n    new Array(colLabels.length).fill(0).map((_, i) => (\n      <ColHeader\n        key={i}\n        label={colLabels[i]}\n      />\n    )\n  ))\n\n  return (\n    <Row\n      data-row='header'\n    >\n      {renderCornerCell()}\n      {renderLabelCells()}\n    </Row>\n  )\n}\n\nColHeaderRow.propTypes = {\n  colLabels: PropTypes.arrayOf(PropTypes.string)\n}\n\nexport default ColHeaderRow\n\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core'\nimport { connect } from 'react-redux'\n\nimport { setRowHeight } from '~/actions/tableMetaActions'\nimport { DEFAULT_ROW_HEIGHT, MIN_ROW_HEIGHT, MAX_ROW_HEIGHT } from '~/library/constants'\nimport { debounce, clamp } from '~/library/utils'\n\n\nconst Root = styled.div`\n  position: relative;\n  font-size: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.colors.cell.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.cell.borderDark};\n  background: ${props => props.theme.colors.cell.labelBkg};\n`\n\nconst BtnHeight = styled.button`\n  background: transparent;\n  cursor: row-resize;\n  outline: none;\n  position: absolute;\n  width: 100%;\n  height: 6px;\n  margin: 0 0 -3px 0;\n  border: 0;\n  padding: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 1;\n\n  :hover {\n    background: ${props => props.theme.colors.primary.light};\n  }\n`\n\nclass RowHeader extends React.PureComponent {\n\n  static propTypes = {\n    label: PropTypes.number.isRequired,\n    setRowHeight: PropTypes.func.isRequired,\n    height: PropTypes.number,\n  }\n\n  constructor() {\n    super()\n    this.handleBtnHeightOnMouseDown = this.handleBtnHeightOnMouseDown.bind(this)\n    this.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this)\n    this.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this)\n    this.debSetRowHeight = this.debSetRowHeight.bind(this)\n  }\n\n  state = {\n    pageY: 0,\n    height: 0,\n    btnBottom: 0,\n    isResizing: false,\n  }\n\n  refRoot = React.createRef()\n\n  getRootStyle() {\n    const { height } = this.props\n    const style = {\n      width: 34\n    }\n\n    if (height) {\n      style.height = height\n    } else {\n      style.minHeight = DEFAULT_ROW_HEIGHT\n      style.height = 'auto'\n    }\n\n    return style\n  }\n\n  getBtnHeightStyle() {\n    if (!this.state.isResizing) { return }\n\n    const newBottom = this.state.btnBottom\n    const minBottom = MIN_ROW_HEIGHT - this.state.height\n    const maxBottom = MAX_ROW_HEIGHT - this.state.height\n    const bottom = -(clamp(newBottom, minBottom, maxBottom) - 4)\n\n    return (theme) => css`\n      height: 1.5px;\n      width: 95vw;\n      bottom: ${bottom}px;\n      background: ${theme.colors.primary.light};\n    `\n  }\n\n  debSetRowHeight = debounce(40, (event) => {\n    const delta = event.pageY - this.state.pageY\n    this.setState({ btnBottom: delta, })\n  })\n\n  handleDocumentMouseMove(event) {\n    this.debSetRowHeight(event)\n  }\n\n  handleDocumentMouseUp(event) {\n    const delta = event.pageY - this.state.pageY\n    const height = this.state.height + delta\n\n    this.props.setRowHeight(this.props.label, height)\n    this.setState({ btnBottom: 0, isResizing: false })\n    document.removeEventListener('mousemove', this.handleDocumentMouseMove)\n    document.removeEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n\n  handleBtnHeightOnMouseDown(event) {\n    event.preventDefault()\n\n    this.setState({\n      pageY: event.pageY,\n      height: this.props.height || this.refRoot.current.getBoundingClientRect().height,\n      isResizing: true,\n    })\n\n    document.addEventListener('mousemove', this.handleDocumentMouseMove)\n    document.addEventListener('mouseup', this.handleDocumentMouseUp)\n  }\n\n  render() {\n    const { label } = this.props\n\n    return (\n      <Root\n        ref={this.refRoot}\n        data-row={label}\n        className='row-header-width'\n        css={this.getRootStyle()}\n      >\n        {label}\n        <BtnHeight\n          css={this.getBtnHeightStyle()}\n          tabIndex='-1'\n          onMouseDown={this.handleBtnHeightOnMouseDown}\n          onMouseMove={this.handleBtnHeightOnMouseMove}\n          onMouseUp={this.handleBtnHeightOnMouseUp}\n        />\n      </Root>\n    )\n  }\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const height = state.tableMeta.rowHeights[ownProps.label]\n  return { height }\n}\n\nconst mapDispatchToProps = { setRowHeight }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RowHeader)\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\n\n\nconst Root = styled.div`\n  display: flex;\n  align-items: center;\n  border: 2px solid transparent;\n  line-height: 1.1em;\n  height: 100%;\n  width: 100%;\n  padding: 2px;\n\n  :focus {\n    border: 2px solid salmon;\n  }\n`\n\nfunction Datum({ fwdRef, location, result, onClick, onKeyDown, onDoubleClick, onFocus }) {\n  const getStyle = () => {\n    let style = {}\n\n    if (typeof result === 'number') {\n      style = {\n        whiteSpace: 'nowrap',\n        textOverflow: 'clip',\n        overflow: 'hidden',\n      }\n    }\n\n    return style\n  }\n\n  return (\n    <Root\n      ref={fwdRef}\n      data-cell='result'\n      data-location={location}\n      css={getStyle()}\n      tabIndex='0'\n      onClick={onClick}\n      onKeyDown={onKeyDown}\n      onDoubleClick={onDoubleClick}\n      onFocus={onFocus}\n    >\n    {result}\n  </Root>\n  )\n}\n\nDatum.propTypes = {\n  fwdRef: PropTypes.object.isRequired,\n  result: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]).isRequired,\n  onClick: PropTypes.func.isRequired,\n  onKeyDown: PropTypes.func.isRequired,\n  onDoubleClick: PropTypes.func.isRequired,\n  onFocus: PropTypes.func.isRequired,\n}\n\nexport default Datum\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\n\nimport { clearCellData } from '~/actions/tableDataActions'\nimport { openCellInputter, setActiveCell } from '~/actions/globalActions'\nimport Datum from './Datum'\n\n\nexport class Result extends React.PureComponent {\n\n  static propTypes = {\n    // props\n    location: PropTypes.string.isRequired,\n    fwdRef: PropTypes.object.isRequired,\n    // redux\n    openCellInputter: PropTypes.func.isRequired,\n    clearCellData: PropTypes.func.isRequired,\n    setActiveCell: PropTypes.func.isRequired,\n    result: PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.number,\n    ]).isRequired,\n  }\n\n  constructor(props) {\n    super()\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.handleOnDoubleClick = this.handleOnDoubleClick.bind(this)\n    this.handleOnFocus = this.handleOnFocus.bind(this)\n    this.handleOnKeyDown = this.handleOnKeyDown.bind(this)\n    this.refDatum = props.fwdRef\n  }\n\n  openCellInputter(willReplaceValue) {\n    const datumRect = this.refDatum.current.getBoundingClientRect()\n    const cellRect = JSON.parse(JSON.stringify(datumRect))\n    this.props.openCellInputter(cellRect, willReplaceValue)\n  }\n\n  handleOnFocus() {\n    this.props.setActiveCell(this.props.location)\n  }\n\n  handleOnClick(event) {\n    event.stopPropagation()\n  }\n\n  handleOnDoubleClick(event) {\n    event.stopPropagation()\n    this.openCellInputter(false)\n  }\n\n  handleOnKeyDown({ key }) {\n    if (['Delete', 'Backspace'].includes(key)) {\n      const valueStr = '' + this.props.result\n\n      if (valueStr.length > 0) {\n        this.props.clearCellData(this.props.location)\n      }\n      // key pressed is a printable symbol, ex: 'a', '1', ','\n      // can be further refined, but for now it's fine\n    } else if (key.length === 1) {\n      this.openCellInputter(true)\n    }\n  }\n\n  render() {\n    return (\n      <Datum\n        fwdRef={this.refDatum}\n        location={this.props.location}\n        result={this.props.result}\n        onClick={this.handleOnClick}\n        onDoubleClick={this.handleOnDoubleClick}\n        onFocus={this.handleOnFocus}\n        onKeyDown={this.handleOnKeyDown}\n      />\n    )\n  }\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const cell = state.tableData[ownProps.location]\n  const result = cell ? cell.result : ''\n  return { result }\n}\n\nconst mapDispatchToProps = { clearCellData, openCellInputter, setActiveCell }\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Result)\n","/* @jsx jsx */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { jsx, css } from '@emotion/core' // eslint-disable-line\nimport { connect } from 'react-redux'\n\nimport { DEFAULT_COL_WIDTH } from '~/library/constants'\n\n\nconst Root = styled.div`\n  cursor: cell;\n  overflow: hidden;\n  font-size: 13px;\n  border-right: 1px solid ${props => props.theme.colors.cell.border};\n  border-bottom: 1px solid ${props => props.theme.colors.cell.border};\n  outline: none;\n`\n\nexport function OutterBorder({ width, height, onClick, onDoubleClick, children }) {\n  return (\n    <Root\n      data-cell='border'\n      onClick={onClick}\n      onDoubleClick={onDoubleClick}\n      css={{\n        width,\n        height: height && height\n      }}\n    >\n      {children}\n    </Root>\n  )\n}\n\nOutterBorder.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  onDoubleClick: PropTypes.func.isRequired,\n  location: PropTypes.string.isRequired,\n  width: PropTypes.number,\n  height: PropTypes.number,\n}\n\nOutterBorder.defaultProps = {\n  width: DEFAULT_COL_WIDTH,\n}\n\nfunction mapStateToProps(state, ownProps) {\n  const [colLabel, rowLabel] = ownProps.location.split('-')\n  const width = state.tableMeta.colWidths[colLabel]\n  const height = state.tableMeta.rowHeights[rowLabel]\n  return { width, height }\n}\n\nexport default connect(mapStateToProps)(OutterBorder)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Result from './Result'\nimport OutterBorder from './OutterBorder'\n\n\nclass ResultCell extends React.PureComponent {\n\n  static propTypes = {\n    location: PropTypes.string.isRequired,\n  }\n\n  refDatum = React.createRef()\n\n  constructor() {\n    super()\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.handleOnDoubleClick = this.handleOnDoubleClick.bind(this)\n  }\n\n  focusDatum() {\n    setTimeout(() => this.refDatum.current.focus(), 0)\n  }\n\n  handleOnClick() {\n    this.focusDatum()\n  }\n\n  handleOnDoubleClick() {\n    this.focusDatum()\n  }\n\n  render() {\n    const { location } = this.props\n\n    return (\n      <OutterBorder\n        onClick={this.handleOnClick}\n        onDoubleClick={this.handleOnDoubleClick}\n        location={location}\n      >\n        <Result\n          location={location}\n          fwdRef={this.refDatum}\n        />\n      </OutterBorder>\n    )\n  }\n}\n\nexport default ResultCell\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\n\nimport RowHeader from '../cell/RowHeader'\nimport ResultCell from '../ResultCell/ResultCell'\n\n\nconst Row = styled.div`\n  display: flex;\n  width: fit-content;\n`\n\nfunction DataRow({ rowNumber, colLabels }) {\n  const dataCells = () => (\n    new Array(colLabels.length).fill(0).map((_, i) => {\n      const location = `${colLabels[i]}-${rowNumber}`\n      return (\n        <ResultCell\n          key={i}\n          location={location}\n        />\n      )\n    })\n  )\n\n  return (\n    <Row\n      data-row={rowNumber}\n    >\n      <RowHeader\n        label={rowNumber}\n      />\n      {dataCells()}\n    </Row>\n  )\n}\n\nDataRow.propTypes = {\n  rowNumber: PropTypes.number,\n  colLabels: PropTypes.arrayOf(PropTypes.string),\n}\n\nexport default DataRow\n\n","import { Machine, assign } from 'xstate'\n\nimport { parseLocation, getColumnLabel } from '~/library/utils'\n\n\nfunction getTargetLocation({ rows, columns, rowIndex, colIndex, key }) {\n  switch (key) {\n    case 'ArrowUp':\n      rowIndex = Math.max(0, rowIndex - 1)\n      break\n    case 'ArrowRight':\n      colIndex = Math.min(columns - 1, colIndex + 1)\n      break\n    case 'ArrowDown':\n    case 'Enter':\n      rowIndex = Math.min(rows - 1, rowIndex + 1)\n      break\n    case 'ArrowLeft':\n      colIndex = Math.max(0, colIndex - 1)\n      break\n    default:\n      return null\n  }\n\n  const colLabel = getColumnLabel(colIndex)\n  const rowLabel = '' + (rowIndex + 1)\n\n  return `${colLabel}-${rowLabel}`\n}\n\nfunction focusTargetCell(ctx) {\n  if (!ctx.endLocation) { return Promise.resolve(false) }\n\n  return new Promise(resolve => {\n    setTimeout(() => {\n      const id = `[data-location=\"${ctx.endLocation}\"]`\n      const cell = document.querySelector(id)\n      if (cell) { cell.focus() }\n      resolve(true)\n    }, 0)\n  })\n}\n\nconst state = {\n  id: 'keyboardNav',\n  initial: 'idle',\n  context: {\n    columns: null,\n    rows: null,\n    key: null,\n    colIndex: null,\n    rowIndex: null,\n    endLocation: null,\n    wasFocused: false,\n  },\n  states: {\n    idle: {\n      on: {\n        'MOVE_FOCUS': {\n          actions: ['setNewContext', 'calcTargetLocation'],\n          target: 'focusTarget',\n        }\n      }\n    },\n    focusTarget: {\n      invoke: {\n        src: focusTargetCell,\n        onDone: {\n          actions: assign({ wasFocused: (ctx, event) => event.data }),\n          target: 'idle',\n        },\n      },\n    },\n  },\n}\n\nconst actions = {\n  actions: {\n    setNewContext: assign((ctx, { key, location }) => {\n      const [colIndex, rowIndex] = parseLocation(location)\n      return { colIndex, rowIndex, key }\n    }),\n    calcTargetLocation: assign({\n      endLocation: (ctx) => {\n        return getTargetLocation(ctx)\n      }\n    }),\n  },\n}\n\nfunction getKeyboardNavMachine(rows, columns) {\n  const newContext = {\n    ...state.context,\n    columns,\n    rows,\n  }\n\n  return Machine(state, actions, newContext)\n}\n\nexport {\n  state,\n  actions,\n  getTargetLocation,\n  focusTargetCell,\n}\n\nexport default getKeyboardNavMachine\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from '@emotion/styled'\nimport { connect } from 'react-redux'\nimport { interpret } from 'xstate'\n\nimport ColHeaderRow from './ColHeaderRow'\nimport DataRow from './DataRow'\nimport { getColumnNames } from '~/library/utils'\nimport getKeyboardNavMachine from './keyboardNavMachine'\n\n\nconst Grid = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: fit-content;\n  overflow: hidden;\n  border-top: 2px solid ${props => props.theme.colors.cell.borderDark};\n  border-left: 2px solid ${props => props.theme.colors.cell.borderDark};\n  border-right: 1px solid ${props => props.theme.colors.cell.borderDark};\n  border-bottom: 1px solid ${props => props.theme.colors.cell.borderDark};\n\n  * {\n    box-sizing: border-box;\n  }\n`\n\nexport class Table extends React.PureComponent {\n  static propTypes = {\n    rows: PropTypes.number.isRequired,\n    columns: PropTypes.number.isRequired,\n  }\n\n  constructor(props) {\n    super(props)\n    this.handleTableOnClick = this.handleTableOnClick.bind(this)\n    this.handleTableOnKeyDown = this.handleTableOnKeyDown.bind(this)\n    this.colLabels = getColumnNames(props.columns)\n  }\n\n  keyboardNavMachine = getKeyboardNavMachine(this.props.rows, this.props.columns)\n  focusService = interpret(this.keyboardNavMachine)\n\n  componentDidMount() {\n    this.focusService.start()\n  }\n\n  componentWillUnmount() {\n    this.focusService.stop()\n  }\n\n  handleTableOnClick(event) {\n    event.stopPropagation()\n  }\n\n  handleTableOnKeyDown(event) {\n    event.stopPropagation()\n    const { location } = event.target.dataset\n\n    if (location) {\n      this.moveFocus(event.key, event.target.dataset.location)\n    }\n  }\n\n  moveFocus(key, location) {\n    this.focusService.send({ type: 'MOVE_FOCUS', key, location })\n  }\n\n  renderColHeaderRow(i) {\n    return (\n      <ColHeaderRow\n        key={i}\n        rows={this.props.rows}\n        colLabels={this.colLabels}\n      />\n    )\n  }\n\n  renderDataRows(rowNumber) {\n    return (\n      <DataRow\n        key={rowNumber}\n        rowNumber={rowNumber}\n        colLabels={this.colLabels}\n      />\n    )\n  }\n\n  renderRows() {\n    return new Array(this.props.rows + 1).fill(0).map((_, i) => {\n      if (i === 0) {\n        return this.renderColHeaderRow(i)\n      } else {\n        return this.renderDataRows(i)\n      }\n    })\n  }\n\n  render() {\n    return (\n      <Grid\n        data-table='app'\n        onClick={this.handleTableOnClick}\n        onKeyDown={this.handleTableOnKeyDown}\n      >\n        {this.renderRows()}\n      </Grid>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const { rows, columns } = state.global\n  return { rows, columns }\n}\n\nexport default connect(mapStateToProps)(Table)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport styled from '@emotion/styled'\n\nimport Header from './components/header/Header'\nimport Table from './components/table/Table'\nimport CellInputter from './components/CellInputter/CellInputter'\n\n\nconst Container = styled.div`\n  display: grid;\n  grid:\n    \"left-blank main right-blank\" 100vh\n    / auto minmax(auto, 1000px) auto;\n`\n\nconst Main = styled.main`\n  grid-area: main;\n`\n\nfunction App({ isCellInputterOpen }) {\n  return (\n    <Container>\n      <Main>\n        {isCellInputterOpen &&  <CellInputter />}\n        <div data-dummy-focus-stop tabIndex=\"0\" />\n        <Header />\n        <Table />\n      </Main>\n    </Container>\n  )\n}\n\nApp.propTypes = {\n  isCellInputterOpen: PropTypes.bool,\n  setActiveCell: PropTypes.func,\n}\n\nconst mapStateToProps = (state) => {\n  const { isCellInputterOpen } = state.global.cellInputter\n  return { isCellInputterOpen }\n}\n\nexport default connect(mapStateToProps)(App)\n","import React from 'react'\nimport { Provider } from 'react-redux'\nimport { BrowserRouter } from 'react-router-dom'\nimport { ThemeProvider } from 'emotion-theming'\nimport { Global } from '@emotion/core'\nimport 'sanitize.css'\n\nimport appStore from './reducers/'\nimport globalStyles from './styles/globalStyles'\nimport theme from './styles/theme'\nimport App from './App'\n\n\nfunction Root() {\n  return (\n    <Provider store={appStore}>\n      <BrowserRouter>\n        <ThemeProvider theme={theme}>\n          <Global styles={globalStyles} />\n          <App />\n        </ThemeProvider>\n      </BrowserRouter>\n    </Provider>\n  )\n}\n\nexport default Root\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Root from './Root'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<Root />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{53:function(e,t,n){e.exports=n(65)},65:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(34),o=n.n(a),s=n(16),u=n(51),l=n(37),c=n(5),h=(n(62),n(21)),d=n(18),p=Object(h.c)({activeCell:{},cellInputter:{},rows:14,columns:6},{SET_ACTIVE_CELL:function(e,t){var n=t.payload;e.activeCell=n},OPEN_CELL_INPUTTER:function(e,t){var n=t.payload;e.cellInputter=n},CLOSE_CELL_INPUTTER:function(e){e.cellInputter=Object(d.a)({},e.cellInputter,{isCellInputterOpen:!1})}}),f=Object(h.c)({},{SET_CELL_DATA:function(e,t){var n=t.payload,r=n.location,i=n.data;e[r]=i},DELETE_CELL_DATA:function(e,t){delete e[t.payload]}}),v=n(30),b=Object(h.c)({colWidths:{},rowHeights:{}},{SET_COL_WIDTH:function(e,t){var n=t.payload,r=n.colLabel,i=n.width,a=e.colWidths;e.colWidths=Object(d.a)({},a,Object(v.a)({},r,i))},SET_ROW_HEIGHT:function(e,t){var n=t.payload,r=n.rowLabel,i=n.height,a=e.rowHeights;e.rowHeights=Object(d.a)({},a,Object(v.a)({},r,i))}}),m=Object(h.a)({reducer:{global:p,tableData:f,tableMeta:b}}),y={xs:0,sm:420,md:900,lg:1200},g={xs:"sm",sm:"md",md:"lg"},O={xs:"@media (max-width: ".concat(y.sm-1,"px)"),sm:"@media (min-width: ".concat(y.sm,"px) and (max-width: ").concat(y.md-1,"px)"),md:"@media (min-width: ".concat(y.md,"px) and (max-width: ").concat(y.lg-1,"px)"),lg:"@media (min-width: ".concat(y.lg,"px)"),from:function(e){return"@media (min-width: ".concat(y[e],"px)")},upTo:function(e){return"@media (max-width: ".concat(y[g[e]]-1,"px)")}},k={colors:{text:"#3D3D3D",cell:{border:"#dfdfdf",borderDark:"#CCC",labelBkg:"#F5F5F5"},dropdown:{normal:"#fafafa",active:"#ebebeb"},primary:{strong:"#E10D75",light:"salmon"},field:{background:"#F0F0F0"},shadow:"#939393"},breaks:y,queries:O},w=Object(c.c)("body{color:",k.colors.text,";line-height:1.3em;font-family:Arial,Helvetica,sans-serif;}table,th,td{border:0;border-spacing:0;border-collapse:collapse;}td{padding:0;line-height:1.2em;}pre,p,h1,h2,h3,h4,h5,h6{margin:0;}"),x=n(6),j=Object(x.a)("header",{target:"e1mq5pli0"})({name:"1rn5ure",styles:"width:100%;display:flex;flex-direction:column;align-items:center;padding:30px 0 30px;"});var E=function(){return i.a.createElement(j,null,i.a.createElement("h3",null,"Spreadsheet App"))},C=n(2),I=n(4),N=n(10),S=n(9),M=n(8),T=n(11),R=n(28),D=n(25),L=n(14),U="A".codePointAt(0);function A(e,t,n){return Math.min(Math.max(e,t),n)}function F(e){for(var t=[],n=[""],r=e;r>0;){var i=[];e:for(var a=0,o=n;a<o.length;a++){var s=o[a],u=!0,l=!1,c=void 0;try{for(var h,d="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Symbol.iterator]();!(u=(h=d.next()).done);u=!0){var p=h.value;if(0===r)break e;i.push("".concat(s).concat(p)),r-=1}}catch(f){l=!0,c=f}finally{try{u||null==d.return||d.return()}finally{if(l)throw c}}}n=i,t=[].concat(Object(D.a)(t),i)}return t}function P(e){var t=[],n=U,r=e+1;do{var i=n+(r-=1)%26,a=String.fromCodePoint(i);t.push(a),r=Math.floor(r/26)}while(r>0);return t.reverse().join("")}function V(e){var t=e.split("-"),n=Object(L.a)(t,2),r=n[0],i=n[1];return[r.split("").reduce(function(e,t){return 26*e+t.charCodeAt(0)-U+1},0)-1,+i-1]}function B(e){var t=Boolean(e.match(/^[.\d]+$/)),n=(e.match(/\./g)||[]).length;return!!t&&(!(n>1)&&(1!==e.length||"."!==e[0]))}function W(e,t){var n;return function(){n||(t.apply(void 0,arguments),n=setTimeout(function(){clearTimeout(n),n=null},e))}}var z=12,_=800,H=12,K=600;var q=Object(x.a)("div",{target:"e11zdtao0"})("position:relative;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";font-size:12px;"),X=Object(x.a)("button",{target:"e11zdtao1"})("background:transparent;cursor:col-resize;outline:none;position:absolute;height:100%;margin:0 -3px 0 0;width:6px;border:0;padding:0;right:0;top:0;z-index:1;:hover{background:",function(e){return e.theme.colors.primary.light},";}"),G=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(N.a)(this,Object(S.a)(t).call(this))).state={pageX:0,width:0,btnRight:0,isResizing:!1},e.debSetColWidth=W(40,function(t){var n=t.pageX-e.state.pageX;e.setState({btnRight:n})}),e.handleBtnWidthOnMouseDown=e.handleBtnWidthOnMouseDown.bind(Object(M.a)(e)),e.handleDocumentMouseMove=e.handleDocumentMouseMove.bind(Object(M.a)(e)),e.handleDocumentMouseUp=e.handleDocumentMouseUp.bind(Object(M.a)(e)),e.debSetColWidth=e.debSetColWidth.bind(Object(M.a)(e)),e}return Object(T.a)(t,e),Object(I.a)(t,[{key:"getBtnWidthStyle",value:function(){if(this.state.isResizing){var e=-(A(this.state.btnRight,z-this.state.width,_-this.state.width)-4);return function(t){return Object(c.c)("width:1.5px;height:90vh;right:",e,"px;background:",t.colors.primary.light,";")}}}},{key:"handleDocumentMouseMove",value:function(e){this.debSetColWidth(e)}},{key:"handleDocumentMouseUp",value:function(e){var t=e.pageX-this.state.pageX,n=this.state.width+t;this.props.setColWidth(this.props.label,n),this.setState({btnRight:0,isResizing:!1}),document.removeEventListener("mousemove",this.handleDocumentMouseMove),document.removeEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"handleBtnWidthOnMouseDown",value:function(e){e.preventDefault(),this.setState({pageX:e.pageX,width:this.props.width,isResizing:!0}),document.addEventListener("mousemove",this.handleDocumentMouseMove),document.addEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.label,n=e.width;return Object(c.d)(q,{"data-col":t,className:"col-label-height",css:Object(c.c)("width:",n,"px;height:26px;")},t,Object(c.d)(X,{css:this.getBtnWidthStyle(),tabIndex:"-1",onMouseDown:this.handleBtnWidthOnMouseDown,onMouseMove:this.handleBtnWidthOnMouseMove,onMouseUp:this.handleBtnWidthOnMouseUp}))}}]),t}(i.a.PureComponent);G.defaultProps={width:140};var Q={setColWidth:function(e,t){if("number"!==typeof t)throw new Error("width is not a number");return{type:"SET_COL_WIDTH",payload:{colLabel:e,width:A(t,z,_)}}}},Y=Object(s.b)(function(e,t){return{width:e.tableMeta.colWidths[t.label]}},Q)(G),J=Object(x.a)("div",{target:"e40r6tf0"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"}),$=Object(x.a)("div",{target:"e40r6tf1"})("display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";"),Z={name:"zlgvwp",styles:"width:34px;height:26px;"};var ee=function(e){var t=e.colLabels;return Object(c.d)(J,{"data-row":"header"},Object(c.d)($,{css:Z}),new Array(t.length).fill(0).map(function(e,n){return Object(c.d)(Y,{key:n,label:t[n]})}))},te=Object(x.a)("div",{target:"e1d5mcq00"})("position:relative;font-size:12px;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";"),ne=Object(x.a)("button",{target:"e1d5mcq01"})("background:transparent;cursor:row-resize;outline:none;position:absolute;width:100%;height:6px;margin:0 0 -3px 0;border:0;padding:0;left:0;bottom:0;z-index:1;:hover{background:",function(e){return e.theme.colors.primary.light},";}"),re=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(N.a)(this,Object(S.a)(t).call(this))).state={pageY:0,height:0,btnBottom:0,isResizing:!1},e.refRoot=i.a.createRef(),e.debSetRowHeight=W(40,function(t){var n=t.pageY-e.state.pageY;e.setState({btnBottom:n})}),e.handleBtnHeightOnMouseDown=e.handleBtnHeightOnMouseDown.bind(Object(M.a)(e)),e.handleDocumentMouseMove=e.handleDocumentMouseMove.bind(Object(M.a)(e)),e.handleDocumentMouseUp=e.handleDocumentMouseUp.bind(Object(M.a)(e)),e.debSetRowHeight=e.debSetRowHeight.bind(Object(M.a)(e)),e}return Object(T.a)(t,e),Object(I.a)(t,[{key:"getRootStyle",value:function(){var e=this.props.height,t={width:34};return e?t.height=e:(t.minHeight=28,t.height="auto"),t}},{key:"getBtnHeightStyle",value:function(){if(this.state.isResizing){var e=-(A(this.state.btnBottom,H-this.state.height,K-this.state.height)-4);return function(t){return Object(c.c)("height:1.5px;width:95vw;bottom:",e,"px;background:",t.colors.primary.light,";")}}}},{key:"handleDocumentMouseMove",value:function(e){this.debSetRowHeight(e)}},{key:"handleDocumentMouseUp",value:function(e){var t=e.pageY-this.state.pageY,n=this.state.height+t;this.props.setRowHeight(this.props.label,n),this.setState({btnBottom:0,isResizing:!1}),document.removeEventListener("mousemove",this.handleDocumentMouseMove),document.removeEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"handleBtnHeightOnMouseDown",value:function(e){e.preventDefault(),this.setState({pageY:e.pageY,height:this.props.height||this.refRoot.current.getBoundingClientRect().height,isResizing:!0}),document.addEventListener("mousemove",this.handleDocumentMouseMove),document.addEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"render",value:function(){var e=this.props.label;return Object(c.d)(te,{ref:this.refRoot,"data-row":e,className:"row-header-width",css:this.getRootStyle()},e,Object(c.d)(ne,{css:this.getBtnHeightStyle(),tabIndex:"-1",onMouseDown:this.handleBtnHeightOnMouseDown,onMouseMove:this.handleBtnHeightOnMouseMove,onMouseUp:this.handleBtnHeightOnMouseUp}))}}]),t}(i.a.PureComponent);var ie={setRowHeight:function(e,t){if("number"!==typeof t)throw new Error("height is not a number");return{type:"SET_ROW_HEIGHT",payload:{rowLabel:e,height:A(t,H,K)}}}},ae=Object(s.b)(function(e,t){return{height:e.tableMeta.rowHeights[t.label]}},ie)(re),oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;Object(C.a)(this,e);var n=t.getState().global;this.store=t,this.rows=n.rows,this.columns=n.columns}return Object(I.a)(e,[{key:"getCellResult",value:function(e){var t=this.tableData[e];return t&&t.result}},{key:"replaceCellData",value:function(e,t,n){this.store.dispatch(function(e,t,n){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:n}}}}(e,t,n))}},{key:"clearCell",value:function(e){this.store.dispatch(Re(e))}},{key:"tableData",get:function(){return this.store.getState().tableData}},{key:"locations",get:function(){return Object.keys(this.tableData)}}]),e}(),se=function e(t,n,r,i,a){Object(C.a)(this,e),this.type=t,this.category=i,this.text=n,this.whitespace=r,this.index=a,this.value=null,this.html=null};function ue(e){e.forEach(function(e){if("number"!==typeof e)throw new TypeError("Function argument not a number: ".concat(e))})}var le={AVERAGE:{fn:function(){var e,t;if(0===arguments.length)throw new Error("Empty elements");return(e=le.SUM).fn.apply(e,arguments)/(t=le.COUNT).fn.apply(t,arguments)},definition:"AVERAGE(value1, value2, ...)",example:"AVERAGE(A1:B3, 3)",summary:"Returns the average from a series of numbers."},CONCAT:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.reduce(function(e,t){return e+t},"")},definition:'CONCAT("text1", "text2", ...)',example:'CONCAT("one", "two")',summary:"Returns a single concatenated string from a series of strings."},COUNT:{fn:function(){return arguments.length},definition:"COUNT(element1, element2, ...)",example:"COUNT(A1:B3, 2, C4)",summary:"Returns the number of non-empty elements in a set."},MAX:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return ue(t),Math.max.apply(Math,t)},definition:"MAX(value1, value2, ...)",example:"MAX(A1:B3, 4, C3)",summary:"Returns the maximum value from a series of numbers"},MIN:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return ue(t),Math.min.apply(Math,t)},definition:"MIN(value1, value2, ...)",example:"MIN(A1:B3, 4, C3)",summary:"Returns the minimum value from a series of numbers."},POWER:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(2!==t.length)throw new Error("Formula takes only two elements");ue(t);var r=t[0],i=t[1];return Math.pow(r,i)},definition:"POWER(base, exponent)",example:"POWER(A3,2)",summary:"Returns a number raised to an exponent."},SQRT:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1!==t.length)throw new Error("Formula takes only one element");return ue(t),Math.sqrt(t[0])},definition:"SQRT(value)",example:"SQRT(9) or SQRT(A3)",summary:"Returns the square root of a number."},SUM:{fn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return ue(t),t.reduce(function(e,t){return t+e},0)},definition:"SUM(value1, value2, ...)",example:"SUM(A1:B3, 3, C5)",summary:"Retuns the sum from a series of numbers."}};le.AVG=Object(d.a)({},le.AVERAGE,{definition:"AVG(value1, value2, ...)",example:"AVG(A1:B3, 3)"}),le.POW=Object(d.a)({},le.POWER,{definition:"POW(base, exponent)",example:"POW(A3,2)"});var ce=le,he=function(){function e(t){Object(C.a)(this,e),this.tokens=t}return Object(I.a)(e,[{key:"sanitize",value:function(){var e=this;return this.tokens.map(function(t){switch(t.type){case pe.NUMBER:return e.number(t);case pe.CELL:return e.cell(t);case pe.FUNCTION:return e.function(t);case pe.STRING:return e.string(t);default:return t}})}},{key:"number",value:function(e){return B(e.text)?(e.value=parseFloat(e.text),e):(e.type=pe.UNKNOWN,e)}},{key:"cell",value:function(e){return e.value=this.getCellLabel(e),e}},{key:"function",value:function(e){var t=this.getFunction(e);return t?e.value=t:e.type=pe.UNKNOWN,e}},{key:"string",value:function(e){return e.value=e.text.slice(1,-1),e}},{key:"getCellLabel",value:function(e){var t=e.text,n=t.match(/\d+/).index,r=t.slice(0,n).toUpperCase(),i=t.slice(n);return"".concat(r,"-").concat(i)}},{key:"getFunction",value:function(e){var t=e.text.toUpperCase(),n=ce[t];return n&&n.fn}}]),e}(),de=function(){function e(t,n,r,i){Object(C.a)(this,e),this.regex=t,this.groupIndex=n,this.token=r,this.category=i}return Object(I.a)(e,[{key:"setIndex",value:function(e){this.regex.lastIndex=e}},{key:"test",value:function(e){return this.regex.exec(e)}}]),e}(),pe={EOF:"EOF",EQUALS:"EQUALS",COMMA:"COMMA",COLON:"COLON",LPAREN:"LPAREN",RPAREN:"RPAREN",PLUS:"PLUS",MINUS:"MINUS",MULT:"MULT",DIV:"DIV",TEXT:"TEXT",CELL:"CELL",STRING:"STRING",NUMBER:"NUMBER",FUNCTION:"FUNCTION",UNKNOWN:"UNKNOWN"},fe=pe,ve=[new de(/=/g,0,fe.EQUALS,"structure"),new de(/,/g,0,fe.COMMA,"structure"),new de(/:/g,0,fe.COLON,"structure"),new de(/\(/g,0,fe.LPAREN,"structure"),new de(/\)/g,0,fe.RPAREN,"structure"),new de(/\+/g,0,fe.PLUS,"operator"),new de(/\-/g,0,fe.MINUS,"operator"),new de(/\*/g,0,fe.MULT,"operator"),new de(/\//g,0,fe.DIV,"operator"),new de(/("[^"]+")/g,1,fe.STRING,"entity"),new de(/[\d\.]+/g,0,fe.NUMBER,"entity"),new de(/[a-z]+[\d]+/gi,0,fe.CELL,"entity"),new de(/([a-z]+)\(/gi,1,fe.FUNCTION,"entity")],be=function(){function e(t){Object(C.a)(this,e),this.input=t,this.index=0,this.char=this.initChar(t),this.markers=[],this.tokens=[]}return Object(I.a)(e,[{key:"getTokens",value:function(){for(;this.char!==fe.EOF;){var e=this.nextToken();this.tokens.push(e)}var t=new he(this.tokens);return this.tokens=t.sanitize(),this.tokens}},{key:"nextToken",value:function(){if(this.char===fe.EOF)return new se(fe.EOF,fe.EOF,0,"eof",this.index);if(!this.isFormula())return this.tokenTEXTorNUMBER();for(var e,t=this.getWhitespaceLen(),n=0,r=ve;n<r.length;n++){var i=r[n];i.setIndex(this.index);var a=i.test(this.input);if(a&&a.index===this.index){var o=a[i.groupIndex];e=new se(i.token,o,t,i.category,this.index),this.index+=o.length-1,this.consume();break}}return e||(e=this.tokenUNKNOWN(t)),e}},{key:"initChar",value:function(e){return 0===this.input.length&&(this.input="0",this.index=-1),e[this.index]}},{key:"tokenUNKNOWN",value:function(e){for(var t=[];!(this.isEOF()||this.isSeparator()||this.isWhitespace());)t.push(this.char),this.consume();var n=t.join("");return new se(fe.UNKNOWN,n,e,"entity",this.index-n.length)}},{key:"tokenTEXTorNUMBER",value:function(){var e;return e=B(this.input)?new se(fe.NUMBER,this.input,0,"entity",this.index):new se(fe.TEXT,this.input,0,"entity",this.index),this.index=this.input.length-1,this.consume(),e}},{key:"consume",value:function(){this.index++,this.index<this.input.length?this.char=this.input[this.index]:this.char=fe.EOF}},{key:"isFormula",value:function(){return"="===this.input[0]}},{key:"isEOF",value:function(){return this.char===fe.EOF}},{key:"isWhitespace",value:function(){return!this.isEOF()&&Boolean(this.char.match(/\s/))}},{key:"isSeparator",value:function(){return Boolean(this.char.match(/[\(\)\+\-\/\*]/))}},{key:"getWhitespaceLen",value:function(){for(var e=0;this.isWhitespace();)e++,this.consume();return e}}]),e}(),me=be,ye=function(){function e(t){Object(C.a)(this,e),this._name=t}return Object(I.a)(e,[{key:"eval",value:function(){throw new Error("Implement method.")}}]),e}(),ge=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(N.a)(this,Object(S.a)(t).call(this,"TextNode"))).node=e,n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"eval",value:function(){return this.node.text}}]),t}(ye),Oe=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(N.a)(this,Object(S.a)(t).call(this,"StringNode"))).node=e,n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"eval",value:function(){return this.node.value}}]),t}(ye),ke=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(N.a)(this,Object(S.a)(t).call(this,"NumberNode"))).node=e,n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"eval",value:function(){return this.node.value}}]),t}(ye),we=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(N.a)(this,Object(S.a)(t).call(this,"CellNode"))).cell=e,n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"location",get:function(){return this.cell.value}}]),t}(ye),xe=function(e){function t(e,n){var r;return Object(C.a)(this,t),(r=Object(N.a)(this,Object(S.a)(t).call(this,"CellRange"))).leftCell=e,r.rightCell=n,r}return Object(T.a)(t,e),t}(ye),je=function(e){function t(e,n){var r;return Object(C.a)(this,t),(r=Object(N.a)(this,Object(S.a)(t).call(this,"UnaryOp"))).opNode=e,r.expr=n,r}return Object(T.a)(t,e),Object(I.a)(t,[{key:"eval",value:function(e){return this.opNode.type===pe.PLUS?e:this.opNode.type===pe.MINUS?-e:void 0}}]),t}(ye),Ee=function(e){function t(e,n){var r;return Object(C.a)(this,t),(r=Object(N.a)(this,Object(S.a)(t).call(this,"FuncOp"))).funcNode=e,r.argNodes=n,r}return Object(T.a)(t,e),Object(I.a)(t,[{key:"eval",value:function(e){return this.funcNode.value.apply(void 0,Object(D.a)(e))}}]),t}(ye),Ce=function(e){function t(e,n,r){var i;return Object(C.a)(this,t),(i=Object(N.a)(this,Object(S.a)(t).call(this,"BinaryOp"))).leftNode=e,i.opNode=n,i.rightNode=r,i}return Object(T.a)(t,e),Object(I.a)(t,[{key:"eval",value:function(e,t){switch(this.opNode.type){case pe.PLUS:return e+t;case pe.MINUS:return e-t;case pe.DIV:if(0===t)throw new Error("Division by zero: ".concat(e,"/").concat(t));return e/t;case pe.MULT:return e*t;default:throw new Error('Unsupported operator "'.concat(this.token.text,'"'))}}}]),t}(ye),Ie=function(){function e(t){Object(C.a)(this,e),this.index=0,this.tokens=t,this.curr=this.tokens[0],this.ast=null}return Object(I.a)(e,[{key:"parse",value:function(){switch(this.peekType()){case pe.TEXT:this.ast=this.text();break;case pe.NUMBER:this.ast=this.number();break;default:this.equals(),this.ast=this.expr()}if(null!==this.curr)throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));return this.ast}},{key:"expr",value:function(){var e,t,n;for(e=this.term();[pe.PLUS,pe.MINUS].includes(this.peekType());)t=this.operator(),n=this.term(),e=new Ce(e,t,n);return e}},{key:"term",value:function(){var e,t,n;for(e=this.factor();[pe.MULT,pe.DIV].includes(this.peekType());)t=this.operator(),n=this.factor(),e=new Ce(e,t,n);return e}},{key:"factor",value:function(){switch(this.peekType()){case pe.LPAREN:return this.enclosedExpr();case pe.PLUS:case pe.MINUS:return this.unaryOp();case pe.NUMBER:return this.number();case pe.CELL:return this.cell();case pe.FUNCTION:return this.func();case pe.RPAREN:throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));default:throw new Error("Missing factor")}}},{key:"enclosedExpr",value:function(){this.lparen();var e=this.expr();return this.rparen(),e}},{key:"cell",value:function(){if(this.peekType()!==pe.CELL)throw new Error("Missing cell node");var e=new we(this.curr);return this.consume(),e}},{key:"cellRange",value:function(){var e,t;if(!this.isCellRange())throw new Error("Missing cell range");if(e=new we(this.curr),this.consume(),this.consume(),t=new we(this.curr),this.consume(),t.location<e.location){var n=this.invertCellRange(e,t),r=Object(L.a)(n,2);e=r[0],t=r[1]}return new xe(e,t)}},{key:"invertCellRange",value:function(e,t){this.tokens[this.index-2]=t.cell,this.tokens[this.index]=e.cell;var n=e;return[e=t,t=n]}},{key:"func",value:function(){if(this.peekType()!==pe.FUNCTION)throw new Error("Missing function");var e=this.curr;this.consume(),this.lparen();var t=this.list();return this.rparen(),new Ee(e,t)}},{key:"list",value:function(){var e,t=[];for(e=this.listNode(),t.push(e);this.peekType()===pe.COMMA;)this.consume(),e=this.listNode(),t.push(e);return t}},{key:"listNode",value:function(){return this.isCellRange()?this.cellRange():this.peekType()===pe.STRING?this.string():this.expr()}},{key:"text",value:function(){var e;if(this.peekType()!==pe.TEXT)throw new Error("Missing string");return e=new ge(this.curr),this.consume(),e}},{key:"string",value:function(){var e=new Oe(this.curr);return this.consume(),e}},{key:"number",value:function(){if(this.peekType()===pe.NUMBER){var e=new ke(this.curr);return this.consume(),e}throw new Error("Missing number")}},{key:"operator",value:function(){if([pe.PLUS,pe.MINUS,pe.MULT,pe.DIV].includes(this.peekType())){var e=this.curr;return this.consume(),e}throw new Error("Missing operator")}},{key:"equals",value:function(){if(this.peekType()!==pe.EQUALS)throw new Error("Missing equals sign");this.consume()}},{key:"lparen",value:function(){if(this.peekType()!==pe.LPAREN)throw new Error("Missing left parenthesis");this.consume()}},{key:"rparen",value:function(){if(this.peekType()!==pe.RPAREN)throw new Error("Missing right parenthesis");this.consume()}},{key:"unaryOp",value:function(){if(![pe.PLUS,pe.MINUS].includes(this.peekType()))throw new Error("Missing unary operator");var e=this.curr;return this.consume(),new je(e,this.factor())}},{key:"consume",value:function(){this.index<this.tokens.length-1?(this.index++,this.curr=this.tokens[this.index]):this.curr=null}},{key:"isCellRange",value:function(){return this.peekType(0)===pe.CELL&&this.peekType(1)===pe.COLON&&this.peekType(2)===pe.CELL}},{key:"isString",value:function(){return this.peekType(0)===pe.DQUOTE&&this.peekType(1)===pe.TEXT&&this.peekType(2)===pe.DQUOTE}},{key:"peekType",value:function(e){if(!e)return this.curr&&this.curr.type;if(e<0)throw new Error("peak ahead index must be positive");var t=this.index+e;return t<this.tokens.length?this.tokens[t].type:void 0}}]),e}(),Ne=function(){function e(t){Object(C.a)(this,e),this.location=t,this.error=null,this.cache={},this.result=null,this.state=new oe}return Object(I.a)(e,[{key:"interpret",value:function(e){var t,n,r=Te.addVertex(this.location,e);try{t=new be(e),n=new Ie(t.getTokens()),r.ast=n.parse(),Te.recalculate(this.location),this.result=r.result}catch(i){return this.error=r.error=i,this.result=r.result=this.errorResponse(),this.result}return this.error=r.error,this.result}},{key:"visitAST",value:function(e){var t=Te.getVertex(e);if(!t.ast)return t.result;try{this.result=t.result=this.visitNode(t.ast)}catch(n){throw this.error=t.error=n,this.result=t.result=this.errorResponse(),n}return this.result}},{key:"visitNode",value:function(e){switch(e._name){case"NumberNode":return this.NumberNode(e);case"CellNode":return this.CellNode(e);case"TextNode":return this.TextNode(e);case"StringNode":return this.StringNode(e);case"CellRange":return this.CellRange(e);case"FuncOp":return this.FuncOp(e);case"BinaryOp":return this.BinaryOp(e);case"UnaryOp":return this.UnaryOp(e);default:var t=e._name||(e.constructor||{}).name;throw new Error("Unrecognized AST node ".concat(t))}}},{key:"TextNode",value:function(e){return e.eval()}},{key:"StringNode",value:function(e){return e.eval()}},{key:"NumberNode",value:function(e){return e.eval()}},{key:"UnaryOp",value:function(e){var t=this.visitNode(e.expr);return e.eval(t)}},{key:"CellNode",value:function(e){var t=this.getCellResult(e.location);return void 0===t?0:t}},{key:"BinaryOp",value:function(e){var t=this.visitNode(e.leftNode),n=this.visitNode(e.rightNode);return e.eval(t,n)}},{key:"CellRange",value:function(e){for(var t=V(e.leftCell.location),n=Object(L.a)(t,2),r=n[0],i=n[1],a=V(e.rightCell.location),o=Object(L.a)(a,2),s=o[0],u=o[1],l=Math.min(r,s),c=Math.max(r,s),h=Math.min(i,u),d=Math.max(i,u),p=[],f=h;f<=d;f++)for(var v=l;v<=c;v++){var b="".concat(P(v),"-").concat(f+1),m=this.getCellResult(b);void 0!==m&&p.push(m)}return p}},{key:"getCellResult",value:function(e){var t;if(!this.isLocationValid(e))throw new Error("Location out of bounds");return void 0!==this.cache[e]?this.cache[e]:(t=Te.visitCell(e),this.cache[e]=t,t)}},{key:"FuncOp",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.argNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,u=this.visitNode(s);"CellRange"===s._name?t.push.apply(t,Object(D.a)(u)):t.push(u)}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e.eval(t)}},{key:"isLocationValid",value:function(e){var t=V(e),n=Object(L.a)(t,2),r=n[0],i=n[1];return!(Math.min(r,i)<0)&&(!(r>=this.state.columns)&&!(i>=this.state.rows))}},{key:"errorResponse",value:function(){var e=this.error.message;return e.match(/division by zero/i)?"#DIV/0!":e.match(/circular reference/i)?"#REF!":"#ERROR!"}}]),e}(),Se=function e(t){Object(C.a)(this,e),this.entered=t,this.error=null,this.result=null,this.ast=null},Me=new(function(){function e(){Object(C.a)(this,e),this.adj={},this.pending=null,this.visited=null,this.store=new oe}return Object(I.a)(e,[{key:"recalculate",value:function(e){this.setPendingNodes(),this.dfs(e),this.updateStore()}},{key:"setPendingNodes",value:function(){var e=this;this.pending=new Set,Object.keys(this.adj).forEach(function(t){e.pending.add(t)})}},{key:"dfs",value:function(e){for(var t=this;this.pending.size>0;){e||(e=Object(D.a)(this.pending)[0]);try{this.visited=new Set([e]),new Ne(e).visitAST(e)}catch(n){}this.visited.forEach(function(e){return t.pending.delete(e)}),e=null}this.visited=null,this.pending=null}},{key:"visitCell",value:function(e){if(this.hasVertex(e)){this.testPathCycle(e),this.pending.delete(e),this.visited.add(e);var t=new Ne(e).visitAST(e);return this.visited.delete(e),t}}},{key:"getCellResult",value:function(e){return e in this.adj?Me.adj[e].result:""}},{key:"testPathCycle",value:function(e){if(this.visited.has(e))throw new Error("Circular reference")}},{key:"updateStore",value:function(){for(var e=new Set(this.store.locations),t=0,n=Object.entries(this.adj);t<n.length;t++){var r=n[t],i=Object(L.a)(r,2),a=i[0],o=i[1],s=o.entered,u=o.result;e.delete(a),u!==this.store.getCellResult(a)&&this.store.replaceCellData(a,s,u)}var l=!0,c=!1,h=void 0;try{for(var d,p=e[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=d.value;this.store.clearCell(f)}}catch(v){c=!0,h=v}finally{try{l||null==p.return||p.return()}finally{if(c)throw h}}}},{key:"addVertex",value:function(e,t){var n=new Se(t);return this.adj[e]=n,n}},{key:"hasVertex",value:function(e){return e in this.adj}},{key:"getVertex",value:function(e){return this.testMissingLocation(e),this.adj[e]}},{key:"delVertex",value:function(e){e in this.adj&&(delete this.adj[e],this.recalculate())}},{key:"resetAll",value:function(){this.adj={},this.pending=null,this.visited=null,this.store=new oe}},{key:"testMissingLocation",value:function(e){if(!this.hasVertex(e))throw new Error("Missing location")}}]),e}()),Te=Me;function Re(e){return function(t,n){var r=n().tableData[e];return Te.delVertex(e),void 0===r?Promise.resolve():Promise.resolve(t({type:"DELETE_CELL_DATA",payload:e}))}}var De=Object(h.b)("CLOSE_CELL_INPUTTER"),Le=Object(x.a)("div",{target:"e1rvd88v0"})({name:"1ofvsjm",styles:"display:flex;align-items:center;border:2px solid transparent;line-height:1.1em;height:100%;width:100%;padding:2px;:focus{border:2px solid salmon;}"});var Ue=function(e){var t=e.fwdRef,n=e.location,r=e.result,i=e.onClick,a=e.onKeyDown,o=e.onDoubleClick,s=e.onFocus;return Object(c.d)(Le,{ref:t,"data-cell":"result","data-location":n,css:function(){var e={};return"number"===typeof r&&(e={whiteSpace:"nowrap",textOverflow:"clip",overflow:"hidden"}),e}(),tabIndex:"0",onClick:i,onKeyDown:a,onDoubleClick:o,onFocus:s},r)},Ae=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(N.a)(this,Object(S.a)(t).call(this))).handleOnClick=n.handleOnClick.bind(Object(M.a)(n)),n.handleOnDoubleClick=n.handleOnDoubleClick.bind(Object(M.a)(n)),n.handleOnFocus=n.handleOnFocus.bind(Object(M.a)(n)),n.handleOnKeyDown=n.handleOnKeyDown.bind(Object(M.a)(n)),n.refDatum=e.fwdRef,n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"openCellInputter",value:function(e){var t=this.refDatum.current.getBoundingClientRect(),n=JSON.parse(JSON.stringify(t));this.props.openCellInputter(n,e)}},{key:"handleOnFocus",value:function(){this.props.setActiveCell(this.props.location)}},{key:"handleOnClick",value:function(e){e.stopPropagation()}},{key:"handleOnDoubleClick",value:function(e){e.stopPropagation(),this.openCellInputter(!1)}},{key:"handleOnKeyDown",value:function(e){var t=e.key;["Delete","Backspace"].includes(t)?(""+this.props.result).length>0&&this.props.clearCellData(this.props.location):1===t.length&&this.openCellInputter(!0)}},{key:"render",value:function(){return i.a.createElement(Ue,{fwdRef:this.refDatum,location:this.props.location,result:this.props.result,onClick:this.handleOnClick,onDoubleClick:this.handleOnDoubleClick,onFocus:this.handleOnFocus,onKeyDown:this.handleOnKeyDown})}}]),t}(i.a.PureComponent);var Fe={clearCellData:Re,openCellInputter:function(e,t){return function(n,r){var i=t?"":r().global.activeCell.entered;return Promise.resolve(n({type:"OPEN_CELL_INPUTTER",payload:{isCellInputterOpen:!0,newEntered:i,cellRect:e}}))}},setActiveCell:function(e){return function(t,n){var r=(n().tableData[e]||{}).entered||"";return Promise.resolve(t({type:"SET_ACTIVE_CELL",payload:{location:e,entered:r}}))}}},Pe=Object(s.b)(function(e,t){var n=e.tableData[t.location];return{result:n?n.result:""}},Fe)(Ae),Ve=n(19),Be=Object(x.a)("div",{target:"e17q3q8l0"})("cursor:cell;overflow:hidden;font-size:13px;border-right:1px solid ",function(e){return e.theme.colors.cell.border},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.border},";outline:none;");function We(e){var t=e.width,n=e.height,r=e.onClick,i=e.onDoubleClick,a=e.children;return Object(c.d)(Be,{"data-cell":"border",onClick:r,onDoubleClick:i,css:Object(Ve.a)({width:t,height:n&&n})},a)}We.defaultProps={width:140};var ze=Object(s.b)(function(e,t){var n=t.location.split("-"),r=Object(L.a)(n,2),i=r[0],a=r[1];return{width:e.tableMeta.colWidths[i],height:e.tableMeta.rowHeights[a]}})(We),_e=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(N.a)(this,Object(S.a)(t).call(this))).refDatum=i.a.createRef(),e.handleOnClick=e.handleOnClick.bind(Object(M.a)(e)),e.handleOnDoubleClick=e.handleOnDoubleClick.bind(Object(M.a)(e)),e}return Object(T.a)(t,e),Object(I.a)(t,[{key:"focusDatum",value:function(){var e=this;setTimeout(function(){return e.refDatum.current.focus()},0)}},{key:"handleOnClick",value:function(){this.focusDatum()}},{key:"handleOnDoubleClick",value:function(){this.focusDatum()}},{key:"render",value:function(){var e=this.props.location;return i.a.createElement(ze,{onClick:this.handleOnClick,onDoubleClick:this.handleOnDoubleClick,location:e},i.a.createElement(Pe,{location:e,fwdRef:this.refDatum}))}}]),t}(i.a.PureComponent),He=Object(x.a)("div",{target:"exk1gay0"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"});var Ke=function(e){var t=e.rowNumber,n=e.colLabels;return i.a.createElement(He,{"data-row":t},i.a.createElement(ae,{label:t}),new Array(n.length).fill(0).map(function(e,r){var a="".concat(n[r],"-").concat(t);return i.a.createElement(_e,{key:r,location:a})}))};var qe={id:"keyboardNav",initial:"idle",context:{columns:null,rows:null,key:null,colIndex:null,rowIndex:null,endLocation:null,wasFocused:!1},states:{idle:{on:{MOVE_FOCUS:{actions:["setNewContext","calcTargetLocation"],target:"focusTarget"}}},focusTarget:{invoke:{src:function(e){return e.endLocation?new Promise(function(t){setTimeout(function(){var n='[data-location="'.concat(e.endLocation,'"]'),r=document.querySelector(n);r&&r.focus(),t(!0)},0)}):Promise.resolve(!1)},onDone:{actions:Object(R.b)({wasFocused:function(e,t){return t.data}}),target:"idle"}}}}},Xe={actions:{setNewContext:Object(R.b)(function(e,t){var n=t.key,r=V(t.location),i=Object(L.a)(r,2);return{colIndex:i[0],rowIndex:i[1],key:n}}),calcTargetLocation:Object(R.b)({endLocation:function(e){return function(e){var t=e.rows,n=e.columns,r=e.rowIndex,i=e.colIndex;switch(e.key){case"ArrowUp":r=Math.max(0,r-1);break;case"ArrowRight":i=Math.min(n-1,i+1);break;case"ArrowDown":case"Enter":r=Math.min(t-1,r+1);break;case"ArrowLeft":i=Math.max(0,i-1);break;default:return null}var a=P(i),o=""+(r+1);return"".concat(a,"-").concat(o)}(e)}})}};var Ge=function(e,t){var n=Object(d.a)({},qe.context,{columns:t,rows:e});return Object(R.a)(qe,Xe,n)},Qe=Object(x.a)("div",{target:"e1tmjcr20"})("display:flex;flex-direction:column;width:fit-content;overflow:hidden;border-top:2px solid ",function(e){return e.theme.colors.cell.borderDark},";border-left:2px solid ",function(e){return e.theme.colors.cell.borderDark},";border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";*{box-sizing:border-box;}"),Ye=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(N.a)(this,Object(S.a)(t).call(this,e))).keyboardNavMachine=Ge(n.props.rows,n.props.columns),n.focusService=Object(R.c)(n.keyboardNavMachine),n.handleTableOnClick=n.handleTableOnClick.bind(Object(M.a)(n)),n.handleTableOnKeyDown=n.handleTableOnKeyDown.bind(Object(M.a)(n)),n.colLabels=F(e.columns),n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.focusService.start()}},{key:"componentWillUnmount",value:function(){this.focusService.stop()}},{key:"handleTableOnClick",value:function(e){e.stopPropagation()}},{key:"handleTableOnKeyDown",value:function(e){e.stopPropagation(),e.target.dataset.location&&this.moveFocus(e.key,e.target.dataset.location)}},{key:"moveFocus",value:function(e,t){this.focusService.send({type:"MOVE_FOCUS",key:e,location:t})}},{key:"renderColHeaderRow",value:function(e){return i.a.createElement(ee,{key:e,rows:this.props.rows,colLabels:this.colLabels})}},{key:"renderDataRows",value:function(e){return i.a.createElement(Ke,{key:e,rowNumber:e,colLabels:this.colLabels})}},{key:"renderRows",value:function(){var e=this;return new Array(this.props.rows+1).fill(0).map(function(t,n){return 0===n?e.renderColHeaderRow(n):e.renderDataRows(n)})}},{key:"render",value:function(){return i.a.createElement(Qe,{"data-table":"app",onClick:this.handleTableOnClick,onKeyDown:this.handleTableOnKeyDown},this.renderRows())}}]),t}(i.a.PureComponent),Je=Object(s.b)(function(e){var t=e.global;return{rows:t.rows,columns:t.columns}})(Ye),$e=i.a.createContext(),Ze=Object(x.a)("div",{target:"e12j1gm0"})("background:",function(e){return e.theme.colors.dropdown.normal},";margin-top:1px;box-shadow:0 0 5px ",function(e){return e.theme.colors.shadow},";border:1px solid ",function(e){return e.theme.colors.dropdown.active},";width:300px;padding:6px 8px;"),et=Object(x.a)("pre",{target:"e12j1gm1"})({name:"p8bxbz",styles:"line-height:1em;padding-bottom:3px;font-size:14px;"}),tt=Object(x.a)("div",{target:"e12j1gm2"})({name:"11i7ysg",styles:"padding-top:12px;font-size:12px;"}),nt=Object(x.a)("p",{target:"e12j1gm3"})({name:"kcaog3",styles:"line-height:1em;font-size:13px;"}),rt=Object(x.a)("hr",{target:"e12j1gm4"})("border:0;border-top:1px solid ",function(e){return e.theme.colors.dropdown.active},";"),it={name:"1gdm77d",styles:"padding-bottom:6px;"},at=function(e){function t(){return Object(C.a)(this,t),Object(N.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(I.a)(t,[{key:"getFnScope",value:function(){var e,t=this.props,n=t.fnScopes,r=t.cursorPos,i=!0,a=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(!(r>=l.startIndex+1))break;e=l}}catch(c){a=!0,o=c}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return e&&null===e.endIndex?e:e&&r-1<e.endIndex?e:null}},{key:"getFnNode",value:function(e){var t=e.fnName.toUpperCase();return ce[t]}},{key:"render",value:function(){var e=this.getFnScope(),t=this.context.inputRect;if(!t)return null;var n,r=t.bottom,i=t.left;return e?(n=this.getFnNode(e),Object(c.d)(Ze,{css:Object(Ve.a)({top:r,left:i})},Object(c.d)(et,{css:it},n.definition),Object(c.d)(rt,null),Object(c.d)(tt,null,"Example"),Object(c.d)(et,null,n.example),Object(c.d)(tt,null,"Summary"),Object(c.d)(nt,null,n.summary))):null}}]),t}(i.a.PureComponent);at.contextType=$e;var ot=at,st=n(13),ut=n.n(st),lt=Object(x.a)("li",{target:"e9dst5h0"})({name:"10b12fz",styles:"outline:none;"});function ct(e){var t=e.item,n=e.index,r=e.isActive,i=e.onMouseEnter;return Object(c.d)(lt,{tabIndex:0,onMouseEnter:function(){return i(n)}},r&&t.active?t.active:t.base)}ct.defaultProps={onMouseEnter:function(){}};var ht=ct,dt=Object(x.a)("ul",{target:"ehyu2mo0"})({name:"12pmg09",styles:"position:fixed;margin:0;padding:0;list-style:none;"}),pt=function(e){function t(){return Object(C.a)(this,t),Object(N.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(I.a)(t,[{key:"renderListItems",value:function(){var e=this;return this.props.items.map(function(t,n){return i.a.createElement(ht,{key:n,index:n,item:t.item,style:Object(d.a)({},e.props.styles.li),isActive:t.isActive,onMouseEnter:e.props.onMouseEnter})})}},{key:"render",value:function(){var e=this.props,t=e.items,n=e.top,r=e.left,a=e.styles;return 0===t.length?null:i.a.createElement(dt,{tabIndex:-1,style:Object(d.a)({top:n,left:r},a.ul)},this.renderListItems())}}]),t}(i.a.PureComponent);pt.propsTypes={onMouseEnter:ut.a.func,items:ut.a.array.isRequired,top:ut.a.number.isRequired,left:ut.a.number.isRequired,styles:ut.a.shape({ul:ut.a.object,li:ut.a.object})};var ft=pt,vt=Object(x.a)("dialog",{target:"e1fqlcg50"})({name:"107tt68",styles:"border:0;"}),bt={name:"s7sq8v",styles:"padding:6px 8px;"},mt=Object(x.a)("div",{target:"e1fqlcg51"})(bt," background:",function(e){return e.theme.colors.dropdown.normal},";"),yt=Object(x.a)("div",{target:"e1fqlcg52"})(bt," background:",function(e){return e.theme.colors.dropdown.active},";"),gt=Object(x.a)("pre",{target:"e1fqlcg53"})({name:"p8bxbz",styles:"line-height:1em;padding-bottom:3px;font-size:14px;"}),Ot=Object(x.a)("div",{target:"e1fqlcg54"})({name:"1qxtz39",styles:"font-size:12px;"}),kt=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(N.a)(this,Object(S.a)(t).call(this))).state={listItems:[],itemIndex:0,keyEvent:null,isVisible:!1},e.handleOnClick=e.handleOnClick.bind(Object(M.a)(e)),e.setIndex=e.setIndex.bind(Object(M.a)(e)),e}return Object(T.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({itemIndex:0},function(){e.setListItems()})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.listItems!==t.listItems}},{key:"componentDidUpdate",value:function(e,t){this.updateContextData(t),this.updateListItems(e),this.keyActions()}},{key:"componentWillUnmount",value:function(){this.context.setIsFuncSelectorVisible(!1)}},{key:"updateListItems",value:function(e){var t=this;e.token!==this.props.token&&this.setState({itemIndex:0},function(){t.setListItems()})}},{key:"updateContextData",value:function(e){var t=this.context.keyEvent;e.keyEvent!==t&&(this.setState({keyEvent:t}),this.keyEventSetIndex(t))}},{key:"keyActions",value:function(){var e=this.context.keyEvent;this.state.keyEvent!==e&&["Enter","Tab"].includes(e.key)&&this.state.isVisible&&this.updateInputValue()}},{key:"updateInputValue",value:function(){var e=this.context.inputValue,t=this.props.token,n=this.state.listItems[this.state.itemIndex].fnName,r=t.index+t.text.length,i=e.slice(0,t.index),a=e.slice(r),o="".concat(i).concat(n,"(").concat(a),s=i.length+n.length+1;this.context.setInputValue(o,s)}},{key:"setListItems",value:function(){var e,t=this,n=this.props.token.text.toUpperCase(),r=Object.keys(ce).filter(function(e){return e.startsWith(n)}).sort().map(function(e){return{item:{base:t.itemBase(e),active:t.itemActive(e)},isActive:!1,fnName:e}}),i=!1;e=Math.max(Math.min(r.length-1,this.state.itemIndex),0),r.length>0&&(r[e].isActive=i=!0),this.context.setIsFuncSelectorVisible(i),this.setState({listItems:r,itemIndex:e,isVisible:i})}},{key:"keyEventSetIndex",value:function(e){var t=this,n=this.state.itemIndex;switch(e.key){case"ArrowUp":n=this.state.itemIndex-1;break;case"ArrowDown":n=this.state.itemIndex+1}this.setState({itemIndex:n},function(){t.setListItems()})}},{key:"setIndex",value:function(e){var t=this;this.setState({itemIndex:e},function(){t.setListItems()})}},{key:"itemBase",value:function(e){return Object(c.d)(mt,null,Object(c.d)(gt,null,e))}},{key:"itemActive",value:function(e){return Object(c.d)(yt,null,Object(c.d)(gt,null,e),Object(c.d)(Ot,null,ce[e].summary))}},{key:"getListStyles",value:function(){var e=this.props.theme;return{ul:{marginTop:1,boxShadow:"0 0 5px ".concat(e.colors.shadow),border:"1px solid ".concat(e.colors.dropdown.active),width:300}}}},{key:"handleOnClick",value:function(){this.updateInputValue()}},{key:"render",value:function(){var e=this.state,t=e.listItems,n=e.isVisible,r=this.context.inputRect;return Object(c.d)(vt,{open:n,onClick:this.handleOnClick},Object(c.d)(ft,{items:t,top:Math.round(r.bottom),left:Math.round(r.left),styles:this.getListStyles(),onMouseEnter:this.setIndex}))}}]),t}(i.a.Component);kt.contextType=$e;var wt=Object(l.b)(kt),xt=function(e){function t(){var e,n;Object(C.a)(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(n=Object(N.a)(this,(e=Object(S.a)(t)).call.apply(e,[this].concat(i)))).state={fnScopes:[]},n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.setFnScopes()}},{key:"componentDidUpdate",value:function(e){e.tokens!==this.props.tokens&&this.setFnScopes()}},{key:"setFnScopes",value:function(){var e=[],t=[],n=!0,r=!1,i=void 0;try{for(var a,o=this.props.tokens[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.type===pe.FUNCTION){var u={fnName:s.text,startIndex:s.index,endIndex:null};e.push(u),t.push(u)}else if(s.type===pe.LPAREN)e.push("(");else if(s.type===pe.RPAREN){if(e.pop(),e.length>0&&"("!==e[e.length-1])e.pop().endIndex=s.index-1}}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}t.sort(function(e,t){return e.startIndex-t.startIndex}),this.setState({fnScopes:t})}},{key:"getCurrTokenIndex",value:function(e,t){var n;for(n=0;n<e.length;n++){var r=e[n],i=r.index+r.text.length;if(t>r.index&&t<=i)break}return n}},{key:"getCompareTokens",value:function(){var e=this.props,t=e.tokens,n=e.cursorPos,r=this.getCurrTokenIndex(t,n);return[r>0&&t[r-1],t[r],r<t.length-2&&t[r+1]]}},{key:"getFuncSelector",value:function(){var e=this.getCompareTokens(),t=Object(L.a)(e,3),n=t[0],r=t[1],a=t[2];if(this.props.tokens.length<2)return null;var o=n&&r&&a&&"operator"===n.category&&[pe.UNKNOWN,pe.FUNCTION].includes(r.type)&&a.type!==pe.RPAREN,s=n&&r&&!a&&[pe.UNKNOWN,pe.FUNCTION].includes(r.type);return o||s?i.a.createElement(wt,{token:r}):void 0}},{key:"render",value:function(){var e=this.getFuncSelector();return e||i.a.createElement(ot,{cursorPos:this.props.cursorPos,fnScopes:this.state.fnScopes})}}]),t}(i.a.PureComponent);xt.defaultProps={cursorPos:0};var jt=xt,Et=Object(x.a)("input",{target:"eiy8a0f0"})("align-items:center;background-color:white;border:2px solid salmon;box-shadow:0 0 5px ",function(e){return e.theme.colors.shadow},";box-sizing:border-box;display:flex;font-size:13px;height:100%;outline:none;padding:2px;width:100%;"),Ct=Object(x.a)(Et,{target:"ekrhoit0"})({name:"14h8fd2",styles:"position:absolute;margin-top:-200vh;visibility:hidden;"}),It=function(e){function t(){var e,n;Object(C.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(N.a)(this,(e=Object(S.a)(t)).call.apply(e,[this].concat(a)))).refInput=i.a.createRef(),n}return Object(T.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.setInputWidth()}},{key:"componentDidUpdate",value:function(e,t){this.setInputWidth()}},{key:"setInputWidth",value:function(){var e=this.props.cellWidth,t=this.refInput.current,n=t.scrollWidth,r=n>t.getBoundingClientRect().width?Math.max(e,n+15):e;this.props.setInputWidth(r)}},{key:"render",value:function(){return Object(c.d)(Ct,{ref:this.refInput,defaultValue:this.props.value,css:Object(Ve.a)({width:this.props.cellWidth-15})})}}]),t}(i.a.PureComponent),Nt=Object(x.a)("input",{target:"e1spccyr0"})("align-items:center;background-color:white;border:2px solid salmon;box-shadow:0 0 5px ",function(e){return e.theme.colors.shadow},";box-sizing:border-box;display:flex;font-size:13px;height:100%;outline:none;padding:2px;width:100%;");var St=function(e){var t=e.fwdRef,n=e.location,r=e.value,a=e.onChange,o=e.onKeyDown,s=e.onBlur;return i.a.createElement(Nt,{ref:t,"data-cell":"input","data-location":n,value:r,onChange:a,onKeyDown:o,onBlur:s})},Mt=Object(x.a)("div",{target:"e1tztyg90"})({name:"1b7bwed",styles:"position:fixed;"});var Tt=function(e){var t=e.top,n=e.left,r=e.width,i=e.height,a=e.children;return Object(c.d)(Mt,{css:Object(Ve.a)({top:t,left:n,width:r,height:i})},a)},Rt=function(){function e(t){Object(C.a)(this,e),this.c=t}return Object(I.a)(e,[{key:"run",value:function(){var e=this.c.state.keyEvent.key;this.c.state.isFuncSelectorVisible?this.funcSelector(e):this.default(e)}},{key:"funcSelector",value:function(e){switch(e){case"Escape":this.c.props.closeCellInputter();break;case"ArrowLeft":case"ArrowRight":this.c.setState({cursorPos:this.refInput.current.selectionEnd})}}},{key:"default",value:function(e){switch(e){case"Escape":this.c.props.closeCellInputter();break;case"Enter":this.c.cellValueSetter.run(),this.c.props.closeCellInputter();break;case"ArrowLeft":case"ArrowRight":this.c.setState({cursorPos:this.c.refInput.current.selectionEnd})}}}]),e}(),Dt=function(){function e(t){Object(C.a)(this,e),this.c=t}return Object(I.a)(e,[{key:"run",value:function(){var e,t=this.c.state.keyEvent.key,n=this.c.props.location;e=this.c.state.isFuncSelectorVisible?this.funcSelectorElId(t,n):this.defaultElId(t,n),this.focusElement(e)}},{key:"funcSelectorElId",value:function(e,t){if("Escape"===e)return'[data-cell="result"][data-location="'.concat(t,'"]')}},{key:"defaultElId",value:function(e,t){switch(e){case"Tab":return'[data-cell="result"][data-location="'.concat(t,'"]');case"Enter":return this.defaultEnter(t);case"Escape":return'[data-cell="result"][data-location="'.concat(t,'"]')}}},{key:"defaultEnter",value:function(e){var t=V(e),n=Object(L.a)(t,2),r=n[0],i=n[1],a=Math.min(this.c.props.rows-1,i+1),o=P(r),s=""+(a+1),u="".concat(o,"-").concat(s);return'[data-cell="result"][data-location="'.concat(u,'"]')}},{key:"focusElement",value:function(e){if(e){var t=document.querySelector(e);document.activeElement!==t&&t.focus()}}}]),e}(),Lt=function(){function e(t){Object(C.a)(this,e),this.c=t}return Object(I.a)(e,[{key:"run",value:function(){var e,t=this.c.props.location,n=this.c.state.inputValue;this.isWhitespace(n)?this.c.props.clearCellData(t):(e=this.isFormula(n)?this.sanitizeValue(n):n,this.c.props.setCellData(t,e))}},{key:"isFormula",value:function(e){return e.length>0&&"="===e[0]}},{key:"isWhitespace",value:function(e){return 0===e.length||Boolean(e.match(/^\s+$/))}},{key:"sanitizeValue",value:function(e){return new me(e).getTokens().map(function(e){switch(e.type){case pe.FUNCTION:return e.text.toUpperCase();case pe.NUMBER:return e.value;default:return e.text}}).join("")}}]),e}(),Ut=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(N.a)(this,Object(S.a)(t).call(this))).state={tokens:[],isFuncSelectorVisible:!1,inputValue:"",keyEvent:{key:""},cursorPos:0,width:null},e.refInput=i.a.createRef(),e.handleOnKeyDown=e.handleOnKeyDown.bind(Object(M.a)(e)),e.handleOnBlur=e.handleOnBlur.bind(Object(M.a)(e)),e.handleOnChange=e.handleOnChange.bind(Object(M.a)(e)),e.setIsFuncSelectorVisible=e.setIsFuncSelectorVisible.bind(Object(M.a)(e)),e.setInputValue=e.setInputValue.bind(Object(M.a)(e)),e.setInputWidth=e.setInputWidth.bind(Object(M.a)(e)),e.keyboardActions=new Rt(Object(M.a)(e)),e.keyboardFocuser=new Dt(Object(M.a)(e)),e.cellValueSetter=new Lt(Object(M.a)(e)),e}return Object(T.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.focusInputTag(),this.setInputValue(this.props.newEntered)}},{key:"componentDidUpdate",value:function(e,t){t.keyEvent!==this.state.keyEvent&&(this.keyboardFocuser.run(),this.keyboardActions.run()),t.inputValue!==this.state.inputValue&&this.tokenizeInputValue()}},{key:"setInputWidth",value:function(e){this.state.width!==e&&this.setState({width:e})}},{key:"tokenizeInputValue",value:function(){var e=this.state.inputValue,t=new me(e).getTokens();this.setState({tokens:t})}},{key:"focusInputTag",value:function(){var e=this.refInput.current;setTimeout(function(){e.focus(),e.selectionStart=e.value.length},0)}},{key:"setIsFuncSelectorVisible",value:function(e){this.setState({isFuncSelectorVisible:e})}},{key:"setInputValue",value:function(e,t){var n=this.refInput.current;this.setState({inputValue:e,cursorPos:e.length},function(){n.focus(),n.selectionStart=t,n.selectionEnd=t})}},{key:"handleOnChange",value:function(e){var t=e.target.value,n=e.target.selectionStart;this.setState({inputValue:t,cursorPos:n})}},{key:"handleOnKeyDown",value:function(e){var t=e.key,n=e.target.value;this.state.isFuncSelectorVisible&&"Tab"===t&&e.preventDefault(),this.setState({keyEvent:{key:t},inputValue:n})}},{key:"handleOnBlur",value:function(e){var t=this;this.state.isFuncSelectorVisible||this.setState({inputValue:e.target.value},function(){t.cellValueSetter.run(),t.props.closeCellInputter()})}},{key:"render",value:function(){var e=this.refInput.current,t=e&&e.getBoundingClientRect(),n=this.props.cellRect,r=n.top,a=n.left,o=n.height,s=n.width,u=this.state.width||s;return i.a.createElement($e.Provider,{value:{inputRect:t,setIsFuncSelectorVisible:this.setIsFuncSelectorVisible,setInputValue:this.setInputValue,keyEvent:this.state.keyEvent,inputValue:this.state.inputValue}},i.a.createElement(Tt,{width:u,height:o,top:r,left:a},i.a.createElement(It,{value:this.state.inputValue,cellWidth:u,setInputWidth:this.setInputWidth}),i.a.createElement(St,{fwdRef:this.refInput,location:this.props.location,value:this.state.inputValue,onChange:this.handleOnChange,onKeyDown:this.handleOnKeyDown,onBlur:this.handleOnBlur}),i.a.createElement(jt,{tokens:this.state.tokens,cursorPos:this.state.cursorPos})))}}]),t}(i.a.PureComponent);var At={setCellData:function(e,t){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:new Ne(e).interpret(t)}}}},clearCellData:Re,closeCellInputter:De},Ft=Object(s.b)(function(e){var t=e.global,n=t.cellInputter,r=n.isCellInputterOpen,i=n.newEntered,a=n.cellRect,o=t.activeCell;return{location:o.location,entered:o.entered,newEntered:i,isCellInputterOpen:r,cellRect:a,rows:t.rows,columns:t.columns}},At)(Ut),Pt=Object(x.a)("div",{target:"e4x97se0"})({name:"pl3zfx",styles:'display:grid;grid:"left-blank main right-blank" 100vh / auto minmax(auto,1000px) auto;'}),Vt=Object(x.a)("main",{target:"e4x97se1"})({name:"n7iznt",styles:"grid-area:main;"});var Bt=Object(s.b)(function(e){return{isCellInputterOpen:e.global.cellInputter.isCellInputterOpen}})(function(e){var t=e.isCellInputterOpen;return i.a.createElement(Pt,null,i.a.createElement(Vt,null,t&&i.a.createElement(Ft,null),i.a.createElement("div",{"data-dummy-focus-stop":!0,tabIndex:"0"}),i.a.createElement(E,null),i.a.createElement(Je,null)))});var Wt=function(){return i.a.createElement(s.a,{store:m},i.a.createElement(u.a,null,i.a.createElement(l.a,{theme:k},i.a.createElement(c.a,{styles:w}),i.a.createElement(Bt,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Wt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[53,1,2]]]);
//# sourceMappingURL=main.5efef471.chunk.js.map
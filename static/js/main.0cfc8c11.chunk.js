(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e,t,n){e.exports=n(66)},66:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(33),o=n.n(a),s=n(20),l=n(47),c=n(43),u=n(16),h=(n(59),n(26)),d=Object(h.c)({activeCell:null,rows:14,columns:6},{SET_ACTIVE_CELL:function(e,t){var n=t.payload;e.activeCell=n}}),f=Object(h.c)({},{SET_CELL_DATA:function(e,t){var n=t.payload,r=n.location,i=n.data;e[r]=i},DELETE_CELL_DATA:function(e,t){delete e[t.payload]}}),p=Object(h.a)({reducer:{global:d,table:f}}),v={xs:0,sm:420,md:900,lg:1200},b={xs:"sm",sm:"md",md:"lg"},y={xs:"@media (max-width: ".concat(v.sm-1,"px)"),sm:"@media (min-width: ".concat(v.sm,"px) and (max-width: ").concat(v.md-1,"px)"),md:"@media (min-width: ".concat(v.md,"px) and (max-width: ").concat(v.lg-1,"px)"),lg:"@media (min-width: ".concat(v.lg,"px)"),from:function(e){return"@media (min-width: ".concat(v[e],"px)")},upTo:function(e){return"@media (max-width: ".concat(v[b[e]]-1,"px)")}},m={colors:{text:"#3D3D3D",cell:{border:"#dfdfdf",borderDark:"#CCC",labelBkg:"#F5F5F5"},primary:{strong:"#E10D75"},field:{background:"#F0F0F0"}},breaks:v,queries:y},w=Object(u.c)("body{color:",m.colors.text,";line-height:1.3em;font-family:Arial,Helvetica,sans-serif;}table,th,td{border:0;border-spacing:0;border-collapse:collapse;}td{padding:0;line-height:1.2em;}p,h1,h2,h3,h4,h5,h6{margin:0;}"),O=n(8),k=Object(h.b)("SET_ACTIVE_CELL"),g=Object(O.a)("header",{target:"e1mq5pli0"})({name:"1rn5ure",styles:"width:100%;display:flex;flex-direction:column;align-items:center;padding:30px 0 30px;"});var E=function(){return i.a.createElement(g,null,i.a.createElement("h3",null,"Spreadsheet App"))},x=n(5),j=n(6),N=n(13),C=n(12),T=n(10),D=n(14),L=n(19),S=Object(O.a)("div",{target:"e1al44mo0"})("display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";font-size:12px;");var M=function(e){var t=e.label;return i.a.createElement(S,{"data-col":t,className:"col-label-width col-label-height"},t)},A=Object(O.a)("div",{target:"e1ia7370"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"}),U=Object(O.a)("div",{target:"e1ia7371"})("display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";");var I=function(e){var t=e.colLabels;return i.a.createElement(A,{"data-row":"header"},i.a.createElement(U,{className:"row-label-width col-label-height"}),new Array(t.length).fill(0).map(function(e,n){return i.a.createElement(M,{key:n,label:t[n]})}))},R=Object(O.a)("div",{target:"ewfjn6o0"})("font-size:12px;display:flex;align-items:center;justify-content:center;border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";background:",function(e){return e.theme.colors.cell.labelBkg},";");var F=function(e){var t=e.label;return i.a.createElement(R,{"data-row":t,className:"row-label-width row-label-height"},t)},P=Object(L.a)({id:"cell",initial:"static",states:{static:{initial:"notFocused",states:{focused:{},notFocused:{}},on:{EDITABLE_MODIFY:{target:"editable.modify"},EDITABLE_REPLACE:{target:"editable.replace"}}},editable:{states:{modify:{},replace:{}},on:{STATIC_FOCUSED:{target:"static.focused"},STATIC:{target:"static"}}}}}),V=n(22),B=n(29),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;Object(x.a)(this,e);var n=t.getState().global;this.store=t,this.rows=n.rows,this.columns=n.columns}return Object(j.a)(e,[{key:"getCellResult",value:function(e){var t=this.table[e];return t&&t.result}},{key:"replaceCellData",value:function(e,t,n){this.store.dispatch(function(e,t,n){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:n}}}}(e,t,n))}},{key:"clearCell",value:function(e){this.store.dispatch(he(e))}},{key:"table",get:function(){return this.store.getState().table}},{key:"locations",get:function(){return Object.keys(this.table)}}]),e}(),K=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(x.a)(this,e),this.type=t,this.text=n,this.value=null,this.html=null,this.whitespace=r}return Object(j.a)(e,[{key:"_repr",value:function(){return Object.entries(this).reduce(function(e,t){return null!==t[1]&&(e[t[0]]=t[1]),e},{})}}]),e}(),W="A".codePointAt(0);function z(e){for(var t=[],n=[""],r=e;r>0;){var i=[];e:for(var a=0,o=n;a<o.length;a++){var s=o[a],l=!0,c=!1,u=void 0;try{for(var h,d="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var f=h.value;if(0===r)break e;i.push("".concat(s).concat(f)),r-=1}}catch(p){c=!0,u=p}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}}n=i,t=[].concat(Object(B.a)(t),i)}return t}function X(e){var t=e.split("-"),n=Object(V.a)(t,2),r=n[0],i=n[1];return[r.split("").reduce(function(e,t){return 26*e+t.charCodeAt(0)-W+1},0)-1,+i-1]}function q(e){var t=Boolean(e.match(/^[.\d]+$/)),n=(e.match(/\./g)||[]).length;return!!t&&(!(n>1)&&(1!==e.length||"."!==e[0]))}var Q={EOF:"EOF",UNKNOWN:"UNKNOWN",EQUALS:"EQUALS",COMMA:"COMMA",COLON:"COLON",LPAREN:"LPAREN",RPAREN:"RPAREN",PLUS:"PLUS",MINUS:"MINUS",MULT:"MULT",DIV:"DIV",NUMBER:"NUMBER",CELL:"CELL",FUNCTION:"FUNCTION",TEXT:"TEXT"},J=Q,Y=function(){function e(t,n,r){Object(x.a)(this,e),this.regex=t,this.groupIndex=n,this.token=r}return Object(j.a)(e,[{key:"setIndex",value:function(e){this.regex.lastIndex=e}},{key:"test",value:function(e){return this.regex.exec(e)}}]),e}(),$=[new Y(/=/g,0,J.EQUALS),new Y(/,/g,0,J.COMMA),new Y(/:/g,0,J.COLON),new Y(/\(/g,0,J.LPAREN),new Y(/\)/g,0,J.RPAREN),new Y(/\+/g,0,J.PLUS),new Y(/\-/g,0,J.MINUS),new Y(/\*/g,0,J.MULT),new Y(/\//g,0,J.DIV),new Y(/[\d\.]+/g,0,J.NUMBER),new Y(/[a-z]+[\d]+/gi,0,J.CELL),new Y(/([a-z]+)\(/gi,1,J.FUNCTION)],G=function(){function e(t){Object(x.a)(this,e),this.input=t,this.index=0,this.char=this.initChar(t),this.markers=[],this.tokens=[]}return Object(j.a)(e,[{key:"getTokens",value:function(){for(;this.char!==J.EOF;){var e=this.nextToken();this.tokens.push(e)}return this.tokens}},{key:"nextToken",value:function(){if(this.char===J.EOF)return new K(J.EOF,J.EOF);if(!this.isFormula())return this.tokenTEXTorNUMBER();for(var e,t=this.getWhitespace(),n=0,r=$;n<r.length;n++){var i=r[n];i.setIndex(this.index);var a=i.test(this.input);if(a&&a.index===this.index){var o=a[i.groupIndex];e=new K(i.token,o,t),this.index+=o.length-1,this.consume();break}}return e||(e=this.tokenUNKNOWN(t)),e}},{key:"initChar",value:function(e){return 0===this.input.length&&(this.input="0"),e[this.index]}},{key:"tokenUNKNOWN",value:function(e){for(var t=[];!(this.isEOF()||this.isSeparator()||this.isWhitespace());)t.push(this.char),this.consume();var n=t.join("");return new K(J.UNKNOWN,n,e)}},{key:"tokenTEXTorNUMBER",value:function(){var e;return e=q(this.input)?new K(J.NUMBER,this.input):new K(J.TEXT,this.input),this.index=this.input.length-1,this.consume(),e}},{key:"consume",value:function(){this.index++,this.index<this.input.length?this.char=this.input[this.index]:this.char=J.EOF}},{key:"isFormula",value:function(){return"="===this.input[0]}},{key:"isEOF",value:function(){return this.char===J.EOF}},{key:"isWhitespace",value:function(){return!this.isEOF()&&Boolean(this.char.match(/\s/))}},{key:"isSeparator",value:function(){return Boolean(this.char.match(/[\(\)\+\-\/\*]/))}},{key:"getWhitespace",value:function(){for(var e=0;this.isWhitespace();)e++,this.consume();return Array(e).fill(" ").join("")}}]),e}(),H={AVERAGE:function(){if(0===arguments.length)throw new Error("Empty elements");return this.SUM.apply(this,arguments)/this.COUNT.apply(this,arguments)},CONCAT:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.reduce(function(e,t){return e+t},"")},COUNT:function(){return arguments.length},MAX:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.forEach(function(e){if("number"!==typeof e)throw new TypeError("".concat(e," is not a number"))}),Math.max.apply(Math,t)},MIN:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.forEach(function(e){if("number"!==typeof e)throw new TypeError("".concat(e," is not a number"))}),Math.min.apply(Math,t)},POWER:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(2!==t.length)throw new Error("Formula takes only two elements");var r=t[0],i=t[1];return Math.pow(r,i)},SQRT:function(){if(1!==arguments.length)throw new Error("Formula takes only one element");return Math.sqrt(arguments.length<=0?void 0:arguments[0])},SUM:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Empty elements");return t.reduce(function(e,t){return e+t})}};H.POW=H.POWER;var Z=H,ee=function(){function e(t){Object(x.a)(this,e),this._name=t}return Object(j.a)(e,[{key:"eval",value:function(){throw new Error("Implement method.")}}]),e}(),te=function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(N.a)(this,Object(C.a)(t).call(this,"TextNode"))).textNode=e,n}return Object(D.a)(t,e),Object(j.a)(t,[{key:"eval",value:function(){return this.textNode.text}}]),t}(ee),ne=function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(N.a)(this,Object(C.a)(t).call(this,"NumberNode"))).numberNode=e,n}return Object(D.a)(t,e),Object(j.a)(t,[{key:"eval",value:function(){if(q(this.numberNode.text))return this.setTokenValue(),this.value;throw new Error('Invalid number "'.concat(this.numberNode.text,'"'))}},{key:"setTokenValue",value:function(){var e=parseFloat(this.numberNode.text);this.numberNode.value=e}},{key:"value",get:function(){return this.numberNode.value}}]),t}(ee),re=function(e){function t(e){var n;return Object(x.a)(this,t),n=Object(N.a)(this,Object(C.a)(t).call(this,"CellNode")),e.value=n.getCellLabel(e),n.cell=e,n}return Object(D.a)(t,e),Object(j.a)(t,[{key:"getCellLabel",value:function(e){var t=e.text,n=t.match(/\d+/).index,r=t.slice(0,n).toUpperCase(),i=t.slice(n);return"".concat(r,"-").concat(i)}},{key:"location",get:function(){return this.cell.value}}]),t}(ee),ie=function(e){function t(e,n){var r;return Object(x.a)(this,t),(r=Object(N.a)(this,Object(C.a)(t).call(this,"UnaryOp"))).opNode=e,r.expr=n,r}return Object(D.a)(t,e),Object(j.a)(t,[{key:"eval",value:function(e){return this.opNode.type===Q.PLUS?e:this.opNode.type===Q.MINUS?-e:void 0}}]),t}(ee),ae=function(e){function t(e,n){var r;return Object(x.a)(this,t),(r=Object(N.a)(this,Object(C.a)(t).call(this,"FuncOp"))).funcNode=e,r.argNodes=n,r}return Object(D.a)(t,e),Object(j.a)(t,[{key:"eval",value:function(e){return this.getFunction().apply(void 0,Object(B.a)(e))}},{key:"getFunction",value:function(){var e=Z[this.funcNode.text.toUpperCase()];if(e)return e;throw new Error("Formula ".concat(this.funcNode.text," not found"))}}]),t}(ee),oe=function(e){function t(e,n,r){var i;return Object(x.a)(this,t),(i=Object(N.a)(this,Object(C.a)(t).call(this,"BinaryOp"))).leftNode=e,i.opNode=n,i.rightNode=r,i}return Object(D.a)(t,e),Object(j.a)(t,[{key:"eval",value:function(e,t){switch(this.opNode.type){case Q.PLUS:return e+t;case Q.MINUS:return e-t;case Q.DIV:if(0===t)throw new Error("Division by zero: ".concat(e,"/").concat(t));return e/t;case Q.MULT:return e*t;default:throw new Error('Unsupported operator "'.concat(this.token.text,'"'))}}}]),t}(ee),se=function(){function e(t){Object(x.a)(this,e),this.index=0,this.tokens=t,this.curr=this.tokens[0],this.ast=null,this.hasCellRefs=!1}return Object(j.a)(e,[{key:"parse",value:function(){switch(this.peekType()){case Q.TEXT:this.ast=this.text();break;case Q.NUMBER:this.ast=this.number();break;default:this.equals(),this.ast=this.expr()}if(null!==this.curr)throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));return this.ast}},{key:"expr",value:function(){var e,t,n;for(e=this.term();[Q.PLUS,Q.MINUS].includes(this.peekType());)t=this.operator(),n=this.term(),e=new oe(e,t,n);return e}},{key:"term",value:function(){var e,t,n;for(e=this.factor();[Q.MULT,Q.DIV].includes(this.peekType());)t=this.operator(),n=this.factor(),e=new oe(e,t,n);return e}},{key:"factor",value:function(){switch(this.peekType()){case Q.PLUS:case Q.MINUS:return this.unaryOp();case Q.NUMBER:return this.number();case Q.CELL:return this.cell();case Q.LPAREN:return this.enclosedExpr();case Q.FUNCTION:return this.func();case Q.RPAREN:throw new Error("Unexpected term at index ".concat(this.index,': "').concat(this.curr.text,'"'));default:throw new Error("Missing factor")}}},{key:"text",value:function(){var e;if(this.peekType()!==Q.TEXT)throw new Error("Missing string");return e=new te(this.curr),this.consume(),e}},{key:"number",value:function(){if(this.peekType()===Q.NUMBER){var e=new ne(this.curr);return this.consume(),e}throw new Error("Missing number")}},{key:"operator",value:function(){if([Q.PLUS,Q.MINUS,Q.MULT,Q.DIV].includes(this.peekType())){var e=this.curr;return this.consume(),e}throw new Error("Missing operator")}},{key:"enclosedExpr",value:function(){this.lparen();var e=this.expr();return this.rparen(),e}},{key:"cell",value:function(){if(this.peekType()!==Q.CELL)throw new Error("Missing cell node");var e=new re(this.curr);return this.hasCellRefs=!0,this.consume(),e}},{key:"func",value:function(){if(this.peekType()!==Q.FUNCTION)throw new Error("Missing function");var e=this.curr;this.consume(),this.lparen();var t=this.args();return this.rparen(),new ae(e,t)}},{key:"args",value:function(){var e=[],t=this.term();for(e.push(t);this.peekType()===Q.COMMA;)this.consume(),t=this.term(),e.push(t);return e}},{key:"equals",value:function(){if(this.peekType()!==Q.EQUALS)throw new Error("Missing equals sign");this.consume()}},{key:"lparen",value:function(){if(this.peekType()!==Q.LPAREN)throw new Error("Missing left parenthesis");this.consume()}},{key:"rparen",value:function(){if(this.peekType()!==Q.RPAREN)throw new Error("Missing right parenthesis");this.consume()}},{key:"unaryOp",value:function(){if(![Q.PLUS,Q.MINUS].includes(this.peekType()))throw new Error("Missing unary operator");var e=this.curr;return this.consume(),new ie(e,this.factor())}},{key:"consume",value:function(){this.index<this.tokens.length-1?(this.index++,this.curr=this.tokens[this.index]):this.curr=null}},{key:"peekType",value:function(){return this.curr&&this.curr.type}}]),e}(),le=function(){function e(t){Object(x.a)(this,e),this.location=t,this.error=null,this.cache={},this.result=null,this.state=new _}return Object(j.a)(e,[{key:"interpret",value:function(e){var t,n,r=ue.addVertex(this.location,e);try{t=new G(e),n=new se(t.getTokens()),r.ast=n.parse(),ue.recalculate(this.location),this.result=r.result}catch(i){return this.error=r.error=i,this.result=r.result=this.errorResponse(),this.result}return this.error=r.error,this.result}},{key:"visit",value:function(e){var t=ue.getVertex(e);if(ue.isResolved(e))return t.result;if(ue.markVisited(e),!t.ast)return t.result;try{this.result=t.result=this._visit(t.ast)}catch(n){throw this.error=t.error=n,this.result=t.result=this.errorResponse(),n}return this.result}},{key:"_visit",value:function(e){switch(e._name){case"NumberNode":return this.NumberNode(e);case"CellNode":return this.CellNode(e);case"TextNode":return this.TextNode(e);case"FuncOp":return this.FuncOp(e);case"BinaryOp":return this.BinaryOp(e);case"UnaryOp":return this.UnaryOp(e);default:var t=e._name||(e.constructor||{}).name;throw new Error("Unrecognized AST node ".concat(t))}}},{key:"TextNode",value:function(e){return e.eval()}},{key:"NumberNode",value:function(e){return e.eval()}},{key:"CellNode",value:function(e){var t,n=e.location;if(!this.isLocationValid(n))throw new Error("Location out of bounds");if(void 0!==this.cache[n])return this.cache[n];if(ue.isVisited(n))throw new Error("Circular reference");return t=this.dfsCellVisit(n),this.cache[n]=t,t}},{key:"UnaryOp",value:function(e){var t=this._visit(e.expr);return e.eval(t)}},{key:"FuncOp",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.argNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=this._visit(s);t.push(l)}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e.eval(t)}},{key:"BinaryOp",value:function(e){var t=this._visit(e.leftNode),n=this._visit(e.rightNode);return e.eval(t,n)}},{key:"isLocationValid",value:function(e){var t=X(e),n=Object(V.a)(t,2),r=n[0],i=n[1];return!(Math.min(r,i)<0)&&(!(r>=this.state.columns)&&!(i>=this.state.rows))}},{key:"dfsCellVisit",value:function(t){var n=new e(t),r=0;return ue.hasVertex(t)&&(r=n.visit(t)),r}},{key:"errorResponse",value:function(){var e=this.error.message;return e.match(/division by zero/i)?"#DIV/0!":e.match(/circular reference/i)?"#REF!":"#ERROR!"}}]),e}(),ce=function e(t){Object(x.a)(this,e),this.entered=t,this.error=null,this.result=null,this.ast=null},ue=new(function(){function e(){Object(x.a)(this,e),this.adj={},this.pending=null,this.visited=null,this.store=new _}return Object(j.a)(e,[{key:"interpret",value:function(e,t){return new le(e).interpret(t)}},{key:"recalculate",value:function(e){this.setPendingNodes(),this.dfs(e),this.updateStore()}},{key:"getCellResult",value:function(e){return this.hasVertex(e)?this.getVertex(e).result:""}},{key:"setPendingNodes",value:function(){var e=this;this.pending=new Set,Object.keys(this.adj).forEach(function(t){e.pending.add(t)})}},{key:"isResolved",value:function(e){return this.isVisited(e)||!this.isPending(e)}},{key:"isVisited",value:function(e){return this.visited.has(e)}},{key:"isPending",value:function(e){return this.pending.has(e)}},{key:"dfs",value:function(e){for(var t=this;this.pending.size>0;){this.visited=new Set,e||(e=Object(B.a)(this.pending)[0]);try{new le(e).visit(e)}catch(n){}this.visited.forEach(function(e){return t.pending.delete(e)}),e=null}}},{key:"updateStore",value:function(){for(var e=new Set(this.store.locations),t=0,n=Object.entries(this.adj);t<n.length;t++){var r=n[t],i=Object(V.a)(r,2),a=i[0],o=i[1],s=o.entered,l=o.result;e.delete(a),l!==this.store.getCellResult(a)&&this.store.replaceCellData(a,s,l)}var c=!0,u=!1,h=void 0;try{for(var d,f=e[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var p=d.value;this.store.clearCell(p)}}catch(v){u=!0,h=v}finally{try{c||null==f.return||f.return()}finally{if(u)throw h}}}},{key:"markVisited",value:function(e){return this.visited.add(e)}},{key:"addVertex",value:function(e,t){var n=new ce(t);return this.adj[e]=n,n}},{key:"hasVertex",value:function(e){return e in this.adj}},{key:"getVertex",value:function(e){return this.testMissingLocation(e),this.adj[e]}},{key:"delVertex",value:function(e){e in this.adj&&(delete this.adj[e],this.recalculate())}},{key:"resetAll",value:function(){this.adj={},this.pending=null,this.visited=null,this.store=new _}},{key:"testMissingLocation",value:function(e){if(!this.hasVertex(e))throw new Error("Missing location")}}]),e}());function he(e){return function(t,n){var r=n().table[e];return ue.delVertex(e),void 0===r?Promise.resolve():Promise.resolve(t({type:"DELETE_CELL_DATA",payload:e}))}}var de=Object(O.a)("input",{target:"ep2oxkq0"})({name:"wltid4",styles:"display:flex;align-items:center;outline:none;height:100%;width:100%;border:2px solid salmon;padding:2px;box-sizing:border-box;"}),fe=function(e){function t(){var e;return Object(x.a)(this,t),(e=Object(N.a)(this,Object(C.a)(t).call(this))).refInput=i.a.createRef(),e.handleOnKeyDown=e.handleOnKeyDown.bind(Object(T.a)(e)),e.handleOnBlur=e.handleOnBlur.bind(Object(T.a)(e)),e}return Object(D.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.focusInputTag()}},{key:"focusInputTag",value:function(){var e=this.refInput.current;e.focus(),e.scrollLeft=e.scrollWidth}},{key:"setNewValue",value:function(e){var t=this.props.location;this.isWhitespace(e)?this.props.clearCellData(t):this.props.setCellData(t,e)}},{key:"handleOnKeyDown",value:function(e){var t=e.key;"Escape"===t?this.props.onEscape():"Enter"===t?(this.setNewValue(e.target.value),this.props.onCommit()):e.stopPropagation()}},{key:"handleOnBlur",value:function(e){this.setNewValue(e.target.value),this.props.onCommit()}},{key:"isWhitespace",value:function(e){return 0===e.length||Boolean(e.match(/^\s+$/))}},{key:"render",value:function(){var e=this.props.replaceValue?null:this.props.entered;return i.a.createElement(de,{ref:this.refInput,"data-cell":"input","data-location":this.props.location,defaultValue:e,onKeyDown:this.handleOnKeyDown,onBlur:this.handleOnBlur})}}]),t}(i.a.PureComponent);var pe={setCellData:function(e,t){return{type:"SET_CELL_DATA",payload:{location:e,data:{entered:t,result:ue.interpret(e,t)}}}},clearCellData:he},ve=Object(s.b)(function(e,t){var n=e.table[t.location];return{entered:n?n.entered:""}},pe)(fe),be=Object(O.a)("div",{target:"e137pts60"})({name:"252199",styles:"display:flex;align-items:center;outline:none;border:2px solid transparent;line-height:1.1em;height:100%;width:100%;padding:2px;:focus{border:2px solid salmon;}"}),ye=function(e){function t(){var e;return Object(x.a)(this,t),(e=Object(N.a)(this,Object(C.a)(t).call(this))).refDataTag=i.a.createRef(),e.handleOnKeyDown=e.handleOnKeyDown.bind(Object(T.a)(e)),e}return Object(D.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.focusDataTag()}},{key:"focusDataTag",value:function(){this.props.isFocused&&this.refDataTag.current.focus()}},{key:"handleOnKeyDown",value:function(e){var t=e.key;(this.props.setActiveCell(this.props.location),["Delete","Backspace"].includes(t))?(""+this.props.result).length>0&&this.props.clearCellData(this.props.location):1===t.length&&this.props.onKeyDownEditable()}},{key:"getStyle",value:function(){var e={};return"number"===typeof this.props.result&&(e={whiteSpace:"nowrap",textOverflow:"clip",overflow:"hidden"}),e}},{key:"render",value:function(){return Object(u.d)(be,{ref:this.refDataTag,"data-cell":"result","data-location":this.props.location,css:this.getStyle(),tabIndex:"0",onKeyDown:this.handleOnKeyDown,onDoubleClick:this.props.onDoubleClick},this.props.result)}}]),t}(i.a.PureComponent);var me={clearCellData:he,setActiveCell:k},we=Object(s.b)(function(e,t){var n=e.table[t.location];return{result:n?n.result:""}},me)(ye),Oe=Object(O.a)("div",{target:"e17nyd4f0"})("cursor:cell;font-size:13px;border-right:1px solid ",function(e){return e.theme.colors.cell.border},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.border},";"),ke=function(e){function t(){var e;return Object(x.a)(this,t),(e=Object(N.a)(this,Object(C.a)(t).call(this))).state={displayState:P.initialState},e.displayService=Object(L.c)(P).onTransition(function(t){return e.setState({displayState:t})}),e.resultOnDoubleClick=e.resultOnDoubleClick.bind(Object(T.a)(e)),e.resultOnKeyDownEditable=e.resultOnKeyDownEditable.bind(Object(T.a)(e)),e.inputOnEscape=e.inputOnEscape.bind(Object(T.a)(e)),e.inputOnCommit=e.inputOnCommit.bind(Object(T.a)(e)),e}return Object(D.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.displayService.start()}},{key:"componentWillUnmount",value:function(){this.displayService.stop()}},{key:"resultOnDoubleClick",value:function(){this.displayService.send("EDITABLE_MODIFY")}},{key:"resultOnKeyDownEditable",value:function(){this.displayService.send("EDITABLE_REPLACE")}},{key:"inputOnEscape",value:function(){this.displayService.send("STATIC_FOCUSED")}},{key:"inputOnCommit",value:function(){this.displayService.send("STATIC")}},{key:"renderData",value:function(){var e=this.state.displayState;return e.matches("editable")?i.a.createElement(ve,{replaceValue:e.matches("editable.replace"),location:this.props.location,onEscape:this.inputOnEscape,onCommit:this.inputOnCommit}):i.a.createElement(we,{location:this.props.location,onDoubleClick:this.resultOnDoubleClick,onKeyDownEditable:this.resultOnKeyDownEditable,isFocused:e.matches("static.focused")})}},{key:"render",value:function(){return i.a.createElement(Oe,{className:"row-label-height col-label-width"},this.renderData())}}]),t}(i.a.PureComponent),ge=Object(O.a)("div",{target:"exk1gay0"})({name:"16hxjyz",styles:"display:flex;width:fit-content;"});var Ee=function(e){var t=e.rowNumber,n=e.colLabels,r=e.activeCell;return i.a.createElement(ge,{"data-row":t},i.a.createElement(F,{label:t}),new Array(n.length).fill(0).map(function(e,a){var o="".concat(n[a],"-").concat(t);return i.a.createElement(ke,{key:a,isActive:r===o,location:o})}))},xe=n(48);function je(e){var t=e.rows,n=e.columns,r=e.rowIndex,i=e.colIndex;switch(e.key){case"ArrowUp":r=Math.max(0,r-1);break;case"ArrowRight":i=Math.min(n-1,i+1);break;case"ArrowDown":case"Enter":r=Math.min(t-1,r+1);break;case"ArrowLeft":i=Math.max(0,i-1);break;default:return null}var a=function(e){var t=[],n=W,r=e+1;do{var i=n+(r-=1)%26,a=String.fromCodePoint(i);t.push(a),r=Math.floor(r/26)}while(r>0);return t.reverse().join("")}(i),o=""+(r+1);return"".concat(a,"-").concat(o)}var Ne={id:"keyboardNav",initial:"idle",context:{columns:null,rows:null,key:null,colIndex:null,rowIndex:null,endLocation:null,wasFocused:!1},states:{idle:{on:{MOVE_FOCUS:{actions:["setNewContext","calcTargetLocation"],target:"focusTarget"}}},focusTarget:{invoke:{src:function(e){return e.endLocation?new Promise(function(t){setTimeout(function(){var n='[data-location="'.concat(e.endLocation,'"]'),r=document.querySelector(n);r&&r.focus(),t(!0)},0)}):Promise.resolve(!1)},onDone:{actions:Object(L.b)({wasFocused:function(e,t){return t.data}}),target:"idle"}}}}},Ce={actions:{setNewContext:Object(L.b)(function(e,t){var n=t.key,r=X(t.location),i=Object(V.a)(r,2);return{colIndex:i[0],rowIndex:i[1],key:n}}),calcTargetLocation:Object(L.b)({endLocation:function(e){return je(e)}})}};var Te=function(e,t){var n=Object(xe.a)({},Ne.context,{columns:t,rows:e});return Object(L.a)(Ne,Ce,n)},De=Object(O.a)("div",{target:"e1tmjcr20"})("display:flex;flex-direction:column;width:fit-content;border-top:2px solid ",function(e){return e.theme.colors.cell.borderDark},";border-left:2px solid ",function(e){return e.theme.colors.cell.borderDark},";border-right:1px solid ",function(e){return e.theme.colors.cell.borderDark},";border-bottom:1px solid ",function(e){return e.theme.colors.cell.borderDark},";*{box-sizing:border-box;}.row-label-width{width:34px;}.row-label-height{min-height:28px;}.col-label-width{width:140px;}.col-label-height{min-height:26px;}"),Le=function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(N.a)(this,Object(C.a)(t).call(this,e))).keyboardNavMachine=Te(n.props.rows,n.props.columns),n.focusService=Object(L.c)(n.keyboardNavMachine),n.handleTableOnClick=n.handleTableOnClick.bind(Object(T.a)(n)),n.handleTableOnKeyDown=n.handleTableOnKeyDown.bind(Object(T.a)(n)),n.colLabels=z(e.columns),n}return Object(D.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.focusService.start()}},{key:"componentWillUnmount",value:function(){this.focusService.stop()}},{key:"handleTableOnClick",value:function(e){e.stopPropagation()}},{key:"handleTableOnKeyDown",value:function(e){e.stopPropagation(),this.moveFocus(e.key,e.target.dataset.location)}},{key:"moveFocus",value:function(e,t){this.focusService.send({type:"MOVE_FOCUS",key:e,location:t})}},{key:"renderColLabelRow",value:function(e){return i.a.createElement(I,{key:e,rows:this.props.rows,colLabels:this.colLabels})}},{key:"renderDataRows",value:function(e){return i.a.createElement(Ee,{key:e,rowNumber:e,colLabels:this.colLabels,activeCell:this.props.activeCell})}},{key:"renderRows",value:function(){var e=this;return new Array(this.props.rows+1).fill(0).map(function(t,n){return 0===n?e.renderColLabelRow(n):e.renderDataRows(n)})}},{key:"render",value:function(){return i.a.createElement(De,{"data-table":"app",onClick:this.handleTableOnClick,onKeyDown:this.handleTableOnKeyDown},this.renderRows())}}]),t}(i.a.PureComponent),Se=Object(s.b)(function(e){var t=e.global;return{activeCell:t.activeCell,rows:t.rows,columns:t.columns}})(Le),Me=Object(O.a)("div",{target:"e4x97se0"})({name:"pl3zfx",styles:'display:grid;grid:"left-blank main right-blank" 100vh / auto minmax(auto,1000px) auto;'}),Ae=Object(O.a)("main",{target:"e4x97se1"})({name:"n7iznt",styles:"grid-area:main;"});var Ue={setActiveCell:k},Ie=Object(s.b)(null,Ue)(function(e){var t=e.setActiveCell;return i.a.createElement(Me,{onClick:function(){t(null)}},i.a.createElement(Ae,null,i.a.createElement(E,null),i.a.createElement(Se,null)))});var Re=function(){return i.a.createElement(s.a,{store:p},i.a.createElement(l.a,null,i.a.createElement(c.a,{theme:m},i.a.createElement(u.a,{styles:w}),i.a.createElement(Ie,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[50,1,2]]]);
//# sourceMappingURL=main.0cfc8c11.chunk.js.map